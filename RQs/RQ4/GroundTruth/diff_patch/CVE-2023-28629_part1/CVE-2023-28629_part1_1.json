{
  "cve_id": "CVE-2023-28629",
  "cwe_ids": [
    "CWE-79"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
  "cvss_is_v3": true,
  "repo_name": "gocd",
  "commit_msg": "Improve escaping on legacy Freemarker templates",
  "commit_hash": "95f758229d419411a38577608709d8552cccf193",
  "git_url": "https://github.com/gocd/gocd/commit/95f758229d419411a38577608709d8552cccf193",
  "file_path": "server/src/main/java/com/thoughtworks/go/server/presentation/models/MaterialRevisionsJsonBuilder.java",
  "func_name": "visit",
  "func_before": "@Override\n    public void visit(MaterialRevision revision) {\n        this.revision = revision;\n        modificationsJson = new ArrayList();\n\n        materialJson = new LinkedHashMap();\n        materialJson.put(\"revision\", revision.getRevision().getRevision());\n        materialJson.put(\"revision_href\", revision.getRevision().getRevisionUrl());\n        materialJson.put(\"user\", revision.buildCausedBy());\n        materialJson.put(\"date\", formatISO8601(revision.getDateOfLatestModification()));\n        materialJson.put(\"changed\", valueOf(revision.isChanged()));\n        materialJson.put(\"modifications\", modificationsJson);\n\n        materials.add(materialJson);\n    }",
  "abstract_func_before": "@Override\n    public void visit(MaterialRevision VAR_0) {\n        this.revision = VAR_0;\n        VAR_1 = new ArrayList();\n\n        VAR_2 = new LinkedHashMap();\n        VAR_2.put(\"revision\", VAR_0.getRevision().getRevision());\n        VAR_2.put(\"revision_href\", VAR_0.getRevision().getRevisionUrl());\n        VAR_2.put(\"user\", VAR_0.buildCausedBy());\n        VAR_2.put(\"date\", formatISO8601(VAR_0.getDateOfLatestModification()));\n        VAR_2.put(\"changed\", valueOf(VAR_0.isChanged()));\n        VAR_2.put(\"modifications\", VAR_1);\n\n        VAR_3.add(VAR_2);\n    }",
  "func_graph_path_before": "gocd/95f758229d419411a38577608709d8552cccf193/MaterialRevisionsJsonBuilder.java/vul/before/0.json",
  "func": "@Override\n    public void visit(MaterialRevision revision) {\n        this.revision = revision;\n        modificationsJson = new ArrayList<>();\n\n        materialJson = new LinkedHashMap<>();\n        materialJson.put(\"revision\", revision.getRevision().getRevision());\n        materialJson.put(\"revision_href\", revision.getRevision().getRevisionUrl());\n        materialJson.put(\"user\", revision.buildCausedBy());\n        materialJson.put(\"date\", formatISO8601(revision.getDateOfLatestModification()));\n        materialJson.put(\"changed\", valueOf(revision.isChanged()));\n        materialJson.put(\"modifications\", modificationsJson);\n\n        materials.add(materialJson);\n    }",
  "abstract_func": "@Override\n    public void visit(MaterialRevision VAR_0) {\n        this.revision = VAR_0;\n        VAR_1 = new ArrayList<>();\n\n        VAR_2 = new LinkedHashMap<>();\n        VAR_2.put(\"revision\", VAR_0.getRevision().getRevision());\n        VAR_2.put(\"revision_href\", VAR_0.getRevision().getRevisionUrl());\n        VAR_2.put(\"user\", VAR_0.buildCausedBy());\n        VAR_2.put(\"date\", formatISO8601(VAR_0.getDateOfLatestModification()));\n        VAR_2.put(\"changed\", valueOf(VAR_0.isChanged()));\n        VAR_2.put(\"modifications\", VAR_1);\n\n        VAR_3.add(VAR_2);\n    }",
  "func_graph_path": "gocd/95f758229d419411a38577608709d8552cccf193/MaterialRevisionsJsonBuilder.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,9 +1,9 @@\n @Override\n     public void visit(MaterialRevision revision) {\n         this.revision = revision;\n-        modificationsJson = new ArrayList();\n+        modificationsJson = new ArrayList<>();\n \n-        materialJson = new LinkedHashMap();\n+        materialJson = new LinkedHashMap<>();\n         materialJson.put(\"revision\", revision.getRevision().getRevision());\n         materialJson.put(\"revision_href\", revision.getRevision().getRevisionUrl());\n         materialJson.put(\"user\", revision.buildCausedBy());",
  "diff_line_info": {
    "deleted_lines": [
      "        modificationsJson = new ArrayList();",
      "        materialJson = new LinkedHashMap();"
    ],
    "added_lines": [
      "        modificationsJson = new ArrayList<>();",
      "        materialJson = new LinkedHashMap<>();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/gocd/gocd/pull/11070",
  "description": {
    "pr_info": {
      "title": "Improve build label handling",
      "number": 11070
    },
    "comment": [
      "Improves escaping on\r\n- VSM renderer\r\n- Job/build detail pages (breadcrumb and sidebar build history)"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix  \nConfidence Score: 0.95",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "\n\n**Final Output:**\n\nAnalysis: The commit message and ground truth indicate improvements in escaping to prevent security issues like XSS. The code changes, though minor, support the intent of enhancing security.\n\nFinal Classification: Security Vulnerability Fix  \nConfidence Score: 0.95"
}