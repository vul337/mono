{
  "cve_id": "CVE-2020-10028",
  "cwe_ids": [
    "CWE-20"
  ],
  "cvss_vector": "AV:L/AC:L/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "zephyrproject-rtos/zephyr",
  "commit_msg": "drivers: gpio: fix syscall handlers\n\nNo driver object checks were being performed for 3 APIs.\n\nSigned-off-by: Andrew Boie <andrew.p.boie@intel.com>\nSigned-off-by: Flavio Ceolin <flavio.ceolin@intel.com>",
  "commit_hash": "17427ec995be720dc3d31331d534681d29ae9648",
  "git_url": "https://github.com/zephyrproject-rtos/zephyr/commit/17427ec995be720dc3d31331d534681d29ae9648",
  "file_path": "drivers/gpio/gpio_handlers.c",
  "func_name": "z_vrfy_gpio_disable_callback",
  "func_before": "static inline int z_vrfy_gpio_disable_callback(struct device *port,\n\t\t\t\t\t      int access_op, u32_t pin)\n{\n\treturn z_impl_gpio_disable_callback((struct device *)port, access_op,\n\t\t\t\t\t   pin);\n}",
  "abstract_func_before": "static inline int z_vrfy_gpio_disable_callback(struct device *VAR_0,\n\t\t\t\t\t      int VAR_1, u32_t VAR_2)\n{\n\treturn z_impl_gpio_disable_callback((struct device *)VAR_0, VAR_1,\n\t\t\t\t\t   VAR_2);\n}",
  "func_graph_path_before": "zephyrproject-rtos/zephyr/17427ec995be720dc3d31331d534681d29ae9648/gpio_handlers.c/vul/before/2.json",
  "func": "static inline int z_vrfy_gpio_disable_callback(struct device *port,\n\t\t\t\t\t      int access_op, u32_t pin)\n{\n\tZ_OOPS(Z_SYSCALL_DRIVER_GPIO(port, disable_callback));\n\n\treturn z_impl_gpio_disable_callback((struct device *)port, access_op,\n\t\t\t\t\t   pin);\n}",
  "abstract_func": "static inline int z_vrfy_gpio_disable_callback(struct device *VAR_0,\n\t\t\t\t\t      int VAR_1, u32_t VAR_2)\n{\n\tZ_OOPS(Z_SYSCALL_DRIVER_GPIO(VAR_0, VAR_3));\n\n\treturn z_impl_gpio_disable_callback((struct device *)VAR_0, VAR_1,\n\t\t\t\t\t   VAR_2);\n}",
  "func_graph_path": "zephyrproject-rtos/zephyr/17427ec995be720dc3d31331d534681d29ae9648/gpio_handlers.c/vul/after/2.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,6 +1,8 @@\n static inline int z_vrfy_gpio_disable_callback(struct device *port,\n \t\t\t\t\t      int access_op, u32_t pin)\n {\n+\tZ_OOPS(Z_SYSCALL_DRIVER_GPIO(port, disable_callback));\n+\n \treturn z_impl_gpio_disable_callback((struct device *)port, access_op,\n \t\t\t\t\t   pin);\n }",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "\tZ_OOPS(Z_SYSCALL_DRIVER_GPIO(port, disable_callback));",
      ""
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/zephyrproject-rtos/zephyr/pull/23737",
  "description": {
    "pr_info": {
      "title": "Backport v2.1: drivers: gpio: fix syscall handlers",
      "number": 23737
    },
    "comment": [
      "No driver object checks were being performed for 3 APIs.\r\n\r\nSigned-off-by: Andrew Boie <andrew.p.boie@intel.com>\r\nSigned-off-by: Flavio Ceolin <flavio.ceolin@intel.com>"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0"
}