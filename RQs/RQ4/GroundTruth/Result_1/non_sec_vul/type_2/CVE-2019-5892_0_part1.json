{
  "cve_id": "CVE-2019-5892",
  "cwe_ids": [
    "CWE-436"
  ],
  "cvss_vector": "AV:N/AC:L/Au:S/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "FRRouting/frr",
  "commit_msg": "bgpd: don't use BGP_ATTR_VNC(255) unless ENABLE_BGP_VNC_ATTR is defined\n\nSigned-off-by: Lou Berger <lberger@labn.net>",
  "commit_hash": "943d595a018e69b550db08cccba1d0778a86705a",
  "git_url": "https://github.com/FRRouting/frr/commit/943d595a018e69b550db08cccba1d0778a86705a",
  "file_path": "bgpd/bgp_attr.c",
  "func_name": "bgp_packet_attribute",
  "func_before": "bgp_size_t bgp_packet_attribute(struct bgp *bgp, struct peer *peer,\n\t\t\t\tstruct stream *s, struct attr *attr,\n\t\t\t\tstruct bpacket_attr_vec_arr *vecarr,\n\t\t\t\tstruct prefix *p, afi_t afi, safi_t safi,\n\t\t\t\tstruct peer *from, struct prefix_rd *prd,\n\t\t\t\tmpls_label_t *label, uint32_t num_labels,\n\t\t\t\tint addpath_encode, uint32_t addpath_tx_id)\n{\n\tsize_t cp;\n\tsize_t aspath_sizep;\n\tstruct aspath *aspath;\n\tint send_as4_path = 0;\n\tint send_as4_aggregator = 0;\n\tint use32bit = (CHECK_FLAG(peer->cap, PEER_CAP_AS4_RCV)) ? 1 : 0;\n\n\tif (!bgp)\n\t\tbgp = peer->bgp;\n\n\t/* Remember current pointer. */\n\tcp = stream_get_endp(s);\n\n\tif (p\n\t    && !((afi == AFI_IP && safi == SAFI_UNICAST)\n\t\t && !peer_cap_enhe(peer, afi, safi))) {\n\t\tsize_t mpattrlen_pos = 0;\n\n\t\tmpattrlen_pos = bgp_packet_mpattr_start(s, peer, afi, safi,\n\t\t\t\t\t\t\tvecarr, attr);\n\t\tbgp_packet_mpattr_prefix(s, afi, safi, p, prd, label,\n\t\t\t\t\t num_labels, addpath_encode,\n\t\t\t\t\t addpath_tx_id, attr);\n\t\tbgp_packet_mpattr_end(s, mpattrlen_pos);\n\t}\n\n\t/* Origin attribute. */\n\tstream_putc(s, BGP_ATTR_FLAG_TRANS);\n\tstream_putc(s, BGP_ATTR_ORIGIN);\n\tstream_putc(s, 1);\n\tstream_putc(s, attr->origin);\n\n\t/* AS path attribute. */\n\n\t/* If remote-peer is EBGP */\n\tif (peer->sort == BGP_PEER_EBGP\n\t    && (!CHECK_FLAG(peer->af_flags[afi][safi],\n\t\t\t    PEER_FLAG_AS_PATH_UNCHANGED)\n\t\t|| attr->aspath->segments == NULL)\n\t    && (!CHECK_FLAG(peer->af_flags[afi][safi],\n\t\t\t    PEER_FLAG_RSERVER_CLIENT))) {\n\t\taspath = aspath_dup(attr->aspath);\n\n\t\t/* Even though we may not be configured for confederations we\n\t\t * may have\n\t\t * RXed an AS_PATH with AS_CONFED_SEQUENCE or AS_CONFED_SET */\n\t\taspath = aspath_delete_confed_seq(aspath);\n\n\t\tif (CHECK_FLAG(bgp->config, BGP_CONFIG_CONFEDERATION)) {\n\t\t\t/* Stuff our path CONFED_ID on the front */\n\t\t\taspath = aspath_add_seq(aspath, bgp->confed_id);\n\t\t} else {\n\t\t\tif (peer->change_local_as) {\n\t\t\t\t/* If replace-as is specified, we only use the\n\t\t\t\t   change_local_as when\n\t\t\t\t   advertising routes. */\n\t\t\t\tif (!CHECK_FLAG(\n\t\t\t\t\t    peer->flags,\n\t\t\t\t\t    PEER_FLAG_LOCAL_AS_REPLACE_AS)) {\n\t\t\t\t\taspath = aspath_add_seq(aspath,\n\t\t\t\t\t\t\t\tpeer->local_as);\n\t\t\t\t}\n\t\t\t\taspath = aspath_add_seq(aspath,\n\t\t\t\t\t\t\tpeer->change_local_as);\n\t\t\t} else {\n\t\t\t\taspath = aspath_add_seq(aspath, peer->local_as);\n\t\t\t}\n\t\t}\n\t} else if (peer->sort == BGP_PEER_CONFED) {\n\t\t/* A confed member, so we need to do the AS_CONFED_SEQUENCE\n\t\t * thing */\n\t\taspath = aspath_dup(attr->aspath);\n\t\taspath = aspath_add_confed_seq(aspath, peer->local_as);\n\t} else\n\t\taspath = attr->aspath;\n\n\t/* If peer is not AS4 capable, then:\n\t * - send the created AS_PATH out as AS4_PATH (optional, transitive),\n\t *   but ensure that no AS_CONFED_SEQUENCE and AS_CONFED_SET path\n\t * segment\n\t *   types are in it (i.e. exclude them if they are there)\n\t *   AND do this only if there is at least one asnum > 65535 in the\n\t * path!\n\t * - send an AS_PATH out, but put 16Bit ASnums in it, not 32bit, and\n\t * change\n\t *   all ASnums > 65535 to BGP_AS_TRANS\n\t */\n\n\tstream_putc(s, BGP_ATTR_FLAG_TRANS | BGP_ATTR_FLAG_EXTLEN);\n\tstream_putc(s, BGP_ATTR_AS_PATH);\n\taspath_sizep = stream_get_endp(s);\n\tstream_putw(s, 0);\n\tstream_putw_at(s, aspath_sizep, aspath_put(s, aspath, use32bit));\n\n\t/* OLD session may need NEW_AS_PATH sent, if there are 4-byte ASNs\n\t * in the path\n\t */\n\tif (!use32bit && aspath_has_as4(aspath))\n\t\tsend_as4_path =\n\t\t\t1; /* we'll do this later, at the correct place */\n\n\t/* Nexthop attribute. */\n\tif (afi == AFI_IP && safi == SAFI_UNICAST\n\t    && !peer_cap_enhe(peer, afi, safi)) {\n\t\tif (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_NEXT_HOP)) {\n\t\t\tstream_putc(s, BGP_ATTR_FLAG_TRANS);\n\t\t\tstream_putc(s, BGP_ATTR_NEXT_HOP);\n\t\t\tbpacket_attr_vec_arr_set_vec(vecarr, BGP_ATTR_VEC_NH, s,\n\t\t\t\t\t\t     attr);\n\t\t\tstream_putc(s, 4);\n\t\t\tstream_put_ipv4(s, attr->nexthop.s_addr);\n\t\t} else if (peer_cap_enhe(from, afi, safi)) {\n\t\t\t/*\n\t\t\t * Likely this is the case when an IPv4 prefix was\n\t\t\t * received with\n\t\t\t * Extended Next-hop capability and now being advertised\n\t\t\t * to\n\t\t\t * non-ENHE peers.\n\t\t\t * Setting the mandatory (ipv4) next-hop attribute here\n\t\t\t * to enable\n\t\t\t * implicit next-hop self with correct (ipv4 address\n\t\t\t * family).\n\t\t\t */\n\t\t\tstream_putc(s, BGP_ATTR_FLAG_TRANS);\n\t\t\tstream_putc(s, BGP_ATTR_NEXT_HOP);\n\t\t\tbpacket_attr_vec_arr_set_vec(vecarr, BGP_ATTR_VEC_NH, s,\n\t\t\t\t\t\t     NULL);\n\t\t\tstream_putc(s, 4);\n\t\t\tstream_put_ipv4(s, 0);\n\t\t}\n\t}\n\n\t/* MED attribute. */\n\tif (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_MULTI_EXIT_DISC)\n\t    || bgp->maxmed_active) {\n\t\tstream_putc(s, BGP_ATTR_FLAG_OPTIONAL);\n\t\tstream_putc(s, BGP_ATTR_MULTI_EXIT_DISC);\n\t\tstream_putc(s, 4);\n\t\tstream_putl(s, (bgp->maxmed_active ? bgp->maxmed_value\n\t\t\t\t\t\t   : attr->med));\n\t}\n\n\t/* Local preference. */\n\tif (peer->sort == BGP_PEER_IBGP || peer->sort == BGP_PEER_CONFED) {\n\t\tstream_putc(s, BGP_ATTR_FLAG_TRANS);\n\t\tstream_putc(s, BGP_ATTR_LOCAL_PREF);\n\t\tstream_putc(s, 4);\n\t\tstream_putl(s, attr->local_pref);\n\t}\n\n\t/* Atomic aggregate. */\n\tif (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_ATOMIC_AGGREGATE)) {\n\t\tstream_putc(s, BGP_ATTR_FLAG_TRANS);\n\t\tstream_putc(s, BGP_ATTR_ATOMIC_AGGREGATE);\n\t\tstream_putc(s, 0);\n\t}\n\n\t/* Aggregator. */\n\tif (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_AGGREGATOR)) {\n\t\t/* Common to BGP_ATTR_AGGREGATOR, regardless of ASN size */\n\t\tstream_putc(s, BGP_ATTR_FLAG_OPTIONAL | BGP_ATTR_FLAG_TRANS);\n\t\tstream_putc(s, BGP_ATTR_AGGREGATOR);\n\n\t\tif (use32bit) {\n\t\t\t/* AS4 capable peer */\n\t\t\tstream_putc(s, 8);\n\t\t\tstream_putl(s, attr->aggregator_as);\n\t\t} else {\n\t\t\t/* 2-byte AS peer */\n\t\t\tstream_putc(s, 6);\n\n\t\t\t/* Is ASN representable in 2-bytes? Or must AS_TRANS be\n\t\t\t * used? */\n\t\t\tif (attr->aggregator_as > 65535) {\n\t\t\t\tstream_putw(s, BGP_AS_TRANS);\n\n\t\t\t\t/* we have to send AS4_AGGREGATOR, too.\n\t\t\t\t * we'll do that later in order to send\n\t\t\t\t * attributes in ascending\n\t\t\t\t * order.\n\t\t\t\t */\n\t\t\t\tsend_as4_aggregator = 1;\n\t\t\t} else\n\t\t\t\tstream_putw(s, (uint16_t)attr->aggregator_as);\n\t\t}\n\t\tstream_put_ipv4(s, attr->aggregator_addr.s_addr);\n\t}\n\n\t/* Community attribute. */\n\tif (CHECK_FLAG(peer->af_flags[afi][safi], PEER_FLAG_SEND_COMMUNITY)\n\t    && (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_COMMUNITIES))) {\n\t\tif (attr->community->size * 4 > 255) {\n\t\t\tstream_putc(s,\n\t\t\t\t    BGP_ATTR_FLAG_OPTIONAL | BGP_ATTR_FLAG_TRANS\n\t\t\t\t\t    | BGP_ATTR_FLAG_EXTLEN);\n\t\t\tstream_putc(s, BGP_ATTR_COMMUNITIES);\n\t\t\tstream_putw(s, attr->community->size * 4);\n\t\t} else {\n\t\t\tstream_putc(s,\n\t\t\t\t    BGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t\t    | BGP_ATTR_FLAG_TRANS);\n\t\t\tstream_putc(s, BGP_ATTR_COMMUNITIES);\n\t\t\tstream_putc(s, attr->community->size * 4);\n\t\t}\n\t\tstream_put(s, attr->community->val, attr->community->size * 4);\n\t}\n\n\t/*\n\t * Large Community attribute.\n\t */\n\tif (CHECK_FLAG(peer->af_flags[afi][safi],\n\t\t       PEER_FLAG_SEND_LARGE_COMMUNITY)\n\t    && (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_LARGE_COMMUNITIES))) {\n\t\tif (lcom_length(attr->lcommunity) > 255) {\n\t\t\tstream_putc(s,\n\t\t\t\t    BGP_ATTR_FLAG_OPTIONAL | BGP_ATTR_FLAG_TRANS\n\t\t\t\t\t    | BGP_ATTR_FLAG_EXTLEN);\n\t\t\tstream_putc(s, BGP_ATTR_LARGE_COMMUNITIES);\n\t\t\tstream_putw(s, lcom_length(attr->lcommunity));\n\t\t} else {\n\t\t\tstream_putc(s,\n\t\t\t\t    BGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t\t    | BGP_ATTR_FLAG_TRANS);\n\t\t\tstream_putc(s, BGP_ATTR_LARGE_COMMUNITIES);\n\t\t\tstream_putc(s, lcom_length(attr->lcommunity));\n\t\t}\n\t\tstream_put(s, attr->lcommunity->val,\n\t\t\t   lcom_length(attr->lcommunity));\n\t}\n\n\t/* Route Reflector. */\n\tif (peer->sort == BGP_PEER_IBGP && from\n\t    && from->sort == BGP_PEER_IBGP) {\n\t\t/* Originator ID. */\n\t\tstream_putc(s, BGP_ATTR_FLAG_OPTIONAL);\n\t\tstream_putc(s, BGP_ATTR_ORIGINATOR_ID);\n\t\tstream_putc(s, 4);\n\n\t\tif (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_ORIGINATOR_ID))\n\t\t\tstream_put_in_addr(s, &attr->originator_id);\n\t\telse\n\t\t\tstream_put_in_addr(s, &from->remote_id);\n\n\t\t/* Cluster list. */\n\t\tstream_putc(s, BGP_ATTR_FLAG_OPTIONAL);\n\t\tstream_putc(s, BGP_ATTR_CLUSTER_LIST);\n\n\t\tif (attr->cluster) {\n\t\t\tstream_putc(s, attr->cluster->length + 4);\n\t\t\t/* If this peer configuration's parent BGP has\n\t\t\t * cluster_id. */\n\t\t\tif (bgp->config & BGP_CONFIG_CLUSTER_ID)\n\t\t\t\tstream_put_in_addr(s, &bgp->cluster_id);\n\t\t\telse\n\t\t\t\tstream_put_in_addr(s, &bgp->router_id);\n\t\t\tstream_put(s, attr->cluster->list,\n\t\t\t\t   attr->cluster->length);\n\t\t} else {\n\t\t\tstream_putc(s, 4);\n\t\t\t/* If this peer configuration's parent BGP has\n\t\t\t * cluster_id. */\n\t\t\tif (bgp->config & BGP_CONFIG_CLUSTER_ID)\n\t\t\t\tstream_put_in_addr(s, &bgp->cluster_id);\n\t\t\telse\n\t\t\t\tstream_put_in_addr(s, &bgp->router_id);\n\t\t}\n\t}\n\n\t/* Extended Communities attribute. */\n\tif (CHECK_FLAG(peer->af_flags[afi][safi], PEER_FLAG_SEND_EXT_COMMUNITY)\n\t    && (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_EXT_COMMUNITIES))) {\n\t\tif (peer->sort == BGP_PEER_IBGP\n\t\t    || peer->sort == BGP_PEER_CONFED) {\n\t\t\tif (attr->ecommunity->size * 8 > 255) {\n\t\t\t\tstream_putc(s,\n\t\t\t\t\t    BGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t\t\t    | BGP_ATTR_FLAG_TRANS\n\t\t\t\t\t\t    | BGP_ATTR_FLAG_EXTLEN);\n\t\t\t\tstream_putc(s, BGP_ATTR_EXT_COMMUNITIES);\n\t\t\t\tstream_putw(s, attr->ecommunity->size * 8);\n\t\t\t} else {\n\t\t\t\tstream_putc(s,\n\t\t\t\t\t    BGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t\t\t    | BGP_ATTR_FLAG_TRANS);\n\t\t\t\tstream_putc(s, BGP_ATTR_EXT_COMMUNITIES);\n\t\t\t\tstream_putc(s, attr->ecommunity->size * 8);\n\t\t\t}\n\t\t\tstream_put(s, attr->ecommunity->val,\n\t\t\t\t   attr->ecommunity->size * 8);\n\t\t} else {\n\t\t\tuint8_t *pnt;\n\t\t\tint tbit;\n\t\t\tint ecom_tr_size = 0;\n\t\t\tint i;\n\n\t\t\tfor (i = 0; i < attr->ecommunity->size; i++) {\n\t\t\t\tpnt = attr->ecommunity->val + (i * 8);\n\t\t\t\ttbit = *pnt;\n\n\t\t\t\tif (CHECK_FLAG(tbit,\n\t\t\t\t\t       ECOMMUNITY_FLAG_NON_TRANSITIVE))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tecom_tr_size++;\n\t\t\t}\n\n\t\t\tif (ecom_tr_size) {\n\t\t\t\tif (ecom_tr_size * 8 > 255) {\n\t\t\t\t\tstream_putc(\n\t\t\t\t\t\ts,\n\t\t\t\t\t\tBGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t\t\t\t| BGP_ATTR_FLAG_TRANS\n\t\t\t\t\t\t\t| BGP_ATTR_FLAG_EXTLEN);\n\t\t\t\t\tstream_putc(s,\n\t\t\t\t\t\t    BGP_ATTR_EXT_COMMUNITIES);\n\t\t\t\t\tstream_putw(s, ecom_tr_size * 8);\n\t\t\t\t} else {\n\t\t\t\t\tstream_putc(\n\t\t\t\t\t\ts,\n\t\t\t\t\t\tBGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t\t\t\t| BGP_ATTR_FLAG_TRANS);\n\t\t\t\t\tstream_putc(s,\n\t\t\t\t\t\t    BGP_ATTR_EXT_COMMUNITIES);\n\t\t\t\t\tstream_putc(s, ecom_tr_size * 8);\n\t\t\t\t}\n\n\t\t\t\tfor (i = 0; i < attr->ecommunity->size; i++) {\n\t\t\t\t\tpnt = attr->ecommunity->val + (i * 8);\n\t\t\t\t\ttbit = *pnt;\n\n\t\t\t\t\tif (CHECK_FLAG(\n\t\t\t\t\t\t    tbit,\n\t\t\t\t\t\t    ECOMMUNITY_FLAG_NON_TRANSITIVE))\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tstream_put(s, pnt, 8);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/* Label index attribute. */\n\tif (safi == SAFI_LABELED_UNICAST) {\n\t\tif (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_PREFIX_SID)) {\n\t\t\tuint32_t label_index;\n\n\t\t\tlabel_index = attr->label_index;\n\n\t\t\tif (label_index != BGP_INVALID_LABEL_INDEX) {\n\t\t\t\tstream_putc(s,\n\t\t\t\t\t    BGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t\t\t    | BGP_ATTR_FLAG_TRANS);\n\t\t\t\tstream_putc(s, BGP_ATTR_PREFIX_SID);\n\t\t\t\tstream_putc(s, 10);\n\t\t\t\tstream_putc(s, BGP_PREFIX_SID_LABEL_INDEX);\n\t\t\t\tstream_putw(s,\n\t\t\t\t\t    BGP_PREFIX_SID_LABEL_INDEX_LENGTH);\n\t\t\t\tstream_putc(s, 0); // reserved\n\t\t\t\tstream_putw(s, 0); // flags\n\t\t\t\tstream_putl(s, label_index);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (send_as4_path) {\n\t\t/* If the peer is NOT As4 capable, AND */\n\t\t/* there are ASnums > 65535 in path  THEN\n\t\t * give out AS4_PATH */\n\n\t\t/* Get rid of all AS_CONFED_SEQUENCE and AS_CONFED_SET\n\t\t * path segments!\n\t\t * Hm, I wonder...  confederation things *should* only be at\n\t\t * the beginning of an aspath, right?  Then we should use\n\t\t * aspath_delete_confed_seq for this, because it is already\n\t\t * there! (JK)\n\t\t * Folks, talk to me: what is reasonable here!?\n\t\t */\n\t\taspath = aspath_delete_confed_seq(aspath);\n\n\t\tstream_putc(s,\n\t\t\t    BGP_ATTR_FLAG_TRANS | BGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t    | BGP_ATTR_FLAG_EXTLEN);\n\t\tstream_putc(s, BGP_ATTR_AS4_PATH);\n\t\taspath_sizep = stream_get_endp(s);\n\t\tstream_putw(s, 0);\n\t\tstream_putw_at(s, aspath_sizep, aspath_put(s, aspath, 1));\n\t}\n\n\tif (aspath != attr->aspath)\n\t\taspath_free(aspath);\n\n\tif (send_as4_aggregator) {\n\t\t/* send AS4_AGGREGATOR, at this place */\n\t\t/* this section of code moved here in order to ensure the\n\t\t * correct\n\t\t * *ascending* order of attributes\n\t\t */\n\t\tstream_putc(s, BGP_ATTR_FLAG_OPTIONAL | BGP_ATTR_FLAG_TRANS);\n\t\tstream_putc(s, BGP_ATTR_AS4_AGGREGATOR);\n\t\tstream_putc(s, 8);\n\t\tstream_putl(s, attr->aggregator_as);\n\t\tstream_put_ipv4(s, attr->aggregator_addr.s_addr);\n\t}\n\n\tif (((afi == AFI_IP || afi == AFI_IP6)\n\t     && (safi == SAFI_ENCAP || safi == SAFI_MPLS_VPN))\n\t    || (afi == AFI_L2VPN && safi == SAFI_EVPN)) {\n\t\t/* Tunnel Encap attribute */\n\t\tbgp_packet_mpattr_tea(bgp, peer, s, attr, BGP_ATTR_ENCAP);\n\n#if ENABLE_BGP_VNC\n\t\t/* VNC attribute */\n\t\tbgp_packet_mpattr_tea(bgp, peer, s, attr, BGP_ATTR_VNC);\n#endif\n\t}\n\n\t/* PMSI Tunnel */\n\tif (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_PMSI_TUNNEL)) {\n\t\tstream_putc(s, BGP_ATTR_FLAG_OPTIONAL | BGP_ATTR_FLAG_TRANS);\n\t\tstream_putc(s, BGP_ATTR_PMSI_TUNNEL);\n\t\tstream_putc(s, 9); // Length\n\t\tstream_putc(s, 0); // Flags\n\t\tstream_putc(s, PMSI_TNLTYPE_INGR_REPL); // IR (6)\n\t\tstream_put(s, &(attr->label),\n\t\t\t   BGP_LABEL_BYTES); // MPLS Label / VXLAN VNI\n\t\tstream_put_ipv4(s, attr->nexthop.s_addr);\n\t\t// Unicast tunnel endpoint IP address\n\t}\n\n\t/* Unknown transit attribute. */\n\tif (attr->transit)\n\t\tstream_put(s, attr->transit->val, attr->transit->length);\n\n\t/* Return total size of attribute. */\n\treturn stream_get_endp(s) - cp;\n}",
  "abstract_func_before": "bgp_size_t bgp_packet_attribute(struct bgp *bgp, struct peer *peer,\n\t\t\t\tstruct stream *VAR_0, struct attr *attr,\n\t\t\t\tstruct bpacket_attr_vec_arr *VAR_1,\n\t\t\t\tstruct prefix *VAR_2, afi_t VAR_3, safi_t VAR_4,\n\t\t\t\tstruct peer *VAR_5, struct prefix_rd *VAR_6,\n\t\t\t\tmpls_label_t *VAR_7, uint32_t VAR_8,\n\t\t\t\tint VAR_9, uint32_t VAR_10)\n{\n\tsize_t VAR_11;\n\tsize_t VAR_12;\n\tstruct aspath *aspath;\n\tint VAR_13 = 0;\n\tint VAR_14 = 0;\n\tint VAR_15 = (CHECK_FLAG(peer->cap, VAR_16)) ? 1 : 0;\n\n\tif (!bgp)\n\t\tbgp = peer->bgp;\n\n\t/* COMMENT_0 */\n\tVAR_11 = stream_get_endp(VAR_0);\n\n\tif (VAR_2\n\t    && !((VAR_3 == VAR_17 && VAR_4 == VAR_18)\n\t\t && !peer_cap_enhe(peer, VAR_3, VAR_4))) {\n\t\tsize_t VAR_19 = 0;\n\n\t\tVAR_19 = bgp_packet_mpattr_start(VAR_0, peer, VAR_3, VAR_4,\n\t\t\t\t\t\t\tVAR_1, attr);\n\t\tbgp_packet_mpattr_prefix(VAR_0, VAR_3, VAR_4, VAR_2, VAR_6, VAR_7,\n\t\t\t\t\t VAR_8, VAR_9,\n\t\t\t\t\t VAR_10, attr);\n\t\tbgp_packet_mpattr_end(VAR_0, VAR_19);\n\t}\n\n\t/* COMMENT_1 */\n\tstream_putc(VAR_0, VAR_20);\n\tstream_putc(VAR_0, VAR_21);\n\tstream_putc(VAR_0, 1);\n\tstream_putc(VAR_0, attr->origin);\n\n\t/* COMMENT_2 */\n\n\t/* COMMENT_3 */\n\tif (peer->sort == VAR_22\n\t    && (!CHECK_FLAG(peer->af_flags[VAR_3][VAR_4],\n\t\t\t    VAR_23)\n\t\t|| attr->aspath->segments == NULL)\n\t    && (!CHECK_FLAG(peer->af_flags[VAR_3][VAR_4],\n\t\t\t    VAR_24))) {\n\t\taspath = aspath_dup(attr->aspath);\n\n\t\t/* COMMENT_4 */\n             \n                                                                \n\t\taspath = aspath_delete_confed_seq(aspath);\n\n\t\tif (CHECK_FLAG(bgp->config, VAR_25)) {\n\t\t\t/* COMMENT_7 */\n\t\t\taspath = aspath_add_seq(aspath, bgp->confed_id);\n\t\t} else {\n\t\t\tif (peer->change_local_as) {\n\t\t\t\t/* COMMENT_8 */\n                           \n                             \n\t\t\t\tif (!CHECK_FLAG(\n\t\t\t\t\t    peer->flags,\n\t\t\t\t\t    VAR_26)) {\n\t\t\t\t\taspath = aspath_add_seq(aspath,\n\t\t\t\t\t\t\t\tpeer->local_as);\n\t\t\t\t}\n\t\t\t\taspath = aspath_add_seq(aspath,\n\t\t\t\t\t\t\tpeer->change_local_as);\n\t\t\t} else {\n\t\t\t\taspath = aspath_add_seq(aspath, peer->local_as);\n\t\t\t}\n\t\t}\n\t} else if (peer->sort == VAR_27) {\n\t\t/* COMMENT_11 */\n             \n\t\taspath = aspath_dup(attr->aspath);\n\t\taspath = aspath_add_confed_seq(aspath, peer->local_as);\n\t} else\n\t\taspath = attr->aspath;\n\n\t/* COMMENT_13 */\n                                                                      \n                                                                  \n           \n                                                           \n                                                                    \n         \n                                                                     \n          \n                                        \n    \n\n\tstream_putc(VAR_0, VAR_20 | VAR_28);\n\tstream_putc(VAR_0, VAR_29);\n\tVAR_12 = stream_get_endp(VAR_0);\n\tstream_putw(VAR_0, 0);\n\tstream_putw_at(VAR_0, VAR_12, aspath_put(VAR_0, aspath, VAR_15));\n\n\t/* COMMENT_24 */\n               \n    \n\tif (!VAR_15 && aspath_has_as4(aspath))\n\t\tVAR_13 =\n\t\t\t1; /* COMMENT_27 */\n\n\t/* COMMENT_28 */\n\tif (VAR_3 == VAR_17 && VAR_4 == VAR_18\n\t    && !peer_cap_enhe(peer, VAR_3, VAR_4)) {\n\t\tif (attr->flag & ATTR_FLAG_BIT(VAR_30)) {\n\t\t\tstream_putc(VAR_0, VAR_20);\n\t\t\tstream_putc(VAR_0, VAR_30);\n\t\t\tbpacket_attr_vec_arr_set_vec(VAR_1, VAR_31, VAR_0,\n\t\t\t\t\t\t     attr);\n\t\t\tstream_putc(VAR_0, 4);\n\t\t\tstream_put_ipv4(VAR_0, attr->nexthop.s_addr);\n\t\t} else if (peer_cap_enhe(VAR_5, VAR_3, VAR_4)) {\n\t\t\t/* COMMENT_29 */\n                                                     \n                   \n                                                           \n        \n                     \n                                                          \n               \n                                                       \n              \n      \n\t\t\tstream_putc(VAR_0, VAR_20);\n\t\t\tstream_putc(VAR_0, VAR_30);\n\t\t\tbpacket_attr_vec_arr_set_vec(VAR_1, VAR_31, VAR_0,\n\t\t\t\t\t\t     NULL);\n\t\t\tstream_putc(VAR_0, 4);\n\t\t\tstream_put_ipv4(VAR_0, 0);\n\t\t}\n\t}\n\n\t/* COMMENT_40 */\n\tif (attr->flag & ATTR_FLAG_BIT(VAR_32)\n\t    || bgp->maxmed_active) {\n\t\tstream_putc(VAR_0, VAR_33);\n\t\tstream_putc(VAR_0, VAR_32);\n\t\tstream_putc(VAR_0, 4);\n\t\tstream_putl(VAR_0, (bgp->maxmed_active ? bgp->maxmed_value\n\t\t\t\t\t\t   : attr->med));\n\t}\n\n\t/* COMMENT_41 */\n\tif (peer->sort == VAR_34 || peer->sort == VAR_27) {\n\t\tstream_putc(VAR_0, VAR_20);\n\t\tstream_putc(VAR_0, VAR_35);\n\t\tstream_putc(VAR_0, 4);\n\t\tstream_putl(VAR_0, attr->local_pref);\n\t}\n\n\t/* COMMENT_42 */\n\tif (attr->flag & ATTR_FLAG_BIT(VAR_36)) {\n\t\tstream_putc(VAR_0, VAR_20);\n\t\tstream_putc(VAR_0, VAR_36);\n\t\tstream_putc(VAR_0, 0);\n\t}\n\n\t/* COMMENT_43 */\n\tif (attr->flag & ATTR_FLAG_BIT(VAR_37)) {\n\t\t/* COMMENT_44 */\n\t\tstream_putc(VAR_0, VAR_33 | VAR_20);\n\t\tstream_putc(VAR_0, VAR_37);\n\n\t\tif (VAR_15) {\n\t\t\t/* COMMENT_45 */\n\t\t\tstream_putc(VAR_0, 8);\n\t\t\tstream_putl(VAR_0, attr->aggregator_as);\n\t\t} else {\n\t\t\t/* COMMENT_46 */\n\t\t\tstream_putc(VAR_0, 6);\n\n\t\t\t/* COMMENT_47 */\n              \n\t\t\tif (attr->aggregator_as > 65535) {\n\t\t\t\tstream_putw(VAR_0, VAR_38);\n\n\t\t\t\t/* COMMENT_49 */\n                                           \n                              \n             \n       \n\t\t\t\tVAR_14 = 1;\n\t\t\t} else\n\t\t\t\tstream_putw(VAR_0, (uint16_t)attr->aggregator_as);\n\t\t}\n\t\tstream_put_ipv4(VAR_0, attr->aggregator_addr.s_addr);\n\t}\n\n\t/* COMMENT_54 */\n\tif (CHECK_FLAG(peer->af_flags[VAR_3][VAR_4], VAR_39)\n\t    && (attr->flag & ATTR_FLAG_BIT(VAR_40))) {\n\t\tif (attr->community->size * 4 > 255) {\n\t\t\tstream_putc(VAR_0,\n\t\t\t\t    VAR_33 | VAR_20\n\t\t\t\t\t    | VAR_28);\n\t\t\tstream_putc(VAR_0, VAR_40);\n\t\t\tstream_putw(VAR_0, attr->community->size * 4);\n\t\t} else {\n\t\t\tstream_putc(VAR_0,\n\t\t\t\t    VAR_33\n\t\t\t\t\t    | VAR_20);\n\t\t\tstream_putc(VAR_0, VAR_40);\n\t\t\tstream_putc(VAR_0, attr->community->size * 4);\n\t\t}\n\t\tstream_put(VAR_0, attr->community->val, attr->community->size * 4);\n\t}\n\n\t/* COMMENT_55 */\n                              \n    \n\tif (CHECK_FLAG(peer->af_flags[VAR_3][VAR_4],\n\t\t       VAR_41)\n\t    && (attr->flag & ATTR_FLAG_BIT(VAR_42))) {\n\t\tif (lcom_length(attr->lcommunity) > 255) {\n\t\t\tstream_putc(VAR_0,\n\t\t\t\t    VAR_33 | VAR_20\n\t\t\t\t\t    | VAR_28);\n\t\t\tstream_putc(VAR_0, VAR_42);\n\t\t\tstream_putw(VAR_0, lcom_length(attr->lcommunity));\n\t\t} else {\n\t\t\tstream_putc(VAR_0,\n\t\t\t\t    VAR_33\n\t\t\t\t\t    | VAR_20);\n\t\t\tstream_putc(VAR_0, VAR_42);\n\t\t\tstream_putc(VAR_0, lcom_length(attr->lcommunity));\n\t\t}\n\t\tstream_put(VAR_0, attr->lcommunity->val,\n\t\t\t   lcom_length(attr->lcommunity));\n\t}\n\n\t/* COMMENT_58 */\n\tif (peer->sort == VAR_34 && VAR_5\n\t    && VAR_5->sort == VAR_34) {\n\t\t/* COMMENT_59 */\n\t\tstream_putc(VAR_0, VAR_33);\n\t\tstream_putc(VAR_0, VAR_43);\n\t\tstream_putc(VAR_0, 4);\n\n\t\tif (attr->flag & ATTR_FLAG_BIT(VAR_43))\n\t\t\tstream_put_in_addr(VAR_0, &attr->originator_id);\n\t\telse\n\t\t\tstream_put_in_addr(VAR_0, &VAR_5->remote_id);\n\n\t\t/* COMMENT_60 */\n\t\tstream_putc(VAR_0, VAR_33);\n\t\tstream_putc(VAR_0, VAR_44);\n\n\t\tif (attr->cluster) {\n\t\t\tstream_putc(VAR_0, attr->cluster->length + 4);\n\t\t\t/* COMMENT_61 */\n                    \n\t\t\tif (bgp->config & VAR_45)\n\t\t\t\tstream_put_in_addr(VAR_0, &bgp->cluster_id);\n\t\t\telse\n\t\t\t\tstream_put_in_addr(VAR_0, &bgp->router_id);\n\t\t\tstream_put(VAR_0, attr->cluster->list,\n\t\t\t\t   attr->cluster->length);\n\t\t} else {\n\t\t\tstream_putc(VAR_0, 4);\n\t\t\t/* COMMENT_63 */\n                    \n\t\t\tif (bgp->config & VAR_45)\n\t\t\t\tstream_put_in_addr(VAR_0, &bgp->cluster_id);\n\t\t\telse\n\t\t\t\tstream_put_in_addr(VAR_0, &bgp->router_id);\n\t\t}\n\t}\n\n\t/* COMMENT_65 */\n\tif (CHECK_FLAG(peer->af_flags[VAR_3][VAR_4], VAR_46)\n\t    && (attr->flag & ATTR_FLAG_BIT(VAR_47))) {\n\t\tif (peer->sort == VAR_34\n\t\t    || peer->sort == VAR_27) {\n\t\t\tif (attr->ecommunity->size * 8 > 255) {\n\t\t\t\tstream_putc(VAR_0,\n\t\t\t\t\t    VAR_33\n\t\t\t\t\t\t    | VAR_20\n\t\t\t\t\t\t    | VAR_28);\n\t\t\t\tstream_putc(VAR_0, VAR_47);\n\t\t\t\tstream_putw(VAR_0, attr->ecommunity->size * 8);\n\t\t\t} else {\n\t\t\t\tstream_putc(VAR_0,\n\t\t\t\t\t    VAR_33\n\t\t\t\t\t\t    | VAR_20);\n\t\t\t\tstream_putc(VAR_0, VAR_47);\n\t\t\t\tstream_putc(VAR_0, attr->ecommunity->size * 8);\n\t\t\t}\n\t\t\tstream_put(VAR_0, attr->ecommunity->val,\n\t\t\t\t   attr->ecommunity->size * 8);\n\t\t} else {\n\t\t\tuint8_t *VAR_48;\n\t\t\tint VAR_49;\n\t\t\tint VAR_50 = 0;\n\t\t\tint VAR_51;\n\n\t\t\tfor (VAR_51 = 0; VAR_51 < attr->ecommunity->size; VAR_51++) {\n\t\t\t\tVAR_48 = attr->ecommunity->val + (VAR_51 * 8);\n\t\t\t\tVAR_49 = *VAR_48;\n\n\t\t\t\tif (CHECK_FLAG(VAR_49,\n\t\t\t\t\t       VAR_52))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tVAR_50++;\n\t\t\t}\n\n\t\t\tif (VAR_50) {\n\t\t\t\tif (VAR_50 * 8 > 255) {\n\t\t\t\t\tstream_putc(\n\t\t\t\t\t\tVAR_0,\n\t\t\t\t\t\tVAR_33\n\t\t\t\t\t\t\t| VAR_20\n\t\t\t\t\t\t\t| VAR_28);\n\t\t\t\t\tstream_putc(VAR_0,\n\t\t\t\t\t\t    VAR_47);\n\t\t\t\t\tstream_putw(VAR_0, VAR_50 * 8);\n\t\t\t\t} else {\n\t\t\t\t\tstream_putc(\n\t\t\t\t\t\tVAR_0,\n\t\t\t\t\t\tVAR_33\n\t\t\t\t\t\t\t| VAR_20);\n\t\t\t\t\tstream_putc(VAR_0,\n\t\t\t\t\t\t    VAR_47);\n\t\t\t\t\tstream_putc(VAR_0, VAR_50 * 8);\n\t\t\t\t}\n\n\t\t\t\tfor (VAR_51 = 0; VAR_51 < attr->ecommunity->size; VAR_51++) {\n\t\t\t\t\tVAR_48 = attr->ecommunity->val + (VAR_51 * 8);\n\t\t\t\t\tVAR_49 = *VAR_48;\n\n\t\t\t\t\tif (CHECK_FLAG(\n\t\t\t\t\t\t    VAR_49,\n\t\t\t\t\t\t    VAR_52))\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tstream_put(VAR_0, VAR_48, 8);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/* COMMENT_66 */\n\tif (VAR_4 == VAR_53) {\n\t\tif (attr->flag & ATTR_FLAG_BIT(VAR_54)) {\n\t\t\tuint32_t VAR_55;\n\n\t\t\tVAR_55 = attr->label_index;\n\n\t\t\tif (VAR_55 != VAR_56) {\n\t\t\t\tstream_putc(VAR_0,\n\t\t\t\t\t    VAR_33\n\t\t\t\t\t\t    | VAR_20);\n\t\t\t\tstream_putc(VAR_0, VAR_54);\n\t\t\t\tstream_putc(VAR_0, 10);\n\t\t\t\tstream_putc(VAR_0, VAR_57);\n\t\t\t\tstream_putw(VAR_0,\n\t\t\t\t\t    VAR_58);\n\t\t\t\tstream_putc(VAR_0, 0); /* COMMENT_67 */\n\t\t\t\tstream_putw(VAR_0, 0); /* COMMENT_68 */\n\t\t\t\tstream_putl(VAR_0, VAR_55);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (VAR_13) {\n\t\t/* COMMENT_69 */\n\t\t/* COMMENT_70 */\n                         \n\n\t\t/* COMMENT_72 */\n                   \n                                                              \n                                                           \n                                                             \n                \n                                                 \n     \n\t\taspath = aspath_delete_confed_seq(aspath);\n\n\t\tstream_putc(VAR_0,\n\t\t\t    VAR_20 | VAR_33\n\t\t\t\t    | VAR_28);\n\t\tstream_putc(VAR_0, VAR_59);\n\t\tVAR_12 = stream_get_endp(VAR_0);\n\t\tstream_putw(VAR_0, 0);\n\t\tstream_putw_at(VAR_0, VAR_12, aspath_put(VAR_0, aspath, 1));\n\t}\n\n\tif (aspath != attr->aspath)\n\t\taspath_free(aspath);\n\n\tif (VAR_14) {\n\t\t/* COMMENT_80 */\n\t\t/* COMMENT_81 */\n            \n                                    \n     \n\t\tstream_putc(VAR_0, VAR_33 | VAR_20);\n\t\tstream_putc(VAR_0, VAR_60);\n\t\tstream_putc(VAR_0, 8);\n\t\tstream_putl(VAR_0, attr->aggregator_as);\n\t\tstream_put_ipv4(VAR_0, attr->aggregator_addr.s_addr);\n\t}\n\n\tif (((VAR_3 == VAR_17 || VAR_3 == VAR_61)\n\t     && (VAR_4 == VAR_62 || VAR_4 == VAR_63))\n\t    || (VAR_3 == VAR_64 && VAR_4 == VAR_65)) {\n\t\t/* COMMENT_85 */\n\t\tbgp_packet_mpattr_tea(bgp, peer, VAR_0, attr, VAR_66);\n\n#if VAR_67\n\t\t/* COMMENT_86 */\n\t\tbgp_packet_mpattr_tea(bgp, peer, VAR_0, attr, VAR_68);\n#endif\n\t}\n\n\t/* COMMENT_87 */\n\tif (attr->flag & ATTR_FLAG_BIT(VAR_69)) {\n\t\tstream_putc(VAR_0, VAR_33 | VAR_20);\n\t\tstream_putc(VAR_0, VAR_69);\n\t\tstream_putc(VAR_0, 9); /* COMMENT_88 */\n\t\tstream_putc(VAR_0, 0); /* COMMENT_89 */\n\t\tstream_putc(VAR_0, VAR_70); /* COMMENT_90 */\n\t\tstream_put(VAR_0, &(attr->label),\n\t\t\t   VAR_71); /* COMMENT_91 */\n\t\tstream_put_ipv4(VAR_0, attr->nexthop.s_addr);\n\t\t/* COMMENT_92 */\n\t}\n\n\t/* COMMENT_93 */\n\tif (attr->transit)\n\t\tstream_put(VAR_0, attr->transit->val, attr->transit->length);\n\n\t/* COMMENT_94 */\n\treturn stream_get_endp(VAR_0) - VAR_11;\n}",
  "func_graph_path_before": "FRRouting/frr/943d595a018e69b550db08cccba1d0778a86705a/bgp_attr.c/vul/before/1.json",
  "func": "bgp_size_t bgp_packet_attribute(struct bgp *bgp, struct peer *peer,\n\t\t\t\tstruct stream *s, struct attr *attr,\n\t\t\t\tstruct bpacket_attr_vec_arr *vecarr,\n\t\t\t\tstruct prefix *p, afi_t afi, safi_t safi,\n\t\t\t\tstruct peer *from, struct prefix_rd *prd,\n\t\t\t\tmpls_label_t *label, uint32_t num_labels,\n\t\t\t\tint addpath_encode, uint32_t addpath_tx_id)\n{\n\tsize_t cp;\n\tsize_t aspath_sizep;\n\tstruct aspath *aspath;\n\tint send_as4_path = 0;\n\tint send_as4_aggregator = 0;\n\tint use32bit = (CHECK_FLAG(peer->cap, PEER_CAP_AS4_RCV)) ? 1 : 0;\n\n\tif (!bgp)\n\t\tbgp = peer->bgp;\n\n\t/* Remember current pointer. */\n\tcp = stream_get_endp(s);\n\n\tif (p\n\t    && !((afi == AFI_IP && safi == SAFI_UNICAST)\n\t\t && !peer_cap_enhe(peer, afi, safi))) {\n\t\tsize_t mpattrlen_pos = 0;\n\n\t\tmpattrlen_pos = bgp_packet_mpattr_start(s, peer, afi, safi,\n\t\t\t\t\t\t\tvecarr, attr);\n\t\tbgp_packet_mpattr_prefix(s, afi, safi, p, prd, label,\n\t\t\t\t\t num_labels, addpath_encode,\n\t\t\t\t\t addpath_tx_id, attr);\n\t\tbgp_packet_mpattr_end(s, mpattrlen_pos);\n\t}\n\n\t/* Origin attribute. */\n\tstream_putc(s, BGP_ATTR_FLAG_TRANS);\n\tstream_putc(s, BGP_ATTR_ORIGIN);\n\tstream_putc(s, 1);\n\tstream_putc(s, attr->origin);\n\n\t/* AS path attribute. */\n\n\t/* If remote-peer is EBGP */\n\tif (peer->sort == BGP_PEER_EBGP\n\t    && (!CHECK_FLAG(peer->af_flags[afi][safi],\n\t\t\t    PEER_FLAG_AS_PATH_UNCHANGED)\n\t\t|| attr->aspath->segments == NULL)\n\t    && (!CHECK_FLAG(peer->af_flags[afi][safi],\n\t\t\t    PEER_FLAG_RSERVER_CLIENT))) {\n\t\taspath = aspath_dup(attr->aspath);\n\n\t\t/* Even though we may not be configured for confederations we\n\t\t * may have\n\t\t * RXed an AS_PATH with AS_CONFED_SEQUENCE or AS_CONFED_SET */\n\t\taspath = aspath_delete_confed_seq(aspath);\n\n\t\tif (CHECK_FLAG(bgp->config, BGP_CONFIG_CONFEDERATION)) {\n\t\t\t/* Stuff our path CONFED_ID on the front */\n\t\t\taspath = aspath_add_seq(aspath, bgp->confed_id);\n\t\t} else {\n\t\t\tif (peer->change_local_as) {\n\t\t\t\t/* If replace-as is specified, we only use the\n\t\t\t\t   change_local_as when\n\t\t\t\t   advertising routes. */\n\t\t\t\tif (!CHECK_FLAG(\n\t\t\t\t\t    peer->flags,\n\t\t\t\t\t    PEER_FLAG_LOCAL_AS_REPLACE_AS)) {\n\t\t\t\t\taspath = aspath_add_seq(aspath,\n\t\t\t\t\t\t\t\tpeer->local_as);\n\t\t\t\t}\n\t\t\t\taspath = aspath_add_seq(aspath,\n\t\t\t\t\t\t\tpeer->change_local_as);\n\t\t\t} else {\n\t\t\t\taspath = aspath_add_seq(aspath, peer->local_as);\n\t\t\t}\n\t\t}\n\t} else if (peer->sort == BGP_PEER_CONFED) {\n\t\t/* A confed member, so we need to do the AS_CONFED_SEQUENCE\n\t\t * thing */\n\t\taspath = aspath_dup(attr->aspath);\n\t\taspath = aspath_add_confed_seq(aspath, peer->local_as);\n\t} else\n\t\taspath = attr->aspath;\n\n\t/* If peer is not AS4 capable, then:\n\t * - send the created AS_PATH out as AS4_PATH (optional, transitive),\n\t *   but ensure that no AS_CONFED_SEQUENCE and AS_CONFED_SET path\n\t * segment\n\t *   types are in it (i.e. exclude them if they are there)\n\t *   AND do this only if there is at least one asnum > 65535 in the\n\t * path!\n\t * - send an AS_PATH out, but put 16Bit ASnums in it, not 32bit, and\n\t * change\n\t *   all ASnums > 65535 to BGP_AS_TRANS\n\t */\n\n\tstream_putc(s, BGP_ATTR_FLAG_TRANS | BGP_ATTR_FLAG_EXTLEN);\n\tstream_putc(s, BGP_ATTR_AS_PATH);\n\taspath_sizep = stream_get_endp(s);\n\tstream_putw(s, 0);\n\tstream_putw_at(s, aspath_sizep, aspath_put(s, aspath, use32bit));\n\n\t/* OLD session may need NEW_AS_PATH sent, if there are 4-byte ASNs\n\t * in the path\n\t */\n\tif (!use32bit && aspath_has_as4(aspath))\n\t\tsend_as4_path =\n\t\t\t1; /* we'll do this later, at the correct place */\n\n\t/* Nexthop attribute. */\n\tif (afi == AFI_IP && safi == SAFI_UNICAST\n\t    && !peer_cap_enhe(peer, afi, safi)) {\n\t\tif (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_NEXT_HOP)) {\n\t\t\tstream_putc(s, BGP_ATTR_FLAG_TRANS);\n\t\t\tstream_putc(s, BGP_ATTR_NEXT_HOP);\n\t\t\tbpacket_attr_vec_arr_set_vec(vecarr, BGP_ATTR_VEC_NH, s,\n\t\t\t\t\t\t     attr);\n\t\t\tstream_putc(s, 4);\n\t\t\tstream_put_ipv4(s, attr->nexthop.s_addr);\n\t\t} else if (peer_cap_enhe(from, afi, safi)) {\n\t\t\t/*\n\t\t\t * Likely this is the case when an IPv4 prefix was\n\t\t\t * received with\n\t\t\t * Extended Next-hop capability and now being advertised\n\t\t\t * to\n\t\t\t * non-ENHE peers.\n\t\t\t * Setting the mandatory (ipv4) next-hop attribute here\n\t\t\t * to enable\n\t\t\t * implicit next-hop self with correct (ipv4 address\n\t\t\t * family).\n\t\t\t */\n\t\t\tstream_putc(s, BGP_ATTR_FLAG_TRANS);\n\t\t\tstream_putc(s, BGP_ATTR_NEXT_HOP);\n\t\t\tbpacket_attr_vec_arr_set_vec(vecarr, BGP_ATTR_VEC_NH, s,\n\t\t\t\t\t\t     NULL);\n\t\t\tstream_putc(s, 4);\n\t\t\tstream_put_ipv4(s, 0);\n\t\t}\n\t}\n\n\t/* MED attribute. */\n\tif (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_MULTI_EXIT_DISC)\n\t    || bgp->maxmed_active) {\n\t\tstream_putc(s, BGP_ATTR_FLAG_OPTIONAL);\n\t\tstream_putc(s, BGP_ATTR_MULTI_EXIT_DISC);\n\t\tstream_putc(s, 4);\n\t\tstream_putl(s, (bgp->maxmed_active ? bgp->maxmed_value\n\t\t\t\t\t\t   : attr->med));\n\t}\n\n\t/* Local preference. */\n\tif (peer->sort == BGP_PEER_IBGP || peer->sort == BGP_PEER_CONFED) {\n\t\tstream_putc(s, BGP_ATTR_FLAG_TRANS);\n\t\tstream_putc(s, BGP_ATTR_LOCAL_PREF);\n\t\tstream_putc(s, 4);\n\t\tstream_putl(s, attr->local_pref);\n\t}\n\n\t/* Atomic aggregate. */\n\tif (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_ATOMIC_AGGREGATE)) {\n\t\tstream_putc(s, BGP_ATTR_FLAG_TRANS);\n\t\tstream_putc(s, BGP_ATTR_ATOMIC_AGGREGATE);\n\t\tstream_putc(s, 0);\n\t}\n\n\t/* Aggregator. */\n\tif (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_AGGREGATOR)) {\n\t\t/* Common to BGP_ATTR_AGGREGATOR, regardless of ASN size */\n\t\tstream_putc(s, BGP_ATTR_FLAG_OPTIONAL | BGP_ATTR_FLAG_TRANS);\n\t\tstream_putc(s, BGP_ATTR_AGGREGATOR);\n\n\t\tif (use32bit) {\n\t\t\t/* AS4 capable peer */\n\t\t\tstream_putc(s, 8);\n\t\t\tstream_putl(s, attr->aggregator_as);\n\t\t} else {\n\t\t\t/* 2-byte AS peer */\n\t\t\tstream_putc(s, 6);\n\n\t\t\t/* Is ASN representable in 2-bytes? Or must AS_TRANS be\n\t\t\t * used? */\n\t\t\tif (attr->aggregator_as > 65535) {\n\t\t\t\tstream_putw(s, BGP_AS_TRANS);\n\n\t\t\t\t/* we have to send AS4_AGGREGATOR, too.\n\t\t\t\t * we'll do that later in order to send\n\t\t\t\t * attributes in ascending\n\t\t\t\t * order.\n\t\t\t\t */\n\t\t\t\tsend_as4_aggregator = 1;\n\t\t\t} else\n\t\t\t\tstream_putw(s, (uint16_t)attr->aggregator_as);\n\t\t}\n\t\tstream_put_ipv4(s, attr->aggregator_addr.s_addr);\n\t}\n\n\t/* Community attribute. */\n\tif (CHECK_FLAG(peer->af_flags[afi][safi], PEER_FLAG_SEND_COMMUNITY)\n\t    && (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_COMMUNITIES))) {\n\t\tif (attr->community->size * 4 > 255) {\n\t\t\tstream_putc(s,\n\t\t\t\t    BGP_ATTR_FLAG_OPTIONAL | BGP_ATTR_FLAG_TRANS\n\t\t\t\t\t    | BGP_ATTR_FLAG_EXTLEN);\n\t\t\tstream_putc(s, BGP_ATTR_COMMUNITIES);\n\t\t\tstream_putw(s, attr->community->size * 4);\n\t\t} else {\n\t\t\tstream_putc(s,\n\t\t\t\t    BGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t\t    | BGP_ATTR_FLAG_TRANS);\n\t\t\tstream_putc(s, BGP_ATTR_COMMUNITIES);\n\t\t\tstream_putc(s, attr->community->size * 4);\n\t\t}\n\t\tstream_put(s, attr->community->val, attr->community->size * 4);\n\t}\n\n\t/*\n\t * Large Community attribute.\n\t */\n\tif (CHECK_FLAG(peer->af_flags[afi][safi],\n\t\t       PEER_FLAG_SEND_LARGE_COMMUNITY)\n\t    && (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_LARGE_COMMUNITIES))) {\n\t\tif (lcom_length(attr->lcommunity) > 255) {\n\t\t\tstream_putc(s,\n\t\t\t\t    BGP_ATTR_FLAG_OPTIONAL | BGP_ATTR_FLAG_TRANS\n\t\t\t\t\t    | BGP_ATTR_FLAG_EXTLEN);\n\t\t\tstream_putc(s, BGP_ATTR_LARGE_COMMUNITIES);\n\t\t\tstream_putw(s, lcom_length(attr->lcommunity));\n\t\t} else {\n\t\t\tstream_putc(s,\n\t\t\t\t    BGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t\t    | BGP_ATTR_FLAG_TRANS);\n\t\t\tstream_putc(s, BGP_ATTR_LARGE_COMMUNITIES);\n\t\t\tstream_putc(s, lcom_length(attr->lcommunity));\n\t\t}\n\t\tstream_put(s, attr->lcommunity->val,\n\t\t\t   lcom_length(attr->lcommunity));\n\t}\n\n\t/* Route Reflector. */\n\tif (peer->sort == BGP_PEER_IBGP && from\n\t    && from->sort == BGP_PEER_IBGP) {\n\t\t/* Originator ID. */\n\t\tstream_putc(s, BGP_ATTR_FLAG_OPTIONAL);\n\t\tstream_putc(s, BGP_ATTR_ORIGINATOR_ID);\n\t\tstream_putc(s, 4);\n\n\t\tif (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_ORIGINATOR_ID))\n\t\t\tstream_put_in_addr(s, &attr->originator_id);\n\t\telse\n\t\t\tstream_put_in_addr(s, &from->remote_id);\n\n\t\t/* Cluster list. */\n\t\tstream_putc(s, BGP_ATTR_FLAG_OPTIONAL);\n\t\tstream_putc(s, BGP_ATTR_CLUSTER_LIST);\n\n\t\tif (attr->cluster) {\n\t\t\tstream_putc(s, attr->cluster->length + 4);\n\t\t\t/* If this peer configuration's parent BGP has\n\t\t\t * cluster_id. */\n\t\t\tif (bgp->config & BGP_CONFIG_CLUSTER_ID)\n\t\t\t\tstream_put_in_addr(s, &bgp->cluster_id);\n\t\t\telse\n\t\t\t\tstream_put_in_addr(s, &bgp->router_id);\n\t\t\tstream_put(s, attr->cluster->list,\n\t\t\t\t   attr->cluster->length);\n\t\t} else {\n\t\t\tstream_putc(s, 4);\n\t\t\t/* If this peer configuration's parent BGP has\n\t\t\t * cluster_id. */\n\t\t\tif (bgp->config & BGP_CONFIG_CLUSTER_ID)\n\t\t\t\tstream_put_in_addr(s, &bgp->cluster_id);\n\t\t\telse\n\t\t\t\tstream_put_in_addr(s, &bgp->router_id);\n\t\t}\n\t}\n\n\t/* Extended Communities attribute. */\n\tif (CHECK_FLAG(peer->af_flags[afi][safi], PEER_FLAG_SEND_EXT_COMMUNITY)\n\t    && (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_EXT_COMMUNITIES))) {\n\t\tif (peer->sort == BGP_PEER_IBGP\n\t\t    || peer->sort == BGP_PEER_CONFED) {\n\t\t\tif (attr->ecommunity->size * 8 > 255) {\n\t\t\t\tstream_putc(s,\n\t\t\t\t\t    BGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t\t\t    | BGP_ATTR_FLAG_TRANS\n\t\t\t\t\t\t    | BGP_ATTR_FLAG_EXTLEN);\n\t\t\t\tstream_putc(s, BGP_ATTR_EXT_COMMUNITIES);\n\t\t\t\tstream_putw(s, attr->ecommunity->size * 8);\n\t\t\t} else {\n\t\t\t\tstream_putc(s,\n\t\t\t\t\t    BGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t\t\t    | BGP_ATTR_FLAG_TRANS);\n\t\t\t\tstream_putc(s, BGP_ATTR_EXT_COMMUNITIES);\n\t\t\t\tstream_putc(s, attr->ecommunity->size * 8);\n\t\t\t}\n\t\t\tstream_put(s, attr->ecommunity->val,\n\t\t\t\t   attr->ecommunity->size * 8);\n\t\t} else {\n\t\t\tuint8_t *pnt;\n\t\t\tint tbit;\n\t\t\tint ecom_tr_size = 0;\n\t\t\tint i;\n\n\t\t\tfor (i = 0; i < attr->ecommunity->size; i++) {\n\t\t\t\tpnt = attr->ecommunity->val + (i * 8);\n\t\t\t\ttbit = *pnt;\n\n\t\t\t\tif (CHECK_FLAG(tbit,\n\t\t\t\t\t       ECOMMUNITY_FLAG_NON_TRANSITIVE))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tecom_tr_size++;\n\t\t\t}\n\n\t\t\tif (ecom_tr_size) {\n\t\t\t\tif (ecom_tr_size * 8 > 255) {\n\t\t\t\t\tstream_putc(\n\t\t\t\t\t\ts,\n\t\t\t\t\t\tBGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t\t\t\t| BGP_ATTR_FLAG_TRANS\n\t\t\t\t\t\t\t| BGP_ATTR_FLAG_EXTLEN);\n\t\t\t\t\tstream_putc(s,\n\t\t\t\t\t\t    BGP_ATTR_EXT_COMMUNITIES);\n\t\t\t\t\tstream_putw(s, ecom_tr_size * 8);\n\t\t\t\t} else {\n\t\t\t\t\tstream_putc(\n\t\t\t\t\t\ts,\n\t\t\t\t\t\tBGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t\t\t\t| BGP_ATTR_FLAG_TRANS);\n\t\t\t\t\tstream_putc(s,\n\t\t\t\t\t\t    BGP_ATTR_EXT_COMMUNITIES);\n\t\t\t\t\tstream_putc(s, ecom_tr_size * 8);\n\t\t\t\t}\n\n\t\t\t\tfor (i = 0; i < attr->ecommunity->size; i++) {\n\t\t\t\t\tpnt = attr->ecommunity->val + (i * 8);\n\t\t\t\t\ttbit = *pnt;\n\n\t\t\t\t\tif (CHECK_FLAG(\n\t\t\t\t\t\t    tbit,\n\t\t\t\t\t\t    ECOMMUNITY_FLAG_NON_TRANSITIVE))\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tstream_put(s, pnt, 8);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/* Label index attribute. */\n\tif (safi == SAFI_LABELED_UNICAST) {\n\t\tif (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_PREFIX_SID)) {\n\t\t\tuint32_t label_index;\n\n\t\t\tlabel_index = attr->label_index;\n\n\t\t\tif (label_index != BGP_INVALID_LABEL_INDEX) {\n\t\t\t\tstream_putc(s,\n\t\t\t\t\t    BGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t\t\t    | BGP_ATTR_FLAG_TRANS);\n\t\t\t\tstream_putc(s, BGP_ATTR_PREFIX_SID);\n\t\t\t\tstream_putc(s, 10);\n\t\t\t\tstream_putc(s, BGP_PREFIX_SID_LABEL_INDEX);\n\t\t\t\tstream_putw(s,\n\t\t\t\t\t    BGP_PREFIX_SID_LABEL_INDEX_LENGTH);\n\t\t\t\tstream_putc(s, 0); // reserved\n\t\t\t\tstream_putw(s, 0); // flags\n\t\t\t\tstream_putl(s, label_index);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (send_as4_path) {\n\t\t/* If the peer is NOT As4 capable, AND */\n\t\t/* there are ASnums > 65535 in path  THEN\n\t\t * give out AS4_PATH */\n\n\t\t/* Get rid of all AS_CONFED_SEQUENCE and AS_CONFED_SET\n\t\t * path segments!\n\t\t * Hm, I wonder...  confederation things *should* only be at\n\t\t * the beginning of an aspath, right?  Then we should use\n\t\t * aspath_delete_confed_seq for this, because it is already\n\t\t * there! (JK)\n\t\t * Folks, talk to me: what is reasonable here!?\n\t\t */\n\t\taspath = aspath_delete_confed_seq(aspath);\n\n\t\tstream_putc(s,\n\t\t\t    BGP_ATTR_FLAG_TRANS | BGP_ATTR_FLAG_OPTIONAL\n\t\t\t\t    | BGP_ATTR_FLAG_EXTLEN);\n\t\tstream_putc(s, BGP_ATTR_AS4_PATH);\n\t\taspath_sizep = stream_get_endp(s);\n\t\tstream_putw(s, 0);\n\t\tstream_putw_at(s, aspath_sizep, aspath_put(s, aspath, 1));\n\t}\n\n\tif (aspath != attr->aspath)\n\t\taspath_free(aspath);\n\n\tif (send_as4_aggregator) {\n\t\t/* send AS4_AGGREGATOR, at this place */\n\t\t/* this section of code moved here in order to ensure the\n\t\t * correct\n\t\t * *ascending* order of attributes\n\t\t */\n\t\tstream_putc(s, BGP_ATTR_FLAG_OPTIONAL | BGP_ATTR_FLAG_TRANS);\n\t\tstream_putc(s, BGP_ATTR_AS4_AGGREGATOR);\n\t\tstream_putc(s, 8);\n\t\tstream_putl(s, attr->aggregator_as);\n\t\tstream_put_ipv4(s, attr->aggregator_addr.s_addr);\n\t}\n\n\tif (((afi == AFI_IP || afi == AFI_IP6)\n\t     && (safi == SAFI_ENCAP || safi == SAFI_MPLS_VPN))\n\t    || (afi == AFI_L2VPN && safi == SAFI_EVPN)) {\n\t\t/* Tunnel Encap attribute */\n\t\tbgp_packet_mpattr_tea(bgp, peer, s, attr, BGP_ATTR_ENCAP);\n\n#if ENABLE_BGP_VNC_ATTR\n\t\t/* VNC attribute */\n\t\tbgp_packet_mpattr_tea(bgp, peer, s, attr, BGP_ATTR_VNC);\n#endif\n\t}\n\n\t/* PMSI Tunnel */\n\tif (attr->flag & ATTR_FLAG_BIT(BGP_ATTR_PMSI_TUNNEL)) {\n\t\tstream_putc(s, BGP_ATTR_FLAG_OPTIONAL | BGP_ATTR_FLAG_TRANS);\n\t\tstream_putc(s, BGP_ATTR_PMSI_TUNNEL);\n\t\tstream_putc(s, 9); // Length\n\t\tstream_putc(s, 0); // Flags\n\t\tstream_putc(s, PMSI_TNLTYPE_INGR_REPL); // IR (6)\n\t\tstream_put(s, &(attr->label),\n\t\t\t   BGP_LABEL_BYTES); // MPLS Label / VXLAN VNI\n\t\tstream_put_ipv4(s, attr->nexthop.s_addr);\n\t\t// Unicast tunnel endpoint IP address\n\t}\n\n\t/* Unknown transit attribute. */\n\tif (attr->transit)\n\t\tstream_put(s, attr->transit->val, attr->transit->length);\n\n\t/* Return total size of attribute. */\n\treturn stream_get_endp(s) - cp;\n}",
  "abstract_func": "bgp_size_t bgp_packet_attribute(struct bgp *bgp, struct peer *peer,\n\t\t\t\tstruct stream *VAR_0, struct attr *attr,\n\t\t\t\tstruct bpacket_attr_vec_arr *VAR_1,\n\t\t\t\tstruct prefix *VAR_2, afi_t VAR_3, safi_t VAR_4,\n\t\t\t\tstruct peer *VAR_5, struct prefix_rd *VAR_6,\n\t\t\t\tmpls_label_t *VAR_7, uint32_t VAR_8,\n\t\t\t\tint VAR_9, uint32_t VAR_10)\n{\n\tsize_t VAR_11;\n\tsize_t VAR_12;\n\tstruct aspath *aspath;\n\tint VAR_13 = 0;\n\tint VAR_14 = 0;\n\tint VAR_15 = (CHECK_FLAG(peer->cap, VAR_16)) ? 1 : 0;\n\n\tif (!bgp)\n\t\tbgp = peer->bgp;\n\n\t/* COMMENT_0 */\n\tVAR_11 = stream_get_endp(VAR_0);\n\n\tif (VAR_2\n\t    && !((VAR_3 == VAR_17 && VAR_4 == VAR_18)\n\t\t && !peer_cap_enhe(peer, VAR_3, VAR_4))) {\n\t\tsize_t VAR_19 = 0;\n\n\t\tVAR_19 = bgp_packet_mpattr_start(VAR_0, peer, VAR_3, VAR_4,\n\t\t\t\t\t\t\tVAR_1, attr);\n\t\tbgp_packet_mpattr_prefix(VAR_0, VAR_3, VAR_4, VAR_2, VAR_6, VAR_7,\n\t\t\t\t\t VAR_8, VAR_9,\n\t\t\t\t\t VAR_10, attr);\n\t\tbgp_packet_mpattr_end(VAR_0, VAR_19);\n\t}\n\n\t/* COMMENT_1 */\n\tstream_putc(VAR_0, VAR_20);\n\tstream_putc(VAR_0, VAR_21);\n\tstream_putc(VAR_0, 1);\n\tstream_putc(VAR_0, attr->origin);\n\n\t/* COMMENT_2 */\n\n\t/* COMMENT_3 */\n\tif (peer->sort == VAR_22\n\t    && (!CHECK_FLAG(peer->af_flags[VAR_3][VAR_4],\n\t\t\t    VAR_23)\n\t\t|| attr->aspath->segments == NULL)\n\t    && (!CHECK_FLAG(peer->af_flags[VAR_3][VAR_4],\n\t\t\t    VAR_24))) {\n\t\taspath = aspath_dup(attr->aspath);\n\n\t\t/* COMMENT_4 */\n             \n                                                                \n\t\taspath = aspath_delete_confed_seq(aspath);\n\n\t\tif (CHECK_FLAG(bgp->config, VAR_25)) {\n\t\t\t/* COMMENT_7 */\n\t\t\taspath = aspath_add_seq(aspath, bgp->confed_id);\n\t\t} else {\n\t\t\tif (peer->change_local_as) {\n\t\t\t\t/* COMMENT_8 */\n                           \n                             \n\t\t\t\tif (!CHECK_FLAG(\n\t\t\t\t\t    peer->flags,\n\t\t\t\t\t    VAR_26)) {\n\t\t\t\t\taspath = aspath_add_seq(aspath,\n\t\t\t\t\t\t\t\tpeer->local_as);\n\t\t\t\t}\n\t\t\t\taspath = aspath_add_seq(aspath,\n\t\t\t\t\t\t\tpeer->change_local_as);\n\t\t\t} else {\n\t\t\t\taspath = aspath_add_seq(aspath, peer->local_as);\n\t\t\t}\n\t\t}\n\t} else if (peer->sort == VAR_27) {\n\t\t/* COMMENT_11 */\n             \n\t\taspath = aspath_dup(attr->aspath);\n\t\taspath = aspath_add_confed_seq(aspath, peer->local_as);\n\t} else\n\t\taspath = attr->aspath;\n\n\t/* COMMENT_13 */\n                                                                      \n                                                                  \n           \n                                                           \n                                                                    \n         \n                                                                     \n          \n                                        \n    \n\n\tstream_putc(VAR_0, VAR_20 | VAR_28);\n\tstream_putc(VAR_0, VAR_29);\n\tVAR_12 = stream_get_endp(VAR_0);\n\tstream_putw(VAR_0, 0);\n\tstream_putw_at(VAR_0, VAR_12, aspath_put(VAR_0, aspath, VAR_15));\n\n\t/* COMMENT_24 */\n               \n    \n\tif (!VAR_15 && aspath_has_as4(aspath))\n\t\tVAR_13 =\n\t\t\t1; /* COMMENT_27 */\n\n\t/* COMMENT_28 */\n\tif (VAR_3 == VAR_17 && VAR_4 == VAR_18\n\t    && !peer_cap_enhe(peer, VAR_3, VAR_4)) {\n\t\tif (attr->flag & ATTR_FLAG_BIT(VAR_30)) {\n\t\t\tstream_putc(VAR_0, VAR_20);\n\t\t\tstream_putc(VAR_0, VAR_30);\n\t\t\tbpacket_attr_vec_arr_set_vec(VAR_1, VAR_31, VAR_0,\n\t\t\t\t\t\t     attr);\n\t\t\tstream_putc(VAR_0, 4);\n\t\t\tstream_put_ipv4(VAR_0, attr->nexthop.s_addr);\n\t\t} else if (peer_cap_enhe(VAR_5, VAR_3, VAR_4)) {\n\t\t\t/* COMMENT_29 */\n                                                     \n                   \n                                                           \n        \n                     \n                                                          \n               \n                                                       \n              \n      \n\t\t\tstream_putc(VAR_0, VAR_20);\n\t\t\tstream_putc(VAR_0, VAR_30);\n\t\t\tbpacket_attr_vec_arr_set_vec(VAR_1, VAR_31, VAR_0,\n\t\t\t\t\t\t     NULL);\n\t\t\tstream_putc(VAR_0, 4);\n\t\t\tstream_put_ipv4(VAR_0, 0);\n\t\t}\n\t}\n\n\t/* COMMENT_40 */\n\tif (attr->flag & ATTR_FLAG_BIT(VAR_32)\n\t    || bgp->maxmed_active) {\n\t\tstream_putc(VAR_0, VAR_33);\n\t\tstream_putc(VAR_0, VAR_32);\n\t\tstream_putc(VAR_0, 4);\n\t\tstream_putl(VAR_0, (bgp->maxmed_active ? bgp->maxmed_value\n\t\t\t\t\t\t   : attr->med));\n\t}\n\n\t/* COMMENT_41 */\n\tif (peer->sort == VAR_34 || peer->sort == VAR_27) {\n\t\tstream_putc(VAR_0, VAR_20);\n\t\tstream_putc(VAR_0, VAR_35);\n\t\tstream_putc(VAR_0, 4);\n\t\tstream_putl(VAR_0, attr->local_pref);\n\t}\n\n\t/* COMMENT_42 */\n\tif (attr->flag & ATTR_FLAG_BIT(VAR_36)) {\n\t\tstream_putc(VAR_0, VAR_20);\n\t\tstream_putc(VAR_0, VAR_36);\n\t\tstream_putc(VAR_0, 0);\n\t}\n\n\t/* COMMENT_43 */\n\tif (attr->flag & ATTR_FLAG_BIT(VAR_37)) {\n\t\t/* COMMENT_44 */\n\t\tstream_putc(VAR_0, VAR_33 | VAR_20);\n\t\tstream_putc(VAR_0, VAR_37);\n\n\t\tif (VAR_15) {\n\t\t\t/* COMMENT_45 */\n\t\t\tstream_putc(VAR_0, 8);\n\t\t\tstream_putl(VAR_0, attr->aggregator_as);\n\t\t} else {\n\t\t\t/* COMMENT_46 */\n\t\t\tstream_putc(VAR_0, 6);\n\n\t\t\t/* COMMENT_47 */\n              \n\t\t\tif (attr->aggregator_as > 65535) {\n\t\t\t\tstream_putw(VAR_0, VAR_38);\n\n\t\t\t\t/* COMMENT_49 */\n                                           \n                              \n             \n       \n\t\t\t\tVAR_14 = 1;\n\t\t\t} else\n\t\t\t\tstream_putw(VAR_0, (uint16_t)attr->aggregator_as);\n\t\t}\n\t\tstream_put_ipv4(VAR_0, attr->aggregator_addr.s_addr);\n\t}\n\n\t/* COMMENT_54 */\n\tif (CHECK_FLAG(peer->af_flags[VAR_3][VAR_4], VAR_39)\n\t    && (attr->flag & ATTR_FLAG_BIT(VAR_40))) {\n\t\tif (attr->community->size * 4 > 255) {\n\t\t\tstream_putc(VAR_0,\n\t\t\t\t    VAR_33 | VAR_20\n\t\t\t\t\t    | VAR_28);\n\t\t\tstream_putc(VAR_0, VAR_40);\n\t\t\tstream_putw(VAR_0, attr->community->size * 4);\n\t\t} else {\n\t\t\tstream_putc(VAR_0,\n\t\t\t\t    VAR_33\n\t\t\t\t\t    | VAR_20);\n\t\t\tstream_putc(VAR_0, VAR_40);\n\t\t\tstream_putc(VAR_0, attr->community->size * 4);\n\t\t}\n\t\tstream_put(VAR_0, attr->community->val, attr->community->size * 4);\n\t}\n\n\t/* COMMENT_55 */\n                              \n    \n\tif (CHECK_FLAG(peer->af_flags[VAR_3][VAR_4],\n\t\t       VAR_41)\n\t    && (attr->flag & ATTR_FLAG_BIT(VAR_42))) {\n\t\tif (lcom_length(attr->lcommunity) > 255) {\n\t\t\tstream_putc(VAR_0,\n\t\t\t\t    VAR_33 | VAR_20\n\t\t\t\t\t    | VAR_28);\n\t\t\tstream_putc(VAR_0, VAR_42);\n\t\t\tstream_putw(VAR_0, lcom_length(attr->lcommunity));\n\t\t} else {\n\t\t\tstream_putc(VAR_0,\n\t\t\t\t    VAR_33\n\t\t\t\t\t    | VAR_20);\n\t\t\tstream_putc(VAR_0, VAR_42);\n\t\t\tstream_putc(VAR_0, lcom_length(attr->lcommunity));\n\t\t}\n\t\tstream_put(VAR_0, attr->lcommunity->val,\n\t\t\t   lcom_length(attr->lcommunity));\n\t}\n\n\t/* COMMENT_58 */\n\tif (peer->sort == VAR_34 && VAR_5\n\t    && VAR_5->sort == VAR_34) {\n\t\t/* COMMENT_59 */\n\t\tstream_putc(VAR_0, VAR_33);\n\t\tstream_putc(VAR_0, VAR_43);\n\t\tstream_putc(VAR_0, 4);\n\n\t\tif (attr->flag & ATTR_FLAG_BIT(VAR_43))\n\t\t\tstream_put_in_addr(VAR_0, &attr->originator_id);\n\t\telse\n\t\t\tstream_put_in_addr(VAR_0, &VAR_5->remote_id);\n\n\t\t/* COMMENT_60 */\n\t\tstream_putc(VAR_0, VAR_33);\n\t\tstream_putc(VAR_0, VAR_44);\n\n\t\tif (attr->cluster) {\n\t\t\tstream_putc(VAR_0, attr->cluster->length + 4);\n\t\t\t/* COMMENT_61 */\n                    \n\t\t\tif (bgp->config & VAR_45)\n\t\t\t\tstream_put_in_addr(VAR_0, &bgp->cluster_id);\n\t\t\telse\n\t\t\t\tstream_put_in_addr(VAR_0, &bgp->router_id);\n\t\t\tstream_put(VAR_0, attr->cluster->list,\n\t\t\t\t   attr->cluster->length);\n\t\t} else {\n\t\t\tstream_putc(VAR_0, 4);\n\t\t\t/* COMMENT_63 */\n                    \n\t\t\tif (bgp->config & VAR_45)\n\t\t\t\tstream_put_in_addr(VAR_0, &bgp->cluster_id);\n\t\t\telse\n\t\t\t\tstream_put_in_addr(VAR_0, &bgp->router_id);\n\t\t}\n\t}\n\n\t/* COMMENT_65 */\n\tif (CHECK_FLAG(peer->af_flags[VAR_3][VAR_4], VAR_46)\n\t    && (attr->flag & ATTR_FLAG_BIT(VAR_47))) {\n\t\tif (peer->sort == VAR_34\n\t\t    || peer->sort == VAR_27) {\n\t\t\tif (attr->ecommunity->size * 8 > 255) {\n\t\t\t\tstream_putc(VAR_0,\n\t\t\t\t\t    VAR_33\n\t\t\t\t\t\t    | VAR_20\n\t\t\t\t\t\t    | VAR_28);\n\t\t\t\tstream_putc(VAR_0, VAR_47);\n\t\t\t\tstream_putw(VAR_0, attr->ecommunity->size * 8);\n\t\t\t} else {\n\t\t\t\tstream_putc(VAR_0,\n\t\t\t\t\t    VAR_33\n\t\t\t\t\t\t    | VAR_20);\n\t\t\t\tstream_putc(VAR_0, VAR_47);\n\t\t\t\tstream_putc(VAR_0, attr->ecommunity->size * 8);\n\t\t\t}\n\t\t\tstream_put(VAR_0, attr->ecommunity->val,\n\t\t\t\t   attr->ecommunity->size * 8);\n\t\t} else {\n\t\t\tuint8_t *VAR_48;\n\t\t\tint VAR_49;\n\t\t\tint VAR_50 = 0;\n\t\t\tint VAR_51;\n\n\t\t\tfor (VAR_51 = 0; VAR_51 < attr->ecommunity->size; VAR_51++) {\n\t\t\t\tVAR_48 = attr->ecommunity->val + (VAR_51 * 8);\n\t\t\t\tVAR_49 = *VAR_48;\n\n\t\t\t\tif (CHECK_FLAG(VAR_49,\n\t\t\t\t\t       VAR_52))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tVAR_50++;\n\t\t\t}\n\n\t\t\tif (VAR_50) {\n\t\t\t\tif (VAR_50 * 8 > 255) {\n\t\t\t\t\tstream_putc(\n\t\t\t\t\t\tVAR_0,\n\t\t\t\t\t\tVAR_33\n\t\t\t\t\t\t\t| VAR_20\n\t\t\t\t\t\t\t| VAR_28);\n\t\t\t\t\tstream_putc(VAR_0,\n\t\t\t\t\t\t    VAR_47);\n\t\t\t\t\tstream_putw(VAR_0, VAR_50 * 8);\n\t\t\t\t} else {\n\t\t\t\t\tstream_putc(\n\t\t\t\t\t\tVAR_0,\n\t\t\t\t\t\tVAR_33\n\t\t\t\t\t\t\t| VAR_20);\n\t\t\t\t\tstream_putc(VAR_0,\n\t\t\t\t\t\t    VAR_47);\n\t\t\t\t\tstream_putc(VAR_0, VAR_50 * 8);\n\t\t\t\t}\n\n\t\t\t\tfor (VAR_51 = 0; VAR_51 < attr->ecommunity->size; VAR_51++) {\n\t\t\t\t\tVAR_48 = attr->ecommunity->val + (VAR_51 * 8);\n\t\t\t\t\tVAR_49 = *VAR_48;\n\n\t\t\t\t\tif (CHECK_FLAG(\n\t\t\t\t\t\t    VAR_49,\n\t\t\t\t\t\t    VAR_52))\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tstream_put(VAR_0, VAR_48, 8);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/* COMMENT_66 */\n\tif (VAR_4 == VAR_53) {\n\t\tif (attr->flag & ATTR_FLAG_BIT(VAR_54)) {\n\t\t\tuint32_t VAR_55;\n\n\t\t\tVAR_55 = attr->label_index;\n\n\t\t\tif (VAR_55 != VAR_56) {\n\t\t\t\tstream_putc(VAR_0,\n\t\t\t\t\t    VAR_33\n\t\t\t\t\t\t    | VAR_20);\n\t\t\t\tstream_putc(VAR_0, VAR_54);\n\t\t\t\tstream_putc(VAR_0, 10);\n\t\t\t\tstream_putc(VAR_0, VAR_57);\n\t\t\t\tstream_putw(VAR_0,\n\t\t\t\t\t    VAR_58);\n\t\t\t\tstream_putc(VAR_0, 0); /* COMMENT_67 */\n\t\t\t\tstream_putw(VAR_0, 0); /* COMMENT_68 */\n\t\t\t\tstream_putl(VAR_0, VAR_55);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (VAR_13) {\n\t\t/* COMMENT_69 */\n\t\t/* COMMENT_70 */\n                         \n\n\t\t/* COMMENT_72 */\n                   \n                                                              \n                                                           \n                                                             \n                \n                                                 \n     \n\t\taspath = aspath_delete_confed_seq(aspath);\n\n\t\tstream_putc(VAR_0,\n\t\t\t    VAR_20 | VAR_33\n\t\t\t\t    | VAR_28);\n\t\tstream_putc(VAR_0, VAR_59);\n\t\tVAR_12 = stream_get_endp(VAR_0);\n\t\tstream_putw(VAR_0, 0);\n\t\tstream_putw_at(VAR_0, VAR_12, aspath_put(VAR_0, aspath, 1));\n\t}\n\n\tif (aspath != attr->aspath)\n\t\taspath_free(aspath);\n\n\tif (VAR_14) {\n\t\t/* COMMENT_80 */\n\t\t/* COMMENT_81 */\n            \n                                    \n     \n\t\tstream_putc(VAR_0, VAR_33 | VAR_20);\n\t\tstream_putc(VAR_0, VAR_60);\n\t\tstream_putc(VAR_0, 8);\n\t\tstream_putl(VAR_0, attr->aggregator_as);\n\t\tstream_put_ipv4(VAR_0, attr->aggregator_addr.s_addr);\n\t}\n\n\tif (((VAR_3 == VAR_17 || VAR_3 == VAR_61)\n\t     && (VAR_4 == VAR_62 || VAR_4 == VAR_63))\n\t    || (VAR_3 == VAR_64 && VAR_4 == VAR_65)) {\n\t\t/* COMMENT_85 */\n\t\tbgp_packet_mpattr_tea(bgp, peer, VAR_0, attr, VAR_66);\n\n#if VAR_67\n\t\t/* COMMENT_86 */\n\t\tbgp_packet_mpattr_tea(bgp, peer, VAR_0, attr, VAR_68);\n#endif\n\t}\n\n\t/* COMMENT_87 */\n\tif (attr->flag & ATTR_FLAG_BIT(VAR_69)) {\n\t\tstream_putc(VAR_0, VAR_33 | VAR_20);\n\t\tstream_putc(VAR_0, VAR_69);\n\t\tstream_putc(VAR_0, 9); /* COMMENT_88 */\n\t\tstream_putc(VAR_0, 0); /* COMMENT_89 */\n\t\tstream_putc(VAR_0, VAR_70); /* COMMENT_90 */\n\t\tstream_put(VAR_0, &(attr->label),\n\t\t\t   VAR_71); /* COMMENT_91 */\n\t\tstream_put_ipv4(VAR_0, attr->nexthop.s_addr);\n\t\t/* COMMENT_92 */\n\t}\n\n\t/* COMMENT_93 */\n\tif (attr->transit)\n\t\tstream_put(VAR_0, attr->transit->val, attr->transit->length);\n\n\t/* COMMENT_94 */\n\treturn stream_get_endp(VAR_0) - VAR_11;\n}",
  "func_graph_path": "FRRouting/frr/943d595a018e69b550db08cccba1d0778a86705a/bgp_attr.c/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -416,7 +416,7 @@\n \t\t/* Tunnel Encap attribute */\n \t\tbgp_packet_mpattr_tea(bgp, peer, s, attr, BGP_ATTR_ENCAP);\n \n-#if ENABLE_BGP_VNC\n+#if ENABLE_BGP_VNC_ATTR\n \t\t/* VNC attribute */\n \t\tbgp_packet_mpattr_tea(bgp, peer, s, attr, BGP_ATTR_VNC);\n #endif",
  "diff_line_info": {
    "deleted_lines": [
      "#if ENABLE_BGP_VNC"
    ],
    "added_lines": [
      "#if ENABLE_BGP_VNC_ATTR"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/FRRouting/frr/pull/3575",
  "description": {
    "pr_info": {
      "title": "bgpd: don't use BGP_ATTR_VNC(255) unless ENABLE_BGP_VNC_ATTR is defined",
      "number": 3575
    },
    "comment": [
      "\r\n### Summary\r\nAdd ENABLE_BGP_VNC_ATTR check to use of BGP_ATTR_VNC(255) , off by default.\r\n\r\n### Components\r\nbgpd",
      "Once this finishes CI I will push in.",
      "Please put these on all branches 3.0+",
      "# Continuous Integration Result: FAILED\n\nSee below for issues.\nCI System Testrun URL: https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/\n\nThis is a comment from an EXPERIMENTAL automated CI system.\nFor questions and feedback in regards to this CI system, please feel free to email\nMartin Winter - mwinter (at) opensourcerouting.org.\n\n\n## Get source and apply patch from patchwork: Successful\n\n## Building Stage: Successful\n\n## Basic Tests: Failed\n__CentOS 7 rpm pkg check: Successful__\n__Ubuntu 12.04 deb pkg check: Successful__\n__IPv6 protocols on Ubuntu 14.04: Successful__\n__Ubuntu 16.04 deb pkg check: Successful__\n__CentOS 6 rpm pkg check: Successful__\n__Ubuntu 14.04 deb pkg check: Successful__\n__IPv4 ldp protocol on Ubuntu 16.04: Successful__\n__Addresssanitizer topotest: Successful__\n__Debian 8 deb pkg check: Successful__\n__Fedora 24 rpm pkg check: Successful__\n__IPv4 protocols on Ubuntu 14.04: Successful__\n__Debian 9 deb pkg check: Successful__\n__Static analyzer (clang): Successful__\n\n\n#### Topology tests on Ubuntu 18.04 amd64: Failed\nTopology Test Results are at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-TOPOU1804-6327/test\n\n__Topology Tests failed for Topology tests on Ubuntu 18.04 amd64__:\n\n    *** defaultIntf: warning: r1 has no interfaces\n    2019-01-07 17:38:08,169 ERROR: ******************************************************************************\n    2019-01-07 17:38:08,170 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 17:38:08,170 ERROR: ******************************************************************************\n    2019-01-07 17:38:08,170 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 17:38:08,170 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 17:38:08,170 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 17:38:08,170 ERROR: FILE: scripts/check_close.py\n    2019-01-07 17:38:08,170 ERROR: 46   r3     Out of holddown +10.29 secs                              0    1\n    2019-01-07 17:38:08,170 ERROR: 47   r4     Out of holddown +10.51 secs                              0    1\n    2019-01-07 17:38:08,170 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity.test_bgp_rfapi_basic_sanity/output.log for details of errors\n    2019-01-07 17:38:08,179 ERROR: assert failed at \"bgp_rfapi_basic_sanity.test_bgp_rfapi_basic_sanity/test_check_close\": 2 tests failed\n    2019-01-07 17:39:55,239 ERROR: ******************************************************************************\n    2019-01-07 17:39:55,239 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 17:39:55,239 ERROR: ******************************************************************************\n    2019-01-07 17:39:55,239 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 17:39:55,239 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 17:39:55,240 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 17:39:55,240 ERROR: FILE: scripts/check_close.py\n    2019-01-07 17:39:55,240 ERROR: 46   r3     Out of holddown +10.26 secs                              0    1\n    2019-01-07 17:39:55,240 ERROR: 47   r4     Out of holddown +10.66 secs                              0    1\n    2019-01-07 17:39:55,240 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/output.log for details of errors\n    2019-01-07 17:39:55,242 ERROR: assert failed at \"bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/test_check_close\": 2 tests failed\n    *** defaultIntf: warning: lm has no interfaces\n\n   see full log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/TOPOU1804/ErrorLog/log_topotests.txt\n\n#### Topology tests on Ubuntu 16.04 amd64: Failed\nTopology Test Results are at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-TOPOU1604-6327/test\n\n__Topology Tests failed for Topology tests on Ubuntu 16.04 amd64__:\n\n    *** defaultIntf: warning: r1 has no interfaces\n    2019-01-07 09:37:37,780 ERROR: ******************************************************************************\n    2019-01-07 09:37:37,780 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 09:37:37,780 ERROR: ******************************************************************************\n    2019-01-07 09:37:37,780 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 09:37:37,781 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 09:37:37,781 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 09:37:37,781 ERROR: FILE: scripts/check_close.py\n    2019-01-07 09:37:37,781 ERROR: 46   r3     Out of holddown +10.22 secs                              0    1\n    2019-01-07 09:37:37,781 ERROR: 47   r4     Out of holddown +10.58 secs                              0    1\n    2019-01-07 09:37:37,781 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity.test_bgp_rfapi_basic_sanity/output.log for details of errors\n    2019-01-07 09:37:38,232 ERROR: assert failed at \"bgp_rfapi_basic_sanity.test_bgp_rfapi_basic_sanity/test_check_close\": 2 tests failed\n    2019-01-07 09:39:24,009 ERROR: ******************************************************************************\n    2019-01-07 09:39:24,009 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 09:39:24,009 ERROR: ******************************************************************************\n    2019-01-07 09:39:24,009 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 09:39:24,009 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 09:39:24,009 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 09:39:24,009 ERROR: FILE: scripts/check_close.py\n    2019-01-07 09:39:24,009 ERROR: 46   r3     Out of holddown +10.15 secs                              0    1\n    2019-01-07 09:39:24,010 ERROR: 47   r4     Out of holddown +10.22 secs                              0    1\n    2019-01-07 09:39:24,010 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/output.log for details of errors\n    2019-01-07 09:39:24,011 ERROR: assert failed at \"bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/test_check_close\": 2 tests failed\n    *** defaultIntf: warning: lm has no interfaces\n    2019-01-07 09:47:34,399 ERROR: 'compare_show_ipv6_ospf6' failed after 78.32 seconds\n    2019-01-07 09:47:37,541 ERROR: 'compare_show_ipv6_ospf6' failed after 3.14 seconds\n    2019-01-07 09:47:40,674 ERROR: 'compare_show_ipv6_ospf6' failed after 3.13 seconds\n    2019-01-07 09:47:40,676 ERROR: assert failed at \"test_ospf_topo1/test_ospf6_convergence\": OSPF6 did not converge on r1:\n      --- Current output\n      +++ Expected output\n      @@ -11,4 +11,3 @@\n        N E1 2001:db8:200::/64 fe80::xxxx:xxxx:xxxx:xxxx r1-eth1\n       *N IE 2001:db8:300::/64 fe80::xxxx:xxxx:xxxx:xxxx r1-eth1\n        N E1 2001:db8:300::/64 fe80::xxxx:xxxx:xxxx:xxxx r1-eth1\n      -*N E1 fe80::xxxx:xxxx:xxxx:xxxx fe80::xxxx:xxxx:xxxx:xxxx r1-eth1\n    assert False\n    2019-01-07 09:49:43,768 ERROR: 'compare_show_ipv6_ospf6' failed after 78.33 seconds\n    2019-01-07 09:49:43,770 ERROR: assert failed at \"test_ospf_topo1/test_ospf6_link_down\": OSPF6 did not converge on r3:\n      --- Current output\n      +++ Expected output\n      @@ -3,4 +3,3 @@\n        N E1 2001:db8:200::/64 fe80::xxxx:xxxx:xxxx:xxxx r3-eth2\n       *N IA 2001:db8:300::/64 fe80::xxxx:xxxx:xxxx:xxxx r3-eth2\n        N E1 2001:db8:300::/64 fe80::xxxx:xxxx:xxxx:xxxx r3-eth2\n      -*N E1 fe80::xxxx:xxxx:xxxx:xxxx fe80::xxxx:xxxx:xxxx:xxxx r3-eth2\n    assert False\n\n   see full log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/TOPOU1604/ErrorLog/log_topotests.txt\n\n#### Topotest tests on Ubuntu 16.04 i386: Failed\nTopology Test Results are at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-TOPOI386-6327/test\n\n__Topology Tests failed for Topotest tests on Ubuntu 16.04 i386__:\n\n    *** defaultIntf: warning: r1 has no interfaces\n    2019-01-07 09:38:20,989 ERROR: ******************************************************************************\n    2019-01-07 09:38:20,989 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 09:38:20,990 ERROR: ******************************************************************************\n    2019-01-07 09:38:20,990 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 09:38:20,990 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 09:38:20,990 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 09:38:20,990 ERROR: FILE: scripts/check_close.py\n    2019-01-07 09:38:20,990 ERROR: 46   r3     Out of holddown +10.60 secs                              0    1\n    2019-01-07 09:38:20,990 ERROR: 47   r4     Out of holddown +10.26 secs                              0    1\n    2019-01-07 09:38:20,990 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity.test_bgp_rfapi_basic_sanity/output.log for details of errors\n    2019-01-07 09:38:20,993 ERROR: assert failed at \"bgp_rfapi_basic_sanity.test_bgp_rfapi_basic_sanity/test_check_close\": 2 tests failed\n    2019-01-07 09:40:06,472 ERROR: ******************************************************************************\n    2019-01-07 09:40:06,473 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 09:40:06,473 ERROR: ******************************************************************************\n    2019-01-07 09:40:06,473 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 09:40:06,473 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 09:40:06,473 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 09:40:06,474 ERROR: FILE: scripts/check_close.py\n    2019-01-07 09:40:06,474 ERROR: 46   r3     Out of holddown +10.21 secs                              0    1\n    2019-01-07 09:40:06,474 ERROR: 47   r4     Out of holddown +10.03 secs                              0    1\n    2019-01-07 09:40:06,474 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/output.log for details of errors\n    2019-01-07 09:40:06,478 ERROR: assert failed at \"bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/test_check_close\": 2 tests failed\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    *** defaultIntf: warning: lm has no interfaces\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n\n   see full log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/TOPOI386/ErrorLog/log_topotests.txt\n\n__Topology Tests memory analysis:__ https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/TOPOU1804/MemoryLeaks/\n__Topology Tests memory analysis:__ https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/TOPOU1604/MemoryLeaks/\n__Topology Tests memory analysis:__ https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/TOPOI386/MemoryLeaks/\n-----------------------------\n## Warnings Generated during build:\n\n\n### Ubuntu 16.04 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 16.04 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/CI014BUILD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Ubuntu 18.04 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 18.04 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/U1804AMD64/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 4 tags overridden (3 warnings, 1 info)\n\n\n### Ubuntu 16.04 i386 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 16.04 i386 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/U1604I386/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Debian 8 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Debian 8 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/CI008BLD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Debian 9 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Debian 9 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/CI021BUILD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Ubuntu 14.04 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 14.04 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/CI001BUILD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n-----------------------------\n### CLANG Static Analyzer Summary\n- Github Pull Request 3575, comparing to Git base SHA e82d19a\n- Base image data for Git e82d19a does not exist - compare skipped\n",
      "## &#x1F49A; Basic BGPD CI results: SUCCESS, 0 tests failed\n\n<details>\n<summary>Results table</summary>\n\n_|_\n-|-\nResult               | SUCCESS git merge/3575 943d595a\nDate                 | 01/07/2019\nStart                | 13:03:03\nFinish               | 13:26:38\nRun-Time             | 23:35\nTotal                | 1813\nPass                 | 1813\nFail                 | 0\nValgrind-Errors      | 0\nValgrind-Loss        | 0\nDetails              | vncregress-2019-01-07-13:03:03.txt\nLog                  | autoscript-2019-01-07-13:05:24.log.bz2\n\nFor details, please contact louberger\n\n</details>",
      "# Continuous Integration Result: FAILED\n\nSee below for issues.\nCI System Testrun URL: https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/\n\nThis is a comment from an EXPERIMENTAL automated CI system.\nFor questions and feedback in regards to this CI system, please feel free to email\nMartin Winter - mwinter (at) opensourcerouting.org.\n\n\n## Get source and apply patch from patchwork: Successful\n\n## Building Stage: Successful\n\n## Basic Tests: Failed\n__CentOS 7 rpm pkg check: Successful__\n__Ubuntu 12.04 deb pkg check: Successful__\n__IPv6 protocols on Ubuntu 14.04: Successful__\n__Ubuntu 16.04 deb pkg check: Successful__\n__CentOS 6 rpm pkg check: Successful__\n__Ubuntu 14.04 deb pkg check: Successful__\n__IPv4 ldp protocol on Ubuntu 16.04: Successful__\n__Addresssanitizer topotest: Successful__\n__Debian 8 deb pkg check: Successful__\n__Fedora 24 rpm pkg check: Successful__\n__IPv4 protocols on Ubuntu 14.04: Successful__\n__Debian 9 deb pkg check: Successful__\n__Static analyzer (clang): Successful__\n\n\n#### Topology tests on Ubuntu 18.04 amd64: Failed\nTopology Test Results are at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-TOPOU1804-6327/test\n\n__Topology Tests failed for Topology tests on Ubuntu 18.04 amd64__:\n\n    *** defaultIntf: warning: r1 has no interfaces\n    2019-01-07 18:34:55,206 ERROR: ******************************************************************************\n    2019-01-07 18:34:55,206 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 18:34:55,206 ERROR: ******************************************************************************\n    2019-01-07 18:34:55,206 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 18:34:55,206 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 18:34:55,206 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 18:34:55,206 ERROR: FILE: scripts/check_close.py\n    2019-01-07 18:34:55,206 ERROR: 46   r3     Out of holddown +10.66 secs                              0    1\n    2019-01-07 18:34:55,207 ERROR: 47   r4     Out of holddown +10.56 secs                              0    1\n    2019-01-07 18:34:55,207 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity.test_bgp_rfapi_basic_sanity/output.log for details of errors\n    2019-01-07 18:34:55,209 ERROR: assert failed at \"bgp_rfapi_basic_sanity.test_bgp_rfapi_basic_sanity/test_check_close\": 2 tests failed\n    2019-01-07 18:36:40,083 ERROR: ******************************************************************************\n    2019-01-07 18:36:40,084 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 18:36:40,084 ERROR: ******************************************************************************\n    2019-01-07 18:36:40,084 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 18:36:40,084 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 18:36:40,084 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 18:36:40,085 ERROR: FILE: scripts/check_close.py\n    2019-01-07 18:36:40,085 ERROR: 46   r3     Out of holddown +10.59 secs                              0    1\n    2019-01-07 18:36:40,085 ERROR: 47   r4     Out of holddown +10.01 secs                              0    1\n    2019-01-07 18:36:40,085 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/output.log for details of errors\n    2019-01-07 18:36:40,086 ERROR: assert failed at \"bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/test_check_close\": 2 tests failed\n    *** defaultIntf: warning: lm has no interfaces\n\n   see full log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/TOPOU1804/ErrorLog/log_topotests.txt\n\n#### Topology tests on Ubuntu 16.04 amd64: Failed\nTopology Test Results are at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-TOPOU1604-6327/test\n\n__Topology Tests failed for Topology tests on Ubuntu 16.04 amd64__:\n\n    *** defaultIntf: warning: r1 has no interfaces\n    2019-01-07 10:35:16,685 ERROR: ******************************************************************************\n    2019-01-07 10:35:16,686 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 10:35:16,686 ERROR: ******************************************************************************\n    2019-01-07 10:35:16,686 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 10:35:16,686 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 10:35:16,686 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 10:35:16,686 ERROR: FILE: scripts/check_close.py\n    2019-01-07 10:35:16,686 ERROR: 46   r3     Out of holddown +10.27 secs                              0    1\n    2019-01-07 10:35:16,686 ERROR: 47   r4     Out of holddown +10.33 secs                              0    1\n    2019-01-07 10:35:16,687 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity.test_bgp_rfapi_basic_sanity/output.log for details of errors\n    2019-01-07 10:35:16,690 ERROR: assert failed at \"bgp_rfapi_basic_sanity.test_bgp_rfapi_basic_sanity/test_check_close\": 2 tests failed\n    2019-01-07 10:36:50,395 ERROR: ******************************************************************************\n    2019-01-07 10:36:50,396 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 10:36:50,396 ERROR: ******************************************************************************\n    2019-01-07 10:36:50,396 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 10:36:50,396 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 10:36:50,397 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 10:36:50,397 ERROR: FILE: scripts/check_close.py\n    2019-01-07 10:36:50,397 ERROR: 46   r3     Out of holddown +10.23 secs                              0    1\n    2019-01-07 10:36:50,397 ERROR: 47   r4     Out of holddown +10.25 secs                              0    1\n    2019-01-07 10:36:50,397 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/output.log for details of errors\n    2019-01-07 10:36:50,400 ERROR: assert failed at \"bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/test_check_close\": 2 tests failed\n    *** defaultIntf: warning: lm has no interfaces\n\n   see full log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/TOPOU1604/ErrorLog/log_topotests.txt\n\n#### Topotest tests on Ubuntu 16.04 i386: Failed\nTopology Test Results are at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-TOPOI386-6327/test\n\n__Topology Tests failed for Topotest tests on Ubuntu 16.04 i386__:\n\n    *** defaultIntf: warning: r1 has no interfaces\n    2019-01-07 10:35:07,943 ERROR: ******************************************************************************\n    2019-01-07 10:35:07,944 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 10:35:07,944 ERROR: ******************************************************************************\n    2019-01-07 10:35:07,944 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 10:35:07,944 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 10:35:07,944 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 10:35:07,944 ERROR: FILE: scripts/check_close.py\n    2019-01-07 10:35:07,944 ERROR: 46   r3     Out of holddown +10.11 secs                              0    1\n    2019-01-07 10:35:07,944 ERROR: 47   r4     Out of holddown +10.17 secs                              0    1\n    2019-01-07 10:35:07,945 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity.test_bgp_rfapi_basic_sanity/output.log for details of errors\n    2019-01-07 10:35:07,947 ERROR: assert failed at \"bgp_rfapi_basic_sanity.test_bgp_rfapi_basic_sanity/test_check_close\": 2 tests failed\n    2019-01-07 10:36:41,323 ERROR: ******************************************************************************\n    2019-01-07 10:36:41,324 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 10:36:41,324 ERROR: ******************************************************************************\n    2019-01-07 10:36:41,324 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 10:36:41,324 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 10:36:41,324 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 10:36:41,324 ERROR: FILE: scripts/check_close.py\n    2019-01-07 10:36:41,324 ERROR: 46   r3     Out of holddown +10.17 secs                              0    1\n    2019-01-07 10:36:41,324 ERROR: 47   r4     Out of holddown +10.16 secs                              0    1\n    2019-01-07 10:36:41,324 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/output.log for details of errors\n    2019-01-07 10:36:41,326 ERROR: assert failed at \"bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/test_check_close\": 2 tests failed\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    *** defaultIntf: warning: lm has no interfaces\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n\n   see full log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/TOPOI386/ErrorLog/log_topotests.txt\n\n__Topology Tests memory analysis:__ https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/TOPOU1804/MemoryLeaks/\n__Topology Tests memory analysis:__ https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/TOPOU1604/MemoryLeaks/\n__Topology Tests memory analysis:__ https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/TOPOI386/MemoryLeaks/\n-----------------------------\n## Warnings Generated during build:\n\n\n### Ubuntu 16.04 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 16.04 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/CI014BUILD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Ubuntu 18.04 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 18.04 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/U1804AMD64/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 4 tags overridden (3 warnings, 1 info)\n\n\n### Ubuntu 16.04 i386 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 16.04 i386 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/U1604I386/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Debian 8 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Debian 8 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/CI008BLD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Debian 9 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Debian 9 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/CI021BUILD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Ubuntu 14.04 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 14.04 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6327/artifact/CI001BUILD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n-----------------------------\n### CLANG Static Analyzer Summary\n- Github Pull Request 3575, comparing to Git base SHA e82d19a\n- Base image data for Git e82d19a does not exist - compare skipped\n",
      "## &#x1F49A; Basic BGPD CI results: SUCCESS, 0 tests failed\n\n<details>\n<summary>Results table</summary>\n\n_|_\n-|-\nResult               | SUCCESS git merge/3575 ef9aee14\nDate                 | 01/07/2019\nStart                | 15:30:36\nFinish               | 15:54:16\nRun-Time             | 23:40\nTotal                | 1813\nPass                 | 1813\nFail                 | 0\nValgrind-Errors      | 0\nValgrind-Loss        | 0\nDetails              | vncregress-2019-01-07-15:30:36.txt\nLog                  | autoscript-2019-01-07-15:31:20.log.bz2\n\nFor details, please contact louberger\n\n</details>",
      "# Continuous Integration Result: FAILED\n\nSee below for issues.\nCI System Testrun URL: https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6334/\n\nThis is a comment from an EXPERIMENTAL automated CI system.\nFor questions and feedback in regards to this CI system, please feel free to email\nMartin Winter - mwinter (at) opensourcerouting.org.\n\n\n## Get source and apply patch from patchwork: Successful\n\n## Building Stage: Successful\n\n## Basic Tests: Failed\n__CentOS 6 rpm pkg check: Successful__\n__Static analyzer (clang): Successful__\n__IPv6 protocols on Ubuntu 14.04: Successful__\n__Ubuntu 16.04 deb pkg check: Successful__\n__Ubuntu 12.04 deb pkg check: Successful__\n__Fedora 24 rpm pkg check: Successful__\n__CentOS 7 rpm pkg check: Successful__\n__Addresssanitizer topotest: Successful__\n__Debian 8 deb pkg check: Successful__\n__IPv4 protocols on Ubuntu 14.04: Successful__\n__IPv4 ldp protocol on Ubuntu 16.04: Successful__\n__Debian 9 deb pkg check: Successful__\n__Ubuntu 14.04 deb pkg check: Successful__\n\n\n#### Topology tests on Ubuntu 18.04 amd64: Failed\nTopology Test Results are at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-TOPOU1804-6334/test\n\n__Topology Tests failed for Topology tests on Ubuntu 18.04 amd64__:\n\n    *** defaultIntf: warning: r1 has no interfaces\n    2019-01-07 20:36:04,752 ERROR: ******************************************************************************\n    2019-01-07 20:36:04,753 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 20:36:04,753 ERROR: ******************************************************************************\n    2019-01-07 20:36:04,753 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 20:36:04,753 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 20:36:04,753 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 20:36:04,753 ERROR: FILE: scripts/check_close.py\n    2019-01-07 20:36:04,753 ERROR: 46   r3     Out of holddown +10.03 secs                              0    1\n    2019-01-07 20:36:04,753 ERROR: 47   r4     Out of holddown +10.08 secs                              0    1\n    2019-01-07 20:36:04,753 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/output.log for details of errors\n    2019-01-07 20:36:04,755 ERROR: assert failed at \"bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/test_check_close\": 2 tests failed\n    *** defaultIntf: warning: lm has no interfaces\n\n   see full log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6334/artifact/TOPOU1804/ErrorLog/log_topotests.txt\n\n#### Topotest tests on Ubuntu 16.04 i386: Failed\nTopology Test Results are at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-TOPOI386-6334/test\n\n__Topology Tests failed for Topotest tests on Ubuntu 16.04 i386__:\n\n    *** defaultIntf: warning: r1 has no interfaces\n    2019-01-07 12:36:09,814 ERROR: ******************************************************************************\n    2019-01-07 12:36:09,815 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 12:36:09,815 ERROR: ******************************************************************************\n    2019-01-07 12:36:09,815 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 12:36:09,815 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 12:36:09,815 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 12:36:09,815 ERROR: FILE: scripts/check_close.py\n    2019-01-07 12:36:09,815 ERROR: 46   r3     Out of holddown +10.24 secs                              0    1\n    2019-01-07 12:36:09,815 ERROR: 47   r4     Out of holddown +10.15 secs                              0    1\n    2019-01-07 12:36:09,815 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/output.log for details of errors\n    2019-01-07 12:36:09,817 ERROR: assert failed at \"bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/test_check_close\": 2 tests failed\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    *** defaultIntf: warning: lm has no interfaces\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n    RTNETLINK answers: Invalid argument\n\n   see full log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6334/artifact/TOPOI386/ErrorLog/log_topotests.txt\n\n#### Topology tests on Ubuntu 16.04 amd64: Failed\nTopology Test Results are at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-TOPOU1604-6334/test\n\n__Topology Tests failed for Topology tests on Ubuntu 16.04 amd64__:\n\n    *** defaultIntf: warning: r1 has no interfaces\n    2019-01-07 12:36:23,631 ERROR: ******************************************************************************\n    2019-01-07 12:36:23,632 ERROR: Test Target Summary                                                  Pass Fail\n    2019-01-07 12:36:23,632 ERROR: ******************************************************************************\n    2019-01-07 12:36:23,632 ERROR: FILE: scripts/add_routes.py\n    2019-01-07 12:36:23,632 ERROR: FILE: scripts/adjacencies.py\n    2019-01-07 12:36:23,632 ERROR: FILE: scripts/check_routes.py\n    2019-01-07 12:36:23,632 ERROR: FILE: scripts/check_close.py\n    2019-01-07 12:36:23,632 ERROR: 46   r3     Out of holddown +10.12 secs                              0    1\n    2019-01-07 12:36:23,632 ERROR: 47   r4     Out of holddown +10.09 secs                              0    1\n    2019-01-07 12:36:23,632 ERROR: See /tmp/topotests/bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/output.log for details of errors\n    2019-01-07 12:36:23,635 ERROR: assert failed at \"bgp_rfapi_basic_sanity_config2.test_bgp_rfapi_basic_sanity_config2/test_check_close\": 2 tests failed\n    *** defaultIntf: warning: lm has no interfaces\n\n   see full log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6334/artifact/TOPOU1604/ErrorLog/log_topotests.txt\n\n__Topology Tests memory analysis:__ https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6334/artifact/TOPOU1804/MemoryLeaks/\n__Topology Tests memory analysis:__ https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6334/artifact/TOPOI386/MemoryLeaks/\n__Topology Tests memory analysis:__ https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6334/artifact/TOPOU1604/MemoryLeaks/\n-----------------------------\n## Warnings Generated during build:\n\n\n### Debian 8 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Debian 8 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6334/artifact/CI008BLD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Ubuntu 16.04 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 16.04 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6334/artifact/CI014BUILD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Ubuntu 18.04 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 18.04 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6334/artifact/U1804AMD64/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 4 tags overridden (3 warnings, 1 info)\n\n\n### Debian 9 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Debian 9 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6334/artifact/CI021BUILD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Ubuntu 14.04 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 14.04 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6334/artifact/CI001BUILD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Ubuntu 16.04 i386 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 16.04 i386 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6334/artifact/U1604I386/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n-----------------------------\n### CLANG Static Analyzer Summary\n- Github Pull Request 3575, comparing to Git base SHA e82d19a\n#### No Changes in Static Analysis warnings compared to base\n",
      "## &#x1F49A; Basic BGPD CI results: SUCCESS, 0 tests failed\n\n<details>\n<summary>Results table</summary>\n\n_|_\n-|-\nResult               | SUCCESS git merge/3575 e3d16a4f\nDate                 | 01/07/2019\nStart                | 17:20:36\nFinish               | 17:44:32\nRun-Time             | 23:56\nTotal                | 1813\nPass                 | 1813\nFail                 | 0\nValgrind-Errors      | 0\nValgrind-Loss        | 0\nDetails              | vncregress-2019-01-07-17:20:36.txt\nLog                  | autoscript-2019-01-07-17:21:28.log.bz2\n\nFor details, please contact louberger\n\n</details>",
      "# Continuous Integration Result: SUCCESSFUL\n\nCongratulations, this patch passed basic tests\n\nTested-by: NetDEF / OpenSourceRouting.org CI System\n\nCI System Testrun URL: https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6337/\n\nThis is a comment from an EXPERIMENTAL automated CI system.\nFor questions and feedback in regards to this CI system, please feel free to email\nMartin Winter - mwinter (at) opensourcerouting.org.\n\n\n-----------------------------\n## Warnings Generated during build:\n\n\n### Ubuntu 14.04 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 14.04 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6337/artifact/CI001BUILD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Debian 8 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Debian 8 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6337/artifact/CI008BLD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Debian 9 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Debian 9 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6337/artifact/CI021BUILD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Ubuntu 16.04 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 16.04 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6337/artifact/CI014BUILD/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n### Ubuntu 18.04 amd64 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 18.04 amd64 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6337/artifact/U1804AMD64/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 4 tags overridden (3 warnings, 1 info)\n\n\n### Ubuntu 16.04 i386 build: Successful with additional warnings:\n__Debian Package lintian failed for Ubuntu 16.04 i386 build__:\n    (see full package build log at https://ci1.netdef.org/browse/FRR-FRRPULLREQ-6337/artifact/U1604I386/ErrorLog/log_lintian.txt)\n\n    W: frr: package-name-doesnt-match-sonames libfrr0 libfrrospfapiclient0\n    N: 3 tags overridden (3 warnings)\n\n\n-----------------------------\n### CLANG Static Analyzer Summary\n- Github Pull Request 3575, comparing to Git base SHA e82d19a\n#### No Changes in Static Analysis warnings compared to base\n"
    ]
  },
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.8,
  "Bug Filter Response": "\n\nThe patch modifies a conditional check to control the use of a BGP attribute based on a build-time macro. It doesn't address a security vulnerability but rather adjusts feature inclusion, thus falling under a functional change.\n\n**Final Output:**\nAnalysis: The patch changes a conditional check to control the use of a BGP attribute, not addressing a security issue. The CI failures indicate test issues, not security concerns. The change is a functional adjustment, not a security fix.\nFinal Classification: Defect Remediation & Feature Upgrades\nConfidence Score: 0.8"
}