{
  "cve_id": "CVE-2022-21675",
  "cwe_ids": [
    "CWE-22"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "Konloch/bytecode-viewer",
  "commit_msg": "Mitigate Zip Slip exlpoit",
  "commit_hash": "c968e94b2c93da434a4ecfac6d08eda162d615d0",
  "git_url": "https://github.com/Konloch/bytecode-viewer/commit/c968e94b2c93da434a4ecfac6d08eda162d615d0",
  "file_path": "src/main/java/the/bytecode/club/bytecodeviewer/util/ZipUtils.java",
  "func_name": "zipFolder",
  "func_before": "public static void zipFolder(String srcFolder, String destZipFile, String ignore) throws Exception {\n        try (FileOutputStream fileWriter = new FileOutputStream(destZipFile);\n             ZipOutputStream zip = new ZipOutputStream(fileWriter)){\n            addFolderToZip(\"\", srcFolder, zip, ignore);\n            zip.flush();\n        }\n    }",
  "abstract_func_before": "public static void zipFolder(String VAR_0, String VAR_1, String VAR_2) throws Exception {\n        try (FileOutputStream VAR_3 = new FileOutputStream(VAR_1);\n             ZipOutputStream VAR_4 = new ZipOutputStream(VAR_3)){\n            addFolderToZip(\"\", VAR_0, VAR_4, VAR_2);\n            VAR_4.flush();\n        }\n    }",
  "func_graph_path_before": "Konloch/bytecode-viewer/c968e94b2c93da434a4ecfac6d08eda162d615d0/ZipUtils.java/vul/before/0.json",
  "func": "public static void zipFolder(String srcFolder, String destZipFile, String ignore) throws Exception {\n        try (FileOutputStream fileWriter = new FileOutputStream(destZipFile);\n             ZipOutputStream zip = new ZipOutputStream(fileWriter)) {\n            addFolderToZip(\"\", srcFolder, zip, ignore);\n            zip.flush();\n        }\n    }",
  "abstract_func": "public static void zipFolder(String VAR_0, String VAR_1, String VAR_2) throws Exception {\n        try (FileOutputStream VAR_3 = new FileOutputStream(VAR_1);\n             ZipOutputStream VAR_4 = new ZipOutputStream(VAR_3)) {\n            addFolderToZip(\"\", VAR_0, VAR_4, VAR_2);\n            VAR_4.flush();\n        }\n    }",
  "func_graph_path": "Konloch/bytecode-viewer/c968e94b2c93da434a4ecfac6d08eda162d615d0/ZipUtils.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,6 +1,6 @@\n public static void zipFolder(String srcFolder, String destZipFile, String ignore) throws Exception {\n         try (FileOutputStream fileWriter = new FileOutputStream(destZipFile);\n-             ZipOutputStream zip = new ZipOutputStream(fileWriter)){\n+             ZipOutputStream zip = new ZipOutputStream(fileWriter)) {\n             addFolderToZip(\"\", srcFolder, zip, ignore);\n             zip.flush();\n         }",
  "diff_line_info": {
    "deleted_lines": [
      "             ZipOutputStream zip = new ZipOutputStream(fileWriter)){"
    ],
    "added_lines": [
      "             ZipOutputStream zip = new ZipOutputStream(fileWriter)) {"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/Konloch/bytecode-viewer/pull/379",
  "description": {
    "pr_info": {
      "title": "Fixes and Updates",
      "number": 379
    },
    "comment": [
      " - Update Procyon to snapshot version to support JDK 9+\r\n - Optimize POM\r\n - Fix plugin templates\r\n - Update RSTA to support more file extensions and new Java stuff\r\n - Mitigate Zip Slip exploit (Fixes #378)"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix  \nConfidence Score: 0.95",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "\n\n**Final Output:**\nAnalysis: The commit message and PR comments indicate a fix for the Zip Slip exploit, a known security vulnerability. The code diff shows changes to the ZipOutputStream initialization, suggesting potential security checks. The primary purpose is to mitigate a security exploit, fitting the 'Security Vulnerability Fix' category with high confidence.\n\nFinal Classification: Security Vulnerability Fix  \nConfidence Score: 0.95"
}