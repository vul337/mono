{
  "cve_id": "CVE-2018-8005",
  "cwe_ids": [
    "CWE-400"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "apache/trafficserver",
  "commit_msg": "Adds a new configuration proxy.config.http.allow_multi_range\n\nThis is needed to prevent potential abuse with well formed multi-\nrange requests.",
  "commit_hash": "6d248026b04d69e5c5049709c17ea671328ea4ea",
  "git_url": "https://github.com/apache/trafficserver/commit/6d248026b04d69e5c5049709c17ea671328ea4ea",
  "file_path": "proxy/http/HttpConfig.cc",
  "func_name": "HttpConfig::startup",
  "func_before": "void\nHttpConfig::startup()\n{\n  http_rsb = RecAllocateRawStatBlock((int)http_stat_count);\n  register_stat_callbacks();\n\n  HttpConfigParams &c = m_master;\n\n  http_config_cont = new HttpConfigCont;\n\n  HttpEstablishStaticConfigStringAlloc(c.proxy_hostname, \"proxy.config.proxy_name\");\n  c.proxy_hostname_len = -1;\n\n  if (c.proxy_hostname == nullptr) {\n    c.proxy_hostname    = (char *)ats_malloc(sizeof(char));\n    c.proxy_hostname[0] = '\\0';\n  }\n\n  RecHttpLoadIp(\"proxy.local.incoming_ip_to_bind\", c.inbound_ip4, c.inbound_ip6);\n  RecHttpLoadIp(\"proxy.local.outgoing_ip_to_bind\", c.outbound_ip4, c.outbound_ip6);\n\n  HttpEstablishStaticConfigLongLong(c.server_max_connections, \"proxy.config.http.server_max_connections\");\n  HttpEstablishStaticConfigLongLong(c.max_websocket_connections, \"proxy.config.http.websocket.max_number_of_connections\");\n  HttpEstablishStaticConfigLongLong(c.oride.server_tcp_init_cwnd, \"proxy.config.http.server_tcp_init_cwnd\");\n  HttpEstablishStaticConfigLongLong(c.oride.origin_max_connections, \"proxy.config.http.origin_max_connections\");\n  HttpEstablishStaticConfigLongLong(c.oride.origin_max_connections_queue, \"proxy.config.http.origin_max_connections_queue\");\n  HttpEstablishStaticConfigLongLong(c.origin_min_keep_alive_connections, \"proxy.config.http.origin_min_keep_alive_connections\");\n  HttpEstablishStaticConfigByte(c.oride.attach_server_session_to_client, \"proxy.config.http.attach_server_session_to_client\");\n\n  HttpEstablishStaticConfigByte(c.disable_ssl_parenting, \"proxy.local.http.parent_proxy.disable_connect_tunneling\");\n  HttpEstablishStaticConfigByte(c.oride.forward_connect_method, \"proxy.config.http.forward_connect_method\");\n\n  HttpEstablishStaticConfigByte(c.no_dns_forward_to_parent, \"proxy.config.http.no_dns_just_forward_to_parent\");\n  HttpEstablishStaticConfigByte(c.oride.uncacheable_requests_bypass_parent, \"proxy.config.http.uncacheable_requests_bypass_parent\");\n  HttpEstablishStaticConfigByte(c.oride.doc_in_cache_skip_dns, \"proxy.config.http.doc_in_cache_skip_dns\");\n\n  HttpEstablishStaticConfigByte(c.no_origin_server_dns, \"proxy.config.http.no_origin_server_dns\");\n  HttpEstablishStaticConfigByte(c.use_client_target_addr, \"proxy.config.http.use_client_target_addr\");\n  HttpEstablishStaticConfigByte(c.use_client_source_port, \"proxy.config.http.use_client_source_port\");\n  HttpEstablishStaticConfigByte(c.oride.maintain_pristine_host_hdr, \"proxy.config.url_remap.pristine_host_hdr\");\n\n  HttpEstablishStaticConfigByte(c.oride.insert_request_via_string, \"proxy.config.http.insert_request_via_str\");\n  HttpEstablishStaticConfigByte(c.oride.insert_response_via_string, \"proxy.config.http.insert_response_via_str\");\n  HttpEstablishStaticConfigLongLong(c.oride.proxy_response_hsts_max_age, \"proxy.config.ssl.hsts_max_age\");\n  HttpEstablishStaticConfigByte(c.oride.proxy_response_hsts_include_subdomains, \"proxy.config.ssl.hsts_include_subdomains\");\n  HttpEstablishStaticConfigStringAlloc(c.oride.client_cert_filename, \"proxy.config.ssl.client.cert.filename\");\n  HttpEstablishStaticConfigStringAlloc(c.oride.client_cert_filepath, \"proxy.config.ssl.client.cert.path\");\n\n  HttpEstablishStaticConfigStringAlloc(c.proxy_request_via_string, \"proxy.config.http.request_via_str\");\n  c.proxy_request_via_string_len = -1;\n  HttpEstablishStaticConfigStringAlloc(c.proxy_response_via_string, \"proxy.config.http.response_via_str\");\n  c.proxy_response_via_string_len = -1;\n\n  HttpEstablishStaticConfigByte(c.oride.keep_alive_enabled_in, \"proxy.config.http.keep_alive_enabled_in\");\n  HttpEstablishStaticConfigByte(c.oride.keep_alive_enabled_out, \"proxy.config.http.keep_alive_enabled_out\");\n  HttpEstablishStaticConfigByte(c.oride.chunking_enabled, \"proxy.config.http.chunking_enabled\");\n  HttpEstablishStaticConfigLongLong(c.oride.http_chunking_size, \"proxy.config.http.chunking.size\");\n  HttpEstablishStaticConfigByte(c.oride.flow_control_enabled, \"proxy.config.http.flow_control.enabled\");\n  HttpEstablishStaticConfigLongLong(c.oride.flow_high_water_mark, \"proxy.config.http.flow_control.high_water\");\n  HttpEstablishStaticConfigLongLong(c.oride.flow_low_water_mark, \"proxy.config.http.flow_control.low_water\");\n  HttpEstablishStaticConfigByte(c.oride.post_check_content_length_enabled, \"proxy.config.http.post.check.content_length.enabled\");\n  HttpEstablishStaticConfigByte(c.strict_uri_parsing, \"proxy.config.http.strict_uri_parsing\");\n\n  // [amc] This is a bit of a mess, need to figure out to make this cleaner.\n  RecRegisterConfigUpdateCb(\"proxy.config.http.server_session_sharing.match\", &http_server_session_sharing_cb, &c);\n  http_config_enum_read(\"proxy.config.http.server_session_sharing.match\", SessionSharingMatchStrings,\n                        c.oride.server_session_sharing_match);\n  http_config_enum_read(\"proxy.config.http.server_session_sharing.pool\", SessionSharingPoolStrings, c.server_session_sharing_pool);\n\n  RecRegisterConfigUpdateCb(\"proxy.config.http.insert_forwarded\", &http_insert_forwarded_cb, &c);\n  {\n    char str[512];\n\n    if (REC_ERR_OKAY == RecGetRecordString(\"proxy.config.http.insert_forwarded\", str, sizeof(str))) {\n      ts::LocalBufferWriter<1024> error;\n      HttpForwarded::OptionBitSet bs = HttpForwarded::optStrToBitset(ts::string_view(str), error);\n      if (!error.size()) {\n        c.oride.insert_forwarded = bs;\n      } else {\n        Error(\"HTTP %.*s\", static_cast<int>(error.size()), error.data());\n      }\n    }\n  }\n\n  HttpEstablishStaticConfigByte(c.oride.auth_server_session_private, \"proxy.config.http.auth_server_session_private\");\n\n  HttpEstablishStaticConfigByte(c.oride.keep_alive_post_out, \"proxy.config.http.keep_alive_post_out\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.keep_alive_no_activity_timeout_in,\n                                    \"proxy.config.http.keep_alive_no_activity_timeout_in\");\n  HttpEstablishStaticConfigLongLong(c.oride.keep_alive_no_activity_timeout_out,\n                                    \"proxy.config.http.keep_alive_no_activity_timeout_out\");\n  HttpEstablishStaticConfigLongLong(c.oride.transaction_no_activity_timeout_in,\n                                    \"proxy.config.http.transaction_no_activity_timeout_in\");\n  HttpEstablishStaticConfigLongLong(c.oride.transaction_no_activity_timeout_out,\n                                    \"proxy.config.http.transaction_no_activity_timeout_out\");\n  HttpEstablishStaticConfigLongLong(c.oride.websocket_active_timeout, \"proxy.config.websocket.active_timeout\");\n  HttpEstablishStaticConfigLongLong(c.oride.websocket_inactive_timeout, \"proxy.config.websocket.no_activity_timeout\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.transaction_active_timeout_in, \"proxy.config.http.transaction_active_timeout_in\");\n  HttpEstablishStaticConfigLongLong(c.oride.transaction_active_timeout_out, \"proxy.config.http.transaction_active_timeout_out\");\n  HttpEstablishStaticConfigLongLong(c.accept_no_activity_timeout, \"proxy.config.http.accept_no_activity_timeout\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.background_fill_active_timeout, \"proxy.config.http.background_fill_active_timeout\");\n  HttpEstablishStaticConfigFloat(c.oride.background_fill_threshold, \"proxy.config.http.background_fill_completed_threshold\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.connect_attempts_max_retries, \"proxy.config.http.connect_attempts_max_retries\");\n  HttpEstablishStaticConfigLongLong(c.oride.connect_attempts_max_retries_dead_server,\n                                    \"proxy.config.http.connect_attempts_max_retries_dead_server\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.connect_attempts_rr_retries, \"proxy.config.http.connect_attempts_rr_retries\");\n  HttpEstablishStaticConfigLongLong(c.oride.connect_attempts_timeout, \"proxy.config.http.connect_attempts_timeout\");\n  HttpEstablishStaticConfigLongLong(c.oride.post_connect_attempts_timeout, \"proxy.config.http.post_connect_attempts_timeout\");\n  HttpEstablishStaticConfigLongLong(c.oride.parent_connect_attempts, \"proxy.config.http.parent_proxy.total_connect_attempts\");\n  HttpEstablishStaticConfigLongLong(c.oride.parent_retry_time, \"proxy.config.http.parent_proxy.retry_time\");\n  HttpEstablishStaticConfigLongLong(c.oride.parent_fail_threshold, \"proxy.config.http.parent_proxy.fail_threshold\");\n  HttpEstablishStaticConfigLongLong(c.oride.per_parent_connect_attempts,\n                                    \"proxy.config.http.parent_proxy.per_parent_connect_attempts\");\n  HttpEstablishStaticConfigLongLong(c.oride.parent_connect_timeout, \"proxy.config.http.parent_proxy.connect_attempts_timeout\");\n  HttpEstablishStaticConfigByte(c.oride.parent_failures_update_hostdb, \"proxy.config.http.parent_proxy.mark_down_hostdb\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.sock_recv_buffer_size_out, \"proxy.config.net.sock_recv_buffer_size_out\");\n  HttpEstablishStaticConfigLongLong(c.oride.sock_send_buffer_size_out, \"proxy.config.net.sock_send_buffer_size_out\");\n  HttpEstablishStaticConfigLongLong(c.oride.sock_option_flag_out, \"proxy.config.net.sock_option_flag_out\");\n  HttpEstablishStaticConfigLongLong(c.oride.sock_packet_mark_out, \"proxy.config.net.sock_packet_mark_out\");\n  HttpEstablishStaticConfigLongLong(c.oride.sock_packet_tos_out, \"proxy.config.net.sock_packet_tos_out\");\n\n  HttpEstablishStaticConfigByte(c.oride.fwd_proxy_auth_to_parent, \"proxy.config.http.forward.proxy_auth_to_parent\");\n\n  HttpEstablishStaticConfigByte(c.oride.anonymize_remove_from, \"proxy.config.http.anonymize_remove_from\");\n  HttpEstablishStaticConfigByte(c.oride.anonymize_remove_referer, \"proxy.config.http.anonymize_remove_referer\");\n  HttpEstablishStaticConfigByte(c.oride.anonymize_remove_user_agent, \"proxy.config.http.anonymize_remove_user_agent\");\n  HttpEstablishStaticConfigByte(c.oride.anonymize_remove_cookie, \"proxy.config.http.anonymize_remove_cookie\");\n  HttpEstablishStaticConfigByte(c.oride.anonymize_remove_client_ip, \"proxy.config.http.anonymize_remove_client_ip\");\n  HttpEstablishStaticConfigByte(c.oride.anonymize_insert_client_ip, \"proxy.config.http.insert_client_ip\");\n  HttpEstablishStaticConfigStringAlloc(c.anonymize_other_header_list, \"proxy.config.http.anonymize_other_header_list\");\n\n  HttpEstablishStaticConfigStringAlloc(c.oride.global_user_agent_header, \"proxy.config.http.global_user_agent_header\");\n  c.oride.global_user_agent_header_size = c.oride.global_user_agent_header ? strlen(c.oride.global_user_agent_header) : 0;\n\n  HttpEstablishStaticConfigByte(c.oride.proxy_response_server_enabled, \"proxy.config.http.response_server_enabled\");\n  HttpEstablishStaticConfigStringAlloc(c.oride.proxy_response_server_string, \"proxy.config.http.response_server_str\");\n  c.oride.proxy_response_server_string_len =\n    c.oride.proxy_response_server_string ? strlen(c.oride.proxy_response_server_string) : 0;\n\n  HttpEstablishStaticConfigByte(c.oride.insert_squid_x_forwarded_for, \"proxy.config.http.insert_squid_x_forwarded_for\");\n\n  HttpEstablishStaticConfigByte(c.oride.insert_age_in_response, \"proxy.config.http.insert_age_in_response\");\n  HttpEstablishStaticConfigByte(c.enable_http_stats, \"proxy.config.http.enable_http_stats\");\n  HttpEstablishStaticConfigByte(c.oride.normalize_ae, \"proxy.config.http.normalize_ae\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.cache_heuristic_min_lifetime, \"proxy.config.http.cache.heuristic_min_lifetime\");\n  HttpEstablishStaticConfigLongLong(c.oride.cache_heuristic_max_lifetime, \"proxy.config.http.cache.heuristic_max_lifetime\");\n  HttpEstablishStaticConfigFloat(c.oride.cache_heuristic_lm_factor, \"proxy.config.http.cache.heuristic_lm_factor\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.cache_guaranteed_min_lifetime, \"proxy.config.http.cache.guaranteed_min_lifetime\");\n  HttpEstablishStaticConfigLongLong(c.oride.cache_guaranteed_max_lifetime, \"proxy.config.http.cache.guaranteed_max_lifetime\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.cache_max_stale_age, \"proxy.config.http.cache.max_stale_age\");\n  HttpEstablishStaticConfigByte(c.oride.srv_enabled, \"proxy.config.srv_enabled\");\n\n  HttpEstablishStaticConfigStringAlloc(c.oride.cache_vary_default_text, \"proxy.config.http.cache.vary_default_text\");\n  HttpEstablishStaticConfigStringAlloc(c.oride.cache_vary_default_images, \"proxy.config.http.cache.vary_default_images\");\n  HttpEstablishStaticConfigStringAlloc(c.oride.cache_vary_default_other, \"proxy.config.http.cache.vary_default_other\");\n\n  // open read failure retries\n  HttpEstablishStaticConfigLongLong(c.oride.max_cache_open_read_retries, \"proxy.config.http.cache.max_open_read_retries\");\n  HttpEstablishStaticConfigLongLong(c.oride.cache_open_read_retry_time, \"proxy.config.http.cache.open_read_retry_time\");\n  HttpEstablishStaticConfigLongLong(c.oride.cache_generation_number, \"proxy.config.http.cache.generation\");\n\n  // open write failure retries\n  HttpEstablishStaticConfigLongLong(c.oride.max_cache_open_write_retries, \"proxy.config.http.cache.max_open_write_retries\");\n\n  HttpEstablishStaticConfigByte(c.oride.cache_http, \"proxy.config.http.cache.http\");\n  HttpEstablishStaticConfigByte(c.oride.cache_ignore_client_no_cache, \"proxy.config.http.cache.ignore_client_no_cache\");\n  HttpEstablishStaticConfigByte(c.oride.cache_ignore_client_cc_max_age, \"proxy.config.http.cache.ignore_client_cc_max_age\");\n  HttpEstablishStaticConfigByte(c.oride.cache_ims_on_client_no_cache, \"proxy.config.http.cache.ims_on_client_no_cache\");\n  HttpEstablishStaticConfigByte(c.oride.cache_ignore_server_no_cache, \"proxy.config.http.cache.ignore_server_no_cache\");\n  HttpEstablishStaticConfigByte(c.oride.cache_responses_to_cookies, \"proxy.config.http.cache.cache_responses_to_cookies\");\n\n  HttpEstablishStaticConfigByte(c.oride.cache_ignore_auth, \"proxy.config.http.cache.ignore_authentication\");\n  HttpEstablishStaticConfigByte(c.oride.cache_urls_that_look_dynamic, \"proxy.config.http.cache.cache_urls_that_look_dynamic\");\n  HttpEstablishStaticConfigByte(c.oride.cache_enable_default_vary_headers, \"proxy.config.http.cache.enable_default_vary_headers\");\n  HttpEstablishStaticConfigByte(c.cache_post_method, \"proxy.config.http.cache.post_method\");\n\n  HttpEstablishStaticConfigByte(c.oride.ignore_accept_mismatch, \"proxy.config.http.cache.ignore_accept_mismatch\");\n  HttpEstablishStaticConfigByte(c.oride.ignore_accept_language_mismatch, \"proxy.config.http.cache.ignore_accept_language_mismatch\");\n  HttpEstablishStaticConfigByte(c.oride.ignore_accept_encoding_mismatch, \"proxy.config.http.cache.ignore_accept_encoding_mismatch\");\n  HttpEstablishStaticConfigByte(c.oride.ignore_accept_charset_mismatch, \"proxy.config.http.cache.ignore_accept_charset_mismatch\");\n\n  HttpEstablishStaticConfigByte(c.send_100_continue_response, \"proxy.config.http.send_100_continue_response\");\n  HttpEstablishStaticConfigByte(c.disallow_post_100_continue, \"proxy.config.http.disallow_post_100_continue\");\n  HttpEstablishStaticConfigByte(c.parser_allow_non_http, \"proxy.config.http.parse.allow_non_http\");\n\n  HttpEstablishStaticConfigByte(c.keepalive_internal_vc, \"proxy.config.http.keepalive_internal_vc\");\n\n  HttpEstablishStaticConfigByte(c.oride.cache_open_write_fail_action, \"proxy.config.http.cache.open_write_fail_action\");\n\n  HttpEstablishStaticConfigByte(c.oride.cache_when_to_revalidate, \"proxy.config.http.cache.when_to_revalidate\");\n  HttpEstablishStaticConfigByte(c.oride.cache_required_headers, \"proxy.config.http.cache.required_headers\");\n  HttpEstablishStaticConfigByte(c.oride.cache_range_lookup, \"proxy.config.http.cache.range.lookup\");\n  HttpEstablishStaticConfigByte(c.oride.cache_range_write, \"proxy.config.http.cache.range.write\");\n\n  HttpEstablishStaticConfigStringAlloc(c.connect_ports_string, \"proxy.config.http.connect_ports\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.request_hdr_max_size, \"proxy.config.http.request_header_max_size\");\n  HttpEstablishStaticConfigLongLong(c.oride.response_hdr_max_size, \"proxy.config.http.response_header_max_size\");\n\n  HttpEstablishStaticConfigByte(c.push_method_enabled, \"proxy.config.http.push_method_enabled\");\n\n  HttpEstablishStaticConfigByte(c.reverse_proxy_enabled, \"proxy.config.reverse_proxy.enabled\");\n  HttpEstablishStaticConfigByte(c.url_remap_required, \"proxy.config.url_remap.remap_required\");\n\n  HttpEstablishStaticConfigStringAlloc(c.reverse_proxy_no_host_redirect, \"proxy.config.header.parse.no_host_url_redirect\");\n  c.reverse_proxy_no_host_redirect_len = -1;\n  HttpEstablishStaticConfigStringAlloc(c.oride.body_factory_template_base, \"proxy.config.body_factory.template_base\");\n  c.oride.body_factory_template_base_len = c.oride.body_factory_template_base ? strlen(c.oride.body_factory_template_base) : 0;\n  HttpEstablishStaticConfigLongLong(c.body_factory_response_max_size, \"proxy.config.body_factory.response_max_size\");\n  HttpEstablishStaticConfigByte(c.errors_log_error_pages, \"proxy.config.http.errors.log_error_pages\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.slow_log_threshold, \"proxy.config.http.slow.log.threshold\");\n  HttpEstablishStaticConfigByte(c.oride.ssl_client_verify_server, \"proxy.config.ssl.client.verify.server\");\n\n  HttpEstablishStaticConfigByte(c.record_cop_page, \"proxy.config.http.record_heartbeat\");\n\n  HttpEstablishStaticConfigByte(c.oride.send_http11_requests, \"proxy.config.http.send_http11_requests\");\n\n  // HTTP Referer Filtering\n  HttpEstablishStaticConfigByte(c.referer_filter_enabled, \"proxy.config.http.referer_filter\");\n  HttpEstablishStaticConfigByte(c.referer_format_redirect, \"proxy.config.http.referer_format_redirect\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.down_server_timeout, \"proxy.config.http.down_server.cache_time\");\n  HttpEstablishStaticConfigLongLong(c.oride.client_abort_threshold, \"proxy.config.http.down_server.abort_threshold\");\n\n  // Negative caching and revalidation\n  HttpEstablishStaticConfigByte(c.oride.negative_caching_enabled, \"proxy.config.http.negative_caching_enabled\");\n  HttpEstablishStaticConfigLongLong(c.oride.negative_caching_lifetime, \"proxy.config.http.negative_caching_lifetime\");\n  HttpEstablishStaticConfigByte(c.oride.negative_revalidating_enabled, \"proxy.config.http.negative_revalidating_enabled\");\n  HttpEstablishStaticConfigLongLong(c.oride.negative_revalidating_lifetime, \"proxy.config.http.negative_revalidating_lifetime\");\n\n  // Buffer size and watermark\n  HttpEstablishStaticConfigLongLong(c.oride.default_buffer_size_index, \"proxy.config.http.default_buffer_size\");\n  HttpEstablishStaticConfigLongLong(c.oride.default_buffer_water_mark, \"proxy.config.http.default_buffer_water_mark\");\n\n  // Stat Page Info\n  HttpEstablishStaticConfigByte(c.enable_http_info, \"proxy.config.http.enable_http_info\");\n\n  HttpEstablishStaticConfigLongLong(c.max_post_size, \"proxy.config.http.max_post_size\");\n\n  //##############################################################################\n  //#\n  //# Redirection\n  //#\n  //# 1. number_of_redirections: The maximum number of redirections YTS permits. 0 == disabled\n  //# 2. redirect_use_orig_cache_key: if set to 1, use original request cache key.\n  //# 3. post_copy_size: The maximum POST data size YTS permits to copy\n  //# 4. redirection_host_no_port: do not include default port in host header during redirection\n  //#\n  //##############################################################################\n  HttpEstablishStaticConfigByte(c.oride.redirect_use_orig_cache_key, \"proxy.config.http.redirect_use_orig_cache_key\");\n  HttpEstablishStaticConfigByte(c.redirection_host_no_port, \"proxy.config.http.redirect_host_no_port\");\n  HttpEstablishStaticConfigLongLong(c.oride.number_of_redirections, \"proxy.config.http.number_of_redirections\");\n  HttpEstablishStaticConfigLongLong(c.post_copy_size, \"proxy.config.http.post_copy_size\");\n\n  // Local Manager\n  HttpEstablishStaticConfigLongLong(c.synthetic_port, \"proxy.config.admin.synthetic_port\");\n\n  http_config_cont->handleEvent(EVENT_NONE, nullptr);\n\n  return;\n}",
  "abstract_func_before": "void\nHttpConfig::startup()\n{\n  VAR_0 = RecAllocateRawStatBlock((int)VAR_1);\n  register_stat_callbacks();\n\n  HttpConfigParams &VAR_2 = VAR_3;\n\n  VAR_4 = new HttpConfigCont;\n\n  HttpEstablishStaticConfigStringAlloc(VAR_2.proxy_hostname, \"proxy.config.proxy_name\");\n  VAR_2.proxy_hostname_len = -1;\n\n  if (VAR_2.proxy_hostname == nullptr) {\n    VAR_2.proxy_hostname    = (char *)ats_malloc(sizeof(char));\n    VAR_2.proxy_hostname[0] = '\\0';\n  }\n\n  RecHttpLoadIp(\"proxy.local.incoming_ip_to_bind\", VAR_2.inbound_ip4, VAR_2.inbound_ip6);\n  RecHttpLoadIp(\"proxy.local.outgoing_ip_to_bind\", VAR_2.outbound_ip4, VAR_2.outbound_ip6);\n\n  HttpEstablishStaticConfigLongLong(VAR_2.server_max_connections, \"proxy.config.http.server_max_connections\");\n  HttpEstablishStaticConfigLongLong(VAR_2.max_websocket_connections, \"proxy.config.http.websocket.max_number_of_connections\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.server_tcp_init_cwnd, \"proxy.config.http.server_tcp_init_cwnd\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.origin_max_connections, \"proxy.config.http.origin_max_connections\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.origin_max_connections_queue, \"proxy.config.http.origin_max_connections_queue\");\n  HttpEstablishStaticConfigLongLong(VAR_2.origin_min_keep_alive_connections, \"proxy.config.http.origin_min_keep_alive_connections\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.attach_server_session_to_client, \"proxy.config.http.attach_server_session_to_client\");\n\n  HttpEstablishStaticConfigByte(VAR_2.disable_ssl_parenting, \"proxy.local.http.parent_proxy.disable_connect_tunneling\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.forward_connect_method, \"proxy.config.http.forward_connect_method\");\n\n  HttpEstablishStaticConfigByte(VAR_2.no_dns_forward_to_parent, \"proxy.config.http.no_dns_just_forward_to_parent\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.uncacheable_requests_bypass_parent, \"proxy.config.http.uncacheable_requests_bypass_parent\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.doc_in_cache_skip_dns, \"proxy.config.http.doc_in_cache_skip_dns\");\n\n  HttpEstablishStaticConfigByte(VAR_2.no_origin_server_dns, \"proxy.config.http.no_origin_server_dns\");\n  HttpEstablishStaticConfigByte(VAR_2.use_client_target_addr, \"proxy.config.http.use_client_target_addr\");\n  HttpEstablishStaticConfigByte(VAR_2.use_client_source_port, \"proxy.config.http.use_client_source_port\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.maintain_pristine_host_hdr, \"proxy.config.url_remap.pristine_host_hdr\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.insert_request_via_string, \"proxy.config.http.insert_request_via_str\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.insert_response_via_string, \"proxy.config.http.insert_response_via_str\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.proxy_response_hsts_max_age, \"proxy.config.ssl.hsts_max_age\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.proxy_response_hsts_include_subdomains, \"proxy.config.ssl.hsts_include_subdomains\");\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.client_cert_filename, \"proxy.config.ssl.client.cert.filename\");\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.client_cert_filepath, \"proxy.config.ssl.client.cert.path\");\n\n  HttpEstablishStaticConfigStringAlloc(VAR_2.proxy_request_via_string, \"proxy.config.http.request_via_str\");\n  VAR_2.proxy_request_via_string_len = -1;\n  HttpEstablishStaticConfigStringAlloc(VAR_2.proxy_response_via_string, \"proxy.config.http.response_via_str\");\n  VAR_2.proxy_response_via_string_len = -1;\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.keep_alive_enabled_in, \"proxy.config.http.keep_alive_enabled_in\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.keep_alive_enabled_out, \"proxy.config.http.keep_alive_enabled_out\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.chunking_enabled, \"proxy.config.http.chunking_enabled\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.http_chunking_size, \"proxy.config.http.chunking.size\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.flow_control_enabled, \"proxy.config.http.flow_control.enabled\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.flow_high_water_mark, \"proxy.config.http.flow_control.high_water\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.flow_low_water_mark, \"proxy.config.http.flow_control.low_water\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.post_check_content_length_enabled, \"proxy.config.http.post.check.content_length.enabled\");\n  HttpEstablishStaticConfigByte(VAR_2.strict_uri_parsing, \"proxy.config.http.strict_uri_parsing\");\n\n  /* COMMENT_0 */\n  RecRegisterConfigUpdateCb(\"proxy.config.http.server_session_sharing.match\", &VAR_5, &VAR_2);\n  http_config_enum_read(\"proxy.config.http.server_session_sharing.match\", VAR_6,\n                        VAR_2.oride.server_session_sharing_match);\n  http_config_enum_read(\"proxy.config.http.server_session_sharing.pool\", VAR_7, VAR_2.server_session_sharing_pool);\n\n  RecRegisterConfigUpdateCb(\"proxy.config.http.insert_forwarded\", &VAR_8, &VAR_2);\n  {\n    char VAR_9[512];\n\n    if (VAR_10 == RecGetRecordString(\"proxy.config.http.insert_forwarded\", VAR_9, sizeof(VAR_9))) {\n      ts::LocalBufferWriter<1024> VAR_11;\n      HttpForwarded::OptionBitSet VAR_12 = HttpForwarded::optStrToBitset(ts::string_view(VAR_9), VAR_11);\n      if (!VAR_11.size()) {\n        VAR_2.oride.insert_forwarded = VAR_12;\n      } else {\n        Error(\"HTTP %.*s\", VAR_13<int>(VAR_11.size()), VAR_11.data());\n      }\n    }\n  }\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.auth_server_session_private, \"proxy.config.http.auth_server_session_private\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.keep_alive_post_out, \"proxy.config.http.keep_alive_post_out\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.keep_alive_no_activity_timeout_in,\n                                    \"proxy.config.http.keep_alive_no_activity_timeout_in\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.keep_alive_no_activity_timeout_out,\n                                    \"proxy.config.http.keep_alive_no_activity_timeout_out\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.transaction_no_activity_timeout_in,\n                                    \"proxy.config.http.transaction_no_activity_timeout_in\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.transaction_no_activity_timeout_out,\n                                    \"proxy.config.http.transaction_no_activity_timeout_out\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.websocket_active_timeout, \"proxy.config.websocket.active_timeout\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.websocket_inactive_timeout, \"proxy.config.websocket.no_activity_timeout\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.transaction_active_timeout_in, \"proxy.config.http.transaction_active_timeout_in\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.transaction_active_timeout_out, \"proxy.config.http.transaction_active_timeout_out\");\n  HttpEstablishStaticConfigLongLong(VAR_2.accept_no_activity_timeout, \"proxy.config.http.accept_no_activity_timeout\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.background_fill_active_timeout, \"proxy.config.http.background_fill_active_timeout\");\n  HttpEstablishStaticConfigFloat(VAR_2.oride.background_fill_threshold, \"proxy.config.http.background_fill_completed_threshold\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.connect_attempts_max_retries, \"proxy.config.http.connect_attempts_max_retries\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.connect_attempts_max_retries_dead_server,\n                                    \"proxy.config.http.connect_attempts_max_retries_dead_server\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.connect_attempts_rr_retries, \"proxy.config.http.connect_attempts_rr_retries\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.connect_attempts_timeout, \"proxy.config.http.connect_attempts_timeout\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.post_connect_attempts_timeout, \"proxy.config.http.post_connect_attempts_timeout\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.parent_connect_attempts, \"proxy.config.http.parent_proxy.total_connect_attempts\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.parent_retry_time, \"proxy.config.http.parent_proxy.retry_time\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.parent_fail_threshold, \"proxy.config.http.parent_proxy.fail_threshold\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.per_parent_connect_attempts,\n                                    \"proxy.config.http.parent_proxy.per_parent_connect_attempts\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.parent_connect_timeout, \"proxy.config.http.parent_proxy.connect_attempts_timeout\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.parent_failures_update_hostdb, \"proxy.config.http.parent_proxy.mark_down_hostdb\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.sock_recv_buffer_size_out, \"proxy.config.net.sock_recv_buffer_size_out\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.sock_send_buffer_size_out, \"proxy.config.net.sock_send_buffer_size_out\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.sock_option_flag_out, \"proxy.config.net.sock_option_flag_out\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.sock_packet_mark_out, \"proxy.config.net.sock_packet_mark_out\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.sock_packet_tos_out, \"proxy.config.net.sock_packet_tos_out\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.fwd_proxy_auth_to_parent, \"proxy.config.http.forward.proxy_auth_to_parent\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.anonymize_remove_from, \"proxy.config.http.anonymize_remove_from\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.anonymize_remove_referer, \"proxy.config.http.anonymize_remove_referer\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.anonymize_remove_user_agent, \"proxy.config.http.anonymize_remove_user_agent\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.anonymize_remove_cookie, \"proxy.config.http.anonymize_remove_cookie\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.anonymize_remove_client_ip, \"proxy.config.http.anonymize_remove_client_ip\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.anonymize_insert_client_ip, \"proxy.config.http.insert_client_ip\");\n  HttpEstablishStaticConfigStringAlloc(VAR_2.anonymize_other_header_list, \"proxy.config.http.anonymize_other_header_list\");\n\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.global_user_agent_header, \"proxy.config.http.global_user_agent_header\");\n  VAR_2.oride.global_user_agent_header_size = VAR_2.oride.global_user_agent_header ? strlen(VAR_2.oride.global_user_agent_header) : 0;\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.proxy_response_server_enabled, \"proxy.config.http.response_server_enabled\");\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.proxy_response_server_string, \"proxy.config.http.response_server_str\");\n  VAR_2.oride.proxy_response_server_string_len =\n    VAR_2.oride.proxy_response_server_string ? strlen(VAR_2.oride.proxy_response_server_string) : 0;\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.insert_squid_x_forwarded_for, \"proxy.config.http.insert_squid_x_forwarded_for\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.insert_age_in_response, \"proxy.config.http.insert_age_in_response\");\n  HttpEstablishStaticConfigByte(VAR_2.enable_http_stats, \"proxy.config.http.enable_http_stats\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.normalize_ae, \"proxy.config.http.normalize_ae\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.cache_heuristic_min_lifetime, \"proxy.config.http.cache.heuristic_min_lifetime\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.cache_heuristic_max_lifetime, \"proxy.config.http.cache.heuristic_max_lifetime\");\n  HttpEstablishStaticConfigFloat(VAR_2.oride.cache_heuristic_lm_factor, \"proxy.config.http.cache.heuristic_lm_factor\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.cache_guaranteed_min_lifetime, \"proxy.config.http.cache.guaranteed_min_lifetime\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.cache_guaranteed_max_lifetime, \"proxy.config.http.cache.guaranteed_max_lifetime\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.cache_max_stale_age, \"proxy.config.http.cache.max_stale_age\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.srv_enabled, \"proxy.config.srv_enabled\");\n\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.cache_vary_default_text, \"proxy.config.http.cache.vary_default_text\");\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.cache_vary_default_images, \"proxy.config.http.cache.vary_default_images\");\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.cache_vary_default_other, \"proxy.config.http.cache.vary_default_other\");\n\n  /* COMMENT_1 */\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.max_cache_open_read_retries, \"proxy.config.http.cache.max_open_read_retries\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.cache_open_read_retry_time, \"proxy.config.http.cache.open_read_retry_time\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.cache_generation_number, \"proxy.config.http.cache.generation\");\n\n  /* COMMENT_2 */\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.max_cache_open_write_retries, \"proxy.config.http.cache.max_open_write_retries\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_http, \"proxy.config.http.cache.http\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_ignore_client_no_cache, \"proxy.config.http.cache.ignore_client_no_cache\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_ignore_client_cc_max_age, \"proxy.config.http.cache.ignore_client_cc_max_age\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_ims_on_client_no_cache, \"proxy.config.http.cache.ims_on_client_no_cache\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_ignore_server_no_cache, \"proxy.config.http.cache.ignore_server_no_cache\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_responses_to_cookies, \"proxy.config.http.cache.cache_responses_to_cookies\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_ignore_auth, \"proxy.config.http.cache.ignore_authentication\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_urls_that_look_dynamic, \"proxy.config.http.cache.cache_urls_that_look_dynamic\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_enable_default_vary_headers, \"proxy.config.http.cache.enable_default_vary_headers\");\n  HttpEstablishStaticConfigByte(VAR_2.cache_post_method, \"proxy.config.http.cache.post_method\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.ignore_accept_mismatch, \"proxy.config.http.cache.ignore_accept_mismatch\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.ignore_accept_language_mismatch, \"proxy.config.http.cache.ignore_accept_language_mismatch\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.ignore_accept_encoding_mismatch, \"proxy.config.http.cache.ignore_accept_encoding_mismatch\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.ignore_accept_charset_mismatch, \"proxy.config.http.cache.ignore_accept_charset_mismatch\");\n\n  HttpEstablishStaticConfigByte(VAR_2.send_100_continue_response, \"proxy.config.http.send_100_continue_response\");\n  HttpEstablishStaticConfigByte(VAR_2.disallow_post_100_continue, \"proxy.config.http.disallow_post_100_continue\");\n  HttpEstablishStaticConfigByte(VAR_2.parser_allow_non_http, \"proxy.config.http.parse.allow_non_http\");\n\n  HttpEstablishStaticConfigByte(VAR_2.keepalive_internal_vc, \"proxy.config.http.keepalive_internal_vc\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_open_write_fail_action, \"proxy.config.http.cache.open_write_fail_action\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_when_to_revalidate, \"proxy.config.http.cache.when_to_revalidate\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_required_headers, \"proxy.config.http.cache.required_headers\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_range_lookup, \"proxy.config.http.cache.range.lookup\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_range_write, \"proxy.config.http.cache.range.write\");\n\n  HttpEstablishStaticConfigStringAlloc(VAR_2.connect_ports_string, \"proxy.config.http.connect_ports\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.request_hdr_max_size, \"proxy.config.http.request_header_max_size\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.response_hdr_max_size, \"proxy.config.http.response_header_max_size\");\n\n  HttpEstablishStaticConfigByte(VAR_2.push_method_enabled, \"proxy.config.http.push_method_enabled\");\n\n  HttpEstablishStaticConfigByte(VAR_2.reverse_proxy_enabled, \"proxy.config.reverse_proxy.enabled\");\n  HttpEstablishStaticConfigByte(VAR_2.url_remap_required, \"proxy.config.url_remap.remap_required\");\n\n  HttpEstablishStaticConfigStringAlloc(VAR_2.reverse_proxy_no_host_redirect, \"proxy.config.header.parse.no_host_url_redirect\");\n  VAR_2.reverse_proxy_no_host_redirect_len = -1;\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.body_factory_template_base, \"proxy.config.body_factory.template_base\");\n  VAR_2.oride.body_factory_template_base_len = VAR_2.oride.body_factory_template_base ? strlen(VAR_2.oride.body_factory_template_base) : 0;\n  HttpEstablishStaticConfigLongLong(VAR_2.body_factory_response_max_size, \"proxy.config.body_factory.response_max_size\");\n  HttpEstablishStaticConfigByte(VAR_2.errors_log_error_pages, \"proxy.config.http.errors.log_error_pages\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.slow_log_threshold, \"proxy.config.http.slow.log.threshold\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.ssl_client_verify_server, \"proxy.config.ssl.client.verify.server\");\n\n  HttpEstablishStaticConfigByte(VAR_2.record_cop_page, \"proxy.config.http.record_heartbeat\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.send_http11_requests, \"proxy.config.http.send_http11_requests\");\n\n  /* COMMENT_3 */\n  HttpEstablishStaticConfigByte(VAR_2.referer_filter_enabled, \"proxy.config.http.referer_filter\");\n  HttpEstablishStaticConfigByte(VAR_2.referer_format_redirect, \"proxy.config.http.referer_format_redirect\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.down_server_timeout, \"proxy.config.http.down_server.cache_time\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.client_abort_threshold, \"proxy.config.http.down_server.abort_threshold\");\n\n  /* COMMENT_4 */\n  HttpEstablishStaticConfigByte(VAR_2.oride.negative_caching_enabled, \"proxy.config.http.negative_caching_enabled\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.negative_caching_lifetime, \"proxy.config.http.negative_caching_lifetime\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.negative_revalidating_enabled, \"proxy.config.http.negative_revalidating_enabled\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.negative_revalidating_lifetime, \"proxy.config.http.negative_revalidating_lifetime\");\n\n  /* COMMENT_5 */\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.default_buffer_size_index, \"proxy.config.http.default_buffer_size\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.default_buffer_water_mark, \"proxy.config.http.default_buffer_water_mark\");\n\n  /* COMMENT_6 */\n  HttpEstablishStaticConfigByte(VAR_2.enable_http_info, \"proxy.config.http.enable_http_info\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.max_post_size, \"proxy.config.http.max_post_size\");\n\n  /* COMMENT_7 */\n  /* COMMENT_8 */\n  /* COMMENT_9 */\n  /* COMMENT_8 */\n  /* COMMENT_10 */\n  /* COMMENT_11 */\n  /* COMMENT_12 */\n  /* COMMENT_13 */\n  /* COMMENT_8 */\n  /* COMMENT_7 */\n  HttpEstablishStaticConfigByte(VAR_2.oride.redirect_use_orig_cache_key, \"proxy.config.http.redirect_use_orig_cache_key\");\n  HttpEstablishStaticConfigByte(VAR_2.redirection_host_no_port, \"proxy.config.http.redirect_host_no_port\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.number_of_redirections, \"proxy.config.http.number_of_redirections\");\n  HttpEstablishStaticConfigLongLong(VAR_2.post_copy_size, \"proxy.config.http.post_copy_size\");\n\n  /* COMMENT_14 */\n  HttpEstablishStaticConfigLongLong(VAR_2.synthetic_port, \"proxy.config.admin.synthetic_port\");\n\n  VAR_4->handleEvent(VAR_14, nullptr);\n\n  return;\n}",
  "func_graph_path_before": "apache/trafficserver/6d248026b04d69e5c5049709c17ea671328ea4ea/HttpConfig.cc/vul/before/1.json",
  "func": "void\nHttpConfig::startup()\n{\n  http_rsb = RecAllocateRawStatBlock((int)http_stat_count);\n  register_stat_callbacks();\n\n  HttpConfigParams &c = m_master;\n\n  http_config_cont = new HttpConfigCont;\n\n  HttpEstablishStaticConfigStringAlloc(c.proxy_hostname, \"proxy.config.proxy_name\");\n  c.proxy_hostname_len = -1;\n\n  if (c.proxy_hostname == nullptr) {\n    c.proxy_hostname    = (char *)ats_malloc(sizeof(char));\n    c.proxy_hostname[0] = '\\0';\n  }\n\n  RecHttpLoadIp(\"proxy.local.incoming_ip_to_bind\", c.inbound_ip4, c.inbound_ip6);\n  RecHttpLoadIp(\"proxy.local.outgoing_ip_to_bind\", c.outbound_ip4, c.outbound_ip6);\n\n  HttpEstablishStaticConfigLongLong(c.server_max_connections, \"proxy.config.http.server_max_connections\");\n  HttpEstablishStaticConfigLongLong(c.max_websocket_connections, \"proxy.config.http.websocket.max_number_of_connections\");\n  HttpEstablishStaticConfigLongLong(c.oride.server_tcp_init_cwnd, \"proxy.config.http.server_tcp_init_cwnd\");\n  HttpEstablishStaticConfigLongLong(c.oride.origin_max_connections, \"proxy.config.http.origin_max_connections\");\n  HttpEstablishStaticConfigLongLong(c.oride.origin_max_connections_queue, \"proxy.config.http.origin_max_connections_queue\");\n  HttpEstablishStaticConfigLongLong(c.origin_min_keep_alive_connections, \"proxy.config.http.origin_min_keep_alive_connections\");\n  HttpEstablishStaticConfigByte(c.oride.attach_server_session_to_client, \"proxy.config.http.attach_server_session_to_client\");\n\n  HttpEstablishStaticConfigByte(c.disable_ssl_parenting, \"proxy.local.http.parent_proxy.disable_connect_tunneling\");\n  HttpEstablishStaticConfigByte(c.oride.forward_connect_method, \"proxy.config.http.forward_connect_method\");\n\n  HttpEstablishStaticConfigByte(c.no_dns_forward_to_parent, \"proxy.config.http.no_dns_just_forward_to_parent\");\n  HttpEstablishStaticConfigByte(c.oride.uncacheable_requests_bypass_parent, \"proxy.config.http.uncacheable_requests_bypass_parent\");\n  HttpEstablishStaticConfigByte(c.oride.doc_in_cache_skip_dns, \"proxy.config.http.doc_in_cache_skip_dns\");\n\n  HttpEstablishStaticConfigByte(c.no_origin_server_dns, \"proxy.config.http.no_origin_server_dns\");\n  HttpEstablishStaticConfigByte(c.use_client_target_addr, \"proxy.config.http.use_client_target_addr\");\n  HttpEstablishStaticConfigByte(c.use_client_source_port, \"proxy.config.http.use_client_source_port\");\n  HttpEstablishStaticConfigByte(c.oride.maintain_pristine_host_hdr, \"proxy.config.url_remap.pristine_host_hdr\");\n\n  HttpEstablishStaticConfigByte(c.oride.insert_request_via_string, \"proxy.config.http.insert_request_via_str\");\n  HttpEstablishStaticConfigByte(c.oride.insert_response_via_string, \"proxy.config.http.insert_response_via_str\");\n  HttpEstablishStaticConfigLongLong(c.oride.proxy_response_hsts_max_age, \"proxy.config.ssl.hsts_max_age\");\n  HttpEstablishStaticConfigByte(c.oride.proxy_response_hsts_include_subdomains, \"proxy.config.ssl.hsts_include_subdomains\");\n  HttpEstablishStaticConfigStringAlloc(c.oride.client_cert_filename, \"proxy.config.ssl.client.cert.filename\");\n  HttpEstablishStaticConfigStringAlloc(c.oride.client_cert_filepath, \"proxy.config.ssl.client.cert.path\");\n\n  HttpEstablishStaticConfigStringAlloc(c.proxy_request_via_string, \"proxy.config.http.request_via_str\");\n  c.proxy_request_via_string_len = -1;\n  HttpEstablishStaticConfigStringAlloc(c.proxy_response_via_string, \"proxy.config.http.response_via_str\");\n  c.proxy_response_via_string_len = -1;\n\n  HttpEstablishStaticConfigByte(c.oride.keep_alive_enabled_in, \"proxy.config.http.keep_alive_enabled_in\");\n  HttpEstablishStaticConfigByte(c.oride.keep_alive_enabled_out, \"proxy.config.http.keep_alive_enabled_out\");\n  HttpEstablishStaticConfigByte(c.oride.chunking_enabled, \"proxy.config.http.chunking_enabled\");\n  HttpEstablishStaticConfigLongLong(c.oride.http_chunking_size, \"proxy.config.http.chunking.size\");\n  HttpEstablishStaticConfigByte(c.oride.flow_control_enabled, \"proxy.config.http.flow_control.enabled\");\n  HttpEstablishStaticConfigLongLong(c.oride.flow_high_water_mark, \"proxy.config.http.flow_control.high_water\");\n  HttpEstablishStaticConfigLongLong(c.oride.flow_low_water_mark, \"proxy.config.http.flow_control.low_water\");\n  HttpEstablishStaticConfigByte(c.oride.post_check_content_length_enabled, \"proxy.config.http.post.check.content_length.enabled\");\n  HttpEstablishStaticConfigByte(c.strict_uri_parsing, \"proxy.config.http.strict_uri_parsing\");\n\n  // [amc] This is a bit of a mess, need to figure out to make this cleaner.\n  RecRegisterConfigUpdateCb(\"proxy.config.http.server_session_sharing.match\", &http_server_session_sharing_cb, &c);\n  http_config_enum_read(\"proxy.config.http.server_session_sharing.match\", SessionSharingMatchStrings,\n                        c.oride.server_session_sharing_match);\n  http_config_enum_read(\"proxy.config.http.server_session_sharing.pool\", SessionSharingPoolStrings, c.server_session_sharing_pool);\n\n  RecRegisterConfigUpdateCb(\"proxy.config.http.insert_forwarded\", &http_insert_forwarded_cb, &c);\n  {\n    char str[512];\n\n    if (REC_ERR_OKAY == RecGetRecordString(\"proxy.config.http.insert_forwarded\", str, sizeof(str))) {\n      ts::LocalBufferWriter<1024> error;\n      HttpForwarded::OptionBitSet bs = HttpForwarded::optStrToBitset(ts::string_view(str), error);\n      if (!error.size()) {\n        c.oride.insert_forwarded = bs;\n      } else {\n        Error(\"HTTP %.*s\", static_cast<int>(error.size()), error.data());\n      }\n    }\n  }\n\n  HttpEstablishStaticConfigByte(c.oride.auth_server_session_private, \"proxy.config.http.auth_server_session_private\");\n\n  HttpEstablishStaticConfigByte(c.oride.keep_alive_post_out, \"proxy.config.http.keep_alive_post_out\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.keep_alive_no_activity_timeout_in,\n                                    \"proxy.config.http.keep_alive_no_activity_timeout_in\");\n  HttpEstablishStaticConfigLongLong(c.oride.keep_alive_no_activity_timeout_out,\n                                    \"proxy.config.http.keep_alive_no_activity_timeout_out\");\n  HttpEstablishStaticConfigLongLong(c.oride.transaction_no_activity_timeout_in,\n                                    \"proxy.config.http.transaction_no_activity_timeout_in\");\n  HttpEstablishStaticConfigLongLong(c.oride.transaction_no_activity_timeout_out,\n                                    \"proxy.config.http.transaction_no_activity_timeout_out\");\n  HttpEstablishStaticConfigLongLong(c.oride.websocket_active_timeout, \"proxy.config.websocket.active_timeout\");\n  HttpEstablishStaticConfigLongLong(c.oride.websocket_inactive_timeout, \"proxy.config.websocket.no_activity_timeout\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.transaction_active_timeout_in, \"proxy.config.http.transaction_active_timeout_in\");\n  HttpEstablishStaticConfigLongLong(c.oride.transaction_active_timeout_out, \"proxy.config.http.transaction_active_timeout_out\");\n  HttpEstablishStaticConfigLongLong(c.accept_no_activity_timeout, \"proxy.config.http.accept_no_activity_timeout\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.background_fill_active_timeout, \"proxy.config.http.background_fill_active_timeout\");\n  HttpEstablishStaticConfigFloat(c.oride.background_fill_threshold, \"proxy.config.http.background_fill_completed_threshold\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.connect_attempts_max_retries, \"proxy.config.http.connect_attempts_max_retries\");\n  HttpEstablishStaticConfigLongLong(c.oride.connect_attempts_max_retries_dead_server,\n                                    \"proxy.config.http.connect_attempts_max_retries_dead_server\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.connect_attempts_rr_retries, \"proxy.config.http.connect_attempts_rr_retries\");\n  HttpEstablishStaticConfigLongLong(c.oride.connect_attempts_timeout, \"proxy.config.http.connect_attempts_timeout\");\n  HttpEstablishStaticConfigLongLong(c.oride.post_connect_attempts_timeout, \"proxy.config.http.post_connect_attempts_timeout\");\n  HttpEstablishStaticConfigLongLong(c.oride.parent_connect_attempts, \"proxy.config.http.parent_proxy.total_connect_attempts\");\n  HttpEstablishStaticConfigLongLong(c.oride.parent_retry_time, \"proxy.config.http.parent_proxy.retry_time\");\n  HttpEstablishStaticConfigLongLong(c.oride.parent_fail_threshold, \"proxy.config.http.parent_proxy.fail_threshold\");\n  HttpEstablishStaticConfigLongLong(c.oride.per_parent_connect_attempts,\n                                    \"proxy.config.http.parent_proxy.per_parent_connect_attempts\");\n  HttpEstablishStaticConfigLongLong(c.oride.parent_connect_timeout, \"proxy.config.http.parent_proxy.connect_attempts_timeout\");\n  HttpEstablishStaticConfigByte(c.oride.parent_failures_update_hostdb, \"proxy.config.http.parent_proxy.mark_down_hostdb\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.sock_recv_buffer_size_out, \"proxy.config.net.sock_recv_buffer_size_out\");\n  HttpEstablishStaticConfigLongLong(c.oride.sock_send_buffer_size_out, \"proxy.config.net.sock_send_buffer_size_out\");\n  HttpEstablishStaticConfigLongLong(c.oride.sock_option_flag_out, \"proxy.config.net.sock_option_flag_out\");\n  HttpEstablishStaticConfigLongLong(c.oride.sock_packet_mark_out, \"proxy.config.net.sock_packet_mark_out\");\n  HttpEstablishStaticConfigLongLong(c.oride.sock_packet_tos_out, \"proxy.config.net.sock_packet_tos_out\");\n\n  HttpEstablishStaticConfigByte(c.oride.fwd_proxy_auth_to_parent, \"proxy.config.http.forward.proxy_auth_to_parent\");\n\n  HttpEstablishStaticConfigByte(c.oride.anonymize_remove_from, \"proxy.config.http.anonymize_remove_from\");\n  HttpEstablishStaticConfigByte(c.oride.anonymize_remove_referer, \"proxy.config.http.anonymize_remove_referer\");\n  HttpEstablishStaticConfigByte(c.oride.anonymize_remove_user_agent, \"proxy.config.http.anonymize_remove_user_agent\");\n  HttpEstablishStaticConfigByte(c.oride.anonymize_remove_cookie, \"proxy.config.http.anonymize_remove_cookie\");\n  HttpEstablishStaticConfigByte(c.oride.anonymize_remove_client_ip, \"proxy.config.http.anonymize_remove_client_ip\");\n  HttpEstablishStaticConfigByte(c.oride.anonymize_insert_client_ip, \"proxy.config.http.insert_client_ip\");\n  HttpEstablishStaticConfigStringAlloc(c.anonymize_other_header_list, \"proxy.config.http.anonymize_other_header_list\");\n\n  HttpEstablishStaticConfigStringAlloc(c.oride.global_user_agent_header, \"proxy.config.http.global_user_agent_header\");\n  c.oride.global_user_agent_header_size = c.oride.global_user_agent_header ? strlen(c.oride.global_user_agent_header) : 0;\n\n  HttpEstablishStaticConfigByte(c.oride.proxy_response_server_enabled, \"proxy.config.http.response_server_enabled\");\n  HttpEstablishStaticConfigStringAlloc(c.oride.proxy_response_server_string, \"proxy.config.http.response_server_str\");\n  c.oride.proxy_response_server_string_len =\n    c.oride.proxy_response_server_string ? strlen(c.oride.proxy_response_server_string) : 0;\n\n  HttpEstablishStaticConfigByte(c.oride.insert_squid_x_forwarded_for, \"proxy.config.http.insert_squid_x_forwarded_for\");\n\n  HttpEstablishStaticConfigByte(c.oride.insert_age_in_response, \"proxy.config.http.insert_age_in_response\");\n  HttpEstablishStaticConfigByte(c.enable_http_stats, \"proxy.config.http.enable_http_stats\");\n  HttpEstablishStaticConfigByte(c.oride.normalize_ae, \"proxy.config.http.normalize_ae\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.cache_heuristic_min_lifetime, \"proxy.config.http.cache.heuristic_min_lifetime\");\n  HttpEstablishStaticConfigLongLong(c.oride.cache_heuristic_max_lifetime, \"proxy.config.http.cache.heuristic_max_lifetime\");\n  HttpEstablishStaticConfigFloat(c.oride.cache_heuristic_lm_factor, \"proxy.config.http.cache.heuristic_lm_factor\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.cache_guaranteed_min_lifetime, \"proxy.config.http.cache.guaranteed_min_lifetime\");\n  HttpEstablishStaticConfigLongLong(c.oride.cache_guaranteed_max_lifetime, \"proxy.config.http.cache.guaranteed_max_lifetime\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.cache_max_stale_age, \"proxy.config.http.cache.max_stale_age\");\n  HttpEstablishStaticConfigByte(c.oride.srv_enabled, \"proxy.config.srv_enabled\");\n\n  HttpEstablishStaticConfigStringAlloc(c.oride.cache_vary_default_text, \"proxy.config.http.cache.vary_default_text\");\n  HttpEstablishStaticConfigStringAlloc(c.oride.cache_vary_default_images, \"proxy.config.http.cache.vary_default_images\");\n  HttpEstablishStaticConfigStringAlloc(c.oride.cache_vary_default_other, \"proxy.config.http.cache.vary_default_other\");\n\n  // open read failure retries\n  HttpEstablishStaticConfigLongLong(c.oride.max_cache_open_read_retries, \"proxy.config.http.cache.max_open_read_retries\");\n  HttpEstablishStaticConfigLongLong(c.oride.cache_open_read_retry_time, \"proxy.config.http.cache.open_read_retry_time\");\n  HttpEstablishStaticConfigLongLong(c.oride.cache_generation_number, \"proxy.config.http.cache.generation\");\n\n  // open write failure retries\n  HttpEstablishStaticConfigLongLong(c.oride.max_cache_open_write_retries, \"proxy.config.http.cache.max_open_write_retries\");\n\n  HttpEstablishStaticConfigByte(c.oride.cache_http, \"proxy.config.http.cache.http\");\n  HttpEstablishStaticConfigByte(c.oride.cache_ignore_client_no_cache, \"proxy.config.http.cache.ignore_client_no_cache\");\n  HttpEstablishStaticConfigByte(c.oride.cache_ignore_client_cc_max_age, \"proxy.config.http.cache.ignore_client_cc_max_age\");\n  HttpEstablishStaticConfigByte(c.oride.cache_ims_on_client_no_cache, \"proxy.config.http.cache.ims_on_client_no_cache\");\n  HttpEstablishStaticConfigByte(c.oride.cache_ignore_server_no_cache, \"proxy.config.http.cache.ignore_server_no_cache\");\n  HttpEstablishStaticConfigByte(c.oride.cache_responses_to_cookies, \"proxy.config.http.cache.cache_responses_to_cookies\");\n\n  HttpEstablishStaticConfigByte(c.oride.cache_ignore_auth, \"proxy.config.http.cache.ignore_authentication\");\n  HttpEstablishStaticConfigByte(c.oride.cache_urls_that_look_dynamic, \"proxy.config.http.cache.cache_urls_that_look_dynamic\");\n  HttpEstablishStaticConfigByte(c.oride.cache_enable_default_vary_headers, \"proxy.config.http.cache.enable_default_vary_headers\");\n  HttpEstablishStaticConfigByte(c.cache_post_method, \"proxy.config.http.cache.post_method\");\n\n  HttpEstablishStaticConfigByte(c.oride.ignore_accept_mismatch, \"proxy.config.http.cache.ignore_accept_mismatch\");\n  HttpEstablishStaticConfigByte(c.oride.ignore_accept_language_mismatch, \"proxy.config.http.cache.ignore_accept_language_mismatch\");\n  HttpEstablishStaticConfigByte(c.oride.ignore_accept_encoding_mismatch, \"proxy.config.http.cache.ignore_accept_encoding_mismatch\");\n  HttpEstablishStaticConfigByte(c.oride.ignore_accept_charset_mismatch, \"proxy.config.http.cache.ignore_accept_charset_mismatch\");\n\n  HttpEstablishStaticConfigByte(c.send_100_continue_response, \"proxy.config.http.send_100_continue_response\");\n  HttpEstablishStaticConfigByte(c.disallow_post_100_continue, \"proxy.config.http.disallow_post_100_continue\");\n  HttpEstablishStaticConfigByte(c.parser_allow_non_http, \"proxy.config.http.parse.allow_non_http\");\n\n  HttpEstablishStaticConfigByte(c.keepalive_internal_vc, \"proxy.config.http.keepalive_internal_vc\");\n\n  HttpEstablishStaticConfigByte(c.oride.cache_open_write_fail_action, \"proxy.config.http.cache.open_write_fail_action\");\n\n  HttpEstablishStaticConfigByte(c.oride.cache_when_to_revalidate, \"proxy.config.http.cache.when_to_revalidate\");\n  HttpEstablishStaticConfigByte(c.oride.cache_required_headers, \"proxy.config.http.cache.required_headers\");\n  HttpEstablishStaticConfigByte(c.oride.cache_range_lookup, \"proxy.config.http.cache.range.lookup\");\n  HttpEstablishStaticConfigByte(c.oride.cache_range_write, \"proxy.config.http.cache.range.write\");\n\n  HttpEstablishStaticConfigStringAlloc(c.connect_ports_string, \"proxy.config.http.connect_ports\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.request_hdr_max_size, \"proxy.config.http.request_header_max_size\");\n  HttpEstablishStaticConfigLongLong(c.oride.response_hdr_max_size, \"proxy.config.http.response_header_max_size\");\n\n  HttpEstablishStaticConfigByte(c.push_method_enabled, \"proxy.config.http.push_method_enabled\");\n\n  HttpEstablishStaticConfigByte(c.reverse_proxy_enabled, \"proxy.config.reverse_proxy.enabled\");\n  HttpEstablishStaticConfigByte(c.url_remap_required, \"proxy.config.url_remap.remap_required\");\n\n  HttpEstablishStaticConfigStringAlloc(c.reverse_proxy_no_host_redirect, \"proxy.config.header.parse.no_host_url_redirect\");\n  c.reverse_proxy_no_host_redirect_len = -1;\n  HttpEstablishStaticConfigStringAlloc(c.oride.body_factory_template_base, \"proxy.config.body_factory.template_base\");\n  c.oride.body_factory_template_base_len = c.oride.body_factory_template_base ? strlen(c.oride.body_factory_template_base) : 0;\n  HttpEstablishStaticConfigLongLong(c.body_factory_response_max_size, \"proxy.config.body_factory.response_max_size\");\n  HttpEstablishStaticConfigByte(c.errors_log_error_pages, \"proxy.config.http.errors.log_error_pages\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.slow_log_threshold, \"proxy.config.http.slow.log.threshold\");\n  HttpEstablishStaticConfigByte(c.oride.ssl_client_verify_server, \"proxy.config.ssl.client.verify.server\");\n\n  HttpEstablishStaticConfigByte(c.record_cop_page, \"proxy.config.http.record_heartbeat\");\n\n  HttpEstablishStaticConfigByte(c.oride.send_http11_requests, \"proxy.config.http.send_http11_requests\");\n  HttpEstablishStaticConfigByte(c.oride.allow_multi_range, \"proxy.config.http.allow_multi_range\");\n\n  // HTTP Referer Filtering\n  HttpEstablishStaticConfigByte(c.referer_filter_enabled, \"proxy.config.http.referer_filter\");\n  HttpEstablishStaticConfigByte(c.referer_format_redirect, \"proxy.config.http.referer_format_redirect\");\n\n  HttpEstablishStaticConfigLongLong(c.oride.down_server_timeout, \"proxy.config.http.down_server.cache_time\");\n  HttpEstablishStaticConfigLongLong(c.oride.client_abort_threshold, \"proxy.config.http.down_server.abort_threshold\");\n\n  // Negative caching and revalidation\n  HttpEstablishStaticConfigByte(c.oride.negative_caching_enabled, \"proxy.config.http.negative_caching_enabled\");\n  HttpEstablishStaticConfigLongLong(c.oride.negative_caching_lifetime, \"proxy.config.http.negative_caching_lifetime\");\n  HttpEstablishStaticConfigByte(c.oride.negative_revalidating_enabled, \"proxy.config.http.negative_revalidating_enabled\");\n  HttpEstablishStaticConfigLongLong(c.oride.negative_revalidating_lifetime, \"proxy.config.http.negative_revalidating_lifetime\");\n\n  // Buffer size and watermark\n  HttpEstablishStaticConfigLongLong(c.oride.default_buffer_size_index, \"proxy.config.http.default_buffer_size\");\n  HttpEstablishStaticConfigLongLong(c.oride.default_buffer_water_mark, \"proxy.config.http.default_buffer_water_mark\");\n\n  // Stat Page Info\n  HttpEstablishStaticConfigByte(c.enable_http_info, \"proxy.config.http.enable_http_info\");\n\n  HttpEstablishStaticConfigLongLong(c.max_post_size, \"proxy.config.http.max_post_size\");\n\n  //##############################################################################\n  //#\n  //# Redirection\n  //#\n  //# 1. number_of_redirections: The maximum number of redirections YTS permits. 0 == disabled\n  //# 2. redirect_use_orig_cache_key: if set to 1, use original request cache key.\n  //# 3. post_copy_size: The maximum POST data size YTS permits to copy\n  //# 4. redirection_host_no_port: do not include default port in host header during redirection\n  //#\n  //##############################################################################\n  HttpEstablishStaticConfigByte(c.oride.redirect_use_orig_cache_key, \"proxy.config.http.redirect_use_orig_cache_key\");\n  HttpEstablishStaticConfigByte(c.redirection_host_no_port, \"proxy.config.http.redirect_host_no_port\");\n  HttpEstablishStaticConfigLongLong(c.oride.number_of_redirections, \"proxy.config.http.number_of_redirections\");\n  HttpEstablishStaticConfigLongLong(c.post_copy_size, \"proxy.config.http.post_copy_size\");\n\n  // Local Manager\n  HttpEstablishStaticConfigLongLong(c.synthetic_port, \"proxy.config.admin.synthetic_port\");\n\n  http_config_cont->handleEvent(EVENT_NONE, nullptr);\n\n  return;\n}",
  "abstract_func": "void\nHttpConfig::startup()\n{\n  VAR_0 = RecAllocateRawStatBlock((int)VAR_1);\n  register_stat_callbacks();\n\n  HttpConfigParams &VAR_2 = VAR_3;\n\n  VAR_4 = new HttpConfigCont;\n\n  HttpEstablishStaticConfigStringAlloc(VAR_2.proxy_hostname, \"proxy.config.proxy_name\");\n  VAR_2.proxy_hostname_len = -1;\n\n  if (VAR_2.proxy_hostname == nullptr) {\n    VAR_2.proxy_hostname    = (char *)ats_malloc(sizeof(char));\n    VAR_2.proxy_hostname[0] = '\\0';\n  }\n\n  RecHttpLoadIp(\"proxy.local.incoming_ip_to_bind\", VAR_2.inbound_ip4, VAR_2.inbound_ip6);\n  RecHttpLoadIp(\"proxy.local.outgoing_ip_to_bind\", VAR_2.outbound_ip4, VAR_2.outbound_ip6);\n\n  HttpEstablishStaticConfigLongLong(VAR_2.server_max_connections, \"proxy.config.http.server_max_connections\");\n  HttpEstablishStaticConfigLongLong(VAR_2.max_websocket_connections, \"proxy.config.http.websocket.max_number_of_connections\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.server_tcp_init_cwnd, \"proxy.config.http.server_tcp_init_cwnd\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.origin_max_connections, \"proxy.config.http.origin_max_connections\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.origin_max_connections_queue, \"proxy.config.http.origin_max_connections_queue\");\n  HttpEstablishStaticConfigLongLong(VAR_2.origin_min_keep_alive_connections, \"proxy.config.http.origin_min_keep_alive_connections\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.attach_server_session_to_client, \"proxy.config.http.attach_server_session_to_client\");\n\n  HttpEstablishStaticConfigByte(VAR_2.disable_ssl_parenting, \"proxy.local.http.parent_proxy.disable_connect_tunneling\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.forward_connect_method, \"proxy.config.http.forward_connect_method\");\n\n  HttpEstablishStaticConfigByte(VAR_2.no_dns_forward_to_parent, \"proxy.config.http.no_dns_just_forward_to_parent\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.uncacheable_requests_bypass_parent, \"proxy.config.http.uncacheable_requests_bypass_parent\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.doc_in_cache_skip_dns, \"proxy.config.http.doc_in_cache_skip_dns\");\n\n  HttpEstablishStaticConfigByte(VAR_2.no_origin_server_dns, \"proxy.config.http.no_origin_server_dns\");\n  HttpEstablishStaticConfigByte(VAR_2.use_client_target_addr, \"proxy.config.http.use_client_target_addr\");\n  HttpEstablishStaticConfigByte(VAR_2.use_client_source_port, \"proxy.config.http.use_client_source_port\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.maintain_pristine_host_hdr, \"proxy.config.url_remap.pristine_host_hdr\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.insert_request_via_string, \"proxy.config.http.insert_request_via_str\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.insert_response_via_string, \"proxy.config.http.insert_response_via_str\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.proxy_response_hsts_max_age, \"proxy.config.ssl.hsts_max_age\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.proxy_response_hsts_include_subdomains, \"proxy.config.ssl.hsts_include_subdomains\");\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.client_cert_filename, \"proxy.config.ssl.client.cert.filename\");\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.client_cert_filepath, \"proxy.config.ssl.client.cert.path\");\n\n  HttpEstablishStaticConfigStringAlloc(VAR_2.proxy_request_via_string, \"proxy.config.http.request_via_str\");\n  VAR_2.proxy_request_via_string_len = -1;\n  HttpEstablishStaticConfigStringAlloc(VAR_2.proxy_response_via_string, \"proxy.config.http.response_via_str\");\n  VAR_2.proxy_response_via_string_len = -1;\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.keep_alive_enabled_in, \"proxy.config.http.keep_alive_enabled_in\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.keep_alive_enabled_out, \"proxy.config.http.keep_alive_enabled_out\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.chunking_enabled, \"proxy.config.http.chunking_enabled\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.http_chunking_size, \"proxy.config.http.chunking.size\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.flow_control_enabled, \"proxy.config.http.flow_control.enabled\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.flow_high_water_mark, \"proxy.config.http.flow_control.high_water\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.flow_low_water_mark, \"proxy.config.http.flow_control.low_water\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.post_check_content_length_enabled, \"proxy.config.http.post.check.content_length.enabled\");\n  HttpEstablishStaticConfigByte(VAR_2.strict_uri_parsing, \"proxy.config.http.strict_uri_parsing\");\n\n  /* COMMENT_0 */\n  RecRegisterConfigUpdateCb(\"proxy.config.http.server_session_sharing.match\", &VAR_5, &VAR_2);\n  http_config_enum_read(\"proxy.config.http.server_session_sharing.match\", VAR_6,\n                        VAR_2.oride.server_session_sharing_match);\n  http_config_enum_read(\"proxy.config.http.server_session_sharing.pool\", VAR_7, VAR_2.server_session_sharing_pool);\n\n  RecRegisterConfigUpdateCb(\"proxy.config.http.insert_forwarded\", &VAR_8, &VAR_2);\n  {\n    char VAR_9[512];\n\n    if (VAR_10 == RecGetRecordString(\"proxy.config.http.insert_forwarded\", VAR_9, sizeof(VAR_9))) {\n      ts::LocalBufferWriter<1024> VAR_11;\n      HttpForwarded::OptionBitSet VAR_12 = HttpForwarded::optStrToBitset(ts::string_view(VAR_9), VAR_11);\n      if (!VAR_11.size()) {\n        VAR_2.oride.insert_forwarded = VAR_12;\n      } else {\n        Error(\"HTTP %.*s\", VAR_13<int>(VAR_11.size()), VAR_11.data());\n      }\n    }\n  }\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.auth_server_session_private, \"proxy.config.http.auth_server_session_private\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.keep_alive_post_out, \"proxy.config.http.keep_alive_post_out\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.keep_alive_no_activity_timeout_in,\n                                    \"proxy.config.http.keep_alive_no_activity_timeout_in\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.keep_alive_no_activity_timeout_out,\n                                    \"proxy.config.http.keep_alive_no_activity_timeout_out\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.transaction_no_activity_timeout_in,\n                                    \"proxy.config.http.transaction_no_activity_timeout_in\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.transaction_no_activity_timeout_out,\n                                    \"proxy.config.http.transaction_no_activity_timeout_out\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.websocket_active_timeout, \"proxy.config.websocket.active_timeout\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.websocket_inactive_timeout, \"proxy.config.websocket.no_activity_timeout\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.transaction_active_timeout_in, \"proxy.config.http.transaction_active_timeout_in\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.transaction_active_timeout_out, \"proxy.config.http.transaction_active_timeout_out\");\n  HttpEstablishStaticConfigLongLong(VAR_2.accept_no_activity_timeout, \"proxy.config.http.accept_no_activity_timeout\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.background_fill_active_timeout, \"proxy.config.http.background_fill_active_timeout\");\n  HttpEstablishStaticConfigFloat(VAR_2.oride.background_fill_threshold, \"proxy.config.http.background_fill_completed_threshold\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.connect_attempts_max_retries, \"proxy.config.http.connect_attempts_max_retries\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.connect_attempts_max_retries_dead_server,\n                                    \"proxy.config.http.connect_attempts_max_retries_dead_server\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.connect_attempts_rr_retries, \"proxy.config.http.connect_attempts_rr_retries\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.connect_attempts_timeout, \"proxy.config.http.connect_attempts_timeout\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.post_connect_attempts_timeout, \"proxy.config.http.post_connect_attempts_timeout\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.parent_connect_attempts, \"proxy.config.http.parent_proxy.total_connect_attempts\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.parent_retry_time, \"proxy.config.http.parent_proxy.retry_time\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.parent_fail_threshold, \"proxy.config.http.parent_proxy.fail_threshold\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.per_parent_connect_attempts,\n                                    \"proxy.config.http.parent_proxy.per_parent_connect_attempts\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.parent_connect_timeout, \"proxy.config.http.parent_proxy.connect_attempts_timeout\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.parent_failures_update_hostdb, \"proxy.config.http.parent_proxy.mark_down_hostdb\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.sock_recv_buffer_size_out, \"proxy.config.net.sock_recv_buffer_size_out\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.sock_send_buffer_size_out, \"proxy.config.net.sock_send_buffer_size_out\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.sock_option_flag_out, \"proxy.config.net.sock_option_flag_out\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.sock_packet_mark_out, \"proxy.config.net.sock_packet_mark_out\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.sock_packet_tos_out, \"proxy.config.net.sock_packet_tos_out\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.fwd_proxy_auth_to_parent, \"proxy.config.http.forward.proxy_auth_to_parent\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.anonymize_remove_from, \"proxy.config.http.anonymize_remove_from\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.anonymize_remove_referer, \"proxy.config.http.anonymize_remove_referer\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.anonymize_remove_user_agent, \"proxy.config.http.anonymize_remove_user_agent\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.anonymize_remove_cookie, \"proxy.config.http.anonymize_remove_cookie\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.anonymize_remove_client_ip, \"proxy.config.http.anonymize_remove_client_ip\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.anonymize_insert_client_ip, \"proxy.config.http.insert_client_ip\");\n  HttpEstablishStaticConfigStringAlloc(VAR_2.anonymize_other_header_list, \"proxy.config.http.anonymize_other_header_list\");\n\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.global_user_agent_header, \"proxy.config.http.global_user_agent_header\");\n  VAR_2.oride.global_user_agent_header_size = VAR_2.oride.global_user_agent_header ? strlen(VAR_2.oride.global_user_agent_header) : 0;\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.proxy_response_server_enabled, \"proxy.config.http.response_server_enabled\");\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.proxy_response_server_string, \"proxy.config.http.response_server_str\");\n  VAR_2.oride.proxy_response_server_string_len =\n    VAR_2.oride.proxy_response_server_string ? strlen(VAR_2.oride.proxy_response_server_string) : 0;\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.insert_squid_x_forwarded_for, \"proxy.config.http.insert_squid_x_forwarded_for\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.insert_age_in_response, \"proxy.config.http.insert_age_in_response\");\n  HttpEstablishStaticConfigByte(VAR_2.enable_http_stats, \"proxy.config.http.enable_http_stats\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.normalize_ae, \"proxy.config.http.normalize_ae\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.cache_heuristic_min_lifetime, \"proxy.config.http.cache.heuristic_min_lifetime\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.cache_heuristic_max_lifetime, \"proxy.config.http.cache.heuristic_max_lifetime\");\n  HttpEstablishStaticConfigFloat(VAR_2.oride.cache_heuristic_lm_factor, \"proxy.config.http.cache.heuristic_lm_factor\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.cache_guaranteed_min_lifetime, \"proxy.config.http.cache.guaranteed_min_lifetime\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.cache_guaranteed_max_lifetime, \"proxy.config.http.cache.guaranteed_max_lifetime\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.cache_max_stale_age, \"proxy.config.http.cache.max_stale_age\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.srv_enabled, \"proxy.config.srv_enabled\");\n\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.cache_vary_default_text, \"proxy.config.http.cache.vary_default_text\");\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.cache_vary_default_images, \"proxy.config.http.cache.vary_default_images\");\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.cache_vary_default_other, \"proxy.config.http.cache.vary_default_other\");\n\n  /* COMMENT_1 */\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.max_cache_open_read_retries, \"proxy.config.http.cache.max_open_read_retries\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.cache_open_read_retry_time, \"proxy.config.http.cache.open_read_retry_time\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.cache_generation_number, \"proxy.config.http.cache.generation\");\n\n  /* COMMENT_2 */\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.max_cache_open_write_retries, \"proxy.config.http.cache.max_open_write_retries\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_http, \"proxy.config.http.cache.http\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_ignore_client_no_cache, \"proxy.config.http.cache.ignore_client_no_cache\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_ignore_client_cc_max_age, \"proxy.config.http.cache.ignore_client_cc_max_age\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_ims_on_client_no_cache, \"proxy.config.http.cache.ims_on_client_no_cache\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_ignore_server_no_cache, \"proxy.config.http.cache.ignore_server_no_cache\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_responses_to_cookies, \"proxy.config.http.cache.cache_responses_to_cookies\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_ignore_auth, \"proxy.config.http.cache.ignore_authentication\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_urls_that_look_dynamic, \"proxy.config.http.cache.cache_urls_that_look_dynamic\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_enable_default_vary_headers, \"proxy.config.http.cache.enable_default_vary_headers\");\n  HttpEstablishStaticConfigByte(VAR_2.cache_post_method, \"proxy.config.http.cache.post_method\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.ignore_accept_mismatch, \"proxy.config.http.cache.ignore_accept_mismatch\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.ignore_accept_language_mismatch, \"proxy.config.http.cache.ignore_accept_language_mismatch\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.ignore_accept_encoding_mismatch, \"proxy.config.http.cache.ignore_accept_encoding_mismatch\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.ignore_accept_charset_mismatch, \"proxy.config.http.cache.ignore_accept_charset_mismatch\");\n\n  HttpEstablishStaticConfigByte(VAR_2.send_100_continue_response, \"proxy.config.http.send_100_continue_response\");\n  HttpEstablishStaticConfigByte(VAR_2.disallow_post_100_continue, \"proxy.config.http.disallow_post_100_continue\");\n  HttpEstablishStaticConfigByte(VAR_2.parser_allow_non_http, \"proxy.config.http.parse.allow_non_http\");\n\n  HttpEstablishStaticConfigByte(VAR_2.keepalive_internal_vc, \"proxy.config.http.keepalive_internal_vc\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_open_write_fail_action, \"proxy.config.http.cache.open_write_fail_action\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_when_to_revalidate, \"proxy.config.http.cache.when_to_revalidate\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_required_headers, \"proxy.config.http.cache.required_headers\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_range_lookup, \"proxy.config.http.cache.range.lookup\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.cache_range_write, \"proxy.config.http.cache.range.write\");\n\n  HttpEstablishStaticConfigStringAlloc(VAR_2.connect_ports_string, \"proxy.config.http.connect_ports\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.request_hdr_max_size, \"proxy.config.http.request_header_max_size\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.response_hdr_max_size, \"proxy.config.http.response_header_max_size\");\n\n  HttpEstablishStaticConfigByte(VAR_2.push_method_enabled, \"proxy.config.http.push_method_enabled\");\n\n  HttpEstablishStaticConfigByte(VAR_2.reverse_proxy_enabled, \"proxy.config.reverse_proxy.enabled\");\n  HttpEstablishStaticConfigByte(VAR_2.url_remap_required, \"proxy.config.url_remap.remap_required\");\n\n  HttpEstablishStaticConfigStringAlloc(VAR_2.reverse_proxy_no_host_redirect, \"proxy.config.header.parse.no_host_url_redirect\");\n  VAR_2.reverse_proxy_no_host_redirect_len = -1;\n  HttpEstablishStaticConfigStringAlloc(VAR_2.oride.body_factory_template_base, \"proxy.config.body_factory.template_base\");\n  VAR_2.oride.body_factory_template_base_len = VAR_2.oride.body_factory_template_base ? strlen(VAR_2.oride.body_factory_template_base) : 0;\n  HttpEstablishStaticConfigLongLong(VAR_2.body_factory_response_max_size, \"proxy.config.body_factory.response_max_size\");\n  HttpEstablishStaticConfigByte(VAR_2.errors_log_error_pages, \"proxy.config.http.errors.log_error_pages\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.slow_log_threshold, \"proxy.config.http.slow.log.threshold\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.ssl_client_verify_server, \"proxy.config.ssl.client.verify.server\");\n\n  HttpEstablishStaticConfigByte(VAR_2.record_cop_page, \"proxy.config.http.record_heartbeat\");\n\n  HttpEstablishStaticConfigByte(VAR_2.oride.send_http11_requests, \"proxy.config.http.send_http11_requests\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.allow_multi_range, \"proxy.config.http.allow_multi_range\");\n\n  /* COMMENT_3 */\n  HttpEstablishStaticConfigByte(VAR_2.referer_filter_enabled, \"proxy.config.http.referer_filter\");\n  HttpEstablishStaticConfigByte(VAR_2.referer_format_redirect, \"proxy.config.http.referer_format_redirect\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.down_server_timeout, \"proxy.config.http.down_server.cache_time\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.client_abort_threshold, \"proxy.config.http.down_server.abort_threshold\");\n\n  /* COMMENT_4 */\n  HttpEstablishStaticConfigByte(VAR_2.oride.negative_caching_enabled, \"proxy.config.http.negative_caching_enabled\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.negative_caching_lifetime, \"proxy.config.http.negative_caching_lifetime\");\n  HttpEstablishStaticConfigByte(VAR_2.oride.negative_revalidating_enabled, \"proxy.config.http.negative_revalidating_enabled\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.negative_revalidating_lifetime, \"proxy.config.http.negative_revalidating_lifetime\");\n\n  /* COMMENT_5 */\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.default_buffer_size_index, \"proxy.config.http.default_buffer_size\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.default_buffer_water_mark, \"proxy.config.http.default_buffer_water_mark\");\n\n  /* COMMENT_6 */\n  HttpEstablishStaticConfigByte(VAR_2.enable_http_info, \"proxy.config.http.enable_http_info\");\n\n  HttpEstablishStaticConfigLongLong(VAR_2.max_post_size, \"proxy.config.http.max_post_size\");\n\n  /* COMMENT_7 */\n  /* COMMENT_8 */\n  /* COMMENT_9 */\n  /* COMMENT_8 */\n  /* COMMENT_10 */\n  /* COMMENT_11 */\n  /* COMMENT_12 */\n  /* COMMENT_13 */\n  /* COMMENT_8 */\n  /* COMMENT_7 */\n  HttpEstablishStaticConfigByte(VAR_2.oride.redirect_use_orig_cache_key, \"proxy.config.http.redirect_use_orig_cache_key\");\n  HttpEstablishStaticConfigByte(VAR_2.redirection_host_no_port, \"proxy.config.http.redirect_host_no_port\");\n  HttpEstablishStaticConfigLongLong(VAR_2.oride.number_of_redirections, \"proxy.config.http.number_of_redirections\");\n  HttpEstablishStaticConfigLongLong(VAR_2.post_copy_size, \"proxy.config.http.post_copy_size\");\n\n  /* COMMENT_14 */\n  HttpEstablishStaticConfigLongLong(VAR_2.synthetic_port, \"proxy.config.admin.synthetic_port\");\n\n  VAR_4->handleEvent(VAR_14, nullptr);\n\n  return;\n}",
  "func_graph_path": "apache/trafficserver/6d248026b04d69e5c5049709c17ea671328ea4ea/HttpConfig.cc/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -224,6 +224,7 @@\n   HttpEstablishStaticConfigByte(c.record_cop_page, \"proxy.config.http.record_heartbeat\");\n \n   HttpEstablishStaticConfigByte(c.oride.send_http11_requests, \"proxy.config.http.send_http11_requests\");\n+  HttpEstablishStaticConfigByte(c.oride.allow_multi_range, \"proxy.config.http.allow_multi_range\");\n \n   // HTTP Referer Filtering\n   HttpEstablishStaticConfigByte(c.referer_filter_enabled, \"proxy.config.http.referer_filter\");",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "  HttpEstablishStaticConfigByte(c.oride.allow_multi_range, \"proxy.config.http.allow_multi_range\");"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/apache/trafficserver/pull/3106",
  "description": {
    "pr_info": {
      "title": "Adds a new configuration proxy.config.http.allow_multi_range",
      "number": 3106
    },
    "comment": [
      "This is needed to prevent potential abuse with well formed multi-\r\nrange requests.",
      "This has many, but trivial, merge conflicts, primarily due to clang-formatting.",
      "Cheery-picked to 7.1.3"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix\n\nConfidence Score: 0.9",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "\n\n**Final Output:**\n\nAnalysis: The patch introduces a new configuration option to control multi-range requests, aiming to prevent potential abuse and mitigate a security risk.\n\nFinal Classification: Security Vulnerability Fix\n\nConfidence Score: 0.9"
}