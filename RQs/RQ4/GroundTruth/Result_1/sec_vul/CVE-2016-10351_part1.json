{
  "cve_id": "CVE-2016-10351",
  "cwe_ids": [
    "CWE-200"
  ],
  "cvss_vector": "AV:L/AC:L/Au:N/C:P/I:N/A:N",
  "cvss_is_v3": false,
  "repo_name": "telegramdesktop/tdesktop",
  "commit_msg": "Fix CVE-2016-10351: Insecure cWorkingDir permissions.\n\nSet 700 permisson on dir on every start.\n\nSigned-off-by: Alexander GQ Gerasiov <gq@cs.msu.su>",
  "commit_hash": "388703b9ca1912a5438e37f9dd54c35805f2c594",
  "git_url": "https://github.com/telegramdesktop/tdesktop/commit/388703b9ca1912a5438e37f9dd54c35805f2c594",
  "file_path": "Telegram/SourceFiles/settings.h",
  "func_name": "cForceWorkingDir",
  "func_before": "inline void cForceWorkingDir(const QString &newDir) {\n\tcSetWorkingDir(newDir);\n\tif (!gWorkingDir.isEmpty()) QDir().mkpath(gWorkingDir);\n}",
  "abstract_func_before": "inline void cForceWorkingDir(const QString &VAR_0) {\n\tcSetWorkingDir(VAR_0);\n\tif (!VAR_1.isEmpty()) QDir().mkpath(VAR_1);\n}",
  "func_graph_path_before": null,
  "func": "inline void cForceWorkingDir(const QString &newDir) {\n\tcSetWorkingDir(newDir);\n\tif (!gWorkingDir.isEmpty()) {\n\t\tQDir().mkpath(gWorkingDir);\n\t\tQFile::setPermissions(gWorkingDir,\n\t\t\tQFileDevice::ReadUser | QFileDevice::WriteUser | QFileDevice::ExeUser);\n\t}\n\n}",
  "abstract_func": "inline void cForceWorkingDir(const QString &VAR_0) {\n\tcSetWorkingDir(VAR_0);\n\tif (!VAR_1.isEmpty()) {\n\t\tQDir().mkpath(VAR_1);\n\t\tQFile::VAR_2(VAR_1,\n\t\t\tVAR_3::VAR_4 | VAR_3::VAR_5 | VAR_3::VAR_6);\n\t}\n\n}",
  "func_graph_path": null,
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,9 @@\n inline void cForceWorkingDir(const QString &newDir) {\n \tcSetWorkingDir(newDir);\n-\tif (!gWorkingDir.isEmpty()) QDir().mkpath(gWorkingDir);\n+\tif (!gWorkingDir.isEmpty()) {\n+\t\tQDir().mkpath(gWorkingDir);\n+\t\tQFile::setPermissions(gWorkingDir,\n+\t\t\tQFileDevice::ReadUser | QFileDevice::WriteUser | QFileDevice::ExeUser);\n+\t}\n+\n }",
  "diff_line_info": {
    "deleted_lines": [
      "\tif (!gWorkingDir.isEmpty()) QDir().mkpath(gWorkingDir);"
    ],
    "added_lines": [
      "\tif (!gWorkingDir.isEmpty()) {",
      "\t\tQDir().mkpath(gWorkingDir);",
      "\t\tQFile::setPermissions(gWorkingDir,",
      "\t\t\tQFileDevice::ReadUser | QFileDevice::WriteUser | QFileDevice::ExeUser);",
      "\t}",
      ""
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/telegramdesktop/tdesktop/pull/3842",
  "description": {
    "pr_info": {
      "title": "Fix CVE-2016-10351: Insecure cWorkingDir permissions.",
      "number": 3842
    },
    "comment": [
      "Set 700 permisson on dir on every start.\r\n\r\nShould fix #2666 ",
      "Thanks, that indeed should be better.",
      "This pull request has been automatically locked since there has not been any recent activity after it was closed. Please open a new issue for related bugs."
    ]
  },
  "Bug Filter": "Security Vulnerability Fix\n\nConfidence Score: 1.0",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "\n\n**Final Output:**\n\nAnalysis: The patch addresses a security vulnerability by setting directory permissions to 700, preventing unauthorized access. The commit message references a CVE, indicating a security fix.\n\nFinal Classification: Security Vulnerability Fix\n\nConfidence Score: 1.0"
}