{
  "cve_id": "CVE-2023-48795",
  "cwe_ids": [
    "CWE-354"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N",
  "cvss_is_v3": true,
  "repo_name": "janmojzis/tinyssh",
  "commit_msg": "implementation kex-strict-s-v00@openssh.com",
  "commit_hash": "12ec08d24e43e382cb6d9b61facd87685f99eae0",
  "git_url": "https://github.com/janmojzis/tinyssh/commit/12ec08d24e43e382cb6d9b61facd87685f99eae0",
  "file_path": "tinyssh/packet_put.c",
  "func_name": "packet_put",
  "func_before": "void packet_put(struct buf *b) {\n\n    if (packet.flagkeys) {\n        sshcrypto_packet_put(b);\n    }\n    else {\n        packet_put_plain_(b);\n    }\n}",
  "abstract_func_before": "void packet_put(struct buf *VAR_0) {\n\n    if (VAR_1.flagkeys) {\n        sshcrypto_packet_put(VAR_0);\n    }\n    else {\n        packet_put_plain_(VAR_0);\n    }\n}",
  "func_graph_path_before": "janmojzis/tinyssh/12ec08d24e43e382cb6d9b61facd87685f99eae0/packet_put.c/vul/before/0.json",
  "func": "void packet_put(struct buf *b) {\n\n    if (packet.flagkeys) {\n        sshcrypto_packet_put(b);\n    }\n    else {\n        packet_put_plain_(b);\n    }\n\n    /* strict kex - reset sendpacketid */\n    if (b->buf[0] == SSH_MSG_NEWKEYS && sshcrypto_kex_flags & sshcrypto_FLAGSTRICTKEX) {\n        packet.sendpacketid = 0;\n    }\n}",
  "abstract_func": "void packet_put(struct buf *VAR_0) {\n\n    if (VAR_1.flagkeys) {\n        sshcrypto_packet_put(VAR_0);\n    }\n    else {\n        packet_put_plain_(VAR_0);\n    }\n\n    /* COMMENT_0 */\n    if (VAR_0->buf[0] == VAR_2 && VAR_3 & VAR_4) {\n        VAR_1.sendpacketid = 0;\n    }\n}",
  "func_graph_path": "janmojzis/tinyssh/12ec08d24e43e382cb6d9b61facd87685f99eae0/packet_put.c/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -6,4 +6,9 @@\n     else {\n         packet_put_plain_(b);\n     }\n+\n+    /* strict kex - reset sendpacketid */\n+    if (b->buf[0] == SSH_MSG_NEWKEYS && sshcrypto_kex_flags & sshcrypto_FLAGSTRICTKEX) {\n+        packet.sendpacketid = 0;\n+    }\n }",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "",
      "    /* strict kex - reset sendpacketid */",
      "    if (b->buf[0] == SSH_MSG_NEWKEYS && sshcrypto_kex_flags & sshcrypto_FLAGSTRICTKEX) {",
      "        packet.sendpacketid = 0;",
      "    }"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/janmojzis/tinyssh/pull/82",
  "description": {
    "pr_info": {
      "title": "implementation kex-strict-s-v00@openssh.com",
      "number": 82
    },
    "comment": [
      "Add new KEX kex-strict-s-v00@openssh.com protocol.\r\n'Terrapin Attack'  mitigation CVE-2023-48795.\r\nFixes https://github.com/janmojzis/tinyssh/issues/81\r\n"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix\n\nConfidence Score: 1.0",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "\n\n**Final Output:**\n\nAnalysis: The patch implements a new KEX method to mitigate the \"Terrapin Attack\" (CVE-2023-48795), indicating a security vulnerability. The code change resets the sendpacketid during key exchange, addressing a known exploit.\n\nFinal Classification: Security Vulnerability Fix\n\nConfidence Score: 1.0"
}