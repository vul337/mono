{
  "cve_id": "CVE-2020-10028",
  "cwe_ids": [
    "CWE-20"
  ],
  "cvss_vector": "AV:L/AC:L/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "zephyrproject-rtos/zephyr",
  "commit_msg": "drivers: gpio: fix syscall handlers\n\nNo driver object checks were being performed for 3 APIs.\n\nSigned-off-by: Andrew Boie <andrew.p.boie@intel.com>\nSigned-off-by: Flavio Ceolin <flavio.ceolin@intel.com>",
  "commit_hash": "17427ec995be720dc3d31331d534681d29ae9648",
  "git_url": "https://github.com/zephyrproject-rtos/zephyr/commit/17427ec995be720dc3d31331d534681d29ae9648",
  "file_path": "drivers/gpio/gpio_handlers.c",
  "func_name": "z_vrfy_gpio_get_pending_int",
  "func_before": "static inline int z_vrfy_gpio_get_pending_int(struct device *dev)\n{\n\treturn z_impl_gpio_get_pending_int((struct device *)dev);\n}",
  "abstract_func_before": "static inline int z_vrfy_gpio_get_pending_int(struct device *VAR_0)\n{\n\treturn z_impl_gpio_get_pending_int((struct device *)VAR_0);\n}",
  "func_graph_path_before": "zephyrproject-rtos/zephyr/17427ec995be720dc3d31331d534681d29ae9648/gpio_handlers.c/vul/before/1.json",
  "func": "static inline int z_vrfy_gpio_get_pending_int(struct device *dev)\n{\n\tZ_OOPS(Z_SYSCALL_DRIVER_GPIO(dev, get_pending_int));\n\n\treturn z_impl_gpio_get_pending_int((struct device *)dev);\n}",
  "abstract_func": "static inline int z_vrfy_gpio_get_pending_int(struct device *VAR_0)\n{\n\tZ_OOPS(Z_SYSCALL_DRIVER_GPIO(VAR_0, VAR_1));\n\n\treturn z_impl_gpio_get_pending_int((struct device *)VAR_0);\n}",
  "func_graph_path": "zephyrproject-rtos/zephyr/17427ec995be720dc3d31331d534681d29ae9648/gpio_handlers.c/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,6 @@\n static inline int z_vrfy_gpio_get_pending_int(struct device *dev)\n {\n+\tZ_OOPS(Z_SYSCALL_DRIVER_GPIO(dev, get_pending_int));\n+\n \treturn z_impl_gpio_get_pending_int((struct device *)dev);\n }",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "\tZ_OOPS(Z_SYSCALL_DRIVER_GPIO(dev, get_pending_int));",
      ""
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/zephyrproject-rtos/zephyr/pull/23737",
  "description": {
    "pr_info": {
      "title": "Backport v2.1: drivers: gpio: fix syscall handlers",
      "number": 23737
    },
    "comment": [
      "No driver object checks were being performed for 3 APIs.\r\n\r\nSigned-off-by: Andrew Boie <andrew.p.boie@intel.com>\r\nSigned-off-by: Flavio Ceolin <flavio.ceolin@intel.com>"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix\nConfidence Score: 0.95",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "\n\nThe patch addresses a security vulnerability by adding necessary driver object checks, preventing potential unauthorized access to GPIO functions.\n\n**Final Output:**\nAnalysis: The patch adds validation checks to prevent unauthorized access to GPIO drivers, which is a security concern.\nFinal Classification: Security Vulnerability Fix\nConfidence Score: 0.95"
}