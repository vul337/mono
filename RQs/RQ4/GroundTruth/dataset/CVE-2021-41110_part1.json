{
  "cve_id": "CVE-2021-41110",
  "cwe_ids": [
    "CWE-502"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "common-workflow-language/cwlviewer",
  "commit_msg": "Use Yaml SafeConstructor (#355)",
  "commit_hash": "f6066f09edb70033a2ce80200e9fa9e70a5c29de",
  "git_url": "https://github.com/common-workflow-language/cwlviewer/commit/f6066f09edb70033a2ce80200e9fa9e70a5c29de",
  "file_path": "src/main/java/org/commonwl/view/cwl/CWLService.java",
  "func_name": "yamlPathToJson",
  "func_before": "private JsonNode yamlPathToJson(Path path) throws IOException {\n        Yaml reader = new Yaml();\n        ObjectMapper mapper = new ObjectMapper();\n        Path p;\n        \n        try (InputStream in = Files.newInputStream(path)) {\n        \treturn mapper.valueToTree(reader.load(in));\n        }\n    }",
  "abstract_func_before": "private JsonNode yamlPathToJson(Path VAR_0) throws IOException {\n        Yaml VAR_1 = new Yaml();\n        ObjectMapper VAR_2 = new ObjectMapper();\n        Path VAR_3;\n        \n        try (InputStream VAR_4 = VAR_5.newInputStream(VAR_0)) {\n        \treturn VAR_2.valueToTree(VAR_1.load(VAR_4));\n        }\n    }",
  "func_graph_path_before": "common-workflow-language/cwlviewer/f6066f09edb70033a2ce80200e9fa9e70a5c29de/CWLService.java/vul/before/0.json",
  "func": "private JsonNode yamlPathToJson(Path path) throws IOException {\n        Yaml reader = new Yaml(new SafeConstructor());\n        ObjectMapper mapper = new ObjectMapper();\n        try (InputStream in = Files.newInputStream(path)) {\n        \treturn mapper.valueToTree(reader.load(in));\n        }\n    }",
  "abstract_func": "private JsonNode yamlPathToJson(Path VAR_0) throws IOException {\n        Yaml VAR_1 = new Yaml(new SafeConstructor());\n        ObjectMapper VAR_2 = new ObjectMapper();\n        try (InputStream VAR_3 = VAR_4.newInputStream(VAR_0)) {\n        \treturn VAR_2.valueToTree(VAR_1.load(VAR_3));\n        }\n    }",
  "func_graph_path": "common-workflow-language/cwlviewer/f6066f09edb70033a2ce80200e9fa9e70a5c29de/CWLService.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,8 +1,6 @@\n private JsonNode yamlPathToJson(Path path) throws IOException {\n-        Yaml reader = new Yaml();\n+        Yaml reader = new Yaml(new SafeConstructor());\n         ObjectMapper mapper = new ObjectMapper();\n-        Path p;\n-        \n         try (InputStream in = Files.newInputStream(path)) {\n         \treturn mapper.valueToTree(reader.load(in));\n         }",
  "diff_line_info": {
    "deleted_lines": [
      "        Yaml reader = new Yaml();",
      "        Path p;",
      "        "
    ],
    "added_lines": [
      "        Yaml reader = new Yaml(new SafeConstructor());"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/common-workflow-language/cwlviewer/pull/355",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/common-workflow-language/cwlviewer/pull/355: 403 Client Error: Forbidden for url: https://api.github.com/repos/common-workflow-language/cwlviewer/pulls/355",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 1.0"
}