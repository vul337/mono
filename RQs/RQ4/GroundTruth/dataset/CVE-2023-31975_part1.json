{
  "cve_id": "CVE-2023-31975",
  "cwe_ids": [
    "CWE-401"
  ],
  "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L",
  "cvss_is_v3": true,
  "repo_name": "yasm",
  "commit_msg": "fix issue #210",
  "commit_hash": "168febbc155c832439be9500452ebe39994d2309",
  "git_url": "https://github.com/yasm/yasm/commit/168febbc155c832439be9500452ebe39994d2309",
  "file_path": "modules/objfmts/bin/bin-objfmt.c",
  "func_name": "bin_section_data_destroy",
  "func_before": "static void\nbin_section_data_destroy(void *data)\n{\n    bin_section_data *bsd = (bin_section_data *)data;\n    if (bsd->start)\n        yasm_expr_destroy(bsd->start);\n    if (bsd->vstart)\n        yasm_expr_destroy(bsd->vstart);\n    if (bsd->follows)\n        yasm_xfree(bsd->follows);\n    if (bsd->vfollows)\n        yasm_xfree(bsd->vfollows);\n    if (bsd->istart)\n        yasm_intnum_destroy(bsd->istart);\n    if (bsd->ivstart)\n        yasm_intnum_destroy(bsd->ivstart);\n    if (bsd->length)\n        yasm_intnum_destroy(bsd->length);\n    yasm_xfree(data);\n}",
  "abstract_func_before": "static void\nbin_section_data_destroy(void *VAR_0)\n{\n    bin_section_data *VAR_1 = (bin_section_data *)VAR_0;\n    if (VAR_1->start)\n        yasm_expr_destroy(VAR_1->start);\n    if (VAR_1->vstart)\n        yasm_expr_destroy(VAR_1->vstart);\n    if (VAR_1->follows)\n        yasm_xfree(VAR_1->follows);\n    if (VAR_1->vfollows)\n        yasm_xfree(VAR_1->vfollows);\n    if (VAR_1->istart)\n        yasm_intnum_destroy(VAR_1->istart);\n    if (VAR_1->ivstart)\n        yasm_intnum_destroy(VAR_1->ivstart);\n    if (VAR_1->length)\n        yasm_intnum_destroy(VAR_1->length);\n    yasm_xfree(VAR_0);\n}",
  "func_graph_path_before": "yasm/168febbc155c832439be9500452ebe39994d2309/bin-objfmt.c/vul/before/0.json",
  "func": "static void\nbin_section_data_destroy(void *data)\n{\n    bin_section_data *bsd = (bin_section_data *)data;\n    if (bsd->align)\n        yasm_xfree(bsd->align);\n    if (bsd->valign)\n        yasm_xfree(bsd->valign);\n    if (bsd->start)\n        yasm_expr_destroy(bsd->start);\n    if (bsd->vstart)\n        yasm_expr_destroy(bsd->vstart);\n    if (bsd->follows)\n        yasm_xfree(bsd->follows);\n    if (bsd->vfollows)\n        yasm_xfree(bsd->vfollows);\n    if (bsd->istart)\n        yasm_intnum_destroy(bsd->istart);\n    if (bsd->ivstart)\n        yasm_intnum_destroy(bsd->ivstart);\n    if (bsd->length)\n        yasm_intnum_destroy(bsd->length);\n    yasm_xfree(data);\n}",
  "abstract_func": "static void\nbin_section_data_destroy(void *VAR_0)\n{\n    bin_section_data *VAR_1 = (bin_section_data *)VAR_0;\n    if (VAR_1->align)\n        yasm_xfree(VAR_1->align);\n    if (VAR_1->valign)\n        yasm_xfree(VAR_1->valign);\n    if (VAR_1->start)\n        yasm_expr_destroy(VAR_1->start);\n    if (VAR_1->vstart)\n        yasm_expr_destroy(VAR_1->vstart);\n    if (VAR_1->follows)\n        yasm_xfree(VAR_1->follows);\n    if (VAR_1->vfollows)\n        yasm_xfree(VAR_1->vfollows);\n    if (VAR_1->istart)\n        yasm_intnum_destroy(VAR_1->istart);\n    if (VAR_1->ivstart)\n        yasm_intnum_destroy(VAR_1->ivstart);\n    if (VAR_1->length)\n        yasm_intnum_destroy(VAR_1->length);\n    yasm_xfree(VAR_0);\n}",
  "func_graph_path": "yasm/168febbc155c832439be9500452ebe39994d2309/bin-objfmt.c/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -2,6 +2,10 @@\n bin_section_data_destroy(void *data)\n {\n     bin_section_data *bsd = (bin_section_data *)data;\n+    if (bsd->align)\n+        yasm_xfree(bsd->align);\n+    if (bsd->valign)\n+        yasm_xfree(bsd->valign);\n     if (bsd->start)\n         yasm_expr_destroy(bsd->start);\n     if (bsd->vstart)",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "    if (bsd->align)",
      "        yasm_xfree(bsd->align);",
      "    if (bsd->valign)",
      "        yasm_xfree(bsd->valign);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/yasm/yasm/pull/231",
  "description": {
    "pr_info": {
      "title": "fix issue #210",
      "number": 231
    },
    "comment": [
      "This is a fix for memory leak (issue #210).\r\nAdding the fix, valgrind no longer reports the memory leaks in my environment (Ubuntu 20.04.3 LTS).\r\nI would be happy if this PR is reviewed."
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 1.0"
}