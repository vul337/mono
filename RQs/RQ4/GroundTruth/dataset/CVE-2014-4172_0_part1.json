{
  "cve_id": "CVE-2014-4172",
  "cwe_ids": [
    "CWE-74"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "apereo/java-cas-client",
  "commit_msg": "CASC-228 URL Encode Paramaters Passed to Server via Validate\n\nProblem: We currently don't pass encoded values to the server, possibly resolving in parsing/extraction errors.\nSolution: URL Encode all values instead of just the service url.\n\nQA Notes: Added unit test.",
  "commit_hash": "ae37092100c8eaec610dab6d83e5e05a8ee58814",
  "git_url": "https://github.com/apereo/java-cas-client/commit/ae37092100c8eaec610dab6d83e5e05a8ee58814",
  "file_path": "cas-client-core/src/main/java/org/jasig/cas/client/validation/Cas20ServiceTicketValidator.java",
  "func_name": "populateUrlAttributeMap",
  "func_before": "protected final void populateUrlAttributeMap(final Map<String, String> urlParameters) {\n        urlParameters.put(\"pgtUrl\", encodeUrl(this.proxyCallbackUrl));\n    }",
  "abstract_func_before": "protected final void populateUrlAttributeMap(final Map<String, String> VAR_0) {\n        VAR_0.put(\"pgtUrl\", encodeUrl(this.proxyCallbackUrl));\n    }",
  "func_graph_path_before": "apereo/java-cas-client/ae37092100c8eaec610dab6d83e5e05a8ee58814/Cas20ServiceTicketValidator.java/vul/before/0.json",
  "func": "protected final void populateUrlAttributeMap(final Map<String, String> urlParameters) {\n        urlParameters.put(\"pgtUrl\", this.proxyCallbackUrl);\n    }",
  "abstract_func": "protected final void populateUrlAttributeMap(final Map<String, String> VAR_0) {\n        VAR_0.put(\"pgtUrl\", this.proxyCallbackUrl);\n    }",
  "func_graph_path": "apereo/java-cas-client/ae37092100c8eaec610dab6d83e5e05a8ee58814/Cas20ServiceTicketValidator.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,3 +1,3 @@\n protected final void populateUrlAttributeMap(final Map<String, String> urlParameters) {\n-        urlParameters.put(\"pgtUrl\", encodeUrl(this.proxyCallbackUrl));\n+        urlParameters.put(\"pgtUrl\", this.proxyCallbackUrl);\n     }",
  "diff_line_info": {
    "deleted_lines": [
      "        urlParameters.put(\"pgtUrl\", encodeUrl(this.proxyCallbackUrl));"
    ],
    "added_lines": [
      "        urlParameters.put(\"pgtUrl\", this.proxyCallbackUrl);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/apereo/java-cas-client/pull/73",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/apereo/java-cas-client/pull/73: 403 Client Error: Forbidden for url: https://api.github.com/repos/apereo/java-cas-client/pulls/73",
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.7,
  "Bug Filter Response": "**Final Classification:** Defect Remediation & Feature Upgrades; **Confidence:** 0.7"
}