{
  "cve_id": "CVE-2019-13115",
  "cwe_ids": [
    "CWE-190",
    "CWE-125"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:P/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "libssh2",
  "commit_msg": "Updated _libssh2_check_length()\n\nUpdated suggested patch to protect against incorrect usage which could cause a wrap-around value to return success.",
  "commit_hash": "b4289eeb84057d3d5e041af72af000a80b4f40d6",
  "git_url": "https://github.com/libssh2/libssh2/commit/b4289eeb84057d3d5e041af72af000a80b4f40d6",
  "file_path": "src/misc.c",
  "func_name": "_libssh2_check_length",
  "func_before": "int _libssh2_check_length(struct string_buf *buf, size_t len)\n{\n    return (len <= (size_t)((buf->data + buf->len) - buf->dataptr));\n}",
  "abstract_func_before": "int _libssh2_check_length(struct string_buf *VAR_0, size_t VAR_1)\n{\n    return (VAR_1 <= (size_t)((VAR_0->data + VAR_0->len) - VAR_0->dataptr));\n}",
  "func_graph_path_before": "libssh2/b4289eeb84057d3d5e041af72af000a80b4f40d6/misc.c/vul/before/0.json",
  "func": "int _libssh2_check_length(struct string_buf *buf, size_t len)\n{\n    unsigned char *endp = &buf->data[buf->len];\n    size_t left = endp - buf->dataptr;\n    return ((len <= left) && (left <= buf->len));\n}",
  "abstract_func": "int _libssh2_check_length(struct string_buf *VAR_0, size_t VAR_1)\n{\n    unsigned char *VAR_2 = &VAR_0->data[VAR_0->len];\n    size_t VAR_3 = VAR_2 - VAR_0->dataptr;\n    return ((VAR_1 <= VAR_3) && (VAR_3 <= VAR_0->len));\n}",
  "func_graph_path": "libssh2/b4289eeb84057d3d5e041af72af000a80b4f40d6/misc.c/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,6 @@\n int _libssh2_check_length(struct string_buf *buf, size_t len)\n {\n-    return (len <= (size_t)((buf->data + buf->len) - buf->dataptr));\n+    unsigned char *endp = &buf->data[buf->len];\n+    size_t left = endp - buf->dataptr;\n+    return ((len <= left) && (left <= buf->len));\n }",
  "diff_line_info": {
    "deleted_lines": [
      "    return (len <= (size_t)((buf->data + buf->len) - buf->dataptr));"
    ],
    "added_lines": [
      "    unsigned char *endp = &buf->data[buf->len];",
      "    size_t left = endp - buf->dataptr;",
      "    return ((len <= left) && (left <= buf->len));"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/libssh2/libssh2/pull/350",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/libssh2/libssh2/pull/350: 403 Client Error: Forbidden for url: https://api.github.com/repos/libssh2/libssh2/pulls/350",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.95  \n\nThe changes address a buffer check issue, preventing a potential wrap-around scenario, which is likely a security fix to prevent incorrect buffer handling."
}