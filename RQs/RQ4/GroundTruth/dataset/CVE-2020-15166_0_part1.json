{
  "cve_id": "CVE-2020-15166",
  "cwe_ids": [
    "CWE-400"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "zeromq/libzmq",
  "commit_msg": "problem: zeromq connects peer before handshake is completed\n\nSolution: delay connecting the peer pipe until the handshake is completed",
  "commit_hash": "e7f0090b161ce6344f6bd35009816a925c070b09",
  "git_url": "https://github.com/zeromq/libzmq/commit/e7f0090b161ce6344f6bd35009816a925c070b09",
  "file_path": "src/raw_engine.cpp",
  "func_name": "zmq::raw_engine_t::raw_engine_t",
  "func_before": "zmq::raw_engine_t::raw_engine_t (\n  fd_t fd_,\n  const options_t &options_,\n  const endpoint_uri_pair_t &endpoint_uri_pair_) :\n    stream_engine_base_t (fd_, options_, endpoint_uri_pair_)\n{\n}",
  "abstract_func_before": "zmq::raw_engine_t::raw_engine_t (\n  fd_t VAR_0,\n  const options_t &VAR_1,\n  const endpoint_uri_pair_t &VAR_2) :\n    stream_engine_base_t (VAR_0, VAR_1, VAR_2)\n{\n}",
  "func_graph_path_before": "zeromq/libzmq/e7f0090b161ce6344f6bd35009816a925c070b09/raw_engine.cpp/vul/before/0.json",
  "func": "zmq::raw_engine_t::raw_engine_t (\n  fd_t fd_,\n  const options_t &options_,\n  const endpoint_uri_pair_t &endpoint_uri_pair_) :\n    stream_engine_base_t (fd_, options_, endpoint_uri_pair_, false)\n{\n}",
  "abstract_func": "zmq::raw_engine_t::raw_engine_t (\n  fd_t VAR_0,\n  const options_t &VAR_1,\n  const endpoint_uri_pair_t &VAR_2) :\n    stream_engine_base_t (VAR_0, VAR_1, VAR_2, false)\n{\n}",
  "func_graph_path": "zeromq/libzmq/e7f0090b161ce6344f6bd35009816a925c070b09/raw_engine.cpp/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -2,6 +2,6 @@\n   fd_t fd_,\n   const options_t &options_,\n   const endpoint_uri_pair_t &endpoint_uri_pair_) :\n-    stream_engine_base_t (fd_, options_, endpoint_uri_pair_)\n+    stream_engine_base_t (fd_, options_, endpoint_uri_pair_, false)\n {\n }",
  "diff_line_info": {
    "deleted_lines": [
      "    stream_engine_base_t (fd_, options_, endpoint_uri_pair_)"
    ],
    "added_lines": [
      "    stream_engine_base_t (fd_, options_, endpoint_uri_pair_, false)"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/zeromq/libzmq/pull/3913",
  "description": {
    "pr_info": {
      "title": "problem: zeromq connects peer before handshake is complete",
      "number": 3913
    },
    "comment": [
      "Solution: delay connecting the peer pipe until the handshake is complete",
      "@bluca PR is ready ",
      "Thanks!"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 0.95  \nThe commit addresses a security issue by delaying peer connection until the handshake is completed, which is critical for preventing potential exploits. The code change supports this solution effectively, aligning both description and implementation."
}