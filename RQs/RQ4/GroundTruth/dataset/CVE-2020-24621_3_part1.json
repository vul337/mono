{
  "cve_id": "CVE-2020-24621",
  "cwe_ids": [
    "CWE-22"
  ],
  "cvss_vector": "AV:N/AC:L/Au:S/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "openmrs/openmrs-module-uiframework",
  "commit_msg": "UIFR-215: Do not allow loading arbitrary files",
  "commit_hash": "0422fa52c7eba3d96cce2936cb92897dca4b680a",
  "git_url": "https://github.com/openmrs/openmrs-module-uiframework/commit/0422fa52c7eba3d96cce2936cb92897dca4b680a",
  "file_path": "api/src/main/java/org/openmrs/ui/framework/resource/ResourceFactory.java",
  "func_name": "setAdditionalResourceProviders",
  "func_before": "public void setAdditionalResourceProviders(Map<String, ResourceProvider> additional) {\n    \tfor (Map.Entry<String, ResourceProvider> e : additional.entrySet()) {\n\t        addResourceProvider(e.getKey(), e.getValue());\n        }\n    }",
  "abstract_func_before": "public void setAdditionalResourceProviders(Map<String, ResourceProvider> VAR_0) {\n    \tfor (Map.Entry<String, ResourceProvider> VAR_1 : VAR_0.entrySet()) {\n\t        addResourceProvider(VAR_1.getKey(), VAR_1.getValue());\n        }\n    }",
  "func_graph_path_before": "openmrs/openmrs-module-uiframework/0422fa52c7eba3d96cce2936cb92897dca4b680a/ResourceFactory.java/vul/before/2.json",
  "func": "public void setAdditionalResourceProviders(Map<String, ResourceProvider> additional) {\n\t\tfor (Map.Entry<String, ResourceProvider> e : additional.entrySet()) {\n\t\t\taddResourceProvider(e.getKey(), e.getValue());\n\t\t}\n\t}",
  "abstract_func": "public void setAdditionalResourceProviders(Map<String, ResourceProvider> VAR_0) {\n\t\tfor (Map.Entry<String, ResourceProvider> VAR_1 : VAR_0.entrySet()) {\n\t\t\taddResourceProvider(VAR_1.getKey(), VAR_1.getValue());\n\t\t}\n\t}",
  "func_graph_path": "openmrs/openmrs-module-uiframework/0422fa52c7eba3d96cce2936cb92897dca4b680a/ResourceFactory.java/vul/after/2.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,5 @@\n public void setAdditionalResourceProviders(Map<String, ResourceProvider> additional) {\n-    \tfor (Map.Entry<String, ResourceProvider> e : additional.entrySet()) {\n-\t        addResourceProvider(e.getKey(), e.getValue());\n-        }\n-    }\n+\t\tfor (Map.Entry<String, ResourceProvider> e : additional.entrySet()) {\n+\t\t\taddResourceProvider(e.getKey(), e.getValue());\n+\t\t}\n+\t}",
  "diff_line_info": {
    "deleted_lines": [
      "    \tfor (Map.Entry<String, ResourceProvider> e : additional.entrySet()) {",
      "\t        addResourceProvider(e.getKey(), e.getValue());",
      "        }",
      "    }"
    ],
    "added_lines": [
      "\t\tfor (Map.Entry<String, ResourceProvider> e : additional.entrySet()) {",
      "\t\t\taddResourceProvider(e.getKey(), e.getValue());",
      "\t\t}",
      "\t}"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/openmrs/openmrs-module-uiframework/pull/59",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/openmrs/openmrs-module-uiframework/pull/59: 403 Client Error: Forbidden for url: https://api.github.com/repos/openmrs/openmrs-module-uiframework/pulls/59",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.95  \nThe patch addresses a security issue by preventing file loading via absolute paths or path traversal, which is a known security concern.\n\n**Step-by-Step Explanation:**\n\n1. **Input Analysis:** The commit message and vulnerability description indicate a focus on preventing arbitrary file loading, a security concern. The code diff modifies the method, likely adding validation.\n\n2. **Consistency Check:** Commit message aligns with the vulnerability description, suggesting a coherent security fix.\n\n3. **Purpose Evaluation:** Changes likely involve adding security checks to core logic, preventing a known exploit.\n\n4. **Security Assessment:** Preventing path traversal is a security fix, targeting an exploit vector.\n\n5. **Confidence Scoring:** High confidence due to clear security intent in the description, though code details are limited.\n\n**Final Output:** Security Vulnerability Fix; Confidence: 0.95"
}