{
  "cve_id": "CVE-2023-3894",
  "cwe_ids": [
    "CWE-787"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "cvss_is_v3": true,
  "repo_name": "FasterXML/jackson-dataformats-text",
  "commit_msg": "remove toml feature",
  "commit_hash": "a05e4f3485d878153747b82937536e0b4b0f0579",
  "git_url": "https://github.com/FasterXML/jackson-dataformats-text/commit/a05e4f3485d878153747b82937536e0b4b0f0579",
  "file_path": "toml/src/test/java/com/fasterxml/jackson/dataformat/toml/TomlMapperTestBase.java",
  "func_name": "newTomlFactory",
  "func_before": "protected static TomlFactory newTomlFactory() {\n        return TomlFactory.builder()\n                .enable(TomlReadFeature.VALIDATE_NESTING_DEPTH)\n                .build();\n    }",
  "abstract_func_before": "protected static TomlFactory newTomlFactory() {\n        return VAR_0.builder()\n                .enable(VAR_1.VALIDATE_NESTING_DEPTH)\n                .build();\n    }",
  "func_graph_path_before": "FasterXML/jackson-dataformats-text/a05e4f3485d878153747b82937536e0b4b0f0579/TomlMapperTestBase.java/vul/before/0.json",
  "func": "protected static TomlFactory newTomlFactory() {\n        return TomlFactory.builder().build();\n    }",
  "abstract_func": "protected static TomlFactory newTomlFactory() {\n        return VAR_0.builder().build();\n    }",
  "func_graph_path": "FasterXML/jackson-dataformats-text/a05e4f3485d878153747b82937536e0b4b0f0579/TomlMapperTestBase.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,3 @@\n protected static TomlFactory newTomlFactory() {\n-        return TomlFactory.builder()\n-                .enable(TomlReadFeature.VALIDATE_NESTING_DEPTH)\n-                .build();\n+        return TomlFactory.builder().build();\n     }",
  "diff_line_info": {
    "deleted_lines": [
      "        return TomlFactory.builder()",
      "                .enable(TomlReadFeature.VALIDATE_NESTING_DEPTH)",
      "                .build();"
    ],
    "added_lines": [
      "        return TomlFactory.builder().build();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/FasterXML/jackson-dataformats-text/pull/398",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/FasterXML/jackson-dataformats-text/pull/398: 403 Client Error: Forbidden for url: https://api.github.com/repos/FasterXML/jackson-dataformats-text/pulls/398",
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.6,
  "Bug Filter Response": "**Final Classification:** Defect Remediation & Feature Upgrades  \n**Confidence:** 0.6  \n\nThe patch removes a feature in the TOML parser, specifically disabling nesting depth validation. While the vulnerability description implies a potential issue with depth tracking, the commit message doesn't explicitly indicate a security fix. The code change is a feature removal, likely addressing a non-security defect or feature enhancement. The confidence is moderate due to ambiguity in the security context."
}