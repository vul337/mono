{
  "cve_id": "CVE-2023-4043",
  "cwe_ids": [
    "CWE-834"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "cvss_is_v3": true,
  "repo_name": "eclipse-ee4j/parsson",
  "commit_msg": "Exception message moved to messages bundle.\n\nSigned-off-by: Tomáš Kraus <tomas.kraus@oracle.com>",
  "commit_hash": "84764ffbe3d0376da242b27a9a526138d0dfb8e6",
  "git_url": "https://github.com/eclipse-ee4j/parsson/commit/84764ffbe3d0376da242b27a9a526138d0dfb8e6",
  "file_path": "impl/src/main/java/org/eclipse/parsson/JsonNumberImpl.java",
  "func_name": "bigIntegerValueExact",
  "func_before": "@Override\n    public BigInteger bigIntegerValueExact() {\n        BigDecimal bd = bigDecimalValue();\n        if (Math.abs(bd.scale()) <= bigIntegerScaleLimit) {\n            return bd.toBigIntegerExact();\n        }\n        throw new UnsupportedOperationException(\n                String.format(SCALE_LIMIT_EXCEPTION_MESSAGE, bd.scale(), bigIntegerScaleLimit));\n    }",
  "abstract_func_before": "@Override\n    public BigInteger bigIntegerValueExact() {\n        BigDecimal VAR_0 = bigDecimalValue();\n        if (VAR_1.abs(VAR_0.scale()) <= VAR_2) {\n            return VAR_0.toBigIntegerExact();\n        }\n        throw new UnsupportedOperationException(\n                VAR_3.format(VAR_4, VAR_0.scale(), VAR_2));\n    }",
  "func_graph_path_before": "eclipse-ee4j/parsson/84764ffbe3d0376da242b27a9a526138d0dfb8e6/JsonNumberImpl.java/vul/before/0.json",
  "func": "@Override\n    public BigInteger bigIntegerValueExact() {\n        BigDecimal bd = bigDecimalValue();\n        if (Math.abs(bd.scale()) <= bigIntegerScaleLimit) {\n            return bd.toBigIntegerExact();\n        }\n        throw new UnsupportedOperationException(\n                JsonMessages.NUMBER_SCALE_LIMIT_EXCEPTION(bd.scale(), bigIntegerScaleLimit));\n    }",
  "abstract_func": "@Override\n    public BigInteger bigIntegerValueExact() {\n        BigDecimal VAR_0 = bigDecimalValue();\n        if (VAR_1.abs(VAR_0.scale()) <= VAR_2) {\n            return VAR_0.toBigIntegerExact();\n        }\n        throw new UnsupportedOperationException(\n                VAR_3.NUMBER_SCALE_LIMIT_EXCEPTION(VAR_0.scale(), VAR_2));\n    }",
  "func_graph_path": "eclipse-ee4j/parsson/84764ffbe3d0376da242b27a9a526138d0dfb8e6/JsonNumberImpl.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -5,5 +5,5 @@\n             return bd.toBigIntegerExact();\n         }\n         throw new UnsupportedOperationException(\n-                String.format(SCALE_LIMIT_EXCEPTION_MESSAGE, bd.scale(), bigIntegerScaleLimit));\n+                JsonMessages.NUMBER_SCALE_LIMIT_EXCEPTION(bd.scale(), bigIntegerScaleLimit));\n     }",
  "diff_line_info": {
    "deleted_lines": [
      "                String.format(SCALE_LIMIT_EXCEPTION_MESSAGE, bd.scale(), bigIntegerScaleLimit));"
    ],
    "added_lines": [
      "                JsonMessages.NUMBER_SCALE_LIMIT_EXCEPTION(bd.scale(), bigIntegerScaleLimit));"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/eclipse-ee4j/parsson/pull/100",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/eclipse-ee4j/parsson/pull/100: 403 Client Error: Forbidden for url: https://api.github.com/repos/eclipse-ee4j/parsson/pulls/100",
  "Bug Filter": "Supporting & Non-Core Improvements",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Supporting & Non-Core Improvements  \n**Confidence:** 0.95\n\nThe patch moves exception messages to a resource bundle, which is a supportive improvement for localization. The confidence is high as the code change is clear and not related to security fixes."
}