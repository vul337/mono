{
  "cve_id": "CVE-2018-20227",
  "cwe_ids": [
    "CWE-22"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "eclipse-rdf4j/rdf4j",
  "commit_msg": "Verify that zip file entries don't try to escape the parent dir + test\n\nSigned-off-by: Bart Hanssens <bart.hanssens@bosa.fgov.be>",
  "commit_hash": "df15a4d7a8f2789c043b27c9eafe1b30316cfa79",
  "git_url": "https://github.com/eclipse-rdf4j/rdf4j/commit/df15a4d7a8f2789c043b27c9eafe1b30316cfa79",
  "file_path": "util/src/main/java/org/eclipse/rdf4j/common/io/ZipUtil.java",
  "func_name": "isZipStream",
  "func_before": "public static boolean isZipStream(InputStream in)\n\t\tthrows IOException\n\t{\n\t\tin.mark(MAGIC_NUMBER.length);\n\t\tbyte[] fileHeader = IOUtil.readBytes(in, MAGIC_NUMBER.length);\n\t\tin.reset();\n\t\treturn Arrays.equals(MAGIC_NUMBER, fileHeader);\n\t}",
  "abstract_func_before": "public static boolean isZipStream(InputStream VAR_0)\n\t\tthrows IOException\n\t{\n\t\tVAR_0.mark(VAR_1.length);\n\t\tbyte[] VAR_2 = VAR_3.readBytes(VAR_0, VAR_1.length);\n\t\tVAR_0.reset();\n\t\treturn VAR_4.equals(VAR_1, VAR_2);\n\t}",
  "func_graph_path_before": "eclipse-rdf4j/rdf4j/df15a4d7a8f2789c043b27c9eafe1b30316cfa79/ZipUtil.java/vul/before/1.json",
  "func": "public static boolean isZipStream(InputStream in) throws IOException {\n\t\tin.mark(MAGIC_NUMBER.length);\n\t\tbyte[] fileHeader = IOUtil.readBytes(in, MAGIC_NUMBER.length);\n\t\tin.reset();\n\t\treturn Arrays.equals(MAGIC_NUMBER, fileHeader);\n\t}",
  "abstract_func": "public static boolean isZipStream(InputStream VAR_0) throws IOException {\n\t\tVAR_0.mark(VAR_1.length);\n\t\tbyte[] VAR_2 = VAR_3.readBytes(VAR_0, VAR_1.length);\n\t\tVAR_0.reset();\n\t\treturn VAR_4.equals(VAR_1, VAR_2);\n\t}",
  "func_graph_path": "eclipse-rdf4j/rdf4j/df15a4d7a8f2789c043b27c9eafe1b30316cfa79/ZipUtil.java/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,6 +1,4 @@\n-public static boolean isZipStream(InputStream in)\n-\t\tthrows IOException\n-\t{\n+public static boolean isZipStream(InputStream in) throws IOException {\n \t\tin.mark(MAGIC_NUMBER.length);\n \t\tbyte[] fileHeader = IOUtil.readBytes(in, MAGIC_NUMBER.length);\n \t\tin.reset();",
  "diff_line_info": {
    "deleted_lines": [
      "public static boolean isZipStream(InputStream in)",
      "\t\tthrows IOException",
      "\t{"
    ],
    "added_lines": [
      "public static boolean isZipStream(InputStream in) throws IOException {"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/eclipse-rdf4j/rdf4j/pull/1211",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/eclipse-rdf4j/rdf4j/pull/1211: 403 Client Error: Forbidden for url: https://api.github.com/repos/eclipse-rdf4j/rdf4j/pulls/1211",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.7,
  "Bug Filter Response": "The analysis shows that the commit aims to fix a directory traversal vulnerability in zip file handling, which aligns with a security concern. However, the code diff provided doesn't include the actual security-related changes, leading to some uncertainty.\n\n**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.7  \n\nThis score reflects the clear security intent from the commit message and PR description but is reduced due to the lack of visible code changes addressing the vulnerability."
}