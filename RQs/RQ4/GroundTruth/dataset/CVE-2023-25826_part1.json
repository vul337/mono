{
  "cve_id": "CVE-2023-25826",
  "cwe_ids": [
    "CWE-78"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "OpenTSDB/opentsdb",
  "commit_msg": "Improved fix for #2261.\nRegular expressions wouldn't catch the newlines or possibly other\ncontrol characters. Now we'll use the TAG validation code to make\nsure the inputs are only plain ASCII printables first.\nFixes CVE-2018-12972, CVE-2020-35476",
  "commit_hash": "26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25",
  "git_url": "https://github.com/OpenTSDB/opentsdb/commit/26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25",
  "file_path": "test/tsd/TestGraphHandler.java",
  "func_name": "setStyleParams",
  "func_before": "@Test\n  public void setStyleParams() throws Exception {\n    assertPlotParam(\"style\", \"linespoint\");\n    assertPlotParam(\"style\", \"points\");\n    assertPlotParam(\"style\", \"circles\");\n    assertPlotParam(\"style\", \"dots\");\n    assertInvalidPlotParam(\"style\", \"dots%20[33:system(%20\");\n  }",
  "abstract_func_before": "@Test\n  public void setStyleParams() throws Exception {\n    assertPlotParam(\"style\", \"linespoint\");\n    assertPlotParam(\"style\", \"points\");\n    assertPlotParam(\"style\", \"circles\");\n    assertPlotParam(\"style\", \"dots\");\n    assertInvalidPlotParam(\"style\", \"dots%20[33:system(%20\");\n  }",
  "func_graph_path_before": "OpenTSDB/opentsdb/26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25/TestGraphHandler.java/vul/before/0.json",
  "func": "@Test\n  public void setStyleParams() throws Exception {\n    assertPlotParam(\"style\", \"linespoint\");\n    assertPlotParam(\"style\", \"points\");\n    assertPlotParam(\"style\", \"circles\");\n    assertPlotParam(\"style\", \"dots\");\n    assertInvalidPlotParam(\"style\", \"dots%20%0a[33:system(%20\");\n    assertInvalidPlotParam(\"style\", \"%3Bsystem%20%22cat%20/home/ubuntuvm/secret.txt%20%3E/tmp/secret.txt%22%20%22\\\"\");\n  }",
  "abstract_func": "@Test\n  public void setStyleParams() throws Exception {\n    assertPlotParam(\"style\", \"linespoint\");\n    assertPlotParam(\"style\", \"points\");\n    assertPlotParam(\"style\", \"circles\");\n    assertPlotParam(\"style\", \"dots\");\n    assertInvalidPlotParam(\"style\", \"dots%20%0a[33:system(%20\");\n    assertInvalidPlotParam(\"style\", \"%3Bsystem%20%22cat%20/home/ubuntuvm/secret.txt%20%3E/tmp/secret.txt%22%20%22\\\"\");\n  }",
  "func_graph_path": "OpenTSDB/opentsdb/26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25/TestGraphHandler.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -4,5 +4,6 @@\n     assertPlotParam(\"style\", \"points\");\n     assertPlotParam(\"style\", \"circles\");\n     assertPlotParam(\"style\", \"dots\");\n-    assertInvalidPlotParam(\"style\", \"dots%20[33:system(%20\");\n+    assertInvalidPlotParam(\"style\", \"dots%20%0a[33:system(%20\");\n+    assertInvalidPlotParam(\"style\", \"%3Bsystem%20%22cat%20/home/ubuntuvm/secret.txt%20%3E/tmp/secret.txt%22%20%22\\\"\");\n   }",
  "diff_line_info": {
    "deleted_lines": [
      "    assertInvalidPlotParam(\"style\", \"dots%20[33:system(%20\");"
    ],
    "added_lines": [
      "    assertInvalidPlotParam(\"style\", \"dots%20%0a[33:system(%20\");",
      "    assertInvalidPlotParam(\"style\", \"%3Bsystem%20%22cat%20/home/ubuntuvm/secret.txt%20%3E/tmp/secret.txt%22%20%22\\\"\");"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/OpenTSDB/opentsdb/pull/2275",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/OpenTSDB/opentsdb/pull/2275: 403 Client Error: Forbidden for url: https://api.github.com/repos/OpenTSDB/opentsdb/pulls/2275",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 1.0"
}