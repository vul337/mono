{
  "cve_id": "CVE-2019-16754",
  "cwe_ids": [
    "CWE-476"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "RIOT-OS/RIOT",
  "commit_msg": "asymcute: don't make the assumption that req->arg is non-NULL\n\nThis fixes a denial of service where an attacker would be able to cause\na NULL pointer dereference by sending a spoofed packet. This attack only\nrequires knowledge about pending message ids.",
  "commit_hash": "30e4823e946949befe74ef94bc48fe43958c28a6",
  "git_url": "https://github.com/RIOT-OS/RIOT/commit/30e4823e946949befe74ef94bc48fe43958c28a6",
  "file_path": "sys/net/application_layer/asymcute/asymcute.c",
  "func_name": "_on_suback_timeout",
  "func_before": "static unsigned _on_suback_timeout(asymcute_con_t *con, asymcute_req_t *req)\n{\n    (void)con;\n\n    /* reset the subscription context */\n    asymcute_sub_t *sub = (asymcute_sub_t *)req->arg;\n    sub->topic = NULL;\n    return ASYMCUTE_TIMEOUT;\n}",
  "abstract_func_before": "static unsigned _on_suback_timeout(asymcute_con_t *VAR_0, asymcute_req_t *VAR_1)\n{\n    (void)VAR_0;\n\n    /* COMMENT_0 */\n    asymcute_sub_t *VAR_2 = (asymcute_sub_t *)VAR_1->arg;\n    VAR_2->topic = NULL;\n    return VAR_3;\n}",
  "func_graph_path_before": "RIOT-OS/RIOT/30e4823e946949befe74ef94bc48fe43958c28a6/asymcute.c/vul/before/1.json",
  "func": "static unsigned _on_suback_timeout(asymcute_con_t *con, asymcute_req_t *req)\n{\n    (void)con;\n\n    /* reset the subscription context */\n    asymcute_sub_t *sub = (asymcute_sub_t *)req->arg;\n    if (sub == NULL) {\n        return ASYMCUTE_REJECTED;\n    }\n    sub->topic = NULL;\n    return ASYMCUTE_TIMEOUT;\n}",
  "abstract_func": "static unsigned _on_suback_timeout(asymcute_con_t *VAR_0, asymcute_req_t *VAR_1)\n{\n    (void)VAR_0;\n\n    /* COMMENT_0 */\n    asymcute_sub_t *VAR_2 = (asymcute_sub_t *)VAR_1->arg;\n    if (VAR_2 == NULL) {\n        return VAR_3;\n    }\n    VAR_2->topic = NULL;\n    return VAR_4;\n}",
  "func_graph_path": "RIOT-OS/RIOT/30e4823e946949befe74ef94bc48fe43958c28a6/asymcute.c/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -4,6 +4,9 @@\n \n     /* reset the subscription context */\n     asymcute_sub_t *sub = (asymcute_sub_t *)req->arg;\n+    if (sub == NULL) {\n+        return ASYMCUTE_REJECTED;\n+    }\n     sub->topic = NULL;\n     return ASYMCUTE_TIMEOUT;\n }",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "    if (sub == NULL) {",
      "        return ASYMCUTE_REJECTED;",
      "    }"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/RIOT-OS/RIOT/pull/12293",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/RIOT-OS/RIOT/pull/12293: 403 Client Error: Forbidden for url: https://api.github.com/repos/RIOT-OS/RIOT/pulls/12293",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "The patch addresses a security issue by fixing a NULL pointer dereference, preventing a denial of service. The confidence is high as all elements align with a security fix.\n\n**Final Classification:** Security Vulnerability Fix; **Confidence:** 0.95"
}