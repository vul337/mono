{
  "cve_id": "CVE-2022-41882",
  "cwe_ids": [
    "CWE-94"
  ],
  "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "nextcloud/desktop",
  "commit_msg": "makes JsonApiJob share common code with SimpleApiJob\n\nSigned-off-by: Matthieu Gallien <matthieu.gallien@nextcloud.com>",
  "commit_hash": "615c02e3d3ee5daa62f8780e43d28bb631b55df8",
  "git_url": "https://github.com/nextcloud/desktop/commit/615c02e3d3ee5daa62f8780e43d28bb631b55df8",
  "file_path": "src/libsync/networkjobs.cpp",
  "func_name": "JsonApiJob::setBody",
  "func_before": "void JsonApiJob::setBody(const QJsonDocument &body)\n{\n    _body = body.toJson();\n    qCDebug(lcJsonApiJob) << \"Set body for request:\" << _body;\n    if (!_body.isEmpty()) {\n        _request.setHeader(QNetworkRequest::ContentTypeHeader, \"application/json\");\n    }\n}",
  "abstract_func_before": "void JsonApiJob::setBody(const QJsonDocument &VAR_0)\n{\n    VAR_1 = VAR_0.toJson();\n    qCDebug(VAR_2) << \"Set body for request:\" << VAR_1;\n    if (!VAR_1.isEmpty()) {\n        VAR_3.setHeader(QNetworkRequest::ContentTypeHeader, \"application/json\");\n    }\n}",
  "func_graph_path_before": "nextcloud/desktop/615c02e3d3ee5daa62f8780e43d28bb631b55df8/networkjobs.cpp/vul/before/0.json",
  "func": "void JsonApiJob::setBody(const QJsonDocument &body)\n{\n    SimpleApiJob::setBody(body.toJson());\n    qCDebug(lcJsonApiJob) << \"Set body for request:\" << SimpleApiJob::body();\n    if (!SimpleApiJob::body().isEmpty()) {\n        request().setHeader(QNetworkRequest::ContentTypeHeader, \"application/json\");\n    }\n}",
  "abstract_func": "void JsonApiJob::setBody(const QJsonDocument &VAR_0)\n{\n    SimpleApiJob::setBody(VAR_0.toJson());\n    qCDebug(VAR_1) << \"Set body for request:\" << SimpleApiJob::body();\n    if (!SimpleApiJob::body().isEmpty()) {\n        request().setHeader(QNetworkRequest::ContentTypeHeader, \"application/json\");\n    }\n}",
  "func_graph_path": "nextcloud/desktop/615c02e3d3ee5daa62f8780e43d28bb631b55df8/networkjobs.cpp/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,8 +1,8 @@\n void JsonApiJob::setBody(const QJsonDocument &body)\n {\n-    _body = body.toJson();\n-    qCDebug(lcJsonApiJob) << \"Set body for request:\" << _body;\n-    if (!_body.isEmpty()) {\n-        _request.setHeader(QNetworkRequest::ContentTypeHeader, \"application/json\");\n+    SimpleApiJob::setBody(body.toJson());\n+    qCDebug(lcJsonApiJob) << \"Set body for request:\" << SimpleApiJob::body();\n+    if (!SimpleApiJob::body().isEmpty()) {\n+        request().setHeader(QNetworkRequest::ContentTypeHeader, \"application/json\");\n     }\n }",
  "diff_line_info": {
    "deleted_lines": [
      "    _body = body.toJson();",
      "    qCDebug(lcJsonApiJob) << \"Set body for request:\" << _body;",
      "    if (!_body.isEmpty()) {",
      "        _request.setHeader(QNetworkRequest::ContentTypeHeader, \"application/json\");"
    ],
    "added_lines": [
      "    SimpleApiJob::setBody(body.toJson());",
      "    qCDebug(lcJsonApiJob) << \"Set body for request:\" << SimpleApiJob::body();",
      "    if (!SimpleApiJob::body().isEmpty()) {",
      "        request().setHeader(QNetworkRequest::ContentTypeHeader, \"application/json\");"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/nextcloud/desktop/pull/5039",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/nextcloud/desktop/pull/5039: 403 Client Error: Forbidden for url: https://api.github.com/repos/nextcloud/desktop/pulls/5039",
  "Bug Filter": "Supporting & Non-Core Improvements",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Supporting & Non-Core Improvements;  \n**Confidence:** 0.9"
}