{
  "cve_id": "CVE-2022-24886",
  "cwe_ids": [
    "CWE-732"
  ],
  "cvss_vector": "AV:L/AC:L/Au:N/C:P/I:N/A:N",
  "cvss_is_v3": false,
  "repo_name": "nextcloud/android",
  "commit_msg": "Make PendingIntents immutable\n\nGood practice for security\n\nSigned-off-by: √Ålvaro Brey Vilas <alvaro.brey@nextcloud.com>",
  "commit_hash": "27559efb79d45782e000b762860658d49e9c35e9",
  "git_url": "https://github.com/nextcloud/android/commit/27559efb79d45782e000b762860658d49e9c35e9",
  "file_path": "src/main/java/com/owncloud/android/files/services/FileDownloader.java",
  "func_name": "configureUpdateCredentialsNotification",
  "func_before": "private void configureUpdateCredentialsNotification(Account account) {\n        // let the user update credentials with one click\n        Intent updateAccountCredentials = new Intent(this, AuthenticatorActivity.class);\n        updateAccountCredentials.putExtra(AuthenticatorActivity.EXTRA_ACCOUNT, account);\n        updateAccountCredentials.putExtra(\n                AuthenticatorActivity.EXTRA_ACTION,\n                AuthenticatorActivity.ACTION_UPDATE_EXPIRED_TOKEN\n        );\n        updateAccountCredentials.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n        updateAccountCredentials.addFlags(Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);\n        updateAccountCredentials.addFlags(Intent.FLAG_FROM_BACKGROUND);\n        mNotificationBuilder.setContentIntent(PendingIntent.getActivity(this, (int) System.currentTimeMillis(),\n                updateAccountCredentials, PendingIntent.FLAG_ONE_SHOT));\n    }",
  "abstract_func_before": "private void configureUpdateCredentialsNotification(Account VAR_0) {\n        /* COMMENT_0 */\n        Intent VAR_1 = new Intent(this, AuthenticatorActivity.class);\n        VAR_1.putExtra(VAR_2.EXTRA_ACCOUNT, VAR_0);\n        VAR_1.putExtra(\n                VAR_2.EXTRA_ACTION,\n                VAR_2.ACTION_UPDATE_EXPIRED_TOKEN\n        );\n        VAR_1.addFlags(VAR_3.FLAG_ACTIVITY_NEW_TASK);\n        VAR_1.addFlags(VAR_3.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);\n        VAR_1.addFlags(VAR_3.FLAG_FROM_BACKGROUND);\n        VAR_4.setContentIntent(VAR_5.getActivity(this, (int) VAR_6.currentTimeMillis(),\n                VAR_1, VAR_5.FLAG_ONE_SHOT));\n    }",
  "func_graph_path_before": "nextcloud/android/27559efb79d45782e000b762860658d49e9c35e9/FileDownloader.java/vul/before/2.json",
  "func": "private void configureUpdateCredentialsNotification(Account account) {\n        // let the user update credentials with one click\n        Intent updateAccountCredentials = new Intent(this, AuthenticatorActivity.class);\n        updateAccountCredentials.putExtra(AuthenticatorActivity.EXTRA_ACCOUNT, account);\n        updateAccountCredentials.putExtra(\n                AuthenticatorActivity.EXTRA_ACTION,\n                AuthenticatorActivity.ACTION_UPDATE_EXPIRED_TOKEN\n        );\n        updateAccountCredentials.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n        updateAccountCredentials.addFlags(Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);\n        updateAccountCredentials.addFlags(Intent.FLAG_FROM_BACKGROUND);\n        mNotificationBuilder.setContentIntent(\n            PendingIntent.getActivity(this,\n                                      (int) System.currentTimeMillis(),\n                                      updateAccountCredentials,\n                                      PendingIntent.FLAG_ONE_SHOT | PendingIntent.FLAG_IMMUTABLE)\n                                             );\n    }",
  "abstract_func": "private void configureUpdateCredentialsNotification(Account VAR_0) {\n        /* COMMENT_0 */\n        Intent VAR_1 = new Intent(this, AuthenticatorActivity.class);\n        VAR_1.putExtra(VAR_2.EXTRA_ACCOUNT, VAR_0);\n        VAR_1.putExtra(\n                VAR_2.EXTRA_ACTION,\n                VAR_2.ACTION_UPDATE_EXPIRED_TOKEN\n        );\n        VAR_1.addFlags(VAR_3.FLAG_ACTIVITY_NEW_TASK);\n        VAR_1.addFlags(VAR_3.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);\n        VAR_1.addFlags(VAR_3.FLAG_FROM_BACKGROUND);\n        VAR_4.setContentIntent(\n            VAR_5.getActivity(this,\n                                      (int) VAR_6.currentTimeMillis(),\n                                      VAR_1,\n                                      VAR_5.FLAG_ONE_SHOT | VAR_5.FLAG_IMMUTABLE)\n                                             );\n    }",
  "func_graph_path": "nextcloud/android/27559efb79d45782e000b762860658d49e9c35e9/FileDownloader.java/vul/after/2.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -9,6 +9,10 @@\n         updateAccountCredentials.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n         updateAccountCredentials.addFlags(Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);\n         updateAccountCredentials.addFlags(Intent.FLAG_FROM_BACKGROUND);\n-        mNotificationBuilder.setContentIntent(PendingIntent.getActivity(this, (int) System.currentTimeMillis(),\n-                updateAccountCredentials, PendingIntent.FLAG_ONE_SHOT));\n+        mNotificationBuilder.setContentIntent(\n+            PendingIntent.getActivity(this,\n+                                      (int) System.currentTimeMillis(),\n+                                      updateAccountCredentials,\n+                                      PendingIntent.FLAG_ONE_SHOT | PendingIntent.FLAG_IMMUTABLE)\n+                                             );\n     }",
  "diff_line_info": {
    "deleted_lines": [
      "        mNotificationBuilder.setContentIntent(PendingIntent.getActivity(this, (int) System.currentTimeMillis(),",
      "                updateAccountCredentials, PendingIntent.FLAG_ONE_SHOT));"
    ],
    "added_lines": [
      "        mNotificationBuilder.setContentIntent(",
      "            PendingIntent.getActivity(this,",
      "                                      (int) System.currentTimeMillis(),",
      "                                      updateAccountCredentials,",
      "                                      PendingIntent.FLAG_ONE_SHOT | PendingIntent.FLAG_IMMUTABLE)",
      "                                             );"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/nextcloud/android/pull/9726",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/nextcloud/android/pull/9726: 403 Client Error: Forbidden for url: https://api.github.com/repos/nextcloud/android/pulls/9726",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.95"
}