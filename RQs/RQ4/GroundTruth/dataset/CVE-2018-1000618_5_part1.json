{
  "cve_id": "CVE-2018-1000618",
  "cwe_ids": [
    "CWE-674"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "EOSIO/eos",
  "commit_msg": "Add limit to recursion",
  "commit_hash": "cf7209e703e6d3f7a5413e0cb1fe88a4d8e4b38d",
  "git_url": "https://github.com/EOSIO/eos/commit/cf7209e703e6d3f7a5413e0cb1fe88a4d8e4b38d",
  "file_path": "libraries/chain/include/eosio/chain/abi_serializer.hpp",
  "func_name": "abi_to_variant_visitor",
  "func_before": "abi_to_variant_visitor( mutable_variant_object& _mvo, const T& _val, Resolver _resolver )\n         :_vo(_mvo)\n         ,_val(_val)\n         ,_resolver(_resolver)\n         {}",
  "abstract_func_before": "abi_to_variant_visitor( mutable_variant_object& VAR_0, const T& VAR_1, Resolver VAR_2 )\n         :_vo(VAR_0)\n         ,_val(VAR_1)\n         ,_resolver(VAR_2)\n         {}",
  "func_graph_path_before": null,
  "func": "abi_to_variant_visitor( mutable_variant_object& _mvo, const T& _val, Resolver _resolver, size_t _recursion_depth )\n         :_vo(_mvo)\n         ,_val(_val)\n         ,_resolver(_resolver)\n         ,_recursion_depth(_recursion_depth)\n         {}",
  "abstract_func": "abi_to_variant_visitor( mutable_variant_object& VAR_0, const T& VAR_1, Resolver VAR_2, size_t VAR_3 )\n         :_vo(VAR_0)\n         ,_val(VAR_1)\n         ,_resolver(VAR_2)\n         ,_recursion_depth(VAR_3)\n         {}",
  "func_graph_path": null,
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,6 @@\n-abi_to_variant_visitor( mutable_variant_object& _mvo, const T& _val, Resolver _resolver )\n+abi_to_variant_visitor( mutable_variant_object& _mvo, const T& _val, Resolver _resolver, size_t _recursion_depth )\n          :_vo(_mvo)\n          ,_val(_val)\n          ,_resolver(_resolver)\n+         ,_recursion_depth(_recursion_depth)\n          {}",
  "diff_line_info": {
    "deleted_lines": [
      "abi_to_variant_visitor( mutable_variant_object& _mvo, const T& _val, Resolver _resolver )"
    ],
    "added_lines": [
      "abi_to_variant_visitor( mutable_variant_object& _mvo, const T& _val, Resolver _resolver, size_t _recursion_depth )",
      "         ,_recursion_depth(_recursion_depth)"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/EOSIO/eos/pull/4112",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/EOSIO/eos/pull/4112: 403 Client Error: Forbidden for url: https://api.github.com/repos/EOSIO/eos/pulls/4112",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.95  \n\n**Step-by-Step Explanation:**\n\n1. **Input Analysis:** The commit message indicates adding a recursion limit, suggesting a potential DoS fix. The vulnerability description discusses handling invalid ABIs gracefully, which could prevent crashes or resource exhaustion when attacked. The code adds a recursion depth parameter, directly addressing this.\n\n2. **Consistency Check:** The code change aligns with the commit message, adding recursion depth tracking. The vulnerability arises from incorrect handling of invalid ABIs, which the fix addresses.\n\n3. **Purpose Evaluation:** The function modification is crucial for preventing excessive recursion, a common security issue.\n\n4. **Security Assessment:** While the description doesnâ€™t use security terms, the fix targets a condition that could be exploited, making it a security patch.\n\n5. **Confidence Scoring:** High confidence (0.95) due to code changes aligning with a potential security issue, though explicit security terms are missing.\n\n**Final Output:**  \n**Final Classification:** Security Vulnerability Fix; **Confidence:** 0.95"
}