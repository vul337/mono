{
  "cve_id": "CVE-2022-26530",
  "cwe_ids": [
    "CWE-Other"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "swaywm/swaylock",
  "commit_msg": "Add support for ext-session-lock-v1\n\nThis is a new protocol to lock the session [1]. It should be more\nreliable than layer-shell + input-inhibitor.\n\n[1]: https://gitlab.freedesktop.org/wayland/wayland-protocols/-/merge_requests/131",
  "commit_hash": "1d1c75b6316d21933069a9d201f966d84099f6ca",
  "git_url": "https://github.com/swaywm/swaylock/commit/1d1c75b6316d21933069a9d201f966d84099f6ca",
  "file_path": "main.c",
  "func_name": "destroy_surface",
  "func_before": "static void destroy_surface(struct swaylock_surface *surface) {\n\twl_list_remove(&surface->link);\n\tif (surface->layer_surface != NULL) {\n\t\tzwlr_layer_surface_v1_destroy(surface->layer_surface);\n\t}\n\tif (surface->surface != NULL) {\n\t\twl_surface_destroy(surface->surface);\n\t}\n\tdestroy_buffer(&surface->buffers[0]);\n\tdestroy_buffer(&surface->buffers[1]);\n\tdestroy_buffer(&surface->indicator_buffers[0]);\n\tdestroy_buffer(&surface->indicator_buffers[1]);\n\twl_output_destroy(surface->output);\n\tfree(surface);\n}",
  "abstract_func_before": "static void destroy_surface(struct swaylock_surface *VAR_0) {\n\twl_list_remove(&VAR_0->link);\n\tif (VAR_0->layer_surface != NULL) {\n\t\tzwlr_layer_surface_v1_destroy(VAR_0->layer_surface);\n\t}\n\tif (VAR_0->surface != NULL) {\n\t\twl_surface_destroy(VAR_0->surface);\n\t}\n\tdestroy_buffer(&VAR_0->buffers[0]);\n\tdestroy_buffer(&VAR_0->buffers[1]);\n\tdestroy_buffer(&VAR_0->indicator_buffers[0]);\n\tdestroy_buffer(&VAR_0->indicator_buffers[1]);\n\twl_output_destroy(VAR_0->output);\n\tfree(VAR_0);\n}",
  "func_graph_path_before": "swaywm/swaylock/1d1c75b6316d21933069a9d201f966d84099f6ca/main.c/vul/before/2.json",
  "func": "static void destroy_surface(struct swaylock_surface *surface) {\n\twl_list_remove(&surface->link);\n\tif (surface->layer_surface != NULL) {\n\t\tzwlr_layer_surface_v1_destroy(surface->layer_surface);\n\t}\n\tif (surface->ext_session_lock_surface_v1 != NULL) {\n\t\text_session_lock_surface_v1_destroy(surface->ext_session_lock_surface_v1);\n\t}\n\tif (surface->surface != NULL) {\n\t\twl_surface_destroy(surface->surface);\n\t}\n\tdestroy_buffer(&surface->buffers[0]);\n\tdestroy_buffer(&surface->buffers[1]);\n\tdestroy_buffer(&surface->indicator_buffers[0]);\n\tdestroy_buffer(&surface->indicator_buffers[1]);\n\twl_output_destroy(surface->output);\n\tfree(surface);\n}",
  "abstract_func": "static void destroy_surface(struct swaylock_surface *VAR_0) {\n\twl_list_remove(&VAR_0->link);\n\tif (VAR_0->layer_surface != NULL) {\n\t\tzwlr_layer_surface_v1_destroy(VAR_0->layer_surface);\n\t}\n\tif (VAR_0->ext_session_lock_surface_v1 != NULL) {\n\t\text_session_lock_surface_v1_destroy(VAR_0->ext_session_lock_surface_v1);\n\t}\n\tif (VAR_0->surface != NULL) {\n\t\twl_surface_destroy(VAR_0->surface);\n\t}\n\tdestroy_buffer(&VAR_0->buffers[0]);\n\tdestroy_buffer(&VAR_0->buffers[1]);\n\tdestroy_buffer(&VAR_0->indicator_buffers[0]);\n\tdestroy_buffer(&VAR_0->indicator_buffers[1]);\n\twl_output_destroy(VAR_0->output);\n\tfree(VAR_0);\n}",
  "func_graph_path": "swaywm/swaylock/1d1c75b6316d21933069a9d201f966d84099f6ca/main.c/vul/after/2.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -2,6 +2,9 @@\n \twl_list_remove(&surface->link);\n \tif (surface->layer_surface != NULL) {\n \t\tzwlr_layer_surface_v1_destroy(surface->layer_surface);\n+\t}\n+\tif (surface->ext_session_lock_surface_v1 != NULL) {\n+\t\text_session_lock_surface_v1_destroy(surface->ext_session_lock_surface_v1);\n \t}\n \tif (surface->surface != NULL) {\n \t\twl_surface_destroy(surface->surface);",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "\t}",
      "\tif (surface->ext_session_lock_surface_v1 != NULL) {",
      "\t\text_session_lock_surface_v1_destroy(surface->ext_session_lock_surface_v1);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/swaywm/swaylock/pull/219",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/swaywm/swaylock/pull/219: 403 Client Error: Forbidden for url: https://api.github.com/repos/swaywm/swaylock/pulls/219",
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Defect Remediation & Feature Upgrades; **Confidence:** 0.95"
}