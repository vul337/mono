{
  "cve_id": "CVE-2019-15534",
  "cwe_ids": [
    "CWE-89"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "folio-org/raml-module-builder",
  "commit_msg": "RMB-200: Single quote SQL Injection in PostgresClient.update(table, updateSection, ...)",
  "commit_hash": "b7ef741133e57add40aa4cb19430a0065f378a94",
  "git_url": "https://github.com/folio-org/raml-module-builder/commit/b7ef741133e57add40aa4cb19430a0065f378a94",
  "file_path": "domain-models-runtime/src/test/java/org/folio/rest/persist/PostgresClientIT.java",
  "func_name": "deleteByCriterionSingleQuote",
  "func_before": "@Ignore(\"fails - SQL injection!\")\n  @Test\n  public void deleteByCriterionSingleQuote(TestContext context) throws FieldException {\n    deleteByCriterion(context, \"'\");  // SQL injection?\n  }",
  "abstract_func_before": "@Ignore(\"fails - SQL injection!\")\n  @Test\n  public void deleteByCriterionSingleQuote(TestContext VAR_0) throws FieldException {\n    deleteByCriterion(VAR_0, \"'\");  /* COMMENT_0 */\n  }",
  "func_graph_path_before": "folio-org/raml-module-builder/b7ef741133e57add40aa4cb19430a0065f378a94/PostgresClientIT.java/vul/before/1.json",
  "func": "@Test\n  public void deleteByCriterionSingleQuote(TestContext context) throws FieldException {\n    deleteByCriterion(context, \"'\");  // SQL injection?\n  }",
  "abstract_func": "@Test\n  public void deleteByCriterionSingleQuote(TestContext VAR_0) throws FieldException {\n    deleteByCriterion(VAR_0, \"'\");  /* COMMENT_0 */\n  }",
  "func_graph_path": "folio-org/raml-module-builder/b7ef741133e57add40aa4cb19430a0065f378a94/PostgresClientIT.java/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,4 @@\n-@Ignore(\"fails - SQL injection!\")\n-  @Test\n+@Test\n   public void deleteByCriterionSingleQuote(TestContext context) throws FieldException {\n     deleteByCriterion(context, \"'\");  // SQL injection?\n   }",
  "diff_line_info": {
    "deleted_lines": [
      "@Ignore(\"fails - SQL injection!\")",
      "  @Test"
    ],
    "added_lines": [
      "@Test"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/folio-org/raml-module-builder/pull/501",
  "description": {
    "pr_info": {
      "title": "RMB-200: Single quote SQL Injection in PostgresClient.update with updateSection",
      "number": 501
    },
    "comment": [
      "CVE-2019-15534 has been assigned to this vulnerability: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15534\r\n\r\nLink to our issue tracker: https://issues.folio.org/browse/RMB-200\r\n\r\nAffected versions: All below 27.0.0.",
      "Everything seems fine with this change."
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.95  \nThe patch addresses a recognized SQL injection vulnerability (CVE-2019-15534) by fixing the underlying issue and enabling the previously failing test. All elements consistently indicate a security fix.  \n\n**Step-by-Step Explanation:**\n1. The commit message references a SQL injection vulnerability, a clear security issue.\n2. The vulnerability description includes a CVE ID, confirming it's a known security issue.\n3. The code diff shows re-enabling a test that previously failed due to the vulnerability, suggesting the fix was implemented elsewhere but validated here.\n4. The presence of the CVE and explicit mention of SQL injection confirms it's a security patch.\n5. High confidence due to clear and consistent indicators of a security fix."
}