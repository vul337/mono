{
  "cve_id": "CVE-2023-25826",
  "cwe_ids": [
    "CWE-78"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "OpenTSDB/opentsdb",
  "commit_msg": "Improved fix for #2261.\nRegular expressions wouldn't catch the newlines or possibly other\ncontrol characters. Now we'll use the TAG validation code to make\nsure the inputs are only plain ASCII printables first.\nFixes CVE-2018-12972, CVE-2020-35476",
  "commit_hash": "26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25",
  "git_url": "https://github.com/OpenTSDB/opentsdb/commit/26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25",
  "file_path": "test/tsd/TestGraphHandler.java",
  "func_name": "setYRangeParams",
  "func_before": "@Test  \n  public void setYRangeParams() throws Exception {\n    assertPlotParam(\"yrange\",\"[0:1]\");\n    assertPlotParam(\"yrange\", \"[:]\");\n    assertPlotParam(\"yrange\", \"[:0]\");\n    assertPlotParam(\"yrange\", \"[:42]\");\n    assertPlotParam(\"yrange\", \"[:-42]\");\n    assertPlotParam(\"yrange\", \"[:0.8]\");\n    assertPlotParam(\"yrange\", \"[:-0.8]\");\n    assertPlotParam(\"yrange\", \"[:42.4]\");\n    assertPlotParam(\"yrange\", \"[:-42.4]\");\n    assertPlotParam(\"yrange\", \"[:4e4]\");\n    assertPlotParam(\"yrange\", \"[:-4e4]\");\n    assertPlotParam(\"yrange\", \"[:4e-4]\");\n    assertPlotParam(\"yrange\", \"[:-4e-4]\");\n    assertPlotParam(\"yrange\", \"[:4.2e4]\");\n    assertPlotParam(\"yrange\", \"[:-4.2e4]\");\n    assertPlotParam(\"yrange\", \"[0:]\");\n    assertPlotParam(\"yrange\", \"[5:]\");\n    assertPlotParam(\"yrange\", \"[-5:]\");\n    assertPlotParam(\"yrange\", \"[0.5:]\");\n    assertPlotParam(\"yrange\", \"[-0.5:]\");\n    assertPlotParam(\"yrange\", \"[10.5:]\");\n    assertPlotParam(\"yrange\", \"[-10.5:]\");\n    assertPlotParam(\"yrange\", \"[10e5:]\");\n    assertPlotParam(\"yrange\", \"[-10e5:]\");\n    assertPlotParam(\"yrange\", \"[10e-5:]\");\n    assertPlotParam(\"yrange\", \"[-10e-5:]\");\n    assertPlotParam(\"yrange\", \"[10.1e-5:]\");\n    assertPlotParam(\"yrange\", \"[-10.1e-5:]\");\n    assertPlotParam(\"yrange\", \"[-10.1e-5:-10.1e-6]\");\n    assertInvalidPlotParam(\"yrange\", \"[33:system('touch /tmp/poc.txt')]\");\n  }",
  "abstract_func_before": "@Test  \n  public void setYRangeParams() throws Exception {\n    assertPlotParam(\"yrange\",\"[0:1]\");\n    assertPlotParam(\"yrange\", \"[:]\");\n    assertPlotParam(\"yrange\", \"[:0]\");\n    assertPlotParam(\"yrange\", \"[:42]\");\n    assertPlotParam(\"yrange\", \"[:-42]\");\n    assertPlotParam(\"yrange\", \"[:0.8]\");\n    assertPlotParam(\"yrange\", \"[:-0.8]\");\n    assertPlotParam(\"yrange\", \"[:42.4]\");\n    assertPlotParam(\"yrange\", \"[:-42.4]\");\n    assertPlotParam(\"yrange\", \"[:4e4]\");\n    assertPlotParam(\"yrange\", \"[:-4e4]\");\n    assertPlotParam(\"yrange\", \"[:4e-4]\");\n    assertPlotParam(\"yrange\", \"[:-4e-4]\");\n    assertPlotParam(\"yrange\", \"[:4.2e4]\");\n    assertPlotParam(\"yrange\", \"[:-4.2e4]\");\n    assertPlotParam(\"yrange\", \"[0:]\");\n    assertPlotParam(\"yrange\", \"[5:]\");\n    assertPlotParam(\"yrange\", \"[-5:]\");\n    assertPlotParam(\"yrange\", \"[0.5:]\");\n    assertPlotParam(\"yrange\", \"[-0.5:]\");\n    assertPlotParam(\"yrange\", \"[10.5:]\");\n    assertPlotParam(\"yrange\", \"[-10.5:]\");\n    assertPlotParam(\"yrange\", \"[10e5:]\");\n    assertPlotParam(\"yrange\", \"[-10e5:]\");\n    assertPlotParam(\"yrange\", \"[10e-5:]\");\n    assertPlotParam(\"yrange\", \"[-10e-5:]\");\n    assertPlotParam(\"yrange\", \"[10.1e-5:]\");\n    assertPlotParam(\"yrange\", \"[-10.1e-5:]\");\n    assertPlotParam(\"yrange\", \"[-10.1e-5:-10.1e-6]\");\n    assertInvalidPlotParam(\"yrange\", \"[33:system('touch /tmp/poc.txt')]\");\n  }",
  "func_graph_path_before": "OpenTSDB/opentsdb/26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25/TestGraphHandler.java/vul/before/1.json",
  "func": "@Test  \n  public void setYRangeParams() throws Exception {\n    assertPlotParam(\"yrange\",\"[0:1]\");\n    assertPlotParam(\"yrange\", \"[:]\");\n    assertPlotParam(\"yrange\", \"[:0]\");\n    assertPlotParam(\"yrange\", \"[:42]\");\n    assertPlotParam(\"yrange\", \"[:-42]\");\n    assertPlotParam(\"yrange\", \"[:0.8]\");\n    assertPlotParam(\"yrange\", \"[:-0.8]\");\n    assertPlotParam(\"yrange\", \"[:42.4]\");\n    assertPlotParam(\"yrange\", \"[:-42.4]\");\n    assertPlotParam(\"yrange\", \"[:4e4]\");\n    assertPlotParam(\"yrange\", \"[:-4e4]\");\n    assertPlotParam(\"yrange\", \"[:4e-4]\");\n    assertPlotParam(\"yrange\", \"[:-4e-4]\");\n    assertPlotParam(\"yrange\", \"[:4.2e4]\");\n    assertPlotParam(\"yrange\", \"[:-4.2e4]\");\n    assertPlotParam(\"yrange\", \"[0:]\");\n    assertPlotParam(\"yrange\", \"[5:]\");\n    assertPlotParam(\"yrange\", \"[-5:]\");\n    assertPlotParam(\"yrange\", \"[0.5:]\");\n    assertPlotParam(\"yrange\", \"[-0.5:]\");\n    assertPlotParam(\"yrange\", \"[10.5:]\");\n    assertPlotParam(\"yrange\", \"[-10.5:]\");\n    assertPlotParam(\"yrange\", \"[10e5:]\");\n    assertPlotParam(\"yrange\", \"[-10e5:]\");\n    assertPlotParam(\"yrange\", \"[10e-5:]\");\n    assertPlotParam(\"yrange\", \"[-10e-5:]\");\n    assertPlotParam(\"yrange\", \"[10.1e-5:]\");\n    assertPlotParam(\"yrange\", \"[-10.1e-5:]\");\n    assertPlotParam(\"yrange\", \"[-10.1e-5:-10.1e-6]\");\n    assertInvalidPlotParam(\"yrange\", \"[33:system('touch /tmp/poc.txt')]\");\n    assertInvalidPlotParam(\"y2range\", \"[42:%0a[33:system('touch /tmp/poc.txt')]\");\n  }",
  "abstract_func": "@Test  \n  public void setYRangeParams() throws Exception {\n    assertPlotParam(\"yrange\",\"[0:1]\");\n    assertPlotParam(\"yrange\", \"[:]\");\n    assertPlotParam(\"yrange\", \"[:0]\");\n    assertPlotParam(\"yrange\", \"[:42]\");\n    assertPlotParam(\"yrange\", \"[:-42]\");\n    assertPlotParam(\"yrange\", \"[:0.8]\");\n    assertPlotParam(\"yrange\", \"[:-0.8]\");\n    assertPlotParam(\"yrange\", \"[:42.4]\");\n    assertPlotParam(\"yrange\", \"[:-42.4]\");\n    assertPlotParam(\"yrange\", \"[:4e4]\");\n    assertPlotParam(\"yrange\", \"[:-4e4]\");\n    assertPlotParam(\"yrange\", \"[:4e-4]\");\n    assertPlotParam(\"yrange\", \"[:-4e-4]\");\n    assertPlotParam(\"yrange\", \"[:4.2e4]\");\n    assertPlotParam(\"yrange\", \"[:-4.2e4]\");\n    assertPlotParam(\"yrange\", \"[0:]\");\n    assertPlotParam(\"yrange\", \"[5:]\");\n    assertPlotParam(\"yrange\", \"[-5:]\");\n    assertPlotParam(\"yrange\", \"[0.5:]\");\n    assertPlotParam(\"yrange\", \"[-0.5:]\");\n    assertPlotParam(\"yrange\", \"[10.5:]\");\n    assertPlotParam(\"yrange\", \"[-10.5:]\");\n    assertPlotParam(\"yrange\", \"[10e5:]\");\n    assertPlotParam(\"yrange\", \"[-10e5:]\");\n    assertPlotParam(\"yrange\", \"[10e-5:]\");\n    assertPlotParam(\"yrange\", \"[-10e-5:]\");\n    assertPlotParam(\"yrange\", \"[10.1e-5:]\");\n    assertPlotParam(\"yrange\", \"[-10.1e-5:]\");\n    assertPlotParam(\"yrange\", \"[-10.1e-5:-10.1e-6]\");\n    assertInvalidPlotParam(\"yrange\", \"[33:system('touch /tmp/poc.txt')]\");\n    assertInvalidPlotParam(\"y2range\", \"[42:%0a[33:system('touch /tmp/poc.txt')]\");\n  }",
  "func_graph_path": "OpenTSDB/opentsdb/26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25/TestGraphHandler.java/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -30,4 +30,5 @@\n     assertPlotParam(\"yrange\", \"[-10.1e-5:]\");\n     assertPlotParam(\"yrange\", \"[-10.1e-5:-10.1e-6]\");\n     assertInvalidPlotParam(\"yrange\", \"[33:system('touch /tmp/poc.txt')]\");\n+    assertInvalidPlotParam(\"y2range\", \"[42:%0a[33:system('touch /tmp/poc.txt')]\");\n   }",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "    assertInvalidPlotParam(\"y2range\", \"[42:%0a[33:system('touch /tmp/poc.txt')]\");"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/OpenTSDB/opentsdb/pull/2275",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/OpenTSDB/opentsdb/pull/2275: 403 Client Error: Forbidden for url: https://api.github.com/repos/OpenTSDB/opentsdb/pulls/2275",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 1.0"
}