{
  "cve_id": "CVE-2022-24913",
  "cwe_ids": [
    "CWE-668"
  ],
  "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
  "cvss_is_v3": true,
  "repo_name": "cowtowncoder/java-merge-sort",
  "commit_msg": "vuln-fix: Temporary File Information Disclosure\n\n\n\nThis fixes temporary file information disclosure vulnerability due to the use\nof the vulnerable `File.createTempFile()` method. The vulnerability is fixed by\nusing the `Files.createTempFile()` method which sets the correct posix permissions.\n\nWeakness: CWE-377: Insecure Temporary File\nSeverity: Medium\nCVSSS: 5.5\nDetection: CodeQL & OpenRewrite (https://public.moderne.io/recipes/org.openrewrite.java.security.SecureTempFileCreation)\n\nReported-by: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>\nSigned-off-by: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>\n\nBug-tracker: https://github.com/JLLeitschuh/security-research/issues/18\n\n\nCo-authored-by: Moderne <team@moderne.io>",
  "commit_hash": "450fdee70b5f181c2afc5d817f293efa1a543902",
  "git_url": "https://github.com/cowtowncoder/java-merge-sort/commit/450fdee70b5f181c2afc5d817f293efa1a543902",
  "file_path": "src/main/java/com/fasterxml/sort/std/StdTempFileProvider.java",
  "func_name": "provide",
  "func_before": "@Override\n    public File provide() throws IOException\n    {\n        File f = File.createTempFile(_prefix, _suffix);\n        f.deleteOnExit();\n        return f;\n    }",
  "abstract_func_before": "@Override\n    public File provide() throws IOException\n    {\n        File VAR_0 = VAR_1.createTempFile(VAR_2, VAR_3);\n        VAR_0.deleteOnExit();\n        return VAR_0;\n    }",
  "func_graph_path_before": "cowtowncoder/java-merge-sort/450fdee70b5f181c2afc5d817f293efa1a543902/StdTempFileProvider.java/vul/before/0.json",
  "func": "@Override\n    public File provide() throws IOException\n    {\n        File f = Files.createTempFile(_prefix, _suffix).toFile();\n        f.deleteOnExit();\n        return f;\n    }",
  "abstract_func": "@Override\n    public File provide() throws IOException\n    {\n        File VAR_0 = VAR_1.createTempFile(VAR_2, VAR_3).toFile();\n        VAR_0.deleteOnExit();\n        return VAR_0;\n    }",
  "func_graph_path": "cowtowncoder/java-merge-sort/450fdee70b5f181c2afc5d817f293efa1a543902/StdTempFileProvider.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,7 +1,7 @@\n @Override\n     public File provide() throws IOException\n     {\n-        File f = File.createTempFile(_prefix, _suffix);\n+        File f = Files.createTempFile(_prefix, _suffix).toFile();\n         f.deleteOnExit();\n         return f;\n     }",
  "diff_line_info": {
    "deleted_lines": [
      "        File f = File.createTempFile(_prefix, _suffix);"
    ],
    "added_lines": [
      "        File f = Files.createTempFile(_prefix, _suffix).toFile();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/cowtowncoder/java-merge-sort/pull/21",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/cowtowncoder/java-merge-sort/pull/21: 403 Client Error: Forbidden for url: https://api.github.com/repos/cowtowncoder/java-merge-sort/pulls/21",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0"
}