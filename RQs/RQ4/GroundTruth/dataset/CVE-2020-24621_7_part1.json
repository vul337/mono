{
  "cve_id": "CVE-2020-24621",
  "cwe_ids": [
    "CWE-22"
  ],
  "cvss_vector": "AV:N/AC:L/Au:S/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "openmrs/openmrs-module-uiframework",
  "commit_msg": "UIFR-215: Do not allow loading arbitrary files",
  "commit_hash": "0422fa52c7eba3d96cce2936cb92897dca4b680a",
  "git_url": "https://github.com/openmrs/openmrs-module-uiframework/commit/0422fa52c7eba3d96cce2936cb92897dca4b680a",
  "file_path": "api/src/main/java/org/openmrs/ui/framework/resource/ResourceFactory.java",
  "func_name": "addResourceProvider",
  "func_before": "public void addResourceProvider(String key, ResourceProvider provider) {\n\t    if (resourceProviders == null) {\n\t\t\tresourceProviders = new LinkedHashMap<String, ResourceProvider>();\n\t\t}\n\n\t\tboolean addedInDevMode = UiFrameworkUtil.checkAndSetDevelopmentModeForProvider(key, provider);\n\t\tif (addedInDevMode) {\n\t\t\tresourceProvidersInDevelopmentMode.add(key);\n\t\t}\n\t\t\n\t\tresourceProviders.put(key, provider);\n    }",
  "abstract_func_before": "public void addResourceProvider(String VAR_0, ResourceProvider VAR_1) {\n\t    if (VAR_2 == null) {\n\t\t\tVAR_2 = new LinkedHashMap<String, ResourceProvider>();\n\t\t}\n\n\t\tboolean VAR_3 = VAR_4.checkAndSetDevelopmentModeForProvider(VAR_0, VAR_1);\n\t\tif (VAR_3) {\n\t\t\tVAR_5.add(VAR_0);\n\t\t}\n\t\t\n\t\tVAR_2.put(VAR_0, VAR_1);\n    }",
  "func_graph_path_before": "openmrs/openmrs-module-uiframework/0422fa52c7eba3d96cce2936cb92897dca4b680a/ResourceFactory.java/vul/before/6.json",
  "func": "public void addResourceProvider(String key, ResourceProvider provider) {\n\t\tif (resourceProviders == null) {\n\t\t\tresourceProviders = new LinkedHashMap<String, ResourceProvider>();\n\t\t}\n\n\t\tboolean addedInDevMode = UiFrameworkUtil.checkAndSetDevelopmentModeForProvider(key, provider);\n\t\tif (addedInDevMode) {\n\t\t\tresourceProvidersInDevelopmentMode.add(key);\n\t\t}\n\n\t\tresourceProviders.put(key, provider);\n\t}",
  "abstract_func": "public void addResourceProvider(String VAR_0, ResourceProvider VAR_1) {\n\t\tif (VAR_2 == null) {\n\t\t\tVAR_2 = new LinkedHashMap<String, ResourceProvider>();\n\t\t}\n\n\t\tboolean VAR_3 = VAR_4.checkAndSetDevelopmentModeForProvider(VAR_0, VAR_1);\n\t\tif (VAR_3) {\n\t\t\tVAR_5.add(VAR_0);\n\t\t}\n\n\t\tVAR_2.put(VAR_0, VAR_1);\n\t}",
  "func_graph_path": "openmrs/openmrs-module-uiframework/0422fa52c7eba3d96cce2936cb92897dca4b680a/ResourceFactory.java/vul/after/6.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,5 @@\n public void addResourceProvider(String key, ResourceProvider provider) {\n-\t    if (resourceProviders == null) {\n+\t\tif (resourceProviders == null) {\n \t\t\tresourceProviders = new LinkedHashMap<String, ResourceProvider>();\n \t\t}\n \n@@ -7,6 +7,6 @@\n \t\tif (addedInDevMode) {\n \t\t\tresourceProvidersInDevelopmentMode.add(key);\n \t\t}\n-\t\t\n+\n \t\tresourceProviders.put(key, provider);\n-    }\n+\t}",
  "diff_line_info": {
    "deleted_lines": [
      "\t    if (resourceProviders == null) {",
      "\t\t",
      "    }"
    ],
    "added_lines": [
      "\t\tif (resourceProviders == null) {",
      "",
      "\t}"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/openmrs/openmrs-module-uiframework/pull/59",
  "description": {
    "pr_info": {
      "title": "UIFR-215: Do not allow loading arbitrary files",
      "number": 59
    },
    "comment": [
      "This prevents the load of files via absolute paths or path traversal. Ticket is [here](https://issues.openmrs.org/browse/UIFR-215)."
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.9  \n\nThe patch addresses a security issue preventing arbitrary file loading through path traversal, which is a clear security vulnerability. The code changes align with the described fix."
}