{
  "cve_id": "CVE-2023-48795",
  "cwe_ids": [
    "CWE-354"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N",
  "cvss_is_v3": true,
  "repo_name": "janmojzis/tinyssh",
  "commit_msg": "packet_{get,put}: add overflow checks",
  "commit_hash": "ca4a78f5e716b568b5c15ec26ef2f11ecf81431b",
  "git_url": "https://github.com/janmojzis/tinyssh/commit/ca4a78f5e716b568b5c15ec26ef2f11ecf81431b",
  "file_path": "tinyssh/packet_put.c",
  "func_name": "packet_put",
  "func_before": "void packet_put(struct buf *b) {\n\n    if (packet.flagkeys) {\n        sshcrypto_packet_put(b);\n    }\n    else {\n        packet_put_plain_(b);\n    }\n\n    /* strict kex - reset sendpacketid */\n    if (b->buf[0] == SSH_MSG_NEWKEYS && sshcrypto_kex_flags & sshcrypto_FLAGSTRICTKEX) {\n        packet.sendpacketid = 0;\n    }\n}",
  "abstract_func_before": "void packet_put(struct buf *VAR_0) {\n\n    if (VAR_1.flagkeys) {\n        sshcrypto_packet_put(VAR_0);\n    }\n    else {\n        packet_put_plain_(VAR_0);\n    }\n\n    /* COMMENT_0 */\n    if (VAR_0->buf[0] == VAR_2 && VAR_3 & VAR_4) {\n        VAR_1.sendpacketid = 0;\n    }\n}",
  "func_graph_path_before": "janmojzis/tinyssh/ca4a78f5e716b568b5c15ec26ef2f11ecf81431b/packet_put.c/vul/before/0.json",
  "func": "void packet_put(struct buf *b) {\n\n    if (packet.flagkeys) {\n        sshcrypto_packet_put(b);\n    }\n    else {\n        packet_put_plain_(b);\n    }\n\n    /* overflow check */\n    if (!packet.sendpacketid) {\n        log_f1(\"sendpacketid overflow\");\n        global_die(111);\n    }\n\n    /* strict kex - reset sendpacketid */\n    if (b->buf[0] == SSH_MSG_NEWKEYS && sshcrypto_kex_flags & sshcrypto_FLAGSTRICTKEX) {\n        packet.sendpacketid = 0;\n    }\n}",
  "abstract_func": "void packet_put(struct buf *VAR_0) {\n\n    if (VAR_1.flagkeys) {\n        sshcrypto_packet_put(VAR_0);\n    }\n    else {\n        packet_put_plain_(VAR_0);\n    }\n\n    /* COMMENT_0 */\n    if (!VAR_1.sendpacketid) {\n        log_f1(\"sendpacketid overflow\");\n        global_die(111);\n    }\n\n    /* COMMENT_1 */\n    if (VAR_0->buf[0] == VAR_2 && VAR_3 & VAR_4) {\n        VAR_1.sendpacketid = 0;\n    }\n}",
  "func_graph_path": "janmojzis/tinyssh/ca4a78f5e716b568b5c15ec26ef2f11ecf81431b/packet_put.c/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -7,6 +7,12 @@\n         packet_put_plain_(b);\n     }\n \n+    /* overflow check */\n+    if (!packet.sendpacketid) {\n+        log_f1(\"sendpacketid overflow\");\n+        global_die(111);\n+    }\n+\n     /* strict kex - reset sendpacketid */\n     if (b->buf[0] == SSH_MSG_NEWKEYS && sshcrypto_kex_flags & sshcrypto_FLAGSTRICTKEX) {\n         packet.sendpacketid = 0;",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "    /* overflow check */",
      "    if (!packet.sendpacketid) {",
      "        log_f1(\"sendpacketid overflow\");",
      "        global_die(111);",
      "    }",
      ""
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/janmojzis/tinyssh/pull/82",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/janmojzis/tinyssh/pull/82: 403 Client Error: Forbidden for url: https://api.github.com/repos/janmojzis/tinyssh/issues/82/comments",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0"
}