{
  "cve_id": "CVE-2022-24886",
  "cwe_ids": [
    "CWE-732"
  ],
  "cvss_vector": "AV:L/AC:L/Au:N/C:P/I:N/A:N",
  "cvss_is_v3": false,
  "repo_name": "nextcloud/android",
  "commit_msg": "Make more PendingIntents immutable\n\nThis should be all of them. Picked up by lint.\n\nSigned-off-by: √Ålvaro Brey Vilas <alvaro.brey@nextcloud.com>",
  "commit_hash": "c01fa0b17050cdcf77a468cc22f4071eae29d464",
  "git_url": "https://github.com/nextcloud/android/commit/c01fa0b17050cdcf77a468cc22f4071eae29d464",
  "file_path": "src/main/java/com/nextcloud/client/integrations/deck/DeckApiImpl.java",
  "func_name": "createPendingIntent",
  "func_before": "private PendingIntent createPendingIntent(@NonNull Intent intent, @NonNull Notification notification, @NonNull User user) {\n        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n        return PendingIntent.getActivity(context, notification.getNotificationId(),\n                                         putExtrasToIntent(intent, notification, user),\n                                         PendingIntent.FLAG_ONE_SHOT);\n    }",
  "abstract_func_before": "private PendingIntent createPendingIntent(@NonNull Intent VAR_0, @NonNull Notification VAR_1, @NonNull User VAR_2) {\n        VAR_0.addFlags(VAR_3.FLAG_ACTIVITY_NEW_TASK);\n        return VAR_4.getActivity(VAR_5, VAR_1.getNotificationId(),\n                                         putExtrasToIntent(VAR_0, VAR_1, VAR_2),\n                                         VAR_4.FLAG_ONE_SHOT);\n    }",
  "func_graph_path_before": "nextcloud/android/c01fa0b17050cdcf77a468cc22f4071eae29d464/DeckApiImpl.java/vul/before/0.json",
  "func": "private PendingIntent createPendingIntent(@NonNull Intent intent, @NonNull Notification notification, @NonNull User user) {\n        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n        return PendingIntent.getActivity(context, notification.getNotificationId(),\n                                         putExtrasToIntent(intent, notification, user),\n                                         PendingIntent.FLAG_ONE_SHOT | PendingIntent.FLAG_IMMUTABLE);\n    }",
  "abstract_func": "private PendingIntent createPendingIntent(@NonNull Intent VAR_0, @NonNull Notification VAR_1, @NonNull User VAR_2) {\n        VAR_0.addFlags(VAR_3.FLAG_ACTIVITY_NEW_TASK);\n        return VAR_4.getActivity(VAR_5, VAR_1.getNotificationId(),\n                                         putExtrasToIntent(VAR_0, VAR_1, VAR_2),\n                                         VAR_4.FLAG_ONE_SHOT | VAR_4.FLAG_IMMUTABLE);\n    }",
  "func_graph_path": "nextcloud/android/c01fa0b17050cdcf77a468cc22f4071eae29d464/DeckApiImpl.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -2,5 +2,5 @@\n         intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\n         return PendingIntent.getActivity(context, notification.getNotificationId(),\n                                          putExtrasToIntent(intent, notification, user),\n-                                         PendingIntent.FLAG_ONE_SHOT);\n+                                         PendingIntent.FLAG_ONE_SHOT | PendingIntent.FLAG_IMMUTABLE);\n     }",
  "diff_line_info": {
    "deleted_lines": [
      "                                         PendingIntent.FLAG_ONE_SHOT);"
    ],
    "added_lines": [
      "                                         PendingIntent.FLAG_ONE_SHOT | PendingIntent.FLAG_IMMUTABLE);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/nextcloud/android/pull/9726",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/nextcloud/android/pull/9726: 403 Client Error: Forbidden for url: https://api.github.com/repos/nextcloud/android/pulls/9726",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 0.9\n\nStep-by-Step Explanation:\n\n1. The commit modifies PendingIntents to be immutable to enhance security.\n2. Code change adds FLAG_IMMUTABLE, a security best practice.\n3. Consistent with security improvement, though no CVE is cited.\n4. Clear confidence in the security intent, so high score.\n\nThe change is a security fix as it addresses a known security best practice by making PendingIntents immutable, thus improving the app's security posture."
}