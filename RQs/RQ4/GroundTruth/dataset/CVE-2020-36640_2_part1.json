{
  "cve_id": "CVE-2020-36640",
  "cwe_ids": [
    "CWE-611"
  ],
  "cvss_vector": "AV:A/AC:M/Au:S/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "bonitasoft/bonita-connector-webservice",
  "commit_msg": "fix(vulnerabilities): fix XXE attacks vulnerabilities and other code smell (#17)\n\n* Access to external entities and network access should always be\r\ndisable to avoid XXS attacks vulnerabilities.\r\n* Log error properly\r\n* refactor logger name to be compliant with java naming conventions",
  "commit_hash": "a12ad691c05af19e9061d7949b6b828ce48815d5",
  "git_url": "https://github.com/bonitasoft/bonita-connector-webservice/commit/a12ad691c05af19e9061d7949b6b828ce48815d5",
  "file_path": "src/main/java/org/bonitasoft/connectors/ws/SecureWSConnector.java",
  "func_name": "buildResponseDocumentBody",
  "func_before": "private Document buildResponseDocumentBody(Document responseDocumentEnvelope) throws ConnectorException {\n        Document responseDocumentBody = null;\n        if (responseDocumentEnvelope != null) {\n            try {\n                responseDocumentBody = DocumentBuilderFactory.newInstance().newDocumentBuilder().newDocument();\n            } catch (final ParserConfigurationException pce) {\n                throw new ConnectorException(pce);\n            }\n            final Node bodyContent = getEnvelopeBodyContent(responseDocumentEnvelope);\n            final Node clonedBodyContent = bodyContent.cloneNode(true);\n            responseDocumentBody.adoptNode(clonedBodyContent);\n            responseDocumentBody.importNode(clonedBodyContent, true);\n            responseDocumentBody.appendChild(clonedBodyContent);\n        }\n        return responseDocumentBody;\n    }",
  "abstract_func_before": "private Document buildResponseDocumentBody(Document VAR_0) throws ConnectorException {\n        Document VAR_1 = null;\n        if (VAR_0 != null) {\n            try {\n                VAR_1 = VAR_2.newInstance().newDocumentBuilder().newDocument();\n            } catch (final ParserConfigurationException VAR_3) {\n                throw new ConnectorException(VAR_3);\n            }\n            final Node VAR_4 = getEnvelopeBodyContent(VAR_0);\n            final Node VAR_5 = VAR_4.cloneNode(true);\n            VAR_1.adoptNode(VAR_5);\n            VAR_1.importNode(VAR_5, true);\n            VAR_1.appendChild(VAR_5);\n        }\n        return VAR_1;\n    }",
  "func_graph_path_before": "bonitasoft/bonita-connector-webservice/a12ad691c05af19e9061d7949b6b828ce48815d5/SecureWSConnector.java/vul/before/3.json",
  "func": "private Document buildResponseDocumentBody(Document responseDocumentEnvelope) throws ConnectorException {\n        Document responseDocumentBody = null;\n        if (responseDocumentEnvelope != null) {\n            try {\n                DocumentBuilderFactory documentBuilderFactory = DocumentBuilderFactory.newInstance();\n                documentBuilderFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\n                documentBuilderFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, \"\");\n                responseDocumentBody = documentBuilderFactory.newDocumentBuilder().newDocument();\n            } catch (final ParserConfigurationException pce) {\n                throw new ConnectorException(pce);\n            }\n            final Node bodyContent = getEnvelopeBodyContent(responseDocumentEnvelope);\n            final Node clonedBodyContent = bodyContent.cloneNode(true);\n            responseDocumentBody.adoptNode(clonedBodyContent);\n            responseDocumentBody.importNode(clonedBodyContent, true);\n            responseDocumentBody.appendChild(clonedBodyContent);\n        }\n        return responseDocumentBody;\n    }",
  "abstract_func": "private Document buildResponseDocumentBody(Document VAR_0) throws ConnectorException {\n        Document VAR_1 = null;\n        if (VAR_0 != null) {\n            try {\n                DocumentBuilderFactory VAR_2 = VAR_3.newInstance();\n                VAR_2.setAttribute(VAR_4.ACCESS_EXTERNAL_DTD, \"\");\n                VAR_2.setAttribute(VAR_4.ACCESS_EXTERNAL_SCHEMA, \"\");\n                VAR_1 = VAR_2.newDocumentBuilder().newDocument();\n            } catch (final ParserConfigurationException VAR_5) {\n                throw new ConnectorException(VAR_5);\n            }\n            final Node VAR_6 = getEnvelopeBodyContent(VAR_0);\n            final Node VAR_7 = VAR_6.cloneNode(true);\n            VAR_1.adoptNode(VAR_7);\n            VAR_1.importNode(VAR_7, true);\n            VAR_1.appendChild(VAR_7);\n        }\n        return VAR_1;\n    }",
  "func_graph_path": "bonitasoft/bonita-connector-webservice/a12ad691c05af19e9061d7949b6b828ce48815d5/SecureWSConnector.java/vul/after/3.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -2,7 +2,10 @@\n         Document responseDocumentBody = null;\n         if (responseDocumentEnvelope != null) {\n             try {\n-                responseDocumentBody = DocumentBuilderFactory.newInstance().newDocumentBuilder().newDocument();\n+                DocumentBuilderFactory documentBuilderFactory = DocumentBuilderFactory.newInstance();\n+                documentBuilderFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\n+                documentBuilderFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, \"\");\n+                responseDocumentBody = documentBuilderFactory.newDocumentBuilder().newDocument();\n             } catch (final ParserConfigurationException pce) {\n                 throw new ConnectorException(pce);\n             }",
  "diff_line_info": {
    "deleted_lines": [
      "                responseDocumentBody = DocumentBuilderFactory.newInstance().newDocumentBuilder().newDocument();"
    ],
    "added_lines": [
      "                DocumentBuilderFactory documentBuilderFactory = DocumentBuilderFactory.newInstance();",
      "                documentBuilderFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");",
      "                documentBuilderFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, \"\");",
      "                responseDocumentBody = documentBuilderFactory.newDocumentBuilder().newDocument();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/bonitasoft/bonita-connector-webservice/pull/17",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/bonitasoft/bonita-connector-webservice/pull/17: 403 Client Error: Forbidden for url: https://api.github.com/repos/bonitasoft/bonita-connector-webservice/pulls/17",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.95"
}