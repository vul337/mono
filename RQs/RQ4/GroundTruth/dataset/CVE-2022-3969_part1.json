{
  "cve_id": "CVE-2022-3969",
  "cwe_ids": [
    "CWE-377"
  ],
  "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
  "cvss_is_v3": true,
  "repo_name": "openkm/document-management-system",
  "commit_msg": "Fix Temporary Directory Hijacking or Information Disclosure Vulnerability\n\nfix #332",
  "commit_hash": "c069e4d73ab8864345c25119d8459495f45453e1",
  "git_url": "https://github.com/openkm/document-management-system/commit/c069e4d73ab8864345c25119d8459495f45453e1",
  "file_path": "src/main/java/com/openkm/util/FileUtils.java",
  "func_name": "createTempDir",
  "func_before": "public static File createTempDir() throws IOException {\n\t\tFile tmpFile = File.createTempFile(\"okm\", null);\n\n\t\tif (!tmpFile.delete())\n\t\t\tthrow new IOException();\n\t\tif (!tmpFile.mkdir())\n\t\t\tthrow new IOException();\n\t\treturn tmpFile;\n\t}",
  "abstract_func_before": "public static File createTempDir() throws IOException {\n\t\tFile VAR_0 = VAR_1.createTempFile(\"okm\", null);\n\n\t\tif (!VAR_0.delete())\n\t\t\tthrow new IOException();\n\t\tif (!VAR_0.mkdir())\n\t\t\tthrow new IOException();\n\t\treturn VAR_0;\n\t}",
  "func_graph_path_before": "openkm/document-management-system/c069e4d73ab8864345c25119d8459495f45453e1/FileUtils.java/vul/before/0.json",
  "func": "public static File createTempDir() throws IOException {\n\t\treturn Files.createTempDirectory(\"okm\").toFile();\n\t}",
  "abstract_func": "public static File createTempDir() throws IOException {\n\t\treturn VAR_0.createTempDirectory(\"okm\").toFile();\n\t}",
  "func_graph_path": "openkm/document-management-system/c069e4d73ab8864345c25119d8459495f45453e1/FileUtils.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,9 +1,3 @@\n public static File createTempDir() throws IOException {\n-\t\tFile tmpFile = File.createTempFile(\"okm\", null);\n-\n-\t\tif (!tmpFile.delete())\n-\t\t\tthrow new IOException();\n-\t\tif (!tmpFile.mkdir())\n-\t\t\tthrow new IOException();\n-\t\treturn tmpFile;\n+\t\treturn Files.createTempDirectory(\"okm\").toFile();\n \t}",
  "diff_line_info": {
    "deleted_lines": [
      "\t\tFile tmpFile = File.createTempFile(\"okm\", null);",
      "",
      "\t\tif (!tmpFile.delete())",
      "\t\t\tthrow new IOException();",
      "\t\tif (!tmpFile.mkdir())",
      "\t\t\tthrow new IOException();",
      "\t\treturn tmpFile;"
    ],
    "added_lines": [
      "\t\treturn Files.createTempDirectory(\"okm\").toFile();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/openkm/document-management-system/pull/335",
  "description": {
    "pr_info": {
      "title": "Fix Temporary Directory Hijacking or Information Disclosure Vulnerabiâ€¦",
      "number": 335
    },
    "comment": [
      "[SECURITY] Fix Temporary Directory Hijacking or Information Disclosure Vulnerability\r\n\r\nfix #332",
      "Do you need any assistance with vulnerability disclosure here?",
      "It's just fixed, but I created another merge request based on your proposal.\r\n\r\nThanks a lot!"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0  \n\nThe commit message clearly indicates a security fix addressing directory hijacking and information disclosure. The code change uses a secure method to create temporary directories, confirming it's a security patch. All elements align perfectly with a security fix."
}