{
  "cve_id": "CVE-2023-4043",
  "cwe_ids": [
    "CWE-834"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "cvss_is_v3": true,
  "repo_name": "eclipse-ee4j/parsson",
  "commit_msg": "Exception message moved to messages bundle.\n\nSigned-off-by: Tomáš Kraus <tomas.kraus@oracle.com>",
  "commit_hash": "84764ffbe3d0376da242b27a9a526138d0dfb8e6",
  "git_url": "https://github.com/eclipse-ee4j/parsson/commit/84764ffbe3d0376da242b27a9a526138d0dfb8e6",
  "file_path": "impl/src/main/java/org/eclipse/parsson/JsonNumberImpl.java",
  "func_name": "bigIntegerValue",
  "func_before": "@Override\n    public BigInteger bigIntegerValue() {\n        BigDecimal bd = bigDecimalValue();\n        if (Math.abs(bd.scale()) <= bigIntegerScaleLimit) {\n            return bd.toBigInteger();\n        }\n        throw new UnsupportedOperationException(\n                String.format(SCALE_LIMIT_EXCEPTION_MESSAGE, bd.scale(), bigIntegerScaleLimit));\n    }",
  "abstract_func_before": "@Override\n    public BigInteger bigIntegerValue() {\n        BigDecimal VAR_0 = bigDecimalValue();\n        if (VAR_1.abs(VAR_0.scale()) <= VAR_2) {\n            return VAR_0.toBigInteger();\n        }\n        throw new UnsupportedOperationException(\n                VAR_3.format(VAR_4, VAR_0.scale(), VAR_2));\n    }",
  "func_graph_path_before": "eclipse-ee4j/parsson/84764ffbe3d0376da242b27a9a526138d0dfb8e6/JsonNumberImpl.java/vul/before/1.json",
  "func": "@Override\n    public BigInteger bigIntegerValue() {\n        BigDecimal bd = bigDecimalValue();\n        if (Math.abs(bd.scale()) <= bigIntegerScaleLimit) {\n            return bd.toBigInteger();\n        }\n        throw new UnsupportedOperationException(\n                JsonMessages.NUMBER_SCALE_LIMIT_EXCEPTION(bd.scale(), bigIntegerScaleLimit));\n    }",
  "abstract_func": "@Override\n    public BigInteger bigIntegerValue() {\n        BigDecimal VAR_0 = bigDecimalValue();\n        if (VAR_1.abs(VAR_0.scale()) <= VAR_2) {\n            return VAR_0.toBigInteger();\n        }\n        throw new UnsupportedOperationException(\n                VAR_3.NUMBER_SCALE_LIMIT_EXCEPTION(VAR_0.scale(), VAR_2));\n    }",
  "func_graph_path": "eclipse-ee4j/parsson/84764ffbe3d0376da242b27a9a526138d0dfb8e6/JsonNumberImpl.java/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -5,5 +5,5 @@\n             return bd.toBigInteger();\n         }\n         throw new UnsupportedOperationException(\n-                String.format(SCALE_LIMIT_EXCEPTION_MESSAGE, bd.scale(), bigIntegerScaleLimit));\n+                JsonMessages.NUMBER_SCALE_LIMIT_EXCEPTION(bd.scale(), bigIntegerScaleLimit));\n     }",
  "diff_line_info": {
    "deleted_lines": [
      "                String.format(SCALE_LIMIT_EXCEPTION_MESSAGE, bd.scale(), bigIntegerScaleLimit));"
    ],
    "added_lines": [
      "                JsonMessages.NUMBER_SCALE_LIMIT_EXCEPTION(bd.scale(), bigIntegerScaleLimit));"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/eclipse-ee4j/parsson/pull/100",
  "description": {
    "pr_info": {
      "title": "BigInteger scale limit counts absolute value now.",
      "number": 100
    },
    "comment": [
      "Changed contition to count `Math.abs(bd.scale())`\r\nAdded tests with negative scale values."
    ]
  },
  "Bug Filter": "Supporting & Non-Core Improvements",
  "Bug Filter Confidence": 0.8,
  "Bug Filter Response": "The patch involves moving an exception message to a messages bundle and updating the code to use this new reference. The code change focuses on improving maintainability and localization rather than addressing a security vulnerability. \n\n**Final Classification:** Supporting & Non-Core Improvements  \n**Confidence:** 0.8"
}