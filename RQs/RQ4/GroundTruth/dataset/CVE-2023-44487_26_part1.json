{
  "cve_id": "CVE-2023-44487",
  "cwe_ids": [
    "CWE-400"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "cvss_is_v3": true,
  "repo_name": "facebook/proxygen",
  "commit_msg": "Re-sync with internal repository\n\nThe internal and external repositories are out of sync. This Pull Request attempts to brings them back in sync by patching the GitHub repository. Please carefully review this patch. You must disable ShipIt for your project in order to merge this pull request. DO NOT IMPORT this pull request. Instead, merge it directly on GitHub using the MERGE BUTTON. Re-enable ShipIt after merging.",
  "commit_hash": "0a00c43d64c58a85e6250120f2377302675b0fe3",
  "git_url": "https://github.com/facebook/proxygen/commit/0a00c43d64c58a85e6250120f2377302675b0fe3",
  "file_path": "proxygen/lib/http/stats/ThreadLocalHTTPSessionStats.cpp",
  "func_name": "TLHTTPSessionStats::TLHTTPSessionStats",
  "func_before": "TLHTTPSessionStats::TLHTTPSessionStats(const std::string& prefix)\n    : txnsOpen(prefix + \"_transactions_open\"),\n      pendingBufferedReadBytes(prefix + \"_pending_buffered_read_bytes\"),\n      pendingBufferedWriteBytes(prefix + \"_pending_buffered_write_bytes\"),\n      txnsOpened(prefix + \"_txn_opened\", facebook::fb303::SUM),\n      txnsFromSessionReuse(prefix + \"_txn_session_reuse\", facebook::fb303::SUM),\n      txnsTransactionStalled(prefix + \"_txn_transaction_stall\",\n                             facebook::fb303::SUM),\n      txnsSessionStalled(prefix + \"_txn_session_stall\", facebook::fb303::SUM),\n      egressContentLengthMismatches(\n          prefix + \"_egress_content_length_mismatches\", facebook::fb303::SUM),\n      sessionPeriodicPingProbeTimeout(\n          prefix + \"_session_periodic_ping_probe_timeout\",\n          facebook::fb303::SUM),\n      presendIoSplit(prefix + \"_presend_io_split\", facebook::fb303::SUM),\n      presendExceedLimit(prefix + \"_presend_exceed_limit\",\n                         facebook::fb303::SUM),\n      ttlbaTracked(prefix + \"_ttlba_tracked\", facebook::fb303::SUM),\n      ttlbaReceived(prefix + \"_ttlba_received\", facebook::fb303::SUM),\n      ttlbaTimeout(prefix + \"_ttlba_timeout\", facebook::fb303::SUM),\n      ttlbaNotFound(prefix + \"_ttlba_not_found\", facebook::fb303::SUM),\n      ttlbaExceedLimit(prefix + \"_ttlba_exceed_limit\", facebook::fb303::SUM),\n      ttbtxTracked(prefix + \"_ttbtx_tracked\", facebook::fb303::SUM),\n      ttbtxReceived(prefix + \"_ttbtx_received\", facebook::fb303::SUM),\n      ttbtxTimeout(prefix + \"_ttbtx_timeout\", facebook::fb303::SUM),\n      ttbtxNotFound(prefix + \"_ttbtx_not_found\", facebook::fb303::SUM),\n      ttbtxExceedLimit(prefix + \"_ttbtx_exceed_limit\", facebook::fb303::SUM),\n      ctrlMsgsRateLimited(prefix + \"_ctrl_msgs_rate_limited\",\n                          facebook::fb303::SUM),\n      txnsPerSession(prefix + \"_txn_per_session\",\n                     1,\n                     0,\n                     999,\n                     facebook::fb303::AVG,\n                     50,\n                     95,\n                     99),\n      sessionIdleTime(prefix + \"_session_idle_time\",\n                      1,\n                      0,\n                      150,\n                      facebook::fb303::AVG,\n                      50,\n                      75,\n                      95,\n                      99),\n      ctrlMsgsInInterval(\n          prefix + \"_ctrl_msgs_in_interval\",\n          1 /* bucketWidth */,\n          0 /* min */,\n          500 /* max, keep in sync with kDefaultMaxControlMsgsPerInterval */,\n          facebook::fb303::AVG,\n          50,\n          99,\n          100) {\n}",
  "abstract_func_before": "TLHTTPSessionStats::TLHTTPSessionStats(const std::string& VAR_0)\n    : txnsOpen(VAR_0 + \"_transactions_open\"),\n      pendingBufferedReadBytes(VAR_0 + \"_pending_buffered_read_bytes\"),\n      pendingBufferedWriteBytes(VAR_0 + \"_pending_buffered_write_bytes\"),\n      txnsOpened(VAR_0 + \"_txn_opened\", facebook::fb303::SUM),\n      txnsFromSessionReuse(VAR_0 + \"_txn_session_reuse\", facebook::fb303::SUM),\n      txnsTransactionStalled(VAR_0 + \"_txn_transaction_stall\",\n                             facebook::fb303::SUM),\n      txnsSessionStalled(VAR_0 + \"_txn_session_stall\", facebook::fb303::SUM),\n      egressContentLengthMismatches(\n          VAR_0 + \"_egress_content_length_mismatches\", facebook::fb303::SUM),\n      sessionPeriodicPingProbeTimeout(\n          VAR_0 + \"_session_periodic_ping_probe_timeout\",\n          facebook::fb303::SUM),\n      presendIoSplit(VAR_0 + \"_presend_io_split\", facebook::fb303::SUM),\n      presendExceedLimit(VAR_0 + \"_presend_exceed_limit\",\n                         facebook::fb303::SUM),\n      ttlbaTracked(VAR_0 + \"_ttlba_tracked\", facebook::fb303::SUM),\n      ttlbaReceived(VAR_0 + \"_ttlba_received\", facebook::fb303::SUM),\n      ttlbaTimeout(VAR_0 + \"_ttlba_timeout\", facebook::fb303::SUM),\n      ttlbaNotFound(VAR_0 + \"_ttlba_not_found\", facebook::fb303::SUM),\n      ttlbaExceedLimit(VAR_0 + \"_ttlba_exceed_limit\", facebook::fb303::SUM),\n      ttbtxTracked(VAR_0 + \"_ttbtx_tracked\", facebook::fb303::SUM),\n      ttbtxReceived(VAR_0 + \"_ttbtx_received\", facebook::fb303::SUM),\n      ttbtxTimeout(VAR_0 + \"_ttbtx_timeout\", facebook::fb303::SUM),\n      ttbtxNotFound(VAR_0 + \"_ttbtx_not_found\", facebook::fb303::SUM),\n      ttbtxExceedLimit(VAR_0 + \"_ttbtx_exceed_limit\", facebook::fb303::SUM),\n      ctrlMsgsRateLimited(VAR_0 + \"_ctrl_msgs_rate_limited\",\n                          facebook::fb303::SUM),\n      txnsPerSession(VAR_0 + \"_txn_per_session\",\n                     1,\n                     0,\n                     999,\n                     facebook::fb303::AVG,\n                     50,\n                     95,\n                     99),\n      sessionIdleTime(VAR_0 + \"_session_idle_time\",\n                      1,\n                      0,\n                      150,\n                      facebook::fb303::AVG,\n                      50,\n                      75,\n                      95,\n                      99),\n      ctrlMsgsInInterval(\n          VAR_0 + \"_ctrl_msgs_in_interval\",\n          1 /* COMMENT_0 */,\n          0 /* COMMENT_1 */,\n          500 /* COMMENT_2 */,\n          facebook::fb303::AVG,\n          50,\n          99,\n          100) {\n}",
  "func_graph_path_before": "facebook/proxygen/0a00c43d64c58a85e6250120f2377302675b0fe3/ThreadLocalHTTPSessionStats.cpp/vul/before/0.json",
  "func": "TLHTTPSessionStats::TLHTTPSessionStats(const std::string& prefix)\n    : txnsOpen(prefix + \"_transactions_open\"),\n      pendingBufferedReadBytes(prefix + \"_pending_buffered_read_bytes\"),\n      pendingBufferedWriteBytes(prefix + \"_pending_buffered_write_bytes\"),\n      txnsOpened(prefix + \"_txn_opened\", facebook::fb303::SUM),\n      txnsFromSessionReuse(prefix + \"_txn_session_reuse\", facebook::fb303::SUM),\n      txnsTransactionStalled(prefix + \"_txn_transaction_stall\",\n                             facebook::fb303::SUM),\n      txnsSessionStalled(prefix + \"_txn_session_stall\", facebook::fb303::SUM),\n      egressContentLengthMismatches(\n          prefix + \"_egress_content_length_mismatches\", facebook::fb303::SUM),\n      sessionPeriodicPingProbeTimeout(\n          prefix + \"_session_periodic_ping_probe_timeout\",\n          facebook::fb303::SUM),\n      presendIoSplit(prefix + \"_presend_io_split\", facebook::fb303::SUM),\n      presendExceedLimit(prefix + \"_presend_exceed_limit\",\n                         facebook::fb303::SUM),\n      ttlbaTracked(prefix + \"_ttlba_tracked\", facebook::fb303::SUM),\n      ttlbaReceived(prefix + \"_ttlba_received\", facebook::fb303::SUM),\n      ttlbaTimeout(prefix + \"_ttlba_timeout\", facebook::fb303::SUM),\n      ttlbaNotFound(prefix + \"_ttlba_not_found\", facebook::fb303::SUM),\n      ttlbaExceedLimit(prefix + \"_ttlba_exceed_limit\", facebook::fb303::SUM),\n      ttbtxTracked(prefix + \"_ttbtx_tracked\", facebook::fb303::SUM),\n      ttbtxReceived(prefix + \"_ttbtx_received\", facebook::fb303::SUM),\n      ttbtxTimeout(prefix + \"_ttbtx_timeout\", facebook::fb303::SUM),\n      ttbtxNotFound(prefix + \"_ttbtx_not_found\", facebook::fb303::SUM),\n      ttbtxExceedLimit(prefix + \"_ttbtx_exceed_limit\", facebook::fb303::SUM),\n      ctrlMsgsRateLimited(prefix + \"_ctrl_msgs_rate_limited\",\n                          facebook::fb303::SUM),\n      headersRateLimited(prefix + \"_headers_rate_limited\",\n                         facebook::fb303::SUM),\n      txnsPerSession(prefix + \"_txn_per_session\",\n                     1,\n                     0,\n                     999,\n                     facebook::fb303::AVG,\n                     50,\n                     95,\n                     99),\n      sessionIdleTime(prefix + \"_session_idle_time\",\n                      1,\n                      0,\n                      150,\n                      facebook::fb303::AVG,\n                      50,\n                      75,\n                      95,\n                      99),\n      ctrlMsgsInInterval(\n          prefix + \"_ctrl_msgs_in_interval\",\n          1 /* bucketWidth */,\n          0 /* min */,\n          500 /* max, keep in sync with kDefaultMaxControlMsgsPerInterval */,\n          facebook::fb303::AVG,\n          50,\n          99,\n          100),\n      headersInInterval(\n          prefix + \"_headers_in_interval\",\n          1 /* bucketWidth */,\n          0 /* min */,\n          500 /* max, keep in sync with kDefaultMaxHeadersMsgsPerInterval */,\n          facebook::fb303::AVG,\n          50,\n          99,\n          100) {\n}",
  "abstract_func": "TLHTTPSessionStats::TLHTTPSessionStats(const std::string& VAR_0)\n    : txnsOpen(VAR_0 + \"_transactions_open\"),\n      pendingBufferedReadBytes(VAR_0 + \"_pending_buffered_read_bytes\"),\n      pendingBufferedWriteBytes(VAR_0 + \"_pending_buffered_write_bytes\"),\n      txnsOpened(VAR_0 + \"_txn_opened\", facebook::fb303::SUM),\n      txnsFromSessionReuse(VAR_0 + \"_txn_session_reuse\", facebook::fb303::SUM),\n      txnsTransactionStalled(VAR_0 + \"_txn_transaction_stall\",\n                             facebook::fb303::SUM),\n      txnsSessionStalled(VAR_0 + \"_txn_session_stall\", facebook::fb303::SUM),\n      egressContentLengthMismatches(\n          VAR_0 + \"_egress_content_length_mismatches\", facebook::fb303::SUM),\n      sessionPeriodicPingProbeTimeout(\n          VAR_0 + \"_session_periodic_ping_probe_timeout\",\n          facebook::fb303::SUM),\n      presendIoSplit(VAR_0 + \"_presend_io_split\", facebook::fb303::SUM),\n      presendExceedLimit(VAR_0 + \"_presend_exceed_limit\",\n                         facebook::fb303::SUM),\n      ttlbaTracked(VAR_0 + \"_ttlba_tracked\", facebook::fb303::SUM),\n      ttlbaReceived(VAR_0 + \"_ttlba_received\", facebook::fb303::SUM),\n      ttlbaTimeout(VAR_0 + \"_ttlba_timeout\", facebook::fb303::SUM),\n      ttlbaNotFound(VAR_0 + \"_ttlba_not_found\", facebook::fb303::SUM),\n      ttlbaExceedLimit(VAR_0 + \"_ttlba_exceed_limit\", facebook::fb303::SUM),\n      ttbtxTracked(VAR_0 + \"_ttbtx_tracked\", facebook::fb303::SUM),\n      ttbtxReceived(VAR_0 + \"_ttbtx_received\", facebook::fb303::SUM),\n      ttbtxTimeout(VAR_0 + \"_ttbtx_timeout\", facebook::fb303::SUM),\n      ttbtxNotFound(VAR_0 + \"_ttbtx_not_found\", facebook::fb303::SUM),\n      ttbtxExceedLimit(VAR_0 + \"_ttbtx_exceed_limit\", facebook::fb303::SUM),\n      ctrlMsgsRateLimited(VAR_0 + \"_ctrl_msgs_rate_limited\",\n                          facebook::fb303::SUM),\n      headersRateLimited(VAR_0 + \"_headers_rate_limited\",\n                         facebook::fb303::SUM),\n      txnsPerSession(VAR_0 + \"_txn_per_session\",\n                     1,\n                     0,\n                     999,\n                     facebook::fb303::AVG,\n                     50,\n                     95,\n                     99),\n      sessionIdleTime(VAR_0 + \"_session_idle_time\",\n                      1,\n                      0,\n                      150,\n                      facebook::fb303::AVG,\n                      50,\n                      75,\n                      95,\n                      99),\n      ctrlMsgsInInterval(\n          VAR_0 + \"_ctrl_msgs_in_interval\",\n          1 /* COMMENT_0 */,\n          0 /* COMMENT_1 */,\n          500 /* COMMENT_2 */,\n          facebook::fb303::AVG,\n          50,\n          99,\n          100),\n      headersInInterval(\n          VAR_0 + \"_headers_in_interval\",\n          1 /* COMMENT_0 */,\n          0 /* COMMENT_1 */,\n          500 /* COMMENT_3 */,\n          facebook::fb303::AVG,\n          50,\n          99,\n          100) {\n}",
  "func_graph_path": "facebook/proxygen/0a00c43d64c58a85e6250120f2377302675b0fe3/ThreadLocalHTTPSessionStats.cpp/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -27,6 +27,8 @@\n       ttbtxExceedLimit(prefix + \"_ttbtx_exceed_limit\", facebook::fb303::SUM),\n       ctrlMsgsRateLimited(prefix + \"_ctrl_msgs_rate_limited\",\n                           facebook::fb303::SUM),\n+      headersRateLimited(prefix + \"_headers_rate_limited\",\n+                         facebook::fb303::SUM),\n       txnsPerSession(prefix + \"_txn_per_session\",\n                      1,\n                      0,\n@@ -52,5 +54,14 @@\n           facebook::fb303::AVG,\n           50,\n           99,\n+          100),\n+      headersInInterval(\n+          prefix + \"_headers_in_interval\",\n+          1 /* bucketWidth */,\n+          0 /* min */,\n+          500 /* max, keep in sync with kDefaultMaxHeadersMsgsPerInterval */,\n+          facebook::fb303::AVG,\n+          50,\n+          99,\n           100) {\n }",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "      headersRateLimited(prefix + \"_headers_rate_limited\",",
      "                         facebook::fb303::SUM),",
      "          100),",
      "      headersInInterval(",
      "          prefix + \"_headers_in_interval\",",
      "          1 /* bucketWidth */,",
      "          0 /* min */,",
      "          500 /* max, keep in sync with kDefaultMaxHeadersMsgsPerInterval */,",
      "          facebook::fb303::AVG,",
      "          50,",
      "          99,"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/facebook/proxygen/pull/466",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/facebook/proxygen/pull/466: 403 Client Error: Forbidden for url: https://api.github.com/repos/facebook/proxygen/pulls/466",
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "The patch involves adding new metrics for tracking within a function, which is a core feature enhancement rather than a security fix. \n\n**Final Classification:** Defect Remediation & Feature Upgrades; **Confidence:** 1.0"
}