{
  "cve_id": "CVE-2019-13623",
  "cwe_ids": [
    "CWE-22"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "NationalSecurityAgency/ghidra",
  "commit_msg": "GT-3001 (#789) fix RestoreTask to safely extract files from zip.\n\nAbstracted guts of GFileSystemExtractAllTask, reused in RestoreTask.\nFixed NPE in RestoreTask if restore was canceled.",
  "commit_hash": "6c0171c9200b4490deb94abf3c92d1b3da59f9bf",
  "git_url": "https://github.com/NationalSecurityAgency/ghidra/commit/6c0171c9200b4490deb94abf3c92d1b3da59f9bf",
  "file_path": "Ghidra/Features/Base/src/main/java/ghidra/app/plugin/core/archive/ArchivePlugin.java",
  "func_name": "cleanupRestoredProject",
  "func_before": "void cleanupRestoredProject(ProjectLocator projectLocator) {\n\n\t\tProject project = tool.getProject();\n\t\tProjectManager projectManager = project.getProjectManager();\n\n\t\t// delete the project at the given project location\n\t\tif (!projectManager.deleteProject(projectLocator)) {\n\t\t\tMsg.showError(this, null, \"All Files in Project not Removed\",\n\t\t\t\t\"Not all files have been deleted from project \" + projectLocator.getName());\n\t\t}\n\t}",
  "abstract_func_before": "void cleanupRestoredProject(ProjectLocator VAR_0) {\n\n\t\tProject VAR_1 = VAR_2.getProject();\n\t\tProjectManager VAR_3 = VAR_1.getProjectManager();\n\n\t\t/* COMMENT_0 */\n\t\tif (!VAR_3.deleteProject(VAR_0)) {\n\t\t\tVAR_4.showError(this, null, \"All Files in Project not Removed\",\n\t\t\t\t\"Not all files have been deleted from project \" + VAR_0.getName());\n\t\t}\n\t}",
  "func_graph_path_before": "NationalSecurityAgency/ghidra/6c0171c9200b4490deb94abf3c92d1b3da59f9bf/ArchivePlugin.java/vul/before/1.json",
  "func": "void cleanupRestoredProject(ProjectLocator projectLocator) {\n\n\t\tProjectManager projectManager = tool.getProjectManager();\n\n\t\t// delete the project at the given project location\n\t\tif (!projectManager.deleteProject(projectLocator)) {\n\t\t\tMsg.showError(this, null, \"All Files in Project not Removed\",\n\t\t\t\t\"Not all files have been deleted from project \" + projectLocator.getName());\n\t\t}\n\t}",
  "abstract_func": "void cleanupRestoredProject(ProjectLocator VAR_0) {\n\n\t\tProjectManager VAR_1 = VAR_2.getProjectManager();\n\n\t\t/* COMMENT_0 */\n\t\tif (!VAR_1.deleteProject(VAR_0)) {\n\t\t\tVAR_3.showError(this, null, \"All Files in Project not Removed\",\n\t\t\t\t\"Not all files have been deleted from project \" + VAR_0.getName());\n\t\t}\n\t}",
  "func_graph_path": "NationalSecurityAgency/ghidra/6c0171c9200b4490deb94abf3c92d1b3da59f9bf/ArchivePlugin.java/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,7 +1,6 @@\n void cleanupRestoredProject(ProjectLocator projectLocator) {\n \n-\t\tProject project = tool.getProject();\n-\t\tProjectManager projectManager = project.getProjectManager();\n+\t\tProjectManager projectManager = tool.getProjectManager();\n \n \t\t// delete the project at the given project location\n \t\tif (!projectManager.deleteProject(projectLocator)) {",
  "diff_line_info": {
    "deleted_lines": [
      "\t\tProject project = tool.getProject();",
      "\t\tProjectManager projectManager = project.getProjectManager();"
    ],
    "added_lines": [
      "\t\tProjectManager projectManager = tool.getProjectManager();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/NationalSecurityAgency/ghidra/pull/812",
  "description": {
    "pr_info": {
      "title": "GT-3001 (#789) fix RestoreTask to safely extract files from zip.",
      "number": 812
    },
    "comment": [
      "Abstracted guts of GFileSystemExtractAllTask, reused in RestoreTask.\r\nFixed NPE in RestoreTask if restore was canceled.\r\n\r\nFixes #789. "
    ]
  },
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Defect Remediation & Feature Upgrades; **Confidence:** 0.9"
}