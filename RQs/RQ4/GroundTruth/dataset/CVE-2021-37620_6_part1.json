{
  "cve_id": "CVE-2021-37620",
  "cwe_ids": [
    "CWE-125"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "Exiv2/exiv2",
  "commit_msg": "Safer std::vector indexing.",
  "commit_hash": "76e313745e813f80e8910aceb2210af3ad8cf897",
  "git_url": "https://github.com/Exiv2/exiv2/commit/76e313745e813f80e8910aceb2210af3ad8cf897",
  "file_path": "src/actions.cpp",
  "func_name": "dontOverwrite",
  "func_before": "int dontOverwrite(const std::string& path)\n    {\n        if ( path == \"-\" ) return 0;\n\n        if (!Params::instance().force_ && Exiv2::fileExists(path)) {\n            std::cout << Params::instance().progname()\n                      << \": \" << _(\"Overwrite\") << \" `\" << path << \"'? \";\n            std::string s;\n            std::cin >> s;\n            if (s[0] != 'y' && s[0] != 'Y') return 1;\n        }\n        return 0;\n    }",
  "abstract_func_before": "int dontOverwrite(const std::string& VAR_0)\n    {\n        if ( VAR_0 == \"-\" ) return 0;\n\n        if (!Params::instance().force_ && Exiv2::fileExists(VAR_0)) {\n            std::cout << Params::instance().progname()\n                      << \": \" << _(\"Overwrite\") << \" `\" << VAR_0 << \"'? \";\n            std::string VAR_1;\n            std::cin >> VAR_1;\n            if (VAR_1[0] != 'y' && VAR_1[0] != 'Y') return 1;\n        }\n        return 0;\n    }",
  "func_graph_path_before": "Exiv2/exiv2/76e313745e813f80e8910aceb2210af3ad8cf897/actions.cpp/vul/before/1.json",
  "func": "int dontOverwrite(const std::string& path)\n    {\n        if ( path == \"-\" ) return 0;\n\n        if (!Params::instance().force_ && Exiv2::fileExists(path)) {\n            std::cout << Params::instance().progname()\n                      << \": \" << _(\"Overwrite\") << \" `\" << path << \"'? \";\n            std::string s;\n            std::cin >> s;\n            if (s.at(0) != 'y' && s.at(0) != 'Y') return 1;\n        }\n        return 0;\n    }",
  "abstract_func": "int dontOverwrite(const std::string& VAR_0)\n    {\n        if ( VAR_0 == \"-\" ) return 0;\n\n        if (!Params::instance().force_ && Exiv2::fileExists(VAR_0)) {\n            std::cout << Params::instance().progname()\n                      << \": \" << _(\"Overwrite\") << \" `\" << VAR_0 << \"'? \";\n            std::string VAR_1;\n            std::cin >> VAR_1;\n            if (VAR_1.at(0) != 'y' && VAR_1.at(0) != 'Y') return 1;\n        }\n        return 0;\n    }",
  "func_graph_path": "Exiv2/exiv2/76e313745e813f80e8910aceb2210af3ad8cf897/actions.cpp/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -7,7 +7,7 @@\n                       << \": \" << _(\"Overwrite\") << \" `\" << path << \"'? \";\n             std::string s;\n             std::cin >> s;\n-            if (s[0] != 'y' && s[0] != 'Y') return 1;\n+            if (s.at(0) != 'y' && s.at(0) != 'Y') return 1;\n         }\n         return 0;\n     }",
  "diff_line_info": {
    "deleted_lines": [
      "            if (s[0] != 'y' && s[0] != 'Y') return 1;"
    ],
    "added_lines": [
      "            if (s.at(0) != 'y' && s.at(0) != 'Y') return 1;"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/sridharb1/exiv2/pull/4",
  "description": {
    "pr_info": {
      "title": "0.27 maintenance",
      "number": 4
    },
    "comment": []
  },
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.8,
  "Bug Filter Response": "**Final Classification:** Defect Remediation & Feature Upgrades; **Confidence:** 0.8"
}