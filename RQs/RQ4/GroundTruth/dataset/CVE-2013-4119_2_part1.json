{
  "cve_id": "CVE-2013-4119",
  "cwe_ids": [
    "CWE-476"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "FreeRDP",
  "commit_msg": "nla: invalidate sec handle after creation\n\nIf sec pointer isn't invalidated after creation it is not possible\nto check if the upper and lower pointers are valid.\n\nThis fixes a segfault in the server part if the client disconnects before\nthe authentication was finished.",
  "commit_hash": "0773bb9303d24473fe1185d85a424dfe159aff53",
  "git_url": "https://github.com/FreeRDP/FreeRDP/commit/0773bb9303d24473fe1185d85a424dfe159aff53",
  "file_path": "winpr/libwinpr/sspi/sspi.c",
  "func_name": "sspi_SecureHandleGetUpperPointer",
  "func_before": "void* sspi_SecureHandleGetUpperPointer(SecHandle* handle)\n{\n\tvoid* pointer;\n\n\tif (!handle)\n\t\treturn NULL;\n\n\tpointer = (void*) ~((size_t) handle->dwUpper);\n\n\treturn pointer;\n}",
  "abstract_func_before": "void* sspi_SecureHandleGetUpperPointer(SecHandle* VAR_0)\n{\n\tvoid* VAR_1;\n\n\tif (!VAR_0)\n\t\treturn NULL;\n\n\tVAR_1 = (void*) ~((size_t) VAR_0->dwUpper);\n\n\treturn VAR_1;\n}",
  "func_graph_path_before": "FreeRDP/0773bb9303d24473fe1185d85a424dfe159aff53/sspi.c/vul/before/1.json",
  "func": "void* sspi_SecureHandleGetUpperPointer(SecHandle* handle)\n{\n\tvoid* pointer;\n\n\tif (!handle || !SecIsValidHandle(handle))\n\t\treturn NULL;\n\n\tpointer = (void*) ~((size_t) handle->dwUpper);\n\n\treturn pointer;\n}",
  "abstract_func": "void* sspi_SecureHandleGetUpperPointer(SecHandle* VAR_0)\n{\n\tvoid* VAR_1;\n\n\tif (!VAR_0 || !SecIsValidHandle(VAR_0))\n\t\treturn NULL;\n\n\tVAR_1 = (void*) ~((size_t) VAR_0->dwUpper);\n\n\treturn VAR_1;\n}",
  "func_graph_path": "FreeRDP/0773bb9303d24473fe1185d85a424dfe159aff53/sspi.c/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -2,7 +2,7 @@\n {\n \tvoid* pointer;\n \n-\tif (!handle)\n+\tif (!handle || !SecIsValidHandle(handle))\n \t\treturn NULL;\n \n \tpointer = (void*) ~((size_t) handle->dwUpper);",
  "diff_line_info": {
    "deleted_lines": [
      "\tif (!handle)"
    ],
    "added_lines": [
      "\tif (!handle || !SecIsValidHandle(handle))"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/FreeRDP/FreeRDP/pull/1330",
  "description": {
    "pr_info": {
      "title": "Misc fixes",
      "number": 1330
    },
    "comment": [
      "- updated certificate mismatch messages properly fixes #1043\n- fixed a server side segfault if client disconnects before authentication was finished\n",
      "Test PASSed.\nRefer to this link for build results: https://ci.freerdp.com/job/Github%20pull%20request%20tester/140/\n"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.9"
}