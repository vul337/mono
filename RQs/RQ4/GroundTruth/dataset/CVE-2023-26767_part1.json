{
  "cve_id": "CVE-2023-26767",
  "cwe_ids": [
    "CWE-120"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "cvss_is_v3": true,
  "repo_name": "liblouis",
  "commit_msg": "Check the length of path before copying into dataPath\n\nSee https://lwn.net/Articles/507319/ for more background on the\nsecurity problems of strcpy.\n\nFixes #1292",
  "commit_hash": "f432de31058b5a94874d47405216d07910c18a9a",
  "git_url": "https://github.com/liblouis/liblouis/commit/f432de31058b5a94874d47405216d07910c18a9a",
  "file_path": "liblouis/compileTranslationTable.c",
  "func_name": "lou_setDataPath",
  "func_before": "char *EXPORT_CALL\nlou_setDataPath(const char *path) {\n\tstatic char dataPath[MAXSTRING];\n\tdataPathPtr = NULL;\n\tif (path == NULL) return NULL;\n\tstrcpy(dataPath, path);\n\tdataPathPtr = dataPath;\n\treturn dataPathPtr;\n}",
  "abstract_func_before": "char *VAR_0\nlou_setDataPath(const char *VAR_1) {\n\tstatic char VAR_2[VAR_3];\n\tVAR_4 = NULL;\n\tif (VAR_1 == NULL) return NULL;\n\tstrcpy(VAR_2, VAR_1);\n\tVAR_4 = VAR_2;\n\treturn VAR_4;\n}",
  "func_graph_path_before": null,
  "func": "char *EXPORT_CALL\nlou_setDataPath(const char *path) {\n\tstatic char dataPath[MAXSTRING];\n\tdataPathPtr = NULL;\n\tif (path == NULL || strlen(path) >= MAXSTRING) return NULL;\n\tstrcpy(dataPath, path);\n\tdataPathPtr = dataPath;\n\treturn dataPathPtr;\n}",
  "abstract_func": "char *VAR_0\nlou_setDataPath(const char *VAR_1) {\n\tstatic char VAR_2[VAR_3];\n\tVAR_4 = NULL;\n\tif (VAR_1 == NULL || strlen(VAR_1) >= VAR_3) return NULL;\n\tstrcpy(VAR_2, VAR_1);\n\tVAR_4 = VAR_2;\n\treturn VAR_4;\n}",
  "func_graph_path": null,
  "diff_func": "--- func_before\n+++ func_after\n@@ -2,7 +2,7 @@\n lou_setDataPath(const char *path) {\n \tstatic char dataPath[MAXSTRING];\n \tdataPathPtr = NULL;\n-\tif (path == NULL) return NULL;\n+\tif (path == NULL || strlen(path) >= MAXSTRING) return NULL;\n \tstrcpy(dataPath, path);\n \tdataPathPtr = dataPath;\n \treturn dataPathPtr;",
  "diff_line_info": {
    "deleted_lines": [
      "\tif (path == NULL) return NULL;"
    ],
    "added_lines": [
      "\tif (path == NULL || strlen(path) >= MAXSTRING) return NULL;"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/liblouis/liblouis/pull/1297",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/liblouis/liblouis/pull/1297: 403 Client Error: Forbidden for url: https://api.github.com/repos/liblouis/liblouis/pulls/1297",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0"
}