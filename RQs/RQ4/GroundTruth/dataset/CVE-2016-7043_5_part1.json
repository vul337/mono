{
  "cve_id": "CVE-2016-7043",
  "cwe_ids": [
    "CWE-260"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
  "cvss_is_v3": false,
  "repo_name": "kiegroup/droolsjbpm-integration",
  "commit_msg": "[RHBMS-4312] Loading pasword from a keystore",
  "commit_hash": "e916032edd47aa46d15f3a11909b4804ee20a7e8",
  "git_url": "https://github.com/kiegroup/droolsjbpm-integration/commit/e916032edd47aa46d15f3a11909b4804ee20a7e8",
  "file_path": "kie-server-parent/kie-server-common/src/main/java/org/kie/server/common/KeyStoreHelperUtil.java",
  "func_name": "loadPassword",
  "func_before": "public static String loadPassword(KieServerConfig config) {\n        String passwordKey;\n        KeyStoreHelper keyStoreHelper = new KeyStoreHelper();\n\n        try {\n            passwordKey = keyStoreHelper.getPasswordKey();\n        } catch (RuntimeException re) {\n            logger.warn(\"Unable to load key store. Using password from configuration\");\n            passwordKey = config.getConfigItemValue(KieServerConstants.CFG_KIE_CONTROLLER_PASSWORD, \"kieserver1!\");\n        }\n\n        return passwordKey;\n    }",
  "abstract_func_before": "public static String loadPassword(KieServerConfig VAR_0) {\n        String VAR_1;\n        KeyStoreHelper VAR_2 = new KeyStoreHelper();\n\n        try {\n            VAR_1 = VAR_2.getPasswordKey();\n        } catch (RuntimeException VAR_3) {\n            VAR_4.warn(\"Unable to load key store. Using password from configuration\");\n            VAR_1 = VAR_0.getConfigItemValue(VAR_5.CFG_KIE_CONTROLLER_PASSWORD, \"kieserver1!\");\n        }\n\n        return VAR_1;\n    }",
  "func_graph_path_before": "kiegroup/droolsjbpm-integration/e916032edd47aa46d15f3a11909b4804ee20a7e8/KeyStoreHelperUtil.java/vul/before/0.json",
  "func": "public static String loadPassword() {\n        String passwordKey;\n        KeyStoreHelper keyStoreHelper = new KeyStoreHelper();\n\n        try {\n            passwordKey = keyStoreHelper.getPasswordKey();\n        } catch (RuntimeException re) {\n            logger.warn(\"Unable to load key store. Using password from configuration\");\n            passwordKey = System.getProperty(KieServerConstants.CFG_KIE_PASSWORD, \"kieserver1!\");\n        }\n\n        return passwordKey;\n    }",
  "abstract_func": "public static String loadPassword() {\n        String VAR_0;\n        KeyStoreHelper VAR_1 = new KeyStoreHelper();\n\n        try {\n            VAR_0 = VAR_1.getPasswordKey();\n        } catch (RuntimeException VAR_2) {\n            VAR_3.warn(\"Unable to load key store. Using password from configuration\");\n            VAR_0 = VAR_4.getProperty(VAR_5.CFG_KIE_PASSWORD, \"kieserver1!\");\n        }\n\n        return VAR_0;\n    }",
  "func_graph_path": "kiegroup/droolsjbpm-integration/e916032edd47aa46d15f3a11909b4804ee20a7e8/KeyStoreHelperUtil.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,4 @@\n-public static String loadPassword(KieServerConfig config) {\n+public static String loadPassword() {\n         String passwordKey;\n         KeyStoreHelper keyStoreHelper = new KeyStoreHelper();\n \n@@ -6,7 +6,7 @@\n             passwordKey = keyStoreHelper.getPasswordKey();\n         } catch (RuntimeException re) {\n             logger.warn(\"Unable to load key store. Using password from configuration\");\n-            passwordKey = config.getConfigItemValue(KieServerConstants.CFG_KIE_CONTROLLER_PASSWORD, \"kieserver1!\");\n+            passwordKey = System.getProperty(KieServerConstants.CFG_KIE_PASSWORD, \"kieserver1!\");\n         }\n \n         return passwordKey;",
  "diff_line_info": {
    "deleted_lines": [
      "public static String loadPassword(KieServerConfig config) {",
      "            passwordKey = config.getConfigItemValue(KieServerConstants.CFG_KIE_CONTROLLER_PASSWORD, \"kieserver1!\");"
    ],
    "added_lines": [
      "public static String loadPassword() {",
      "            passwordKey = System.getProperty(KieServerConstants.CFG_KIE_PASSWORD, \"kieserver1!\");"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/kiegroup/droolsjbpm-integration/pull/1273",
  "description": {
    "pr_info": {
      "title": "[RHBMS-4312] Loading pasword from a keystore",
      "number": 1273
    },
    "comment": [
      "Jira: https://issues.jboss.org/browse/RHBPMS-4312\r\n\r\nAdded loading password from a keystore also from other methods",
      "Jenkins retest this",
      "@rstancel this now has conflicts, could you please resolve"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.4,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; Confidence: 0.4  \nWait, upon reflection, since there's no explicit security mention and the change is about configuration, perhaps it's a non-security patch. Reclassifying.\n\n**Final Classification:** Supporting & Non-Core Improvements; Confidence: 0.6"
}