{
  "cve_id": "CVE-2013-4119",
  "cwe_ids": [
    "CWE-476"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "FreeRDP",
  "commit_msg": "nla: invalidate sec handle after creation\n\nIf sec pointer isn't invalidated after creation it is not possible\nto check if the upper and lower pointers are valid.\n\nThis fixes a segfault in the server part if the client disconnects before\nthe authentication was finished.",
  "commit_hash": "0773bb9303d24473fe1185d85a424dfe159aff53",
  "git_url": "https://github.com/FreeRDP/FreeRDP/commit/0773bb9303d24473fe1185d85a424dfe159aff53",
  "file_path": "winpr/libwinpr/sspi/sspi.c",
  "func_name": "DeleteSecurityContext",
  "func_before": "SECURITY_STATUS SEC_ENTRY DeleteSecurityContext(PCtxtHandle phContext)\n{\n\tchar* Name;\n\tSECURITY_STATUS status;\n\tSecurityFunctionTableA* table;\n\n\tName = (char*) sspi_SecureHandleGetUpperPointer(phContext);\n\n\tif (!Name)\n\t\treturn SEC_E_SECPKG_NOT_FOUND;\n\n\ttable = sspi_GetSecurityFunctionTableAByNameA(Name);\n\n\tif (!table)\n\t\treturn SEC_E_SECPKG_NOT_FOUND;\n\n\tif (table->DeleteSecurityContext == NULL)\n\t\treturn SEC_E_UNSUPPORTED_FUNCTION;\n\n\tstatus = table->DeleteSecurityContext(phContext);\n\n\treturn status;\n}",
  "abstract_func_before": "SECURITY_STATUS VAR_0 DeleteSecurityContext(PCtxtHandle VAR_1)\n{\n\tchar* VAR_2;\n\tSECURITY_STATUS VAR_3;\n\tSecurityFunctionTableA* VAR_4;\n\n\tVAR_2 = (char*) sspi_SecureHandleGetUpperPointer(VAR_1);\n\n\tif (!VAR_2)\n\t\treturn VAR_5;\n\n\tVAR_4 = sspi_GetSecurityFunctionTableAByNameA(VAR_2);\n\n\tif (!VAR_4)\n\t\treturn VAR_5;\n\n\tif (VAR_4->DeleteSecurityContext == NULL)\n\t\treturn VAR_6;\n\n\tVAR_3 = VAR_4->DeleteSecurityContext(VAR_1);\n\n\treturn VAR_3;\n}",
  "func_graph_path_before": null,
  "func": "SECURITY_STATUS SEC_ENTRY DeleteSecurityContext(PCtxtHandle phContext)\n{\n\tchar* Name = NULL;\n\tSECURITY_STATUS status;\n\tSecurityFunctionTableA* table;\n\n\tName = (char*) sspi_SecureHandleGetUpperPointer(phContext);\n\n\tif (!Name)\n\t\treturn SEC_E_SECPKG_NOT_FOUND;\n\n\ttable = sspi_GetSecurityFunctionTableAByNameA(Name);\n\n\tif (!table)\n\t\treturn SEC_E_SECPKG_NOT_FOUND;\n\n\tif (table->DeleteSecurityContext == NULL)\n\t\treturn SEC_E_UNSUPPORTED_FUNCTION;\n\n\tstatus = table->DeleteSecurityContext(phContext);\n\n\treturn status;\n}",
  "abstract_func": "SECURITY_STATUS VAR_0 DeleteSecurityContext(PCtxtHandle VAR_1)\n{\n\tchar* VAR_2 = NULL;\n\tSECURITY_STATUS VAR_3;\n\tSecurityFunctionTableA* VAR_4;\n\n\tVAR_2 = (char*) sspi_SecureHandleGetUpperPointer(VAR_1);\n\n\tif (!VAR_2)\n\t\treturn VAR_5;\n\n\tVAR_4 = sspi_GetSecurityFunctionTableAByNameA(VAR_2);\n\n\tif (!VAR_4)\n\t\treturn VAR_5;\n\n\tif (VAR_4->DeleteSecurityContext == NULL)\n\t\treturn VAR_6;\n\n\tVAR_3 = VAR_4->DeleteSecurityContext(VAR_1);\n\n\treturn VAR_3;\n}",
  "func_graph_path": null,
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,6 +1,6 @@\n SECURITY_STATUS SEC_ENTRY DeleteSecurityContext(PCtxtHandle phContext)\n {\n-\tchar* Name;\n+\tchar* Name = NULL;\n \tSECURITY_STATUS status;\n \tSecurityFunctionTableA* table;\n ",
  "diff_line_info": {
    "deleted_lines": [
      "\tchar* Name;"
    ],
    "added_lines": [
      "\tchar* Name = NULL;"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/FreeRDP/FreeRDP/pull/1330",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/FreeRDP/FreeRDP/pull/1330: 403 Client Error: Forbidden for url: https://api.github.com/repos/FreeRDP/FreeRDP/pulls/1330",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "The commit addresses a segfault caused by client disconnection during authentication by invalidating a handle, which prevents a server crash. This is a security fix.\n\n**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 1.0"
}