{
  "cve_id": "CVE-2017-3735",
  "cwe_ids": [
    "CWE-119"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:P/A:N",
  "cvss_is_v3": false,
  "repo_name": "openssl",
  "commit_msg": "Avoid out-of-bounds read\n\nFixes CVE 2017-3735\n\nReviewed-by: Kurt Roeckx <kurt@roeckx.be>\n(Merged from https://github.com/openssl/openssl/pull/4276)\n\n(cherry picked from commit b23171744b01e473ebbfd6edad70c1c3825ffbcd)",
  "commit_hash": "068b963bb7afc57f5bdd723de0dd15e7795d5822",
  "git_url": "https://github.com/openssl/openssl/commit/068b963bb7afc57f5bdd723de0dd15e7795d5822",
  "file_path": "crypto/x509v3/v3_addr.c",
  "func_name": "X509v3_addr_get_afi",
  "func_before": "unsigned int X509v3_addr_get_afi(const IPAddressFamily *f)\n{\n    return ((f != NULL &&\n             f->addressFamily != NULL && f->addressFamily->data != NULL)\n            ? ((f->addressFamily->data[0] << 8) | (f->addressFamily->data[1]))\n            : 0);\n}",
  "abstract_func_before": "unsigned int X509v3_addr_get_afi(const IPAddressFamily *VAR_0)\n{\n    return ((VAR_0 != NULL &&\n             VAR_0->addressFamily != NULL && VAR_0->addressFamily->data != NULL)\n            ? ((VAR_0->addressFamily->data[0] << 8) | (VAR_0->addressFamily->data[1]))\n            : 0);\n}",
  "func_graph_path_before": "openssl/068b963bb7afc57f5bdd723de0dd15e7795d5822/v3_addr.c/vul/before/0.json",
  "func": "unsigned int X509v3_addr_get_afi(const IPAddressFamily *f)\n{\n    if (f == NULL\n            || f->addressFamily == NULL\n            || f->addressFamily->data == NULL\n            || f->addressFamily->length < 2)\n        return 0;\n    return (f->addressFamily->data[0] << 8) | f->addressFamily->data[1];\n}",
  "abstract_func": "unsigned int X509v3_addr_get_afi(const IPAddressFamily *VAR_0)\n{\n    if (VAR_0 == NULL\n            || VAR_0->addressFamily == NULL\n            || VAR_0->addressFamily->data == NULL\n            || VAR_0->addressFamily->length < 2)\n        return 0;\n    return (VAR_0->addressFamily->data[0] << 8) | VAR_0->addressFamily->data[1];\n}",
  "func_graph_path": "openssl/068b963bb7afc57f5bdd723de0dd15e7795d5822/v3_addr.c/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,7 +1,9 @@\n unsigned int X509v3_addr_get_afi(const IPAddressFamily *f)\n {\n-    return ((f != NULL &&\n-             f->addressFamily != NULL && f->addressFamily->data != NULL)\n-            ? ((f->addressFamily->data[0] << 8) | (f->addressFamily->data[1]))\n-            : 0);\n+    if (f == NULL\n+            || f->addressFamily == NULL\n+            || f->addressFamily->data == NULL\n+            || f->addressFamily->length < 2)\n+        return 0;\n+    return (f->addressFamily->data[0] << 8) | f->addressFamily->data[1];\n }",
  "diff_line_info": {
    "deleted_lines": [
      "    return ((f != NULL &&",
      "             f->addressFamily != NULL && f->addressFamily->data != NULL)",
      "            ? ((f->addressFamily->data[0] << 8) | (f->addressFamily->data[1]))",
      "            : 0);"
    ],
    "added_lines": [
      "    if (f == NULL",
      "            || f->addressFamily == NULL",
      "            || f->addressFamily->data == NULL",
      "            || f->addressFamily->length < 2)",
      "        return 0;",
      "    return (f->addressFamily->data[0] << 8) | f->addressFamily->data[1];"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/EktapopaT/openssl/pull/1",
  "description": {
    "pr_info": {
      "title": "Open ssl 1 1 0 stable",
      "number": 1
    },
    "comment": [
      "<!--\r\nThank you for your pull request. Please review below requirements.\r\n\r\nContributors guide: https://github.com/openssl/openssl/blob/master/CONTRIBUTING\r\n-->\r\n\r\n##### Checklist\r\n<!-- Remove items that do not apply. For completed items, change [ ] to [x]. -->\r\n- [ ] documentation is added or updated\r\n- [ ] tests are added or updated\r\n- [ ] CLA is signed\r\n\r\n##### Description of change\r\n<!-- Provide a description of the changes.\r\n\r\nIf it fixes a github issue, add Fixes #XXXX.\r\n-->\r\n"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.95"
}