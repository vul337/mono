{
  "cve_id": "CVE-2022-25892",
  "cwe_ids": [
    "CWE-Other"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "cvss_is_v3": true,
  "repo_name": "galkahana/HummusJS",
  "commit_msg": "corrections",
  "commit_hash": "a9bf2520ab5abb69f9328906e406fbebfb36159a",
  "git_url": "https://github.com/galkahana/HummusJS/commit/a9bf2520ab5abb69f9328906e406fbebfb36159a",
  "file_path": "src/deps/PDFWriter/PDFObject.cpp",
  "func_name": "PDFObject::~PDFObject",
  "func_before": "PDFObject::~PDFObject(void)\n{\n\tStringToVoidP::iterator it = mMetadata.begin();\n\tfor (; it != mMetadata.end(); ++it) {\n\t\tdelete it->second;\n\t}\n\tmMetadata.clear();\n}",
  "abstract_func_before": "PDFObject::~VAR_0(void)\n{\n\tStringToVoidP::iterator VAR_1 = VAR_2.begin();\n\tfor (; VAR_1 != VAR_2.end(); ++VAR_1) {\n\t\tdelete VAR_1->second;\n\t}\n\tVAR_2.clear();\n}",
  "func_graph_path_before": "galkahana/HummusJS/a9bf2520ab5abb69f9328906e406fbebfb36159a/PDFObject.cpp/vul/before/4.json",
  "func": "PDFObject::~PDFObject(void)\n{\n\tStringToIDeletable::iterator it = mMetadata.begin();\n\tfor (; it != mMetadata.end(); ++it) {\n\t\tit->second->DeleteMe();\n\t}\n\tmMetadata.clear();\n}",
  "abstract_func": "PDFObject::~VAR_0(void)\n{\n\tStringToIDeletable::iterator VAR_1 = VAR_2.begin();\n\tfor (; VAR_1 != VAR_2.end(); ++VAR_1) {\n\t\tVAR_1->second->DeleteMe();\n\t}\n\tVAR_2.clear();\n}",
  "func_graph_path": "galkahana/HummusJS/a9bf2520ab5abb69f9328906e406fbebfb36159a/PDFObject.cpp/vul/after/4.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,8 +1,8 @@\n PDFObject::~PDFObject(void)\n {\n-\tStringToVoidP::iterator it = mMetadata.begin();\n+\tStringToIDeletable::iterator it = mMetadata.begin();\n \tfor (; it != mMetadata.end(); ++it) {\n-\t\tdelete it->second;\n+\t\tit->second->DeleteMe();\n \t}\n \tmMetadata.clear();\n }",
  "diff_line_info": {
    "deleted_lines": [
      "\tStringToVoidP::iterator it = mMetadata.begin();",
      "\t\tdelete it->second;"
    ],
    "added_lines": [
      "\tStringToIDeletable::iterator it = mMetadata.begin();",
      "\t\tit->second->DeleteMe();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/galkahana/HummusJS/pull/464",
  "description": {
    "pr_info": {
      "title": "Npe corrections",
      "number": 464
    },
    "comment": [
      "corrections based on discussion in:\r\nhttps://github.com/galkahana/HummusJS/issues/463\r\n\r\n+ note recommending transition to muhammara\r\n+ safe metadata release with deletable instead of void* which never got here apparently\r\n",
      "pending on travis build enablement"
    ]
  },
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.7,
  "Bug Filter Response": "The commit addresses an issue related to safely releasing metadata by changing how objects are deleted, which is a crucial fix for memory management. While it could have security implications, there's no explicit reference to a security vulnerability or CVE, making it a non-security fix aimed at defect remediation.\n\n**Final Classification:** Defect Remediation & Feature Upgrades  \n**Confidence:** 0.7"
}