{
  "cve_id": "CVE-2022-41882",
  "cwe_ids": [
    "CWE-94"
  ],
  "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "nextcloud/desktop",
  "commit_msg": "makes JsonApiJob share common code with SimpleApiJob\n\nSigned-off-by: Matthieu Gallien <matthieu.gallien@nextcloud.com>",
  "commit_hash": "615c02e3d3ee5daa62f8780e43d28bb631b55df8",
  "git_url": "https://github.com/nextcloud/desktop/commit/615c02e3d3ee5daa62f8780e43d28bb631b55df8",
  "file_path": "src/libsync/networkjobs.cpp",
  "func_name": "JsonApiJob::start",
  "func_before": "void JsonApiJob::start()\n{\n    addRawHeader(\"OCS-APIREQUEST\", \"true\");\n    auto query = _additionalParams;\n    query.addQueryItem(QLatin1String(\"format\"), QLatin1String(\"json\"));\n    QUrl url = Utility::concatUrlPath(account()->url(), path(), query);\n    const auto httpVerb = verbToString();\n    if (!_body.isEmpty()) {\n        sendRequest(httpVerb, url, _request, _body);\n    } else {\n        sendRequest(httpVerb, url, _request);\n    }\n    AbstractNetworkJob::start();\n}",
  "abstract_func_before": "void JsonApiJob::start()\n{\n    addRawHeader(\"OCS-APIREQUEST\", \"true\");\n    auto VAR_0 = VAR_1;\n    VAR_0.addQueryItem(QLatin1String(\"format\"), QLatin1String(\"json\"));\n    QUrl VAR_2 = Utility::concatUrlPath(account()->url(), path(), VAR_0);\n    const auto VAR_3 = verbToString();\n    if (!VAR_4.isEmpty()) {\n        sendRequest(VAR_3, VAR_2, VAR_5, VAR_4);\n    } else {\n        sendRequest(VAR_3, VAR_2, VAR_5);\n    }\n    AbstractNetworkJob::start();\n}",
  "func_graph_path_before": "nextcloud/desktop/615c02e3d3ee5daa62f8780e43d28bb631b55df8/networkjobs.cpp/vul/before/3.json",
  "func": "void JsonApiJob::start()\n{\n    additionalParams().addQueryItem(QLatin1String(\"format\"), QLatin1String(\"json\"));\n    SimpleApiJob::start();\n}",
  "abstract_func": "void JsonApiJob::start()\n{\n    additionalParams().addQueryItem(QLatin1String(\"format\"), QLatin1String(\"json\"));\n    SimpleApiJob::start();\n}",
  "func_graph_path": "nextcloud/desktop/615c02e3d3ee5daa62f8780e43d28bb631b55df8/networkjobs.cpp/vul/after/3.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,14 +1,5 @@\n void JsonApiJob::start()\n {\n-    addRawHeader(\"OCS-APIREQUEST\", \"true\");\n-    auto query = _additionalParams;\n-    query.addQueryItem(QLatin1String(\"format\"), QLatin1String(\"json\"));\n-    QUrl url = Utility::concatUrlPath(account()->url(), path(), query);\n-    const auto httpVerb = verbToString();\n-    if (!_body.isEmpty()) {\n-        sendRequest(httpVerb, url, _request, _body);\n-    } else {\n-        sendRequest(httpVerb, url, _request);\n-    }\n-    AbstractNetworkJob::start();\n+    additionalParams().addQueryItem(QLatin1String(\"format\"), QLatin1String(\"json\"));\n+    SimpleApiJob::start();\n }",
  "diff_line_info": {
    "deleted_lines": [
      "    addRawHeader(\"OCS-APIREQUEST\", \"true\");",
      "    auto query = _additionalParams;",
      "    query.addQueryItem(QLatin1String(\"format\"), QLatin1String(\"json\"));",
      "    QUrl url = Utility::concatUrlPath(account()->url(), path(), query);",
      "    const auto httpVerb = verbToString();",
      "    if (!_body.isEmpty()) {",
      "        sendRequest(httpVerb, url, _request, _body);",
      "    } else {",
      "        sendRequest(httpVerb, url, _request);",
      "    }",
      "    AbstractNetworkJob::start();"
    ],
    "added_lines": [
      "    additionalParams().addQueryItem(QLatin1String(\"format\"), QLatin1String(\"json\"));",
      "    SimpleApiJob::start();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/nextcloud/desktop/pull/5039",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/nextcloud/desktop/pull/5039: 403 Client Error: Forbidden for url: https://api.github.com/repos/nextcloud/desktop/pulls/5039",
  "Bug Filter": "Supporting & Non-Core Improvements",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Supporting & Non-Core Improvements  \n**Confidence:** 0.9"
}