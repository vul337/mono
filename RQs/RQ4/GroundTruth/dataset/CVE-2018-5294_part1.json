{
  "cve_id": "CVE-2018-5294",
  "cwe_ids": [
    "CWE-190"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "libming",
  "commit_msg": "Fix integer overflow vulnerability in util/read.c.\n\nThis vulnerability is caused by a regression introduced in\nd468907.\n\nIn this commit we cast the result of readUInt8(f) before left\nshifting by 24 in order to avoid out of range shift.\n\nThis commit fixes CVE-2018-5251 (fixes #98).",
  "commit_hash": "c14d07ef20c3f403fcfa59502b74c66933473431",
  "git_url": "https://github.com/libming/libming/commit/c14d07ef20c3f403fcfa59502b74c66933473431",
  "file_path": "util/read.c",
  "func_name": "readUInt32",
  "func_before": "unsigned long readUInt32(FILE *f)\n{\n  unsigned long result = 0u;\n  result |= readUInt8(f);\n  result |= readUInt8(f) << 8;\n  result |= readUInt8(f) << 16;\n  result |= readUInt8(f) << 24;\n  return result;\n}",
  "abstract_func_before": "unsigned long readUInt32(FILE *VAR_0)\n{\n  unsigned long VAR_1 = 0u;\n  VAR_1 |= readUInt8(VAR_0);\n  VAR_1 |= readUInt8(VAR_0) << 8;\n  VAR_1 |= readUInt8(VAR_0) << 16;\n  VAR_1 |= readUInt8(VAR_0) << 24;\n  return VAR_1;\n}",
  "func_graph_path_before": "libming/c14d07ef20c3f403fcfa59502b74c66933473431/read.c/vul/before/0.json",
  "func": "unsigned long readUInt32(FILE *f)\n{\n  unsigned long result = 0u;\n  result |= readUInt8(f);\n  result |= readUInt8(f) << 8;\n  result |= readUInt8(f) << 16;\n  result |= (unsigned long) readUInt8(f) << 24;\n  return result;\n}",
  "abstract_func": "unsigned long readUInt32(FILE *VAR_0)\n{\n  unsigned long VAR_1 = 0u;\n  VAR_1 |= readUInt8(VAR_0);\n  VAR_1 |= readUInt8(VAR_0) << 8;\n  VAR_1 |= readUInt8(VAR_0) << 16;\n  VAR_1 |= (unsigned long) readUInt8(VAR_0) << 24;\n  return VAR_1;\n}",
  "func_graph_path": "libming/c14d07ef20c3f403fcfa59502b74c66933473431/read.c/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -4,6 +4,6 @@\n   result |= readUInt8(f);\n   result |= readUInt8(f) << 8;\n   result |= readUInt8(f) << 16;\n-  result |= readUInt8(f) << 24;\n+  result |= (unsigned long) readUInt8(f) << 24;\n   return result;\n }",
  "diff_line_info": {
    "deleted_lines": [
      "  result |= readUInt8(f) << 24;"
    ],
    "added_lines": [
      "  result |= (unsigned long) readUInt8(f) << 24;"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/libming/libming/pull/100",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/libming/libming/pull/100: 403 Client Error: Forbidden for url: https://api.github.com/repos/libming/libming/pulls/100",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Step1: Input Analysis**  \nThe commit message mentions \"Fix integer overflow vulnerability\" and refers to CVE-2018-5251, indicating a security fix. The code diff modifies the readUInt32 function, casting the result before shifting, which addresses an integer overflow.\n\n**Step2: Consistency Check**  \nThe commit message aligns with the code change, which addresses an overflow issue. No discrepancies found.\n\n**Step3: Purpose Evaluation**  \nThe change directly fixes a security issue related to integer overflow, impacting core functionality's security.\n\n**Step4: Security Vulnerability Assessment**  \nThe fix addresses an exploit (CVE-2018-5251), preventing integer overflow by proper casting, confirming it's a security fix.\n\n**Step5: Non-Security Classification**  \nNot applicable since it's a security fix.\n\n**Step6: Confidence Scoring**  \nAll elements consistently indicate a security fix with clear intent.\n\n**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0"
}