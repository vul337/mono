{
  "cve_id": "CVE-2021-26805",
  "cwe_ids": [
    "CWE-120"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "justdan96/tsMuxer",
  "commit_msg": "Fix an invalid delete error",
  "commit_hash": "ce0a0972aad04bedd779de38b78f13b2f740178d",
  "git_url": "https://github.com/justdan96/tsMuxer/commit/ce0a0972aad04bedd779de38b78f13b2f740178d",
  "file_path": "tsMuxer/vc1Parser.h",
  "func_name": "~VC1Unit",
  "func_before": "~VC1Unit() { delete m_nalBuffer; }",
  "abstract_func_before": "~VAR_0() { delete VAR_1; }",
  "func_graph_path_before": null,
  "func": "~VC1Unit() { delete[] m_nalBuffer; }",
  "abstract_func": "~VAR_0() { delete[] VAR_1; }",
  "func_graph_path": null,
  "diff_func": "--- func_before\n+++ func_after\n@@ -1 +1 @@\n-~VC1Unit() { delete m_nalBuffer; }\n+~VC1Unit() { delete[] m_nalBuffer; }",
  "diff_line_info": {
    "deleted_lines": [
      "~VC1Unit() { delete m_nalBuffer; }"
    ],
    "added_lines": [
      "~VC1Unit() { delete[] m_nalBuffer; }"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/justdan96/tsMuxer/pull/396",
  "description": {
    "pr_info": {
      "title": "Fix an invalid delete error in vc1Parser.h",
      "number": 396
    },
    "comment": [
      "The `m_nalBuffer` member was incremented in the loop while copying, which naturally led to the pointer being invalid when the destructor is executed in order to delete the array. The code was replaced with an equivalent `std::copy` call.\r\nAlso, replaced the invalid `delete` with `delete[]`.\r\nFixes #395.",
      "What about the `delete` in line 93 ?",
      "@jcdr428 Fixed in 16a9c2885d9fdbc0499a776a2b29acee45e1d8a2."
    ]
  },
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.8,
  "Bug Filter Response": "**Final Classification:** Defect Remediation & Feature Upgrades  \n**Confidence:** 0.8\n\nThe patch addresses an incorrect memory management issue, fixing a bug without being a security vulnerability. The commitment message and code changes align, showing a clear fix for improper deletion. While it's not a security issue, it's a necessary fix for correct functionality."
}