{
  "cve_id": "CVE-2021-32687",
  "cwe_ids": [
    "CWE-190",
    "CWE-680"
  ],
  "cvss_vector": "AV:N/AC:M/Au:S/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "redis",
  "commit_msg": "Fix Integer overflow issue with intsets (CVE-2021-32687)\n\nThe vulnerability involves changing the default set-max-intset-entries\nconfiguration parameter to a very large value and constructing specially\ncrafted commands to manipulate sets",
  "commit_hash": "a30d367a71b7017581cf1ca104242a3c644dec0f",
  "git_url": "https://github.com/redis/redis/commit/a30d367a71b7017581cf1ca104242a3c644dec0f",
  "file_path": "src/intset.c",
  "func_name": "intsetResize",
  "func_before": "static intset *intsetResize(intset *is, uint32_t len) {\n    uint32_t size = len*intrev32ifbe(is->encoding);\n    is = zrealloc(is,sizeof(intset)+size);\n    return is;\n}",
  "abstract_func_before": "static intset *intsetResize(intset *VAR_0, uint32_t VAR_1) {\n    uint32_t VAR_2 = VAR_1*intrev32ifbe(VAR_0->encoding);\n    VAR_0 = zrealloc(VAR_0,sizeof(intset)+VAR_2);\n    return VAR_0;\n}",
  "func_graph_path_before": "redis/a30d367a71b7017581cf1ca104242a3c644dec0f/intset.c/vul/before/0.json",
  "func": "static intset *intsetResize(intset *is, uint32_t len) {\n    uint64_t size = (uint64_t)len*intrev32ifbe(is->encoding);\n    assert(size <= SIZE_MAX - sizeof(intset));\n    is = zrealloc(is,sizeof(intset)+size);\n    return is;\n}",
  "abstract_func": "static intset *intsetResize(intset *VAR_0, uint32_t VAR_1) {\n    uint64_t VAR_2 = (uint64_t)VAR_1*intrev32ifbe(VAR_0->encoding);\n    assert(VAR_2 <= VAR_3 - sizeof(intset));\n    VAR_0 = zrealloc(VAR_0,sizeof(intset)+VAR_2);\n    return VAR_0;\n}",
  "func_graph_path": "redis/a30d367a71b7017581cf1ca104242a3c644dec0f/intset.c/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,6 @@\n static intset *intsetResize(intset *is, uint32_t len) {\n-    uint32_t size = len*intrev32ifbe(is->encoding);\n+    uint64_t size = (uint64_t)len*intrev32ifbe(is->encoding);\n+    assert(size <= SIZE_MAX - sizeof(intset));\n     is = zrealloc(is,sizeof(intset)+size);\n     return is;\n }",
  "diff_line_info": {
    "deleted_lines": [
      "    uint32_t size = len*intrev32ifbe(is->encoding);"
    ],
    "added_lines": [
      "    uint64_t size = (uint64_t)len*intrev32ifbe(is->encoding);",
      "    assert(size <= SIZE_MAX - sizeof(intset));"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/redis/redis/pull/9584",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/redis/redis/pull/9584: 403 Client Error: Forbidden for url: https://api.github.com/repos/redis/redis/pulls/9584",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 1.0"
}