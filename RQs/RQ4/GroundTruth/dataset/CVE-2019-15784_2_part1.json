{
  "cve_id": "CVE-2019-15784",
  "cwe_ids": [
    "CWE-129"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "Haivision/srt",
  "commit_msg": "[core] CSndUList initial size is reduced to 512 elements",
  "commit_hash": "64875fa98ff6afd2f21a9727970fb4333efe95de",
  "git_url": "https://github.com/Haivision/srt/commit/64875fa98ff6afd2f21a9727970fb4333efe95de",
  "file_path": "srtcore/queue.cpp",
  "func_name": "CSndUList::CSndUList",
  "func_before": "CSndUList::CSndUList():\n    m_pHeap(NULL),\n    m_iArrayLength(4096),\n    m_iLastEntry(-1),\n    m_ListLock(),\n    m_pWindowLock(NULL),\n    m_pWindowCond(NULL),\n    m_pTimer(NULL)\n{\n    m_pHeap = new CSNode*[m_iArrayLength];\n    pthread_mutex_init(&m_ListLock, NULL);\n}",
  "abstract_func_before": "CSndUList::CSndUList():\n    m_pHeap(NULL),\n    m_iArrayLength(4096),\n    m_iLastEntry(-1),\n    m_ListLock(),\n    m_pWindowLock(NULL),\n    m_pWindowCond(NULL),\n    m_pTimer(NULL)\n{\n    VAR_0 = new CSNode*[VAR_1];\n    pthread_mutex_init(&VAR_2, NULL);\n}",
  "func_graph_path_before": "Haivision/srt/64875fa98ff6afd2f21a9727970fb4333efe95de/queue.cpp/vul/before/0.json",
  "func": "CSndUList::CSndUList():\n    m_pHeap(NULL),\n    m_iArrayLength(512),\n    m_iLastEntry(-1),\n    m_ListLock(),\n    m_pWindowLock(NULL),\n    m_pWindowCond(NULL),\n    m_pTimer(NULL)\n{\n    m_pHeap = new CSNode*[m_iArrayLength];\n    pthread_mutex_init(&m_ListLock, NULL);\n}",
  "abstract_func": "CSndUList::CSndUList():\n    m_pHeap(NULL),\n    m_iArrayLength(512),\n    m_iLastEntry(-1),\n    m_ListLock(),\n    m_pWindowLock(NULL),\n    m_pWindowCond(NULL),\n    m_pTimer(NULL)\n{\n    VAR_0 = new CSNode*[VAR_1];\n    pthread_mutex_init(&VAR_2, NULL);\n}",
  "func_graph_path": "Haivision/srt/64875fa98ff6afd2f21a9727970fb4333efe95de/queue.cpp/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,6 +1,6 @@\n CSndUList::CSndUList():\n     m_pHeap(NULL),\n-    m_iArrayLength(4096),\n+    m_iArrayLength(512),\n     m_iLastEntry(-1),\n     m_ListLock(),\n     m_pWindowLock(NULL),",
  "diff_line_info": {
    "deleted_lines": [
      "    m_iArrayLength(4096),"
    ],
    "added_lines": [
      "    m_iArrayLength(512),"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/Haivision/srt/pull/811",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/Haivision/srt/pull/811: 403 Client Error: Forbidden for url: https://api.github.com/repos/Haivision/srt/pulls/811",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.9\n\n**Step-by-Step Explanation:**\n\n1. **Commit Message Analysis:** The message indicates a core component modification, reducing the size of a list but doesn't mention security explicitly.\n\n2. **Vulnerability Description Review:** Highlights a buffer overflow issue when the list exceeds its default size, leading to out-of-bounds operations, a clear security concern.\n\n3. **Code Diff Inspection:** While the diff only shows size reduction, the description explains it's part of a fix to prevent overflow by adjusting the list's handling.\n\n4. **Security Implication:** The buffer overflow is a known security risk, making the patch a security fix despite the lack of explicit security terminology in the commit message.\n\n5. **Classification:** The fix addresses an overflow vulnerability, hence classified as a security fix with high confidence (0.9) due to the described exploit potential."
}