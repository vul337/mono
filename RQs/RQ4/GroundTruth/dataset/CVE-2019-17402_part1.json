{
  "cve_id": "CVE-2019-17402",
  "cwe_ids": [
    "CWE-120"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "Exiv2/exiv2",
  "commit_msg": "crwimage: Check offset and size against total size\n\nCorrupted or specially crafted CRW images might exceed the overall\nbuffersize.\n\nFixes #1019",
  "commit_hash": "683451567284005cd24e1ccb0a76ca401000968b",
  "git_url": "https://github.com/Exiv2/exiv2/commit/683451567284005cd24e1ccb0a76ca401000968b",
  "file_path": "src/crwimage_int.cpp",
  "func_name": "CiffDirectory::doRead",
  "func_before": "void CiffDirectory::doRead(const byte* pData,\n                               uint32_t    size,\n                               uint32_t    start,\n                               ByteOrder   byteOrder)\n    {\n        CiffComponent::doRead(pData, size, start, byteOrder);\n#ifdef EXIV2_DEBUG_MESSAGES\n        std::cout << \"Reading directory 0x\" << std::hex << tag() << \"\\n\";\n#endif\n        readDirectory(pData + offset(), this->size(), byteOrder);\n#ifdef EXIV2_DEBUG_MESSAGES\n        std::cout << \"<---- 0x\" << std::hex << tag() << \"\\n\";\n#endif\n    }",
  "abstract_func_before": "void CiffDirectory::doRead(const byte* VAR_0,\n                               uint32_t    VAR_1,\n                               uint32_t    VAR_2,\n                               ByteOrder   VAR_3)\n    {\n        CiffComponent::doRead(VAR_0, VAR_1, VAR_2, VAR_3);\n#ifdef VAR_4\n        std::cout << \"Reading directory 0x\" << std::hex << tag() << \"\\n\";\n#endif\n        readDirectory(VAR_0 + offset(), this->size(), VAR_3);\n#ifdef VAR_4\n        std::cout << \"<---- 0x\" << std::hex << tag() << \"\\n\";\n#endif\n    }",
  "func_graph_path_before": "Exiv2/exiv2/683451567284005cd24e1ccb0a76ca401000968b/crwimage_int.cpp/vul/before/0.json",
  "func": "void CiffDirectory::doRead(const byte* pData,\n                               uint32_t    size,\n                               uint32_t    start,\n                               ByteOrder   byteOrder)\n    {\n        CiffComponent::doRead(pData, size, start, byteOrder);\n#ifdef EXIV2_DEBUG_MESSAGES\n        std::cout << \"Reading directory 0x\" << std::hex << tag() << \"\\n\";\n#endif\n        if (this->offset() + this->size() > size)\n            throw Error(kerOffsetOutOfRange);\n\n        readDirectory(pData + offset(), this->size(), byteOrder);\n#ifdef EXIV2_DEBUG_MESSAGES\n        std::cout << \"<---- 0x\" << std::hex << tag() << \"\\n\";\n#endif\n    }",
  "abstract_func": "void CiffDirectory::doRead(const byte* VAR_0,\n                               uint32_t    VAR_1,\n                               uint32_t    VAR_2,\n                               ByteOrder   VAR_3)\n    {\n        CiffComponent::doRead(VAR_0, VAR_1, VAR_2, VAR_3);\n#ifdef VAR_4\n        std::cout << \"Reading directory 0x\" << std::hex << tag() << \"\\n\";\n#endif\n        if (this->offset() + this->size() > VAR_1)\n            throw Error(VAR_5);\n\n        readDirectory(VAR_0 + offset(), this->size(), VAR_3);\n#ifdef VAR_4\n        std::cout << \"<---- 0x\" << std::hex << tag() << \"\\n\";\n#endif\n    }",
  "func_graph_path": "Exiv2/exiv2/683451567284005cd24e1ccb0a76ca401000968b/crwimage_int.cpp/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -7,6 +7,9 @@\n #ifdef EXIV2_DEBUG_MESSAGES\n         std::cout << \"Reading directory 0x\" << std::hex << tag() << \"\\n\";\n #endif\n+        if (this->offset() + this->size() > size)\n+            throw Error(kerOffsetOutOfRange);\n+\n         readDirectory(pData + offset(), this->size(), byteOrder);\n #ifdef EXIV2_DEBUG_MESSAGES\n         std::cout << \"<---- 0x\" << std::hex << tag() << \"\\n\";",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "        if (this->offset() + this->size() > size)",
      "            throw Error(kerOffsetOutOfRange);",
      ""
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/Exiv2/exiv2/pull/1020",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/Exiv2/exiv2/pull/1020: 403 Client Error: Forbidden for url: https://api.github.com/repos/Exiv2/exiv2/pulls/1020",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 1.0"
}