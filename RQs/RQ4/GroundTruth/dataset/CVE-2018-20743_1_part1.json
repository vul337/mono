{
  "cve_id": "CVE-2018-20743",
  "cwe_ids": [
    "CWE-20"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "mumble-voip/mumble",
  "commit_msg": "Prevent instability and crash due to message flood\n\nThis patch adds a rate limiting to selected patches. The underlying rate limiter\nused is the Leaky-Bucket algorithm. It allows for a burst of messages, but\nlimits them after a specified amount of messages within a time frame.",
  "commit_hash": "0daec57f5cfc4225aa4527b537b4ec4fbbc35635",
  "git_url": "https://github.com/mumble-voip/mumble/commit/0daec57f5cfc4225aa4527b537b4ec4fbbc35635",
  "file_path": "src/murmur/Messages.cpp",
  "func_name": "Server::msgVersion",
  "func_before": "void Server::msgVersion(ServerUser *uSource, MumbleProto::Version &msg) {\n\tif (msg.has_version())\n\t\tuSource->uiVersion=msg.version();\n\tif (msg.has_release())\n\t\tuSource->qsRelease = u8(msg.release());\n\tif (msg.has_os()) {\n\t\tuSource->qsOS = u8(msg.os());\n\t\tif (msg.has_os_version())\n\t\t\tuSource->qsOSVersion = u8(msg.os_version());\n\t}\n\n\tlog(uSource, QString(\"Client version %1 (%2: %3)\").arg(MumbleVersion::toString(uSource->uiVersion)).arg(uSource->qsOS).arg(uSource->qsRelease));\n}",
  "abstract_func_before": "void Server::msgVersion(ServerUser *VAR_0, MumbleProto::Version &VAR_1) {\n\tif (VAR_1.has_version())\n\t\tVAR_0->uiVersion=VAR_1.version();\n\tif (VAR_1.has_release())\n\t\tVAR_0->qsRelease = u8(VAR_1.release());\n\tif (VAR_1.has_os()) {\n\t\tVAR_0->qsOS = u8(VAR_1.os());\n\t\tif (VAR_1.has_os_version())\n\t\t\tVAR_0->qsOSVersion = u8(VAR_1.os_version());\n\t}\n\n\tlog(VAR_0, QString(\"Client version %1 (%2: %3)\").arg(MumbleVersion::toString(VAR_0->uiVersion)).arg(VAR_0->qsOS).arg(VAR_0->qsRelease));\n}",
  "func_graph_path_before": "mumble-voip/mumble/0daec57f5cfc4225aa4527b537b4ec4fbbc35635/Messages.cpp/vul/before/2.json",
  "func": "void Server::msgVersion(ServerUser *uSource, MumbleProto::Version &msg) {\n\tRATELIMIT(uSource);\n\n\tif (msg.has_version())\n\t\tuSource->uiVersion=msg.version();\n\tif (msg.has_release())\n\t\tuSource->qsRelease = u8(msg.release());\n\tif (msg.has_os()) {\n\t\tuSource->qsOS = u8(msg.os());\n\t\tif (msg.has_os_version())\n\t\t\tuSource->qsOSVersion = u8(msg.os_version());\n\t}\n\n\tlog(uSource, QString(\"Client version %1 (%2: %3)\").arg(MumbleVersion::toString(uSource->uiVersion)).arg(uSource->qsOS).arg(uSource->qsRelease));\n}",
  "abstract_func": "void Server::msgVersion(ServerUser *VAR_0, MumbleProto::Version &VAR_1) {\n\tRATELIMIT(VAR_0);\n\n\tif (VAR_1.has_version())\n\t\tVAR_0->uiVersion=VAR_1.version();\n\tif (VAR_1.has_release())\n\t\tVAR_0->qsRelease = u8(VAR_1.release());\n\tif (VAR_1.has_os()) {\n\t\tVAR_0->qsOS = u8(VAR_1.os());\n\t\tif (VAR_1.has_os_version())\n\t\t\tVAR_0->qsOSVersion = u8(VAR_1.os_version());\n\t}\n\n\tlog(VAR_0, QString(\"Client version %1 (%2: %3)\").arg(MumbleVersion::toString(VAR_0->uiVersion)).arg(VAR_0->qsOS).arg(VAR_0->qsRelease));\n}",
  "func_graph_path": "mumble-voip/mumble/0daec57f5cfc4225aa4527b537b4ec4fbbc35635/Messages.cpp/vul/after/2.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,6 @@\n void Server::msgVersion(ServerUser *uSource, MumbleProto::Version &msg) {\n+\tRATELIMIT(uSource);\n+\n \tif (msg.has_version())\n \t\tuSource->uiVersion=msg.version();\n \tif (msg.has_release())",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "\tRATELIMIT(uSource);",
      ""
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/mumble-voip/mumble/pull/3510",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/mumble-voip/mumble/pull/3510: 403 Client Error: Forbidden for url: https://api.github.com/repos/mumble-voip/mumble/pulls/3510",
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Defect Remediation & Feature Upgrades; **Confidence:** 0.9"
}