{
  "cve_id": "CVE-2020-15475",
  "cwe_ids": [
    "CWE-416"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "ntop/nDPI",
  "commit_msg": "Fixed use after free caused by dangling pointer\n\n * This fix also improved RCE Injection detection\n\nSigned-off-by: Toni Uhlig <matzeton@googlemail.com>",
  "commit_hash": "6a9f5e4f7c3fd5ddab3e6727b071904d76773952",
  "git_url": "https://github.com/ntop/nDPI/commit/6a9f5e4f7c3fd5ddab3e6727b071904d76773952",
  "file_path": "src/lib/ndpi_main.c",
  "func_name": "ndpi_reset_packet_line_info",
  "func_before": "static void ndpi_reset_packet_line_info(struct ndpi_packet_struct *packet) {\n  packet->parsed_lines = 0, packet->empty_line_position_set = 0, packet->host_line.ptr = NULL,\n    packet->host_line.len = 0, packet->referer_line.ptr = NULL, packet->referer_line.len = 0,\n    packet->content_line.ptr = NULL, packet->content_line.len = 0, packet->accept_line.ptr = NULL,\n    packet->accept_line.len = 0, packet->user_agent_line.ptr = NULL, packet->user_agent_line.len = 0,\n    packet->http_url_name.ptr = NULL, packet->http_url_name.len = 0, packet->http_encoding.ptr = NULL,\n    packet->http_encoding.len = 0, packet->http_transfer_encoding.ptr = NULL, packet->http_transfer_encoding.len = 0,\n    packet->http_contentlen.ptr = NULL, packet->http_contentlen.len = 0, packet->http_cookie.ptr = NULL,\n    packet->http_cookie.len = 0, packet->http_origin.len = 0, packet->http_origin.ptr = NULL,\n    packet->http_x_session_type.ptr = NULL, packet->http_x_session_type.len = 0, packet->server_line.ptr = NULL,\n    packet->server_line.len = 0, packet->http_method.ptr = NULL, packet->http_method.len = 0,\n    packet->http_response.ptr = NULL, packet->http_response.len = 0, packet->http_num_headers = 0;\n}",
  "abstract_func_before": "static void ndpi_reset_packet_line_info(struct ndpi_packet_struct *VAR_0) {\n  VAR_0->parsed_lines = 0, VAR_0->empty_line_position_set = 0, VAR_0->host_line.ptr = NULL,\n    VAR_0->host_line.len = 0, VAR_0->referer_line.ptr = NULL, VAR_0->referer_line.len = 0,\n    VAR_0->content_line.ptr = NULL, VAR_0->content_line.len = 0, VAR_0->accept_line.ptr = NULL,\n    VAR_0->accept_line.len = 0, VAR_0->user_agent_line.ptr = NULL, VAR_0->user_agent_line.len = 0,\n    VAR_0->http_url_name.ptr = NULL, VAR_0->http_url_name.len = 0, VAR_0->http_encoding.ptr = NULL,\n    VAR_0->http_encoding.len = 0, VAR_0->http_transfer_encoding.ptr = NULL, VAR_0->http_transfer_encoding.len = 0,\n    VAR_0->http_contentlen.ptr = NULL, VAR_0->http_contentlen.len = 0, VAR_0->http_cookie.ptr = NULL,\n    VAR_0->http_cookie.len = 0, VAR_0->http_origin.len = 0, VAR_0->http_origin.ptr = NULL,\n    VAR_0->http_x_session_type.ptr = NULL, VAR_0->http_x_session_type.len = 0, VAR_0->server_line.ptr = NULL,\n    VAR_0->server_line.len = 0, VAR_0->http_method.ptr = NULL, VAR_0->http_method.len = 0,\n    VAR_0->http_response.ptr = NULL, VAR_0->http_response.len = 0, VAR_0->http_num_headers = 0;\n}",
  "func_graph_path_before": "ntop/nDPI/6a9f5e4f7c3fd5ddab3e6727b071904d76773952/ndpi_main.c/vul/before/0.json",
  "func": "static void ndpi_reset_packet_line_info(struct ndpi_packet_struct *packet) {\n  packet->parsed_lines = 0, packet->empty_line_position_set = 0, packet->host_line.ptr = NULL,\n    packet->host_line.len = 0, packet->referer_line.ptr = NULL, packet->referer_line.len = 0,\n    packet->content_line.ptr = NULL, packet->content_line.len = 0, packet->accept_line.ptr = NULL,\n    packet->accept_line.len = 0, packet->user_agent_line.ptr = NULL, packet->user_agent_line.len = 0,\n    packet->http_url_name.ptr = NULL, packet->http_url_name.len = 0, packet->http_encoding.ptr = NULL,\n    packet->http_encoding.len = 0, packet->http_transfer_encoding.ptr = NULL, packet->http_transfer_encoding.len = 0,\n    packet->http_contentlen.ptr = NULL, packet->http_contentlen.len = 0, packet->content_disposition_line.ptr = NULL,\n    packet->content_disposition_line.len = 0, packet->http_cookie.ptr = NULL,\n    packet->http_cookie.len = 0, packet->http_origin.len = 0, packet->http_origin.ptr = NULL,\n    packet->http_x_session_type.ptr = NULL, packet->http_x_session_type.len = 0, packet->server_line.ptr = NULL,\n    packet->server_line.len = 0, packet->http_method.ptr = NULL, packet->http_method.len = 0,\n    packet->http_response.ptr = NULL, packet->http_response.len = 0, packet->http_num_headers = 0;\n}",
  "abstract_func": "static void ndpi_reset_packet_line_info(struct ndpi_packet_struct *VAR_0) {\n  VAR_0->parsed_lines = 0, VAR_0->empty_line_position_set = 0, VAR_0->host_line.ptr = NULL,\n    VAR_0->host_line.len = 0, VAR_0->referer_line.ptr = NULL, VAR_0->referer_line.len = 0,\n    VAR_0->content_line.ptr = NULL, VAR_0->content_line.len = 0, VAR_0->accept_line.ptr = NULL,\n    VAR_0->accept_line.len = 0, VAR_0->user_agent_line.ptr = NULL, VAR_0->user_agent_line.len = 0,\n    VAR_0->http_url_name.ptr = NULL, VAR_0->http_url_name.len = 0, VAR_0->http_encoding.ptr = NULL,\n    VAR_0->http_encoding.len = 0, VAR_0->http_transfer_encoding.ptr = NULL, VAR_0->http_transfer_encoding.len = 0,\n    VAR_0->http_contentlen.ptr = NULL, VAR_0->http_contentlen.len = 0, VAR_0->content_disposition_line.ptr = NULL,\n    VAR_0->content_disposition_line.len = 0, VAR_0->http_cookie.ptr = NULL,\n    VAR_0->http_cookie.len = 0, VAR_0->http_origin.len = 0, VAR_0->http_origin.ptr = NULL,\n    VAR_0->http_x_session_type.ptr = NULL, VAR_0->http_x_session_type.len = 0, VAR_0->server_line.ptr = NULL,\n    VAR_0->server_line.len = 0, VAR_0->http_method.ptr = NULL, VAR_0->http_method.len = 0,\n    VAR_0->http_response.ptr = NULL, VAR_0->http_response.len = 0, VAR_0->http_num_headers = 0;\n}",
  "func_graph_path": "ntop/nDPI/6a9f5e4f7c3fd5ddab3e6727b071904d76773952/ndpi_main.c/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -5,7 +5,8 @@\n     packet->accept_line.len = 0, packet->user_agent_line.ptr = NULL, packet->user_agent_line.len = 0,\n     packet->http_url_name.ptr = NULL, packet->http_url_name.len = 0, packet->http_encoding.ptr = NULL,\n     packet->http_encoding.len = 0, packet->http_transfer_encoding.ptr = NULL, packet->http_transfer_encoding.len = 0,\n-    packet->http_contentlen.ptr = NULL, packet->http_contentlen.len = 0, packet->http_cookie.ptr = NULL,\n+    packet->http_contentlen.ptr = NULL, packet->http_contentlen.len = 0, packet->content_disposition_line.ptr = NULL,\n+    packet->content_disposition_line.len = 0, packet->http_cookie.ptr = NULL,\n     packet->http_cookie.len = 0, packet->http_origin.len = 0, packet->http_origin.ptr = NULL,\n     packet->http_x_session_type.ptr = NULL, packet->http_x_session_type.len = 0, packet->server_line.ptr = NULL,\n     packet->server_line.len = 0, packet->http_method.ptr = NULL, packet->http_method.len = 0,",
  "diff_line_info": {
    "deleted_lines": [
      "    packet->http_contentlen.ptr = NULL, packet->http_contentlen.len = 0, packet->http_cookie.ptr = NULL,"
    ],
    "added_lines": [
      "    packet->http_contentlen.ptr = NULL, packet->http_contentlen.len = 0, packet->content_disposition_line.ptr = NULL,",
      "    packet->content_disposition_line.len = 0, packet->http_cookie.ptr = NULL,"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/ntop/nDPI/pull/922",
  "description": {
    "pr_info": {
      "title": "Fixed use after free caused by dangling pointer",
      "number": 922
    },
    "comment": [
      " * This fix also improved RCE Injection detection\r\n\r\nSigned-off-by: Toni Uhlig <matzeton@googlemail.com>",
      "Thank you"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.9"
}