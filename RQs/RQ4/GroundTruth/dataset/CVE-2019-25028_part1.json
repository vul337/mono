{
  "cve_id": "CVE-2019-25028",
  "cwe_ids": [
    "CWE-79"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
  "cvss_is_v3": false,
  "repo_name": "vaadin/framework",
  "commit_msg": "Sanitize input used in Grid header",
  "commit_hash": "c40bed109c3723b38694ed160ea647fef5b28593",
  "git_url": "https://github.com/vaadin/framework/commit/c40bed109c3723b38694ed160ea647fef5b28593",
  "file_path": "server/src/main/java/com/vaadin/ui/Grid.java",
  "func_name": "setCaption",
  "func_before": "public Column<T, V> setCaption(String caption) {\n            Objects.requireNonNull(caption, \"Header caption can't be null\");\n            caption = Jsoup.clean(caption, Whitelist.none());\n            if (caption.equals(getState(false).caption)) {\n                return this;\n            }\n            getState().caption = caption;\n\n            HeaderRow row = getGrid().getDefaultHeaderRow();\n            if (row != null) {\n                row.getCell(this).setText(caption);\n            }\n\n            return this;\n        }",
  "abstract_func_before": "public Column<T, V> setCaption(String VAR_0) {\n            VAR_1.requireNonNull(VAR_0, \"Header caption can't be null\");\n            VAR_0 = VAR_2.clean(VAR_0, VAR_3.none());\n            if (VAR_0.equals(getState(false).caption)) {\n                return this;\n            }\n            getState().caption = VAR_0;\n\n            HeaderRow VAR_4 = getGrid().getDefaultHeaderRow();\n            if (VAR_4 != null) {\n                VAR_4.getCell(this).setText(VAR_0);\n            }\n\n            return this;\n        }",
  "func_graph_path_before": "vaadin/framework/c40bed109c3723b38694ed160ea647fef5b28593/Grid.java/vul/before/0.json",
  "func": "public Column<T, V> setCaption(String caption) {\n            Objects.requireNonNull(caption, \"Header caption can't be null\");\n            caption = Jsoup.parse(caption).text();\n            if (caption.equals(getState(false).caption)) {\n                return this;\n            }\n            getState().caption = caption;\n\n            HeaderRow row = getGrid().getDefaultHeaderRow();\n            if (row != null) {\n                row.getCell(this).setText(caption);\n            }\n\n            return this;\n        }",
  "abstract_func": "public Column<T, V> setCaption(String VAR_0) {\n            VAR_1.requireNonNull(VAR_0, \"Header caption can't be null\");\n            VAR_0 = VAR_2.parse(VAR_0).text();\n            if (VAR_0.equals(getState(false).caption)) {\n                return this;\n            }\n            getState().caption = VAR_0;\n\n            HeaderRow VAR_3 = getGrid().getDefaultHeaderRow();\n            if (VAR_3 != null) {\n                VAR_3.getCell(this).setText(VAR_0);\n            }\n\n            return this;\n        }",
  "func_graph_path": "vaadin/framework/c40bed109c3723b38694ed160ea647fef5b28593/Grid.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,6 +1,6 @@\n public Column<T, V> setCaption(String caption) {\n             Objects.requireNonNull(caption, \"Header caption can't be null\");\n-            caption = Jsoup.clean(caption, Whitelist.none());\n+            caption = Jsoup.parse(caption).text();\n             if (caption.equals(getState(false).caption)) {\n                 return this;\n             }",
  "diff_line_info": {
    "deleted_lines": [
      "            caption = Jsoup.clean(caption, Whitelist.none());"
    ],
    "added_lines": [
      "            caption = Jsoup.parse(caption).text();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/vaadin/framework/pull/11644",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/vaadin/framework/pull/11644: 403 Client Error: Forbidden for url: https://api.github.com/repos/vaadin/framework/pulls/11644",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.85,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 0.85"
}