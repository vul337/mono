{
  "cve_id": "CVE-2017-5495",
  "cwe_ids": [
    "CWE-119"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:N/A:C",
  "cvss_is_v3": false,
  "repo_name": "FRRouting/frr",
  "commit_msg": "lib: limit size of vty buffer to 4096 bytes\n\nThis removes the automatic resizing of the vty input buffer and places a\nhard size cap of 4096 bytes. It also fixes a potentially unsafe strcpy.\n\nSigned-off-by: Quentin Young <qlyoung@cumulusnetworks.com>",
  "commit_hash": "2af38873d89e20bd039255418366c1601aa99e64",
  "git_url": "https://github.com/FRRouting/frr/commit/2af38873d89e20bd039255418366c1601aa99e64",
  "file_path": "lib/vty.c",
  "func_name": "vty_self_insert_overwrite",
  "func_before": "static void\nvty_self_insert_overwrite (struct vty *vty, char c)\n{\n  vty_ensure (vty, vty->length + 1);\n  vty->buf[vty->cp++] = c;\n\n  if (vty->cp > vty->length)\n    vty->length++;\n\n  if ((vty->node == AUTH_NODE) || (vty->node == AUTH_ENABLE_NODE))\n    return;\n\n  vty_write (vty, &c, 1);\n}",
  "abstract_func_before": "static void\nvty_self_insert_overwrite (struct vty *vty, char VAR_0)\n{\n  vty_ensure (vty, vty->length + 1);\n  vty->buf[vty->cp++] = VAR_0;\n\n  if (vty->cp > vty->length)\n    vty->length++;\n\n  if ((vty->node == VAR_1) || (vty->node == VAR_2))\n    return;\n\n  vty_write (vty, &VAR_0, 1);\n}",
  "func_graph_path_before": "FRRouting/frr/2af38873d89e20bd039255418366c1601aa99e64/vty.c/vul/before/1.json",
  "func": "static void\nvty_self_insert_overwrite (struct vty *vty, char c)\n{\n  if (vty->cp == vty->length)\n    {\n      vty_self_insert (vty, c);\n      return;\n    }\n\n  vty->buf[vty->cp++] = c;\n  vty_write (vty, &c, 1);\n}",
  "abstract_func": "static void\nvty_self_insert_overwrite (struct vty *vty, char VAR_0)\n{\n  if (vty->cp == vty->length)\n    {\n      vty_self_insert (vty, VAR_0);\n      return;\n    }\n\n  vty->buf[vty->cp++] = VAR_0;\n  vty_write (vty, &VAR_0, 1);\n}",
  "func_graph_path": "FRRouting/frr/2af38873d89e20bd039255418366c1601aa99e64/vty.c/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,14 +1,12 @@\n static void\n vty_self_insert_overwrite (struct vty *vty, char c)\n {\n-  vty_ensure (vty, vty->length + 1);\n+  if (vty->cp == vty->length)\n+    {\n+      vty_self_insert (vty, c);\n+      return;\n+    }\n+\n   vty->buf[vty->cp++] = c;\n-\n-  if (vty->cp > vty->length)\n-    vty->length++;\n-\n-  if ((vty->node == AUTH_NODE) || (vty->node == AUTH_ENABLE_NODE))\n-    return;\n-\n   vty_write (vty, &c, 1);\n }",
  "diff_line_info": {
    "deleted_lines": [
      "  vty_ensure (vty, vty->length + 1);",
      "",
      "  if (vty->cp > vty->length)",
      "    vty->length++;",
      "",
      "  if ((vty->node == AUTH_NODE) || (vty->node == AUTH_ENABLE_NODE))",
      "    return;",
      ""
    ],
    "added_lines": [
      "  if (vty->cp == vty->length)",
      "    {",
      "      vty_self_insert (vty, c);",
      "      return;",
      "    }",
      ""
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/FRRouting/frr/pull/63",
  "description": {
    "pr_info": {
      "title": "lib: limit size of vty buffer to 4096 bytes",
      "number": 63
    },
    "comment": [
      "This removes the automatic resizing of the vty input buffer and places a\r\nhard size cap of 4096 bytes. It also fixes a potentially unsafe strcpy.\r\n\r\nSigned-off-by: Quentin Young <qlyoung@cumulusnetworks.com>",
      "# Continous Integration Result: SUCCESSFUL\n\nCongratulations, this patch passed basic tests\n\nTested-by: NetDEF / OpenSourceRouting.org CI System\n\n__CI System Testrun URL: https://ci1.netdef.org/browse/FRR-FRRPULLREQ-34/__\n\nThis is a comment from an EXPERIMENTAL automated CI system.\nFor questions and feedback in regards to this CI system, please feel free to email\nMartin Winter - mwinter (at) opensourcerouting.org.\n\n",
      "This is [CVE-2017-5495](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5495)"
    ]
  },
  "Bug Filter": "** Security Vulnerability Fix  \n**Confidence Score:** 0.95",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "\n\nThe patch addresses a buffer overflow vulnerability by limiting the vty buffer size and fixing an unsafe strcpy. This prevents potential attacks leading to unauthorized access or code execution.\n\n**Final Classification:** Security Vulnerability Fix  \n**Confidence Score:** 0.95"
}