{
  "cve_id": "CVE-2018-8005",
  "cwe_ids": [
    "CWE-400"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "apache/trafficserver",
  "commit_msg": "Adds a new configuration proxy.config.http.allow_multi_range\n\nThis is needed to prevent potential abuse with well formed multi-\nrange requests.",
  "commit_hash": "6d248026b04d69e5c5049709c17ea671328ea4ea",
  "git_url": "https://github.com/apache/trafficserver/commit/6d248026b04d69e5c5049709c17ea671328ea4ea",
  "file_path": "proxy/http/HttpConfig.h",
  "func_name": "OverridableHttpConfigParams",
  "func_before": "OverridableHttpConfigParams()\n    : maintain_pristine_host_hdr(1),\n      chunking_enabled(1),\n      negative_caching_enabled(0),\n      negative_revalidating_enabled(0),\n      cache_when_to_revalidate(0),\n      keep_alive_enabled_in(1),\n      keep_alive_enabled_out(1),\n      keep_alive_post_out(1),\n      server_session_sharing_match(TS_SERVER_SESSION_SHARING_MATCH_BOTH),\n      auth_server_session_private(1),\n      fwd_proxy_auth_to_parent(0),\n      uncacheable_requests_bypass_parent(1),\n      attach_server_session_to_client(0),\n      forward_connect_method(0),\n      insert_age_in_response(1),\n      anonymize_remove_from(0),\n      anonymize_remove_referer(0),\n      anonymize_remove_user_agent(0),\n      anonymize_remove_cookie(0),\n      anonymize_remove_client_ip(0),\n      anonymize_insert_client_ip(1),\n      proxy_response_server_enabled(1),\n      proxy_response_hsts_include_subdomains(0),\n      insert_squid_x_forwarded_for(1),\n      insert_forwarded(HttpForwarded::OptionBitSet()),\n      send_http11_requests(1),\n      cache_http(1),\n      cache_ignore_client_no_cache(1),\n      cache_ignore_client_cc_max_age(0),\n      cache_ims_on_client_no_cache(1),\n      cache_ignore_server_no_cache(0),\n      cache_responses_to_cookies(1),\n      cache_ignore_auth(0),\n      cache_urls_that_look_dynamic(1),\n      cache_required_headers(2),\n      cache_range_lookup(1),\n      cache_range_write(0),\n      cache_enable_default_vary_headers(0),\n      ignore_accept_mismatch(0),\n      ignore_accept_language_mismatch(0),\n      ignore_accept_encoding_mismatch(0),\n      ignore_accept_charset_mismatch(0),\n      insert_request_via_string(1),\n      insert_response_via_string(0),\n      doc_in_cache_skip_dns(1),\n      flow_control_enabled(0),\n      normalize_ae(0),\n      srv_enabled(0),\n      parent_failures_update_hostdb(0),\n      cache_open_write_fail_action(0),\n      post_check_content_length_enabled(1),\n      ssl_client_verify_server(0),\n      redirect_use_orig_cache_key(0),\n      number_of_redirections(0),\n      proxy_response_hsts_max_age(-1),\n      negative_caching_lifetime(1800),\n      negative_revalidating_lifetime(1800),\n      sock_recv_buffer_size_out(0),\n      sock_send_buffer_size_out(0),\n      sock_option_flag_out(0),\n      sock_packet_mark_out(0),\n      sock_packet_tos_out(0),\n      server_tcp_init_cwnd(0),\n      request_hdr_max_size(131072),\n      response_hdr_max_size(131072),\n      cache_heuristic_min_lifetime(3600),\n      cache_heuristic_max_lifetime(86400),\n      cache_guaranteed_min_lifetime(0),\n      cache_guaranteed_max_lifetime(31536000),\n      cache_max_stale_age(604800),\n      keep_alive_no_activity_timeout_in(120),\n      keep_alive_no_activity_timeout_out(120),\n      transaction_no_activity_timeout_in(30),\n      transaction_no_activity_timeout_out(30),\n      transaction_active_timeout_out(0),\n      transaction_active_timeout_in(900),\n      websocket_active_timeout(3600),\n      websocket_inactive_timeout(600),\n      origin_max_connections(0),\n      origin_max_connections_queue(0),\n      connect_attempts_max_retries(0),\n      connect_attempts_max_retries_dead_server(3),\n      connect_attempts_rr_retries(3),\n      connect_attempts_timeout(30),\n      post_connect_attempts_timeout(1800),\n      parent_connect_attempts(4),\n      parent_retry_time(300),\n      parent_fail_threshold(10),\n      per_parent_connect_attempts(2),\n      parent_connect_timeout(30),\n      down_server_timeout(300),\n      client_abort_threshold(10),\n      max_cache_open_read_retries(-1),\n      cache_open_read_retry_time(10),\n      cache_generation_number(-1),\n      max_cache_open_write_retries(1),\n      background_fill_active_timeout(60),\n      http_chunking_size(4096),\n      flow_high_water_mark(0),\n      flow_low_water_mark(0),\n      default_buffer_size_index(8),\n      default_buffer_water_mark(32768),\n      slow_log_threshold(0),\n      body_factory_template_base(NULL),\n      body_factory_template_base_len(0),\n      proxy_response_server_string(NULL),\n      proxy_response_server_string_len(0),\n      global_user_agent_header(NULL),\n      global_user_agent_header_size(0),\n      cache_heuristic_lm_factor(0.10),\n      background_fill_threshold(0.5),\n      client_cert_filename(NULL),\n      client_cert_filepath(NULL),\n      cache_vary_default_text(NULL),\n      cache_vary_default_images(NULL),\n      cache_vary_default_other(NULL)\n  {\n  }",
  "abstract_func_before": "OverridableHttpConfigParams()\n    : maintain_pristine_host_hdr(1),\n      chunking_enabled(1),\n      negative_caching_enabled(0),\n      negative_revalidating_enabled(0),\n      cache_when_to_revalidate(0),\n      keep_alive_enabled_in(1),\n      keep_alive_enabled_out(1),\n      keep_alive_post_out(1),\n      server_session_sharing_match(VAR_0),\n      auth_server_session_private(1),\n      fwd_proxy_auth_to_parent(0),\n      uncacheable_requests_bypass_parent(1),\n      attach_server_session_to_client(0),\n      forward_connect_method(0),\n      insert_age_in_response(1),\n      anonymize_remove_from(0),\n      anonymize_remove_referer(0),\n      anonymize_remove_user_agent(0),\n      anonymize_remove_cookie(0),\n      anonymize_remove_client_ip(0),\n      anonymize_insert_client_ip(1),\n      proxy_response_server_enabled(1),\n      proxy_response_hsts_include_subdomains(0),\n      insert_squid_x_forwarded_for(1),\n      insert_forwarded(VAR_1::OptionBitSet()),\n      send_http11_requests(1),\n      cache_http(1),\n      cache_ignore_client_no_cache(1),\n      cache_ignore_client_cc_max_age(0),\n      cache_ims_on_client_no_cache(1),\n      cache_ignore_server_no_cache(0),\n      cache_responses_to_cookies(1),\n      cache_ignore_auth(0),\n      cache_urls_that_look_dynamic(1),\n      cache_required_headers(2),\n      cache_range_lookup(1),\n      cache_range_write(0),\n      cache_enable_default_vary_headers(0),\n      ignore_accept_mismatch(0),\n      ignore_accept_language_mismatch(0),\n      ignore_accept_encoding_mismatch(0),\n      ignore_accept_charset_mismatch(0),\n      insert_request_via_string(1),\n      insert_response_via_string(0),\n      doc_in_cache_skip_dns(1),\n      flow_control_enabled(0),\n      normalize_ae(0),\n      srv_enabled(0),\n      parent_failures_update_hostdb(0),\n      cache_open_write_fail_action(0),\n      post_check_content_length_enabled(1),\n      ssl_client_verify_server(0),\n      redirect_use_orig_cache_key(0),\n      number_of_redirections(0),\n      proxy_response_hsts_max_age(-1),\n      negative_caching_lifetime(1800),\n      negative_revalidating_lifetime(1800),\n      sock_recv_buffer_size_out(0),\n      sock_send_buffer_size_out(0),\n      sock_option_flag_out(0),\n      sock_packet_mark_out(0),\n      sock_packet_tos_out(0),\n      server_tcp_init_cwnd(0),\n      request_hdr_max_size(131072),\n      response_hdr_max_size(131072),\n      cache_heuristic_min_lifetime(3600),\n      cache_heuristic_max_lifetime(86400),\n      cache_guaranteed_min_lifetime(0),\n      cache_guaranteed_max_lifetime(31536000),\n      cache_max_stale_age(604800),\n      keep_alive_no_activity_timeout_in(120),\n      keep_alive_no_activity_timeout_out(120),\n      transaction_no_activity_timeout_in(30),\n      transaction_no_activity_timeout_out(30),\n      transaction_active_timeout_out(0),\n      transaction_active_timeout_in(900),\n      websocket_active_timeout(3600),\n      websocket_inactive_timeout(600),\n      origin_max_connections(0),\n      origin_max_connections_queue(0),\n      connect_attempts_max_retries(0),\n      connect_attempts_max_retries_dead_server(3),\n      connect_attempts_rr_retries(3),\n      connect_attempts_timeout(30),\n      post_connect_attempts_timeout(1800),\n      parent_connect_attempts(4),\n      parent_retry_time(300),\n      parent_fail_threshold(10),\n      per_parent_connect_attempts(2),\n      parent_connect_timeout(30),\n      down_server_timeout(300),\n      client_abort_threshold(10),\n      max_cache_open_read_retries(-1),\n      cache_open_read_retry_time(10),\n      cache_generation_number(-1),\n      max_cache_open_write_retries(1),\n      background_fill_active_timeout(60),\n      http_chunking_size(4096),\n      flow_high_water_mark(0),\n      flow_low_water_mark(0),\n      default_buffer_size_index(8),\n      default_buffer_water_mark(32768),\n      slow_log_threshold(0),\n      body_factory_template_base(NULL),\n      body_factory_template_base_len(0),\n      proxy_response_server_string(NULL),\n      proxy_response_server_string_len(0),\n      global_user_agent_header(NULL),\n      global_user_agent_header_size(0),\n      cache_heuristic_lm_factor(0.10),\n      background_fill_threshold(0.5),\n      client_cert_filename(NULL),\n      client_cert_filepath(NULL),\n      cache_vary_default_text(NULL),\n      cache_vary_default_images(NULL),\n      cache_vary_default_other(NULL)\n  {\n  }",
  "func_graph_path_before": null,
  "func": "OverridableHttpConfigParams()\n    : maintain_pristine_host_hdr(1),\n      chunking_enabled(1),\n      negative_caching_enabled(0),\n      negative_revalidating_enabled(0),\n      cache_when_to_revalidate(0),\n      keep_alive_enabled_in(1),\n      keep_alive_enabled_out(1),\n      keep_alive_post_out(1),\n      server_session_sharing_match(TS_SERVER_SESSION_SHARING_MATCH_BOTH),\n      auth_server_session_private(1),\n      fwd_proxy_auth_to_parent(0),\n      uncacheable_requests_bypass_parent(1),\n      attach_server_session_to_client(0),\n      forward_connect_method(0),\n      insert_age_in_response(1),\n      anonymize_remove_from(0),\n      anonymize_remove_referer(0),\n      anonymize_remove_user_agent(0),\n      anonymize_remove_cookie(0),\n      anonymize_remove_client_ip(0),\n      anonymize_insert_client_ip(1),\n      proxy_response_server_enabled(1),\n      proxy_response_hsts_include_subdomains(0),\n      insert_squid_x_forwarded_for(1),\n      insert_forwarded(HttpForwarded::OptionBitSet()),\n      send_http11_requests(1),\n      cache_http(1),\n      cache_ignore_client_no_cache(1),\n      cache_ignore_client_cc_max_age(0),\n      cache_ims_on_client_no_cache(1),\n      cache_ignore_server_no_cache(0),\n      cache_responses_to_cookies(1),\n      cache_ignore_auth(0),\n      cache_urls_that_look_dynamic(1),\n      cache_required_headers(2),\n      cache_range_lookup(1),\n      cache_range_write(0),\n      allow_multi_range(1),\n      cache_enable_default_vary_headers(0),\n      ignore_accept_mismatch(0),\n      ignore_accept_language_mismatch(0),\n      ignore_accept_encoding_mismatch(0),\n      ignore_accept_charset_mismatch(0),\n      insert_request_via_string(1),\n      insert_response_via_string(0),\n      doc_in_cache_skip_dns(1),\n      flow_control_enabled(0),\n      normalize_ae(0),\n      srv_enabled(0),\n      parent_failures_update_hostdb(0),\n      cache_open_write_fail_action(0),\n      post_check_content_length_enabled(1),\n      ssl_client_verify_server(0),\n      redirect_use_orig_cache_key(0),\n      number_of_redirections(0),\n      proxy_response_hsts_max_age(-1),\n      negative_caching_lifetime(1800),\n      negative_revalidating_lifetime(1800),\n      sock_recv_buffer_size_out(0),\n      sock_send_buffer_size_out(0),\n      sock_option_flag_out(0),\n      sock_packet_mark_out(0),\n      sock_packet_tos_out(0),\n      server_tcp_init_cwnd(0),\n      request_hdr_max_size(131072),\n      response_hdr_max_size(131072),\n      cache_heuristic_min_lifetime(3600),\n      cache_heuristic_max_lifetime(86400),\n      cache_guaranteed_min_lifetime(0),\n      cache_guaranteed_max_lifetime(31536000),\n      cache_max_stale_age(604800),\n      keep_alive_no_activity_timeout_in(120),\n      keep_alive_no_activity_timeout_out(120),\n      transaction_no_activity_timeout_in(30),\n      transaction_no_activity_timeout_out(30),\n      transaction_active_timeout_out(0),\n      transaction_active_timeout_in(900),\n      websocket_active_timeout(3600),\n      websocket_inactive_timeout(600),\n      origin_max_connections(0),\n      origin_max_connections_queue(0),\n      connect_attempts_max_retries(0),\n      connect_attempts_max_retries_dead_server(3),\n      connect_attempts_rr_retries(3),\n      connect_attempts_timeout(30),\n      post_connect_attempts_timeout(1800),\n      parent_connect_attempts(4),\n      parent_retry_time(300),\n      parent_fail_threshold(10),\n      per_parent_connect_attempts(2),\n      parent_connect_timeout(30),\n      down_server_timeout(300),\n      client_abort_threshold(10),\n      max_cache_open_read_retries(-1),\n      cache_open_read_retry_time(10),\n      cache_generation_number(-1),\n      max_cache_open_write_retries(1),\n      background_fill_active_timeout(60),\n      http_chunking_size(4096),\n      flow_high_water_mark(0),\n      flow_low_water_mark(0),\n      default_buffer_size_index(8),\n      default_buffer_water_mark(32768),\n      slow_log_threshold(0),\n      body_factory_template_base(NULL),\n      body_factory_template_base_len(0),\n      proxy_response_server_string(NULL),\n      proxy_response_server_string_len(0),\n      global_user_agent_header(NULL),\n      global_user_agent_header_size(0),\n      cache_heuristic_lm_factor(0.10),\n      background_fill_threshold(0.5),\n      client_cert_filename(NULL),\n      client_cert_filepath(NULL),\n      cache_vary_default_text(NULL),\n      cache_vary_default_images(NULL),\n      cache_vary_default_other(NULL)\n  {\n  }",
  "abstract_func": "OverridableHttpConfigParams()\n    : maintain_pristine_host_hdr(1),\n      chunking_enabled(1),\n      negative_caching_enabled(0),\n      negative_revalidating_enabled(0),\n      cache_when_to_revalidate(0),\n      keep_alive_enabled_in(1),\n      keep_alive_enabled_out(1),\n      keep_alive_post_out(1),\n      server_session_sharing_match(VAR_0),\n      auth_server_session_private(1),\n      fwd_proxy_auth_to_parent(0),\n      uncacheable_requests_bypass_parent(1),\n      attach_server_session_to_client(0),\n      forward_connect_method(0),\n      insert_age_in_response(1),\n      anonymize_remove_from(0),\n      anonymize_remove_referer(0),\n      anonymize_remove_user_agent(0),\n      anonymize_remove_cookie(0),\n      anonymize_remove_client_ip(0),\n      anonymize_insert_client_ip(1),\n      proxy_response_server_enabled(1),\n      proxy_response_hsts_include_subdomains(0),\n      insert_squid_x_forwarded_for(1),\n      insert_forwarded(VAR_1::OptionBitSet()),\n      send_http11_requests(1),\n      cache_http(1),\n      cache_ignore_client_no_cache(1),\n      cache_ignore_client_cc_max_age(0),\n      cache_ims_on_client_no_cache(1),\n      cache_ignore_server_no_cache(0),\n      cache_responses_to_cookies(1),\n      cache_ignore_auth(0),\n      cache_urls_that_look_dynamic(1),\n      cache_required_headers(2),\n      cache_range_lookup(1),\n      cache_range_write(0),\n      allow_multi_range(1),\n      cache_enable_default_vary_headers(0),\n      ignore_accept_mismatch(0),\n      ignore_accept_language_mismatch(0),\n      ignore_accept_encoding_mismatch(0),\n      ignore_accept_charset_mismatch(0),\n      insert_request_via_string(1),\n      insert_response_via_string(0),\n      doc_in_cache_skip_dns(1),\n      flow_control_enabled(0),\n      normalize_ae(0),\n      srv_enabled(0),\n      parent_failures_update_hostdb(0),\n      cache_open_write_fail_action(0),\n      post_check_content_length_enabled(1),\n      ssl_client_verify_server(0),\n      redirect_use_orig_cache_key(0),\n      number_of_redirections(0),\n      proxy_response_hsts_max_age(-1),\n      negative_caching_lifetime(1800),\n      negative_revalidating_lifetime(1800),\n      sock_recv_buffer_size_out(0),\n      sock_send_buffer_size_out(0),\n      sock_option_flag_out(0),\n      sock_packet_mark_out(0),\n      sock_packet_tos_out(0),\n      server_tcp_init_cwnd(0),\n      request_hdr_max_size(131072),\n      response_hdr_max_size(131072),\n      cache_heuristic_min_lifetime(3600),\n      cache_heuristic_max_lifetime(86400),\n      cache_guaranteed_min_lifetime(0),\n      cache_guaranteed_max_lifetime(31536000),\n      cache_max_stale_age(604800),\n      keep_alive_no_activity_timeout_in(120),\n      keep_alive_no_activity_timeout_out(120),\n      transaction_no_activity_timeout_in(30),\n      transaction_no_activity_timeout_out(30),\n      transaction_active_timeout_out(0),\n      transaction_active_timeout_in(900),\n      websocket_active_timeout(3600),\n      websocket_inactive_timeout(600),\n      origin_max_connections(0),\n      origin_max_connections_queue(0),\n      connect_attempts_max_retries(0),\n      connect_attempts_max_retries_dead_server(3),\n      connect_attempts_rr_retries(3),\n      connect_attempts_timeout(30),\n      post_connect_attempts_timeout(1800),\n      parent_connect_attempts(4),\n      parent_retry_time(300),\n      parent_fail_threshold(10),\n      per_parent_connect_attempts(2),\n      parent_connect_timeout(30),\n      down_server_timeout(300),\n      client_abort_threshold(10),\n      max_cache_open_read_retries(-1),\n      cache_open_read_retry_time(10),\n      cache_generation_number(-1),\n      max_cache_open_write_retries(1),\n      background_fill_active_timeout(60),\n      http_chunking_size(4096),\n      flow_high_water_mark(0),\n      flow_low_water_mark(0),\n      default_buffer_size_index(8),\n      default_buffer_water_mark(32768),\n      slow_log_threshold(0),\n      body_factory_template_base(NULL),\n      body_factory_template_base_len(0),\n      proxy_response_server_string(NULL),\n      proxy_response_server_string_len(0),\n      global_user_agent_header(NULL),\n      global_user_agent_header_size(0),\n      cache_heuristic_lm_factor(0.10),\n      background_fill_threshold(0.5),\n      client_cert_filename(NULL),\n      client_cert_filepath(NULL),\n      cache_vary_default_text(NULL),\n      cache_vary_default_images(NULL),\n      cache_vary_default_other(NULL)\n  {\n  }",
  "func_graph_path": null,
  "diff_func": "--- func_before\n+++ func_after\n@@ -36,6 +36,7 @@\n       cache_required_headers(2),\n       cache_range_lookup(1),\n       cache_range_write(0),\n+      allow_multi_range(1),\n       cache_enable_default_vary_headers(0),\n       ignore_accept_mismatch(0),\n       ignore_accept_language_mismatch(0),",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "      allow_multi_range(1),"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/apache/trafficserver/pull/3106",
  "description": {
    "pr_info": {
      "title": "Adds a new configuration proxy.config.http.allow_multi_range",
      "number": 3106
    },
    "comment": [
      "This is needed to prevent potential abuse with well formed multi-\r\nrange requests.",
      "This has many, but trivial, merge conflicts, primarily due to clang-formatting.",
      "Cheery-picked to 7.1.3"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix  \nConfidence Score: 0.8  \n\n**Analysis:**  \nThe patch introduces a new configuration to prevent potential abuse from multi-range HTTP requests, indicating a proactive security measure. While the code change is adding a configuration, the commit message suggests addressing a potential security issue, leading to the classification as a Security Vulnerability Fix. The confidence is moderate due to the proactive nature of the fix rather than resolving an existing exploit.",
  "Bug Filter Confidence": 0.8,
  "Bug Filter Response": "\n\nFinal Classification: Security Vulnerability Fix  \nConfidence Score: 0.8  \n\n**Analysis:**  \nThe patch introduces a new configuration to prevent potential abuse from multi-range HTTP requests, indicating a proactive security measure. While the code change is adding a configuration, the commit message suggests addressing a potential security issue, leading to the classification as a Security Vulnerability Fix. The confidence is moderate due to the proactive nature of the fix rather than resolving an existing exploit."
}