{
  "cve_id": "CVE-2023-25826",
  "cwe_ids": [
    "CWE-78"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "OpenTSDB/opentsdb",
  "commit_msg": "Improved fix for #2261.\nRegular expressions wouldn't catch the newlines or possibly other\ncontrol characters. Now we'll use the TAG validation code to make\nsure the inputs are only plain ASCII printables first.\nFixes CVE-2018-12972, CVE-2020-35476",
  "commit_hash": "26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25",
  "git_url": "https://github.com/OpenTSDB/opentsdb/commit/26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25",
  "file_path": "test/tsd/TestGraphHandler.java",
  "func_name": "setColorParams",
  "func_before": "@Test\n  public void setColorParams() throws Exception {\n    assertPlotParam(\"bgcolor\", \"x000000\");\n    assertPlotParam(\"bgcolor\", \"XDEADBE\");\n    assertPlotParam(\"bgcolor\", \"%58DEADBE\");\n    assertInvalidPlotParam(\"bgcolor\", \"XDEADBEF\");\n    assertInvalidPlotParam(\"bgcolor\", \"%5BDEADBE\");\n\n    assertPlotParam(\"fgcolor\", \"x000000\");\n    assertPlotParam(\"fgcolor\", \"XDEADBE\");\n    assertPlotParam(\"fgcolor\", \"%58DEADBE\");\n    assertInvalidPlotParam(\"fgcolor\", \"XDEADBEF\");\n    assertInvalidPlotParam(\"fgcolor\", \"%5BDEADBE\");\n  }",
  "abstract_func_before": "@Test\n  public void setColorParams() throws Exception {\n    assertPlotParam(\"bgcolor\", \"x000000\");\n    assertPlotParam(\"bgcolor\", \"XDEADBE\");\n    assertPlotParam(\"bgcolor\", \"%58DEADBE\");\n    assertInvalidPlotParam(\"bgcolor\", \"XDEADBEF\");\n    assertInvalidPlotParam(\"bgcolor\", \"%5BDEADBE\");\n\n    assertPlotParam(\"fgcolor\", \"x000000\");\n    assertPlotParam(\"fgcolor\", \"XDEADBE\");\n    assertPlotParam(\"fgcolor\", \"%58DEADBE\");\n    assertInvalidPlotParam(\"fgcolor\", \"XDEADBEF\");\n    assertInvalidPlotParam(\"fgcolor\", \"%5BDEADBE\");\n  }",
  "func_graph_path_before": "OpenTSDB/opentsdb/26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25/TestGraphHandler.java/vul/before/5.json",
  "func": "@Test\n  public void setColorParams() throws Exception {\n    assertPlotParam(\"bgcolor\", \"x000000\");\n    assertPlotParam(\"bgcolor\", \"XDEADBE\");\n    assertPlotParam(\"bgcolor\", \"%58DEADBE\");\n    assertInvalidPlotParam(\"bgcolor\", \"XDEADBEF\");\n    assertInvalidPlotParam(\"bgcolor\", \"%5BDEADBE\");\n    assertInvalidPlotParam(\"bgcolor\", \"xBDE%0AAD\");\n\n    assertPlotParam(\"fgcolor\", \"x000000\");\n    assertPlotParam(\"fgcolor\", \"XDEADBE\");\n    assertPlotParam(\"fgcolor\", \"%58DEADBE\");\n    assertInvalidPlotParam(\"fgcolor\", \"XDEADBEF\");\n    assertInvalidPlotParam(\"fgcolor\", \"%5BDEADBE\");\n    assertInvalidPlotParam(\"fgcolor\", \"xBDE%0AAD\");\n  }",
  "abstract_func": "@Test\n  public void setColorParams() throws Exception {\n    assertPlotParam(\"bgcolor\", \"x000000\");\n    assertPlotParam(\"bgcolor\", \"XDEADBE\");\n    assertPlotParam(\"bgcolor\", \"%58DEADBE\");\n    assertInvalidPlotParam(\"bgcolor\", \"XDEADBEF\");\n    assertInvalidPlotParam(\"bgcolor\", \"%5BDEADBE\");\n    assertInvalidPlotParam(\"bgcolor\", \"xBDE%0AAD\");\n\n    assertPlotParam(\"fgcolor\", \"x000000\");\n    assertPlotParam(\"fgcolor\", \"XDEADBE\");\n    assertPlotParam(\"fgcolor\", \"%58DEADBE\");\n    assertInvalidPlotParam(\"fgcolor\", \"XDEADBEF\");\n    assertInvalidPlotParam(\"fgcolor\", \"%5BDEADBE\");\n    assertInvalidPlotParam(\"fgcolor\", \"xBDE%0AAD\");\n  }",
  "func_graph_path": "OpenTSDB/opentsdb/26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25/TestGraphHandler.java/vul/after/5.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -5,10 +5,12 @@\n     assertPlotParam(\"bgcolor\", \"%58DEADBE\");\n     assertInvalidPlotParam(\"bgcolor\", \"XDEADBEF\");\n     assertInvalidPlotParam(\"bgcolor\", \"%5BDEADBE\");\n+    assertInvalidPlotParam(\"bgcolor\", \"xBDE%0AAD\");\n \n     assertPlotParam(\"fgcolor\", \"x000000\");\n     assertPlotParam(\"fgcolor\", \"XDEADBE\");\n     assertPlotParam(\"fgcolor\", \"%58DEADBE\");\n     assertInvalidPlotParam(\"fgcolor\", \"XDEADBEF\");\n     assertInvalidPlotParam(\"fgcolor\", \"%5BDEADBE\");\n+    assertInvalidPlotParam(\"fgcolor\", \"xBDE%0AAD\");\n   }",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "    assertInvalidPlotParam(\"bgcolor\", \"xBDE%0AAD\");",
      "    assertInvalidPlotParam(\"fgcolor\", \"xBDE%0AAD\");"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/OpenTSDB/opentsdb/pull/2275",
  "description": {
    "pr_info": {
      "title": "Improved fix for #2261.",
      "number": 2275
    },
    "comment": [
      "Regular expressions wouldn't catch the newlines or possibly other control characters. Now we'll use the TAG validation code to make sure the inputs are only plain ASCII printables first. Fixes CVE-2018-12972, CVE-2020-35476",
      "@manolama - this seems to fix the [RCE we reported](https://github.com/OpenTSDB/opentsdb/issues/2261) before Synopsis on Dec 12, 2022. Seems like they have also issued a CVE for the vulnerability we found. Could you please open a Github security advisory? Thanks."
    ]
  },
  "Bug Filter": "Security Vulnerability Fix  \nConfidence Score: 1.0",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "\n\n**Final Output:**\n\nAnalysis: The patch addresses security vulnerabilities by enhancing input validation to prevent unauthorized access through crafted inputs. The changes fix known CVEs, indicating a security issue.\n\nFinal Classification: Security Vulnerability Fix  \nConfidence Score: 1.0"
}