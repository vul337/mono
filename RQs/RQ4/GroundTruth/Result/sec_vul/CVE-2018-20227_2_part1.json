{
  "cve_id": "CVE-2018-20227",
  "cwe_ids": [
    "CWE-22"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "eclipse-rdf4j/rdf4j",
  "commit_msg": "Verify that zip file entries don't try to escape the parent dir + test\n\nSigned-off-by: Bart Hanssens <bart.hanssens@bosa.fgov.be>",
  "commit_hash": "df15a4d7a8f2789c043b27c9eafe1b30316cfa79",
  "git_url": "https://github.com/eclipse-rdf4j/rdf4j/commit/df15a4d7a8f2789c043b27c9eafe1b30316cfa79",
  "file_path": "util/src/main/java/org/eclipse/rdf4j/common/io/ZipUtil.java",
  "func_name": "extract",
  "func_before": "public static void extract(ZipFile zipFile, File destDir)\n\t\tthrows IOException\n\t{\n\t\tassert destDir.isDirectory();\n\n\t\tEnumeration<? extends ZipEntry> entries = zipFile.entries();\n\t\twhile (entries.hasMoreElements()) {\n\t\t\tZipEntry entry = entries.nextElement();\n\t\t\twriteEntry(zipFile, entry, destDir);\n\t\t}\n\t}",
  "abstract_func_before": "public static void extract(ZipFile VAR_0, File VAR_1)\n\t\tthrows IOException\n\t{\n\t\tassert VAR_1.isDirectory();\n\n\t\tEnumeration<? extends ZipEntry> VAR_2 = VAR_0.entries();\n\t\twhile (VAR_2.hasMoreElements()) {\n\t\t\tZipEntry VAR_3 = VAR_2.nextElement();\n\t\t\twriteEntry(VAR_0, VAR_3, VAR_1);\n\t\t}\n\t}",
  "func_graph_path_before": "eclipse-rdf4j/rdf4j/df15a4d7a8f2789c043b27c9eafe1b30316cfa79/ZipUtil.java/vul/before/3.json",
  "func": "public static void extract(ZipFile zipFile, File destDir) throws IOException {\n\t\tassert destDir.isDirectory();\n\n\t\tEnumeration<? extends ZipEntry> entries = zipFile.entries();\n\t\twhile (entries.hasMoreElements()) {\n\t\t\tZipEntry entry = entries.nextElement();\n\t\t\twriteEntry(zipFile, entry, destDir);\n\t\t}\n\t}",
  "abstract_func": "public static void extract(ZipFile VAR_0, File VAR_1) throws IOException {\n\t\tassert VAR_1.isDirectory();\n\n\t\tEnumeration<? extends ZipEntry> VAR_2 = VAR_0.entries();\n\t\twhile (VAR_2.hasMoreElements()) {\n\t\t\tZipEntry VAR_3 = VAR_2.nextElement();\n\t\t\twriteEntry(VAR_0, VAR_3, VAR_1);\n\t\t}\n\t}",
  "func_graph_path": "eclipse-rdf4j/rdf4j/df15a4d7a8f2789c043b27c9eafe1b30316cfa79/ZipUtil.java/vul/after/3.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,6 +1,4 @@\n-public static void extract(ZipFile zipFile, File destDir)\n-\t\tthrows IOException\n-\t{\n+public static void extract(ZipFile zipFile, File destDir) throws IOException {\n \t\tassert destDir.isDirectory();\n \n \t\tEnumeration<? extends ZipEntry> entries = zipFile.entries();",
  "diff_line_info": {
    "deleted_lines": [
      "public static void extract(ZipFile zipFile, File destDir)",
      "\t\tthrows IOException",
      "\t{"
    ],
    "added_lines": [
      "public static void extract(ZipFile zipFile, File destDir) throws IOException {"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/eclipse-rdf4j/rdf4j/pull/1211",
  "description": {
    "pr_info": {
      "title": "Verify that zip file entries don't try to escape the parent dir + test",
      "number": 1211
    },
    "comment": [
      "This PR addresses GitHub issue: #1210 .\r\n\r\nBriefly describe the changes proposed in this PR:\r\n\r\n* Check if zip file entries try to 'escape' / 'break out' of the directory  (i.e. tricks like `../../../etc/`)\r\n* Added test to check if a file \r\n* Minor code formatting\r\n",
      "Great that you made tests!"
    ]
  },
  "Bug Filter": "** Security Vulnerability Fix  \n**Confidence Score:** 0.9",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "\n\nThe patch addresses a security vulnerability by preventing directory traversal during zip file extraction. The commit message explicitly states this intent, and the code change, though limited in the diff, aligns with the goal of enhancing security.\n\n**Final Classification:** Security Vulnerability Fix  \n**Confidence Score:** 0.9"
}