{
  "cve_id": "CVE-2017-1000207",
  "cwe_ids": [
    "CWE-502"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "swagger-api/swagger-parser",
  "commit_msg": "parser change.",
  "commit_hash": "4c6584306b40de9b2dfa9065c3a438cd918534af",
  "git_url": "https://github.com/swagger-api/swagger-parser/commit/4c6584306b40de9b2dfa9065c3a438cd918534af",
  "file_path": "modules/swagger-parser/src/main/java/io/swagger/parser/util/DeserializationUtils.java",
  "func_name": "readYamlValue",
  "func_before": "public static <T> T readYamlValue(String contents, Class<T> expectedType) {\n        org.yaml.snakeyaml.Yaml yaml = new org.yaml.snakeyaml.Yaml();\n        return Json.mapper().convertValue(yaml.load(contents), expectedType);\n    }",
  "abstract_func_before": "public static <T> T readYamlValue(String VAR_0, Class<T> VAR_1) {\n        org.yaml.snakeyaml.Yaml VAR_2 = new org.yaml.snakeyaml.Yaml();\n        return VAR_3.mapper().convertValue(VAR_2.load(VAR_0), VAR_1);\n    }",
  "func_graph_path_before": "swagger-api/swagger-parser/4c6584306b40de9b2dfa9065c3a438cd918534af/DeserializationUtils.java/vul/before/0.json",
  "func": "public static <T> T readYamlValue(String contents, Class<T> expectedType) {\n        org.yaml.snakeyaml.Yaml yaml = new org.yaml.snakeyaml.Yaml(new SafeConstructor());\n        return Json.mapper().convertValue(yaml.load(contents), expectedType);\n    }",
  "abstract_func": "public static <T> T readYamlValue(String VAR_0, Class<T> VAR_1) {\n        org.yaml.snakeyaml.Yaml VAR_2 = new org.yaml.snakeyaml.Yaml(new SafeConstructor());\n        return VAR_3.mapper().convertValue(VAR_2.load(VAR_0), VAR_1);\n    }",
  "func_graph_path": "swagger-api/swagger-parser/4c6584306b40de9b2dfa9065c3a438cd918534af/DeserializationUtils.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,4 @@\n public static <T> T readYamlValue(String contents, Class<T> expectedType) {\n-        org.yaml.snakeyaml.Yaml yaml = new org.yaml.snakeyaml.Yaml();\n+        org.yaml.snakeyaml.Yaml yaml = new org.yaml.snakeyaml.Yaml(new SafeConstructor());\n         return Json.mapper().convertValue(yaml.load(contents), expectedType);\n     }",
  "diff_line_info": {
    "deleted_lines": [
      "        org.yaml.snakeyaml.Yaml yaml = new org.yaml.snakeyaml.Yaml();"
    ],
    "added_lines": [
      "        org.yaml.snakeyaml.Yaml yaml = new org.yaml.snakeyaml.Yaml(new SafeConstructor());"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/swagger-api/swagger-parser/pull/481",
  "description": {
    "pr_info": {
      "title": "parser change.",
      "number": 481
    },
    "comment": [
      "Issue found by running custom written query on lgtm.com (as discussed by email with @fehguy: https://lgtm.com/query/2023830455/project:24760076/lang:java/",
      "Many thanks!  Tests look good."
    ]
  },
  "Bug Filter": "Security Vulnerability Fix\nConfidence Score: 0.95",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "\n\nThe patch changes the YAML parser to use a safe constructor, mitigating a deserialization vulnerability. This falls under security as it prevents unauthorized code execution.\n\n**Final Output:**\nAnalysis: The patch modifies the YAML parser to use SafeConstructor, addressing a potential deserialization vulnerability. This change enhances security by preventing unauthorized code execution.\nFinal Classification: Security Vulnerability Fix\nConfidence Score: 0.95"
}