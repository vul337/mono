{
  "cve_id": "CVE-2021-32694",
  "cwe_ids": [
    "CWE-248"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "nextcloud/android",
  "commit_msg": "Do not crash if wrong deep login url is used\n\nSigned-off-by: tobiasKaminsky <tobias@kaminsky.me>",
  "commit_hash": "9343bdd85d70625a90e0c952897957a102c2421b",
  "git_url": "https://github.com/nextcloud/android/commit/9343bdd85d70625a90e0c952897957a102c2421b",
  "file_path": "src/main/java/com/owncloud/android/authentication/AuthenticatorActivity.java",
  "func_name": "parseAndLoginFromWebView",
  "func_before": "private void parseAndLoginFromWebView(String dataString) {\n        String prefix = getString(R.string.login_data_own_scheme) + PROTOCOL_SUFFIX + \"login/\";\n        LoginUrlInfo loginUrlInfo = parseLoginDataUrl(prefix, dataString);\n\n        try {\n            if (mHostUrlInput != null) {\n                mHostUrlInput.setText(\"\");\n            }\n            mServerInfo.mBaseUrl = AuthenticatorUrlUtils.normalizeUrlSuffix(loginUrlInfo.serverAddress);\n            webViewUser = loginUrlInfo.username;\n            webViewPassword = loginUrlInfo.password;\n        } catch (Exception e) {\n            mServerStatusIcon = R.drawable.ic_alert;\n            mServerStatusText = getString(R.string.qr_could_not_be_read);\n            showServerStatus();\n        }\n        checkOcServer();\n    }",
  "abstract_func_before": "private void parseAndLoginFromWebView(String VAR_0) {\n        String VAR_1 = getString(VAR_2.string.login_data_own_scheme) + VAR_3 + \"login/\";\n        LoginUrlInfo VAR_4 = parseLoginDataUrl(VAR_1, VAR_0);\n\n        try {\n            if (VAR_5 != null) {\n                VAR_5.setText(\"\");\n            }\n            VAR_6.mBaseUrl = VAR_7.normalizeUrlSuffix(VAR_4.serverAddress);\n            VAR_8 = VAR_4.username;\n            VAR_9 = VAR_4.password;\n        } catch (Exception VAR_10) {\n            VAR_11 = VAR_2.drawable.ic_alert;\n            VAR_12 = getString(VAR_2.string.qr_could_not_be_read);\n            showServerStatus();\n        }\n        checkOcServer();\n    }",
  "func_graph_path_before": "nextcloud/android/9343bdd85d70625a90e0c952897957a102c2421b/AuthenticatorActivity.java/vul/before/0.json",
  "func": "private void parseAndLoginFromWebView(String dataString) {\n        try {\n            String prefix = getString(R.string.login_data_own_scheme) + PROTOCOL_SUFFIX + \"login/\";\n            LoginUrlInfo loginUrlInfo = parseLoginDataUrl(prefix, dataString);\n\n            if (mHostUrlInput != null) {\n                mHostUrlInput.setText(\"\");\n            }\n            mServerInfo.mBaseUrl = AuthenticatorUrlUtils.normalizeUrlSuffix(loginUrlInfo.serverAddress);\n            webViewUser = loginUrlInfo.username;\n            webViewPassword = loginUrlInfo.password;\n        } catch (Exception e) {\n            mServerStatusIcon = R.drawable.ic_alert;\n            mServerStatusText = getString(R.string.qr_could_not_be_read);\n            showServerStatus();\n        }\n        checkOcServer();\n    }",
  "abstract_func": "private void parseAndLoginFromWebView(String VAR_0) {\n        try {\n            String VAR_1 = getString(VAR_2.string.login_data_own_scheme) + VAR_3 + \"login/\";\n            LoginUrlInfo VAR_4 = parseLoginDataUrl(VAR_1, VAR_0);\n\n            if (VAR_5 != null) {\n                VAR_5.setText(\"\");\n            }\n            VAR_6.mBaseUrl = VAR_7.normalizeUrlSuffix(VAR_4.serverAddress);\n            VAR_8 = VAR_4.username;\n            VAR_9 = VAR_4.password;\n        } catch (Exception VAR_10) {\n            VAR_11 = VAR_2.drawable.ic_alert;\n            VAR_12 = getString(VAR_2.string.qr_could_not_be_read);\n            showServerStatus();\n        }\n        checkOcServer();\n    }",
  "func_graph_path": "nextcloud/android/9343bdd85d70625a90e0c952897957a102c2421b/AuthenticatorActivity.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,8 +1,8 @@\n private void parseAndLoginFromWebView(String dataString) {\n-        String prefix = getString(R.string.login_data_own_scheme) + PROTOCOL_SUFFIX + \"login/\";\n-        LoginUrlInfo loginUrlInfo = parseLoginDataUrl(prefix, dataString);\n+        try {\n+            String prefix = getString(R.string.login_data_own_scheme) + PROTOCOL_SUFFIX + \"login/\";\n+            LoginUrlInfo loginUrlInfo = parseLoginDataUrl(prefix, dataString);\n \n-        try {\n             if (mHostUrlInput != null) {\n                 mHostUrlInput.setText(\"\");\n             }",
  "diff_line_info": {
    "deleted_lines": [
      "        String prefix = getString(R.string.login_data_own_scheme) + PROTOCOL_SUFFIX + \"login/\";",
      "        LoginUrlInfo loginUrlInfo = parseLoginDataUrl(prefix, dataString);",
      "        try {"
    ],
    "added_lines": [
      "        try {",
      "            String prefix = getString(R.string.login_data_own_scheme) + PROTOCOL_SUFFIX + \"login/\";",
      "            LoginUrlInfo loginUrlInfo = parseLoginDataUrl(prefix, dataString);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/nextcloud/android/pull/7919",
  "description": {
    "pr_info": {
      "title": "Do not crash if wrong deep login url is used",
      "number": 7919
    },
    "comment": [
      "Signed-off-by: tobiasKaminsky <tobias@kaminsky.me>\r\n\r\n### Testing \r\nWriting tests is very important. Please try to write some tests for your PR. \r\nIf you need help, please do not hesitate to ask in this PR for help.\r\n\r\n[unit tests](https://github.com/nextcloud/android/blob/master/CONTRIBUTING.md#unit-tests)\r\n[instrumented tests](https://github.com/nextcloud/android/blob/master/CONTRIBUTING.md#instrumented-tests)\r\n[UI tests](https://github.com/nextcloud/android/blob/master/CONTRIBUTING.md#ui-tests)\r\n\r\n- [x] Tests written, or not not needed\r\n",
      "/backport to stable-3.15",
      "APK file: https://www.kaminsky.me/nc-dev/android-artifacts/7919.apk <br/><br/> ![qrcode](https://www.kaminsky.me/nc-dev/android-artifacts/7919.png) <br/><br/>To test this change/fix you can simply download above APK file and install and test it in parallel to your existing Nextcloud app. ",
      "<h1>Codacy</h1> <h1>Lint</h1><table width='500' cellpadding='5' cellspacing='2'><tr class='tablerow0'><td>Type</td><td><a href='https://www.kaminsky.me/nc-dev/android-lint/master.html'>master</a></td><td><a href='https://www.kaminsky.me/nc-dev/android-lint/510.html'>PR</a></td></tr><tr class='tablerow1'><td>Warnings</td><td>243</td><td>243</td></tr><tr class='tablerow0'><td>Errors</td><td>0</td><td>0</td></tr></table> <h1><a href='https://www.kaminsky.me/nc-dev/android-findbugs/510.html'>SpotBugs</a> (new)</h1><table width='500' cellpadding='5' cellspacing='2'><tr class='tableheader'><th align='left'>Warning Type</th><th align='right'>Number</th></tr><tr class='tablerow0'><td>Bad practice Warnings</td><td align='right'>27</td></tr><tr class='tablerow1'><td>Correctness Warnings</td><td align='right'>52</td></tr><tr class='tablerow0'><td>Internationalization Warnings</td><td align='right'>9</td></tr><tr class='tablerow1'><td>Multithreaded correctness Warnings</td><td align='right'>9</td></tr><tr class='tablerow0'><td>Performance Warnings</td><td align='right'>73</td></tr><tr class='tablerow1'><td>Security Warnings</td><td align='right'>41</td></tr><tr class='tablerow0'><td>Dodgy code Warnings</td><td align='right'>99</td></tr><tr class='tablerow1'><td><b>Total</b></td><td align='right'><b>310</b></td></tr></table> <h1><a href='https://www.kaminsky.me/nc-dev/android-findbugs/master.html'>SpotBugs</a> (master)</h1><table width='500' cellpadding='5' cellspacing='2'><tr class='tableheader'><th align='left'>Warning Type</th><th align='right'>Number</th></tr><tr class='tablerow0'><td>Bad practice Warnings</td><td align='right'>27</td></tr><tr class='tablerow1'><td>Correctness Warnings</td><td align='right'>52</td></tr><tr class='tablerow0'><td>Internationalization Warnings</td><td align='right'>9</td></tr><tr class='tablerow1'><td>Multithreaded correctness Warnings</td><td align='right'>9</td></tr><tr class='tablerow0'><td>Performance Warnings</td><td align='right'>73</td></tr><tr class='tablerow1'><td>Security Warnings</td><td align='right'>41</td></tr><tr class='tablerow0'><td>Dodgy code Warnings</td><td align='right'>99</td></tr><tr class='tablerow1'><td><b>Total</b></td><td align='right'><b>310</b></td></tr></table>     ",
      "White-Light-Screenshot test failed, but no output was generated. Maybe a preliminary stage failed. ",
      "White-Light-IT test failed: https://www.kaminsky.me/nc-dev/android-integrationTests/7919-Screenshot-White-Light-08-17 ",
      "Blue-Light-Screenshot test failed, but no output was generated. Maybe a preliminary stage failed. ",
      "Blue-Light-IT test failed: https://www.kaminsky.me/nc-dev/android-integrationTests/7919-Screenshot-Blue-Light-08-18 ",
      "White-Dark-Screenshot test failed: https://www.kaminsky.me/nc-dev/android-integrationTests/7919-Screenshot-White-Dark-08-19 "
    ]
  },
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.85,
  "Bug Filter Response": "**Final Classification:** Defect Remediation & Feature Upgrades  \n**Confidence:** 0.85"
}