{
  "cve_id": "CVE-2019-18212",
  "cwe_ids": [
    "CWE-22"
  ],
  "cvss_vector": "AV:N/AC:L/Au:S/C:N/I:P/A:N",
  "cvss_is_v3": false,
  "repo_name": "eclipse/lemminx",
  "commit_msg": "Reject download of resource which are not in the cache folder (url which\nuses several ../../).\n\nSigned-off-by: azerr <azerr@redhat.com>",
  "commit_hash": "e37c399aa266be1b7a43061d4afc43dc230410d2",
  "git_url": "https://github.com/eclipse/lemminx/commit/e37c399aa266be1b7a43061d4afc43dc230410d2",
  "file_path": "org.eclipse.lsp4xml/src/main/java/org/eclipse/lsp4xml/utils/FilesUtils.java",
  "func_name": "saveToFile",
  "func_before": "public static void saveToFile(String content, Path outFile) throws IOException {\n\t\tif (!Files.exists(outFile.getParent())) {\n\t\t\tFiles.createDirectories(outFile.getParent());\n\t\t}\n\t\ttry (Writer writer = Files.newBufferedWriter(outFile, StandardCharsets.UTF_8)) {\n\t\t\twriter.write(content);\n\t\t}\n\t}",
  "abstract_func_before": "public static void saveToFile(String VAR_0, Path VAR_1) throws IOException {\n\t\tif (!VAR_2.exists(VAR_1.getParent())) {\n\t\t\tVAR_2.createDirectories(VAR_1.getParent());\n\t\t}\n\t\ttry (Writer VAR_3 = VAR_2.newBufferedWriter(VAR_1, VAR_4.UTF_8)) {\n\t\t\tVAR_3.write(VAR_0);\n\t\t}\n\t}",
  "func_graph_path_before": "eclipse/lemminx/e37c399aa266be1b7a43061d4afc43dc230410d2/FilesUtils.java/vul/before/0.json",
  "func": "public static void saveToFile(String content, Path outFile) throws IOException {\n\t\tif (!Files.exists(outFile.getParent())) {\n\t\t\tFiles.createDirectories(outFile.getParent());\n\t\t}\n\t\ttry (Writer writer = Files.newBufferedWriter(outFile, StandardCharsets.UTF_8)) {\n\t\t\twriter.write(content);\n\t\t}\n\t\t// Make sure it's not executable\n\t\ttry {\n\t\t\tFiles.setPosixFilePermissions(outFile, PosixFilePermissions.fromString(\"rw-r-----\"));\n\t\t} catch (UnsupportedOperationException e) {\n\t\t\t// The associated file system does not support the PosixFileAttributeView,\n\t\t\t// ignore the error\n\t\t\tLOGGER.log(Level.SEVERE,\n\t\t\t\t\t\"The associated file system '\" + outFile + \"' + does not support the PosixFileAttributeView\", e);\n\t\t}\n\t}",
  "abstract_func": "public static void saveToFile(String VAR_0, Path VAR_1) throws IOException {\n\t\tif (!VAR_2.exists(VAR_1.getParent())) {\n\t\t\tVAR_2.createDirectories(VAR_1.getParent());\n\t\t}\n\t\ttry (Writer VAR_3 = VAR_2.newBufferedWriter(VAR_1, VAR_4.UTF_8)) {\n\t\t\tVAR_3.write(VAR_0);\n\t\t}\n\t\t/* COMMENT_0 */\n\t\ttry {\n\t\t\tVAR_2.setPosixFilePermissions(VAR_1, VAR_5.fromString(\"rw-r-----\"));\n\t\t} catch (UnsupportedOperationException VAR_6) {\n\t\t\t/* COMMENT_1 */\n\t\t\t/* COMMENT_2 */\n\t\t\tVAR_7.log(VAR_8.SEVERE,\n\t\t\t\t\t\"The associated file system '\" + VAR_1 + \"' + does not support the PosixFileAttributeView\", VAR_6);\n\t\t}\n\t}",
  "func_graph_path": "eclipse/lemminx/e37c399aa266be1b7a43061d4afc43dc230410d2/FilesUtils.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -5,4 +5,13 @@\n \t\ttry (Writer writer = Files.newBufferedWriter(outFile, StandardCharsets.UTF_8)) {\n \t\t\twriter.write(content);\n \t\t}\n+\t\t// Make sure it's not executable\n+\t\ttry {\n+\t\t\tFiles.setPosixFilePermissions(outFile, PosixFilePermissions.fromString(\"rw-r-----\"));\n+\t\t} catch (UnsupportedOperationException e) {\n+\t\t\t// The associated file system does not support the PosixFileAttributeView,\n+\t\t\t// ignore the error\n+\t\t\tLOGGER.log(Level.SEVERE,\n+\t\t\t\t\t\"The associated file system '\" + outFile + \"' + does not support the PosixFileAttributeView\", e);\n+\t\t}\n \t}",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "\t\t// Make sure it's not executable",
      "\t\ttry {",
      "\t\t\tFiles.setPosixFilePermissions(outFile, PosixFilePermissions.fromString(\"rw-r-----\"));",
      "\t\t} catch (UnsupportedOperationException e) {",
      "\t\t\t// The associated file system does not support the PosixFileAttributeView,",
      "\t\t\t// ignore the error",
      "\t\t\tLOGGER.log(Level.SEVERE,",
      "\t\t\t\t\t\"The associated file system '\" + outFile + \"' + does not support the PosixFileAttributeView\", e);",
      "\t\t}"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/eclipse-lemminx/lemminx/pull/567",
  "description": {
    "pr_info": {
      "title": "Reject download of resource which are not in the cache folder",
      "number": 567
    },
    "comment": [
      "Reject download of resource which are not in the cache folder (url which uses several ../../).\r\n\r\nSigned-off-by: azerr <azerr@redhat.com>",
      "[CVE-2019-18212](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-18212) was opened  about this issue."
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 1.0"
}