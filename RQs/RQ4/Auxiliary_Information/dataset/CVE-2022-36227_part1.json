{
  "cve_id": "CVE-2022-36227",
  "cwe_ids": [
    "CWE-476"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "libarchive",
  "commit_msg": "libarchive: Handle a `calloc` returning NULL (fixes #1754)",
  "commit_hash": "bff38efe8c110469c5080d387bec62a6ca15b1a5",
  "git_url": "https://github.com/libarchive/libarchive/commit/bff38efe8c110469c5080d387bec62a6ca15b1a5",
  "file_path": "libarchive/archive_write.c",
  "func_name": "__archive_write_allocate_filter",
  "func_before": "struct archive_write_filter *\n__archive_write_allocate_filter(struct archive *_a)\n{\n\tstruct archive_write *a = (struct archive_write *)_a;\n\tstruct archive_write_filter *f;\n\n\tf = calloc(1, sizeof(*f));\n\tf->archive = _a;\n\tf->state = ARCHIVE_WRITE_FILTER_STATE_NEW;\n\tif (a->filter_first == NULL)\n\t\ta->filter_first = f;\n\telse\n\t\ta->filter_last->next_filter = f;\n\ta->filter_last = f;\n\treturn f;\n}",
  "abstract_func_before": "struct archive_write_filter *\n__archive_write_allocate_filter(struct archive *VAR_0)\n{\n\tstruct archive_write *VAR_1 = (struct archive_write *)VAR_0;\n\tstruct archive_write_filter *VAR_2;\n\n\tVAR_2 = calloc(1, sizeof(*VAR_2));\n\tVAR_2->archive = VAR_0;\n\tVAR_2->state = VAR_3;\n\tif (VAR_1->filter_first == NULL)\n\t\tVAR_1->filter_first = VAR_2;\n\telse\n\t\tVAR_1->filter_last->next_filter = VAR_2;\n\tVAR_1->filter_last = VAR_2;\n\treturn VAR_2;\n}",
  "func_graph_path_before": "libarchive/bff38efe8c110469c5080d387bec62a6ca15b1a5/archive_write.c/vul/before/0.json",
  "func": "struct archive_write_filter *\n__archive_write_allocate_filter(struct archive *_a)\n{\n\tstruct archive_write *a = (struct archive_write *)_a;\n\tstruct archive_write_filter *f;\n\n\tf = calloc(1, sizeof(*f));\n\n\tif (f == NULL)\n\t\treturn (NULL);\n\n\tf->archive = _a;\n\tf->state = ARCHIVE_WRITE_FILTER_STATE_NEW;\n\tif (a->filter_first == NULL)\n\t\ta->filter_first = f;\n\telse\n\t\ta->filter_last->next_filter = f;\n\ta->filter_last = f;\n\treturn f;\n}",
  "abstract_func": "struct archive_write_filter *\n__archive_write_allocate_filter(struct archive *VAR_0)\n{\n\tstruct archive_write *VAR_1 = (struct archive_write *)VAR_0;\n\tstruct archive_write_filter *VAR_2;\n\n\tVAR_2 = calloc(1, sizeof(*VAR_2));\n\n\tif (VAR_2 == NULL)\n\t\treturn (NULL);\n\n\tVAR_2->archive = VAR_0;\n\tVAR_2->state = VAR_3;\n\tif (VAR_1->filter_first == NULL)\n\t\tVAR_1->filter_first = VAR_2;\n\telse\n\t\tVAR_1->filter_last->next_filter = VAR_2;\n\tVAR_1->filter_last = VAR_2;\n\treturn VAR_2;\n}",
  "func_graph_path": "libarchive/bff38efe8c110469c5080d387bec62a6ca15b1a5/archive_write.c/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -5,6 +5,10 @@\n \tstruct archive_write_filter *f;\n \n \tf = calloc(1, sizeof(*f));\n+\n+\tif (f == NULL)\n+\t\treturn (NULL);\n+\n \tf->archive = _a;\n \tf->state = ARCHIVE_WRITE_FILTER_STATE_NEW;\n \tif (a->filter_first == NULL)",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "",
      "\tif (f == NULL)",
      "\t\treturn (NULL);",
      ""
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/libarchive/libarchive/pull/1759",
  "description": {
    "pr_info": {
      "title": "libarchive: Handle a `calloc` returning NULL (fixes #1754)",
      "number": 1759
    },
    "comment": [
      "Nothing much to see here :smile: \r\n\r\nFixes #1754 (apparently this doesn't work in the title)",
      "Thank you!!!"
    ]
  },
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Defect Remediation & Feature Upgrades  \n**Confidence:** 0.9"
}