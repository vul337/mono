{
  "cve_id": "CVE-2020-9355",
  "cwe_ids": [
    "CWE-Other"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "danfruehauf/NetworkManager-ssh",
  "commit_msg": "Remove extra options\n\nAfter analyzing some privilege escalation possibilites, it was decided\nit is best to remove extra options",
  "commit_hash": "5d88cd89795352b5df54cc0ebb6a0076b8c89ee4",
  "git_url": "https://github.com/danfruehauf/NetworkManager-ssh/commit/5d88cd89795352b5df54cc0ebb6a0076b8c89ee4",
  "file_path": "properties/advanced-dialog.c",
  "func_name": "advanced_dialog_new",
  "func_before": "GtkWidget *\nadvanced_dialog_new (GHashTable *hash)\n{\n\tGtkBuilder *builder;\n\tGtkWidget *dialog = NULL;\n\tchar *ui_file = NULL;\n\tGtkWidget *widget;\n\tconst char *value;\n\tGError *error = NULL;\n\tlong int tmp;\n\n\tg_return_val_if_fail (hash != NULL, NULL);\n\n\tui_file = g_strdup_printf (\"%s/%s\", UIDIR, \"nm-ssh-dialog.ui\");\n\tbuilder = gtk_builder_new ();\n\n\tgtk_builder_set_translation_domain (builder, GETTEXT_PACKAGE);\n\n\tif (!gtk_builder_add_from_file (builder, ui_file, &error)) {\n\t\tg_warning (\"Couldn't load builder file: %s\", error->message);\n\t\tg_error_free (error);\n\t\tg_object_unref (G_OBJECT (builder));\n\t\tgoto out;\n\t}\n\n\tdialog = GTK_WIDGET (gtk_builder_get_object (builder, \"ssh_advanced_dialog\"));\n\tif (!dialog) {\n\t\tg_object_unref (G_OBJECT (builder));\n\t\tgoto out;\n\t}\n\tgtk_window_set_modal (GTK_WINDOW (dialog), TRUE);\n\n\tg_object_set_data_full (G_OBJECT (dialog), \"builder\",\n\t                        builder, (GDestroyNotify) g_object_unref);\n\n\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"port_checkbutton\"));\n\tg_assert (widget);\n\tg_signal_connect (G_OBJECT (widget), \"toggled\", G_CALLBACK (port_toggled_cb), builder);\n\n\tvalue = g_hash_table_lookup (hash, NM_SSH_KEY_PORT);\n\tif (value && strlen (value)) {\n\t\terrno = 0;\n\t\ttmp = strtol (value, NULL, 10);\n\t\tif (errno == 0 && tmp > 0 && tmp < 65536) {\n\t\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), TRUE);\n\n\t\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"port_spinbutton\"));\n\t\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (widget),\n\t\t\t                           (gdouble) tmp);\n\t\t}\n\t\tgtk_widget_set_sensitive (widget, TRUE);\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), FALSE);\n\n\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"port_spinbutton\"));\n\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble) NM_SSH_DEFAULT_PORT);\n\t\tgtk_widget_set_sensitive (widget, FALSE);\n\t}\n\n\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"tunmtu_checkbutton\"));\n\tg_assert (widget);\n\tg_signal_connect (G_OBJECT (widget), \"toggled\", G_CALLBACK (tunmtu_toggled_cb), builder);\n\n\tvalue = g_hash_table_lookup (hash, NM_SSH_KEY_TUNNEL_MTU);\n\tif (value && strlen (value)) {\n\t\terrno = 0;\n\t\ttmp = strtol (value, NULL, 10);\n\t\tif (errno == 0 && tmp > 0 && tmp < 65536) {\n\t\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), TRUE);\n\n\t\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"tunmtu_spinbutton\"));\n\t\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble) tmp);\n\t\t\tgtk_widget_set_sensitive (widget, TRUE);\n\t\t}\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), FALSE);\n\n\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"tunmtu_spinbutton\"));\n\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble) NM_SSH_DEFAULT_MTU);\n\t\tgtk_widget_set_sensitive (widget, FALSE);\n\t}\n\n\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"extra_opts_checkbutton\"));\n\tg_assert (widget);\n\tg_signal_connect (G_OBJECT (widget), \"toggled\", G_CALLBACK (extra_opts_toggled_cb), builder);\n\n\tvalue = g_hash_table_lookup (hash, NM_SSH_KEY_EXTRA_OPTS);\n\tif (value && strlen (value)) {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), TRUE);\n\n\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"extra_opts_entry\"));\n\t\tgtk_entry_set_text (GTK_ENTRY (widget), value);\n\t\tgtk_widget_set_sensitive (widget, TRUE);\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), FALSE);\n\n\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"extra_opts_entry\"));\n\t\tgtk_entry_set_text (GTK_ENTRY (widget), NM_SSH_DEFAULT_EXTRA_OPTS);\n\t\tgtk_widget_set_sensitive (widget, FALSE);\n\t}\n\n\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"remote_dev_checkbutton\"));\n\tg_assert (widget);\n\tg_signal_connect (G_OBJECT (widget), \"toggled\", G_CALLBACK (remote_dev_toggled_cb), builder);\n\n\tvalue = g_hash_table_lookup (hash, NM_SSH_KEY_REMOTE_DEV);\n\tif (value && strlen (value)) {\n\t\terrno = 0;\n\t\ttmp = strtol (value, NULL, 10);\n\t\tif (errno == 0 && tmp >= 0 && tmp < 256) {\n\t\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), TRUE);\n\n\t\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"remote_dev_spinbutton\"));\n\t\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble) tmp);\n\t\t}\n\t\tgtk_widget_set_sensitive (widget, TRUE);\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), FALSE);\n\n\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"remote_dev_spinbutton\"));\n\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble) NM_SSH_DEFAULT_REMOTE_DEV);\n\t\tgtk_widget_set_sensitive (widget, FALSE);\n\t}\n\n\tvalue = g_hash_table_lookup (hash, NM_SSH_KEY_TAP_DEV);\n\tif (value && IS_YES(value)) {\n\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"tap_checkbutton\"));\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), TRUE);\n\t}\n\n\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"remote_username_checkbutton\"));\n\tg_assert (widget);\n\tg_signal_connect (G_OBJECT (widget), \"toggled\", G_CALLBACK (remote_username_toggled_cb), builder);\n\n\tvalue = g_hash_table_lookup (hash, NM_SSH_KEY_REMOTE_USERNAME);\n\tif (value && strlen (value)) {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), TRUE);\n\n\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"remote_username_entry\"));\n\t\tgtk_entry_set_text (GTK_ENTRY (widget), value);\n\t\tgtk_widget_set_sensitive (widget, TRUE);\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), FALSE);\n\n\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"remote_username_entry\"));\n\t\tgtk_entry_set_text (GTK_ENTRY (widget), NM_SSH_DEFAULT_REMOTE_USERNAME);\n\t\tgtk_widget_set_sensitive (widget, FALSE);\n\t}\n\nout:\n\tg_free (ui_file);\n\treturn dialog;\n}",
  "abstract_func_before": "GtkWidget *\nadvanced_dialog_new (GHashTable *VAR_0)\n{\n\tGtkBuilder *VAR_1;\n\tGtkWidget *VAR_2 = NULL;\n\tchar *VAR_3 = NULL;\n\tGtkWidget *VAR_4;\n\tconst char *VAR_5;\n\tGError *VAR_6 = NULL;\n\tlong int VAR_7;\n\n\tg_return_val_if_fail (VAR_0 != NULL, NULL);\n\n\tVAR_3 = g_strdup_printf (\"%s/%s\", VAR_8, \"nm-ssh-dialog.ui\");\n\tVAR_1 = gtk_builder_new ();\n\n\tgtk_builder_set_translation_domain (VAR_1, VAR_9);\n\n\tif (!gtk_builder_add_from_file (VAR_1, VAR_3, &VAR_6)) {\n\t\tg_warning (\"Couldn't load builder file: %s\", VAR_6->message);\n\t\tg_error_free (VAR_6);\n\t\tg_object_unref (G_OBJECT (VAR_1));\n\t\tgoto out;\n\t}\n\n\tVAR_2 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"ssh_advanced_dialog\"));\n\tif (!VAR_2) {\n\t\tg_object_unref (G_OBJECT (VAR_1));\n\t\tgoto out;\n\t}\n\tgtk_window_set_modal (GTK_WINDOW (VAR_2), TRUE);\n\n\tg_object_set_data_full (G_OBJECT (VAR_2), \"builder\",\n\t                        VAR_1, (GDestroyNotify) VAR_10);\n\n\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"port_checkbutton\"));\n\tg_assert (VAR_4);\n\tg_signal_connect (G_OBJECT (VAR_4), \"toggled\", G_CALLBACK (VAR_11), VAR_1);\n\n\tVAR_5 = g_hash_table_lookup (VAR_0, VAR_12);\n\tif (VAR_5 && strlen (VAR_5)) {\n\t\tVAR_13 = 0;\n\t\tVAR_7 = strtol (VAR_5, NULL, 10);\n\t\tif (VAR_13 == 0 && VAR_7 > 0 && VAR_7 < 65536) {\n\t\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), TRUE);\n\n\t\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"port_spinbutton\"));\n\t\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (VAR_4),\n\t\t\t                           (gdouble) VAR_7);\n\t\t}\n\t\tgtk_widget_set_sensitive (VAR_4, TRUE);\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), FALSE);\n\n\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"port_spinbutton\"));\n\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (VAR_4), (gdouble) VAR_14);\n\t\tgtk_widget_set_sensitive (VAR_4, FALSE);\n\t}\n\n\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"tunmtu_checkbutton\"));\n\tg_assert (VAR_4);\n\tg_signal_connect (G_OBJECT (VAR_4), \"toggled\", G_CALLBACK (VAR_15), VAR_1);\n\n\tVAR_5 = g_hash_table_lookup (VAR_0, VAR_16);\n\tif (VAR_5 && strlen (VAR_5)) {\n\t\tVAR_13 = 0;\n\t\tVAR_7 = strtol (VAR_5, NULL, 10);\n\t\tif (VAR_13 == 0 && VAR_7 > 0 && VAR_7 < 65536) {\n\t\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), TRUE);\n\n\t\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"tunmtu_spinbutton\"));\n\t\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (VAR_4), (gdouble) VAR_7);\n\t\t\tgtk_widget_set_sensitive (VAR_4, TRUE);\n\t\t}\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), FALSE);\n\n\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"tunmtu_spinbutton\"));\n\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (VAR_4), (gdouble) VAR_17);\n\t\tgtk_widget_set_sensitive (VAR_4, FALSE);\n\t}\n\n\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"extra_opts_checkbutton\"));\n\tg_assert (VAR_4);\n\tg_signal_connect (G_OBJECT (VAR_4), \"toggled\", G_CALLBACK (VAR_18), VAR_1);\n\n\tVAR_5 = g_hash_table_lookup (VAR_0, VAR_19);\n\tif (VAR_5 && strlen (VAR_5)) {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), TRUE);\n\n\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"extra_opts_entry\"));\n\t\tgtk_entry_set_text (GTK_ENTRY (VAR_4), VAR_5);\n\t\tgtk_widget_set_sensitive (VAR_4, TRUE);\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), FALSE);\n\n\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"extra_opts_entry\"));\n\t\tgtk_entry_set_text (GTK_ENTRY (VAR_4), VAR_20);\n\t\tgtk_widget_set_sensitive (VAR_4, FALSE);\n\t}\n\n\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"remote_dev_checkbutton\"));\n\tg_assert (VAR_4);\n\tg_signal_connect (G_OBJECT (VAR_4), \"toggled\", G_CALLBACK (VAR_21), VAR_1);\n\n\tVAR_5 = g_hash_table_lookup (VAR_0, VAR_22);\n\tif (VAR_5 && strlen (VAR_5)) {\n\t\tVAR_13 = 0;\n\t\tVAR_7 = strtol (VAR_5, NULL, 10);\n\t\tif (VAR_13 == 0 && VAR_7 >= 0 && VAR_7 < 256) {\n\t\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), TRUE);\n\n\t\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"remote_dev_spinbutton\"));\n\t\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (VAR_4), (gdouble) VAR_7);\n\t\t}\n\t\tgtk_widget_set_sensitive (VAR_4, TRUE);\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), FALSE);\n\n\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"remote_dev_spinbutton\"));\n\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (VAR_4), (gdouble) VAR_23);\n\t\tgtk_widget_set_sensitive (VAR_4, FALSE);\n\t}\n\n\tVAR_5 = g_hash_table_lookup (VAR_0, VAR_24);\n\tif (VAR_5 && IS_YES(VAR_5)) {\n\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"tap_checkbutton\"));\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), TRUE);\n\t}\n\n\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"remote_username_checkbutton\"));\n\tg_assert (VAR_4);\n\tg_signal_connect (G_OBJECT (VAR_4), \"toggled\", G_CALLBACK (VAR_25), VAR_1);\n\n\tVAR_5 = g_hash_table_lookup (VAR_0, VAR_26);\n\tif (VAR_5 && strlen (VAR_5)) {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), TRUE);\n\n\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"remote_username_entry\"));\n\t\tgtk_entry_set_text (GTK_ENTRY (VAR_4), VAR_5);\n\t\tgtk_widget_set_sensitive (VAR_4, TRUE);\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), FALSE);\n\n\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"remote_username_entry\"));\n\t\tgtk_entry_set_text (GTK_ENTRY (VAR_4), VAR_27);\n\t\tgtk_widget_set_sensitive (VAR_4, FALSE);\n\t}\n\nout:\n\tg_free (VAR_3);\n\treturn VAR_2;\n}",
  "func_graph_path_before": "danfruehauf/NetworkManager-ssh/5d88cd89795352b5df54cc0ebb6a0076b8c89ee4/advanced-dialog.c/vul/before/0.json",
  "func": "GtkWidget *\nadvanced_dialog_new (GHashTable *hash)\n{\n\tGtkBuilder *builder;\n\tGtkWidget *dialog = NULL;\n\tchar *ui_file = NULL;\n\tGtkWidget *widget;\n\tconst char *value;\n\tGError *error = NULL;\n\tlong int tmp;\n\n\tg_return_val_if_fail (hash != NULL, NULL);\n\n\tui_file = g_strdup_printf (\"%s/%s\", UIDIR, \"nm-ssh-dialog.ui\");\n\tbuilder = gtk_builder_new ();\n\n\tgtk_builder_set_translation_domain (builder, GETTEXT_PACKAGE);\n\n\tif (!gtk_builder_add_from_file (builder, ui_file, &error)) {\n\t\tg_warning (\"Couldn't load builder file: %s\", error->message);\n\t\tg_error_free (error);\n\t\tg_object_unref (G_OBJECT (builder));\n\t\tgoto out;\n\t}\n\n\tdialog = GTK_WIDGET (gtk_builder_get_object (builder, \"ssh_advanced_dialog\"));\n\tif (!dialog) {\n\t\tg_object_unref (G_OBJECT (builder));\n\t\tgoto out;\n\t}\n\tgtk_window_set_modal (GTK_WINDOW (dialog), TRUE);\n\n\tg_object_set_data_full (G_OBJECT (dialog), \"builder\",\n\t                        builder, (GDestroyNotify) g_object_unref);\n\n\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"port_checkbutton\"));\n\tg_assert (widget);\n\tg_signal_connect (G_OBJECT (widget), \"toggled\", G_CALLBACK (port_toggled_cb), builder);\n\n\tvalue = g_hash_table_lookup (hash, NM_SSH_KEY_PORT);\n\tif (value && strlen (value)) {\n\t\terrno = 0;\n\t\ttmp = strtol (value, NULL, 10);\n\t\tif (errno == 0 && tmp > 0 && tmp < 65536) {\n\t\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), TRUE);\n\n\t\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"port_spinbutton\"));\n\t\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (widget),\n\t\t\t                           (gdouble) tmp);\n\t\t}\n\t\tgtk_widget_set_sensitive (widget, TRUE);\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), FALSE);\n\n\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"port_spinbutton\"));\n\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble) NM_SSH_DEFAULT_PORT);\n\t\tgtk_widget_set_sensitive (widget, FALSE);\n\t}\n\n\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"tunmtu_checkbutton\"));\n\tg_assert (widget);\n\tg_signal_connect (G_OBJECT (widget), \"toggled\", G_CALLBACK (tunmtu_toggled_cb), builder);\n\n\tvalue = g_hash_table_lookup (hash, NM_SSH_KEY_TUNNEL_MTU);\n\tif (value && strlen (value)) {\n\t\terrno = 0;\n\t\ttmp = strtol (value, NULL, 10);\n\t\tif (errno == 0 && tmp > 0 && tmp < 65536) {\n\t\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), TRUE);\n\n\t\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"tunmtu_spinbutton\"));\n\t\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble) tmp);\n\t\t\tgtk_widget_set_sensitive (widget, TRUE);\n\t\t}\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), FALSE);\n\n\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"tunmtu_spinbutton\"));\n\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble) NM_SSH_DEFAULT_MTU);\n\t\tgtk_widget_set_sensitive (widget, FALSE);\n\t}\n\n\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"remote_dev_checkbutton\"));\n\tg_assert (widget);\n\tg_signal_connect (G_OBJECT (widget), \"toggled\", G_CALLBACK (remote_dev_toggled_cb), builder);\n\n\tvalue = g_hash_table_lookup (hash, NM_SSH_KEY_REMOTE_DEV);\n\tif (value && strlen (value)) {\n\t\terrno = 0;\n\t\ttmp = strtol (value, NULL, 10);\n\t\tif (errno == 0 && tmp >= 0 && tmp < 256) {\n\t\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), TRUE);\n\n\t\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"remote_dev_spinbutton\"));\n\t\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble) tmp);\n\t\t}\n\t\tgtk_widget_set_sensitive (widget, TRUE);\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), FALSE);\n\n\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"remote_dev_spinbutton\"));\n\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (widget), (gdouble) NM_SSH_DEFAULT_REMOTE_DEV);\n\t\tgtk_widget_set_sensitive (widget, FALSE);\n\t}\n\n\tvalue = g_hash_table_lookup (hash, NM_SSH_KEY_TAP_DEV);\n\tif (value && IS_YES(value)) {\n\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"tap_checkbutton\"));\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), TRUE);\n\t}\n\n\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"remote_username_checkbutton\"));\n\tg_assert (widget);\n\tg_signal_connect (G_OBJECT (widget), \"toggled\", G_CALLBACK (remote_username_toggled_cb), builder);\n\n\tvalue = g_hash_table_lookup (hash, NM_SSH_KEY_REMOTE_USERNAME);\n\tif (value && strlen (value)) {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), TRUE);\n\n\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"remote_username_entry\"));\n\t\tgtk_entry_set_text (GTK_ENTRY (widget), value);\n\t\tgtk_widget_set_sensitive (widget, TRUE);\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), FALSE);\n\n\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"remote_username_entry\"));\n\t\tgtk_entry_set_text (GTK_ENTRY (widget), NM_SSH_DEFAULT_REMOTE_USERNAME);\n\t\tgtk_widget_set_sensitive (widget, FALSE);\n\t}\n\nout:\n\tg_free (ui_file);\n\treturn dialog;\n}",
  "abstract_func": "GtkWidget *\nadvanced_dialog_new (GHashTable *VAR_0)\n{\n\tGtkBuilder *VAR_1;\n\tGtkWidget *VAR_2 = NULL;\n\tchar *VAR_3 = NULL;\n\tGtkWidget *VAR_4;\n\tconst char *VAR_5;\n\tGError *VAR_6 = NULL;\n\tlong int VAR_7;\n\n\tg_return_val_if_fail (VAR_0 != NULL, NULL);\n\n\tVAR_3 = g_strdup_printf (\"%s/%s\", VAR_8, \"nm-ssh-dialog.ui\");\n\tVAR_1 = gtk_builder_new ();\n\n\tgtk_builder_set_translation_domain (VAR_1, VAR_9);\n\n\tif (!gtk_builder_add_from_file (VAR_1, VAR_3, &VAR_6)) {\n\t\tg_warning (\"Couldn't load builder file: %s\", VAR_6->message);\n\t\tg_error_free (VAR_6);\n\t\tg_object_unref (G_OBJECT (VAR_1));\n\t\tgoto out;\n\t}\n\n\tVAR_2 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"ssh_advanced_dialog\"));\n\tif (!VAR_2) {\n\t\tg_object_unref (G_OBJECT (VAR_1));\n\t\tgoto out;\n\t}\n\tgtk_window_set_modal (GTK_WINDOW (VAR_2), TRUE);\n\n\tg_object_set_data_full (G_OBJECT (VAR_2), \"builder\",\n\t                        VAR_1, (GDestroyNotify) VAR_10);\n\n\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"port_checkbutton\"));\n\tg_assert (VAR_4);\n\tg_signal_connect (G_OBJECT (VAR_4), \"toggled\", G_CALLBACK (VAR_11), VAR_1);\n\n\tVAR_5 = g_hash_table_lookup (VAR_0, VAR_12);\n\tif (VAR_5 && strlen (VAR_5)) {\n\t\tVAR_13 = 0;\n\t\tVAR_7 = strtol (VAR_5, NULL, 10);\n\t\tif (VAR_13 == 0 && VAR_7 > 0 && VAR_7 < 65536) {\n\t\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), TRUE);\n\n\t\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"port_spinbutton\"));\n\t\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (VAR_4),\n\t\t\t                           (gdouble) VAR_7);\n\t\t}\n\t\tgtk_widget_set_sensitive (VAR_4, TRUE);\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), FALSE);\n\n\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"port_spinbutton\"));\n\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (VAR_4), (gdouble) VAR_14);\n\t\tgtk_widget_set_sensitive (VAR_4, FALSE);\n\t}\n\n\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"tunmtu_checkbutton\"));\n\tg_assert (VAR_4);\n\tg_signal_connect (G_OBJECT (VAR_4), \"toggled\", G_CALLBACK (VAR_15), VAR_1);\n\n\tVAR_5 = g_hash_table_lookup (VAR_0, VAR_16);\n\tif (VAR_5 && strlen (VAR_5)) {\n\t\tVAR_13 = 0;\n\t\tVAR_7 = strtol (VAR_5, NULL, 10);\n\t\tif (VAR_13 == 0 && VAR_7 > 0 && VAR_7 < 65536) {\n\t\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), TRUE);\n\n\t\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"tunmtu_spinbutton\"));\n\t\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (VAR_4), (gdouble) VAR_7);\n\t\t\tgtk_widget_set_sensitive (VAR_4, TRUE);\n\t\t}\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), FALSE);\n\n\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"tunmtu_spinbutton\"));\n\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (VAR_4), (gdouble) VAR_17);\n\t\tgtk_widget_set_sensitive (VAR_4, FALSE);\n\t}\n\n\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"remote_dev_checkbutton\"));\n\tg_assert (VAR_4);\n\tg_signal_connect (G_OBJECT (VAR_4), \"toggled\", G_CALLBACK (VAR_18), VAR_1);\n\n\tVAR_5 = g_hash_table_lookup (VAR_0, VAR_19);\n\tif (VAR_5 && strlen (VAR_5)) {\n\t\tVAR_13 = 0;\n\t\tVAR_7 = strtol (VAR_5, NULL, 10);\n\t\tif (VAR_13 == 0 && VAR_7 >= 0 && VAR_7 < 256) {\n\t\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), TRUE);\n\n\t\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"remote_dev_spinbutton\"));\n\t\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (VAR_4), (gdouble) VAR_7);\n\t\t}\n\t\tgtk_widget_set_sensitive (VAR_4, TRUE);\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), FALSE);\n\n\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"remote_dev_spinbutton\"));\n\t\tgtk_spin_button_set_value (GTK_SPIN_BUTTON (VAR_4), (gdouble) VAR_20);\n\t\tgtk_widget_set_sensitive (VAR_4, FALSE);\n\t}\n\n\tVAR_5 = g_hash_table_lookup (VAR_0, VAR_21);\n\tif (VAR_5 && IS_YES(VAR_5)) {\n\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"tap_checkbutton\"));\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), TRUE);\n\t}\n\n\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"remote_username_checkbutton\"));\n\tg_assert (VAR_4);\n\tg_signal_connect (G_OBJECT (VAR_4), \"toggled\", G_CALLBACK (VAR_22), VAR_1);\n\n\tVAR_5 = g_hash_table_lookup (VAR_0, VAR_23);\n\tif (VAR_5 && strlen (VAR_5)) {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), TRUE);\n\n\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"remote_username_entry\"));\n\t\tgtk_entry_set_text (GTK_ENTRY (VAR_4), VAR_5);\n\t\tgtk_widget_set_sensitive (VAR_4, TRUE);\n\t} else {\n\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (VAR_4), FALSE);\n\n\t\tVAR_4 = GTK_WIDGET (gtk_builder_get_object (VAR_1, \"remote_username_entry\"));\n\t\tgtk_entry_set_text (GTK_ENTRY (VAR_4), VAR_24);\n\t\tgtk_widget_set_sensitive (VAR_4, FALSE);\n\t}\n\nout:\n\tg_free (VAR_3);\n\treturn VAR_2;\n}",
  "func_graph_path": "danfruehauf/NetworkManager-ssh/5d88cd89795352b5df54cc0ebb6a0076b8c89ee4/advanced-dialog.c/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -80,25 +80,6 @@\n \t\tgtk_widget_set_sensitive (widget, FALSE);\n \t}\n \n-\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"extra_opts_checkbutton\"));\n-\tg_assert (widget);\n-\tg_signal_connect (G_OBJECT (widget), \"toggled\", G_CALLBACK (extra_opts_toggled_cb), builder);\n-\n-\tvalue = g_hash_table_lookup (hash, NM_SSH_KEY_EXTRA_OPTS);\n-\tif (value && strlen (value)) {\n-\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), TRUE);\n-\n-\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"extra_opts_entry\"));\n-\t\tgtk_entry_set_text (GTK_ENTRY (widget), value);\n-\t\tgtk_widget_set_sensitive (widget, TRUE);\n-\t} else {\n-\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), FALSE);\n-\n-\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"extra_opts_entry\"));\n-\t\tgtk_entry_set_text (GTK_ENTRY (widget), NM_SSH_DEFAULT_EXTRA_OPTS);\n-\t\tgtk_widget_set_sensitive (widget, FALSE);\n-\t}\n-\n \twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"remote_dev_checkbutton\"));\n \tg_assert (widget);\n \tg_signal_connect (G_OBJECT (widget), \"toggled\", G_CALLBACK (remote_dev_toggled_cb), builder);",
  "diff_line_info": {
    "deleted_lines": [
      "\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"extra_opts_checkbutton\"));",
      "\tg_assert (widget);",
      "\tg_signal_connect (G_OBJECT (widget), \"toggled\", G_CALLBACK (extra_opts_toggled_cb), builder);",
      "",
      "\tvalue = g_hash_table_lookup (hash, NM_SSH_KEY_EXTRA_OPTS);",
      "\tif (value && strlen (value)) {",
      "\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), TRUE);",
      "",
      "\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"extra_opts_entry\"));",
      "\t\tgtk_entry_set_text (GTK_ENTRY (widget), value);",
      "\t\tgtk_widget_set_sensitive (widget, TRUE);",
      "\t} else {",
      "\t\tgtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (widget), FALSE);",
      "",
      "\t\twidget = GTK_WIDGET (gtk_builder_get_object (builder, \"extra_opts_entry\"));",
      "\t\tgtk_entry_set_text (GTK_ENTRY (widget), NM_SSH_DEFAULT_EXTRA_OPTS);",
      "\t\tgtk_widget_set_sensitive (widget, FALSE);",
      "\t}",
      ""
    ],
    "added_lines": []
  },
  "is_vul": true,
  "pr_url": "https://github.com/danfruehauf/NetworkManager-ssh/pull/98",
  "description": {
    "pr_info": {
      "title": "Remove extra options",
      "number": 98
    },
    "comment": [
      "After analyzing some privilege escalation possibilites, it was decided\r\nit is best to remove extra options",
      "I understand some people are going to be very unhappy with it. However I hope to add `-L` and `-R` options.\r\n\r\nSee also:\r\nhttps://bugzilla.redhat.com/show_bug.cgi?id=1803499",
      "@lhw This should be urgently deployed. I'll tag it as 1.2.11",
      "@danfruehauf can you please request a CVE as needed for the privilege escalation flaw via https://cveform.mitre.org/ ?",
      "@carnil I've requested a CVE ID and will post it here once I've heard back from them.",
      "@kobus-v-schoor was there any news on the CVE assignment?",
      "@danfruehauf https://bugzilla.redhat.com/show_bug.cgi?id=1803499 is not publicly accessible, possible to open that up? This might be blocking the CVE assignment from MITRE if they have not enough context.",
      "CVE-2020-9355 was assigned for this issue.",
      "Darn. I can't -D anymore. Is there some way to add this? :(",
      "The PR removed the extra options, but left in the README section and the image, giving the false impression this is still supported.\r\n\r\nOn the same topic, I'd really like to have `-L` back, would you be open to merge a very restricted input field that just allows the user to append valid `-L` blocks?"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.95"
}