{
  "cve_id": "CVE-2022-36044",
  "cwe_ids": [
    "CWE-787"
  ],
  "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "rizinorg/rizin",
  "commit_msg": "Fix oob read on _luac_build_info and luac memleaks",
  "commit_hash": "05bbd147caccc60162d6fba9baaaf24befa281cd",
  "git_url": "https://github.com/rizinorg/rizin/commit/05bbd147caccc60162d6fba9baaaf24befa281cd",
  "file_path": "librz/bin/p/bin_luac.c",
  "func_name": "symbols",
  "func_before": "static RzList *symbols(RzBinFile *bf) {\n\tif (!bf) {\n\t\treturn NULL;\n\t}\n\tLuacBinInfo *bin_info_obj = GET_INTERNAL_BIN_INFO_OBJ(bf);\n\tif (!bin_info_obj) {\n\t\treturn NULL;\n\t}\n\n\treturn bin_info_obj->symbol_list;\n}",
  "abstract_func_before": "static RzList *symbols(RzBinFile *VAR_0) {\n\tif (!VAR_0) {\n\t\treturn NULL;\n\t}\n\tLuacBinInfo *VAR_1 = GET_INTERNAL_BIN_INFO_OBJ(VAR_0);\n\tif (!VAR_1) {\n\t\treturn NULL;\n\t}\n\n\treturn VAR_1->symbol_list;\n}",
  "func_graph_path_before": "rizinorg/rizin/05bbd147caccc60162d6fba9baaaf24befa281cd/bin_luac.c/vul/before/0.json",
  "func": "static RzList *symbols(RzBinFile *bf) {\n\tif (!bf) {\n\t\treturn NULL;\n\t}\n\tLuacBinInfo *bin_info_obj = GET_INTERNAL_BIN_INFO_OBJ(bf);\n\tif (!bin_info_obj) {\n\t\treturn NULL;\n\t}\n\n\treturn rz_list_clone(bin_info_obj->symbol_list);\n}",
  "abstract_func": "static RzList *symbols(RzBinFile *VAR_0) {\n\tif (!VAR_0) {\n\t\treturn NULL;\n\t}\n\tLuacBinInfo *VAR_1 = GET_INTERNAL_BIN_INFO_OBJ(VAR_0);\n\tif (!VAR_1) {\n\t\treturn NULL;\n\t}\n\n\treturn rz_list_clone(VAR_1->symbol_list);\n}",
  "func_graph_path": "rizinorg/rizin/05bbd147caccc60162d6fba9baaaf24befa281cd/bin_luac.c/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -7,5 +7,5 @@\n \t\treturn NULL;\n \t}\n \n-\treturn bin_info_obj->symbol_list;\n+\treturn rz_list_clone(bin_info_obj->symbol_list);\n }",
  "diff_line_info": {
    "deleted_lines": [
      "\treturn bin_info_obj->symbol_list;"
    ],
    "added_lines": [
      "\treturn rz_list_clone(bin_info_obj->symbol_list);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/rizinorg/rizin/pull/2930",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/rizinorg/rizin/pull/2930: 403 Client Error: Forbidden for url: https://api.github.com/repos/rizinorg/rizin/pulls/2930",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0"
}