{
  "cve_id": "CVE-2022-2414",
  "cwe_ids": [
    "CWE-611"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
  "cvss_is_v3": true,
  "repo_name": "dogtagpki/pki",
  "commit_msg": "Disable access to external entities when parsing XML\n\nThis reduces the vulnerability of XML parsers to XXE (XML external\nentity) injection.\n\nThe best way to prevent XXE is to stop using XML altogether, which we do\nplan to do. Until that happens I consider it worthwhile to tighten the\nsecurity here though.",
  "commit_hash": "16deffdf7548e305507982e246eb9fd1eac414fd",
  "git_url": "https://github.com/dogtagpki/pki/commit/16deffdf7548e305507982e246eb9fd1eac414fd",
  "file_path": "base/util/src/main/java/com/netscape/cmsutil/xml/XMLObject.java",
  "func_name": "output",
  "func_before": "public void output(OutputStream os)\n            throws TransformerConfigurationException, TransformerException {\n        TransformerFactory tranFactory = TransformerFactory.newInstance();\n        Transformer aTransformer = tranFactory.newTransformer();\n        Source src = new DOMSource(mDoc);\n        Result dest = new StreamResult(os);\n        aTransformer.transform(src, dest);\n    }",
  "abstract_func_before": "public void output(OutputStream VAR_0)\n            throws TransformerConfigurationException, TransformerException {\n        TransformerFactory VAR_1 = VAR_2.newInstance();\n        Transformer VAR_3 = VAR_1.newTransformer();\n        Source VAR_4 = new DOMSource(VAR_5);\n        Result VAR_6 = new StreamResult(VAR_0);\n        VAR_3.transform(VAR_4, VAR_6);\n    }",
  "func_graph_path_before": "dogtagpki/pki/16deffdf7548e305507982e246eb9fd1eac414fd/XMLObject.java/vul/before/0.json",
  "func": "public void output(OutputStream os)\n            throws TransformerConfigurationException, TransformerException {\n        TransformerFactory tranFactory = TransformerFactory.newInstance();\n        tranFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\n        tranFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, \"\");\n        Transformer aTransformer = tranFactory.newTransformer();\n        Source src = new DOMSource(mDoc);\n        Result dest = new StreamResult(os);\n        aTransformer.transform(src, dest);\n    }",
  "abstract_func": "public void output(OutputStream VAR_0)\n            throws TransformerConfigurationException, TransformerException {\n        TransformerFactory VAR_1 = VAR_2.newInstance();\n        VAR_1.setAttribute(VAR_3.ACCESS_EXTERNAL_DTD, \"\");\n        VAR_1.setAttribute(VAR_3.ACCESS_EXTERNAL_STYLESHEET, \"\");\n        Transformer VAR_4 = VAR_1.newTransformer();\n        Source VAR_5 = new DOMSource(VAR_6);\n        Result VAR_7 = new StreamResult(VAR_0);\n        VAR_4.transform(VAR_5, VAR_7);\n    }",
  "func_graph_path": "dogtagpki/pki/16deffdf7548e305507982e246eb9fd1eac414fd/XMLObject.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,6 +1,8 @@\n public void output(OutputStream os)\n             throws TransformerConfigurationException, TransformerException {\n         TransformerFactory tranFactory = TransformerFactory.newInstance();\n+        tranFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\n+        tranFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, \"\");\n         Transformer aTransformer = tranFactory.newTransformer();\n         Source src = new DOMSource(mDoc);\n         Result dest = new StreamResult(os);",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "        tranFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");",
      "        tranFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, \"\");"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/dogtagpki/pki/pull/4021",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/dogtagpki/pki/pull/4021: 403 Client Error: Forbidden for url: https://api.github.com/repos/dogtagpki/pki/pulls/4021",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0"
}