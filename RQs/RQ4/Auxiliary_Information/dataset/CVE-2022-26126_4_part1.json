{
  "cve_id": "CVE-2022-26126",
  "cwe_ids": [
    "CWE-119"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "FRRouting/frr",
  "commit_msg": "isisd: fix #10505 using base64 encoding\n\nUsing base64 instead of the raw string to encode\nthe binary data.\n\nSigned-off-by: whichbug <whichbug@github.com>",
  "commit_hash": "ac3133450de12ba86c051265fc0f1b12bc57b40c",
  "git_url": "https://github.com/FRRouting/frr/commit/ac3133450de12ba86c051265fc0f1b12bc57b40c",
  "file_path": "isisd/isis_nb_notifications.c",
  "func_name": "isis_notif_authentication_type_failure",
  "func_before": "void isis_notif_authentication_type_failure(const struct isis_circuit *circuit,\n\t\t\t\t\t    const char *raw_pdu,\n\t\t\t\t\t    size_t raw_pdu_len)\n{\n\tconst char *xpath = \"/frr-isisd:authentication-type-failure\";\n\tstruct list *arguments = yang_data_list_new();\n\tchar xpath_arg[XPATH_MAXLEN];\n\tstruct yang_data *data;\n\tstruct isis_area *area = circuit->area;\n\n\tnotif_prep_instance_hdr(xpath, area, \"default\", arguments);\n\tnotif_prepr_iface_hdr(xpath, circuit, arguments);\n\tsnprintf(xpath_arg, sizeof(xpath_arg), \"%s/raw-pdu\", xpath);\n\tdata = yang_data_new(xpath_arg, raw_pdu);\n\tlistnode_add(arguments, data);\n\n\thook_call(isis_hook_authentication_type_failure, circuit, raw_pdu,\n\t\t  raw_pdu_len);\n\n\tnb_notification_send(xpath, arguments);\n}",
  "abstract_func_before": "void isis_notif_authentication_type_failure(const struct isis_circuit *VAR_0,\n\t\t\t\t\t    const char *VAR_1,\n\t\t\t\t\t    size_t VAR_2)\n{\n\tconst char *VAR_3 = \"/frr-isisd:authentication-type-failure\";\n\tstruct list *VAR_4 = yang_data_list_new();\n\tchar VAR_5[VAR_6];\n\tstruct yang_data *VAR_7;\n\tstruct isis_area *VAR_8 = VAR_0->area;\n\n\tnotif_prep_instance_hdr(VAR_3, VAR_8, \"default\", VAR_4);\n\tnotif_prepr_iface_hdr(VAR_3, VAR_0, VAR_4);\n\tsnprintf(VAR_5, sizeof(VAR_5), \"%s/raw-pdu\", VAR_3);\n\tVAR_7 = yang_data_new(VAR_5, VAR_1);\n\tlistnode_add(VAR_4, VAR_7);\n\n\thook_call(VAR_9, VAR_0, VAR_1,\n\t\t  VAR_2);\n\n\tnb_notification_send(VAR_3, VAR_4);\n}",
  "func_graph_path_before": "FRRouting/frr/ac3133450de12ba86c051265fc0f1b12bc57b40c/isis_nb_notifications.c/vul/before/5.json",
  "func": "void isis_notif_authentication_type_failure(const struct isis_circuit *circuit,\n\t\t\t\t\t    const char *raw_pdu,\n\t\t\t\t\t    size_t raw_pdu_len)\n{\n\tconst char *xpath = \"/frr-isisd:authentication-type-failure\";\n\tstruct list *arguments = yang_data_list_new();\n\tchar xpath_arg[XPATH_MAXLEN];\n\tstruct yang_data *data;\n\tstruct isis_area *area = circuit->area;\n\n\tnotif_prep_instance_hdr(xpath, area, \"default\", arguments);\n\tnotif_prepr_iface_hdr(xpath, circuit, arguments);\n\tsnprintf(xpath_arg, sizeof(xpath_arg), \"%s/raw-pdu\", xpath);\n\tdata = yang_data_new_binary(xpath_arg, raw_pdu, raw_pdu_len);\n\tlistnode_add(arguments, data);\n\n\thook_call(isis_hook_authentication_type_failure, circuit, raw_pdu,\n\t\t  raw_pdu_len);\n\n\tnb_notification_send(xpath, arguments);\n}",
  "abstract_func": "void isis_notif_authentication_type_failure(const struct isis_circuit *VAR_0,\n\t\t\t\t\t    const char *VAR_1,\n\t\t\t\t\t    size_t VAR_2)\n{\n\tconst char *VAR_3 = \"/frr-isisd:authentication-type-failure\";\n\tstruct list *VAR_4 = yang_data_list_new();\n\tchar VAR_5[VAR_6];\n\tstruct yang_data *VAR_7;\n\tstruct isis_area *VAR_8 = VAR_0->area;\n\n\tnotif_prep_instance_hdr(VAR_3, VAR_8, \"default\", VAR_4);\n\tnotif_prepr_iface_hdr(VAR_3, VAR_0, VAR_4);\n\tsnprintf(VAR_5, sizeof(VAR_5), \"%s/raw-pdu\", VAR_3);\n\tVAR_7 = yang_data_new_binary(VAR_5, VAR_1, VAR_2);\n\tlistnode_add(VAR_4, VAR_7);\n\n\thook_call(VAR_9, VAR_0, VAR_1,\n\t\t  VAR_2);\n\n\tnb_notification_send(VAR_3, VAR_4);\n}",
  "func_graph_path": "FRRouting/frr/ac3133450de12ba86c051265fc0f1b12bc57b40c/isis_nb_notifications.c/vul/after/5.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -11,7 +11,7 @@\n \tnotif_prep_instance_hdr(xpath, area, \"default\", arguments);\n \tnotif_prepr_iface_hdr(xpath, circuit, arguments);\n \tsnprintf(xpath_arg, sizeof(xpath_arg), \"%s/raw-pdu\", xpath);\n-\tdata = yang_data_new(xpath_arg, raw_pdu);\n+\tdata = yang_data_new_binary(xpath_arg, raw_pdu, raw_pdu_len);\n \tlistnode_add(arguments, data);\n \n \thook_call(isis_hook_authentication_type_failure, circuit, raw_pdu,",
  "diff_line_info": {
    "deleted_lines": [
      "\tdata = yang_data_new(xpath_arg, raw_pdu);"
    ],
    "added_lines": [
      "\tdata = yang_data_new_binary(xpath_arg, raw_pdu, raw_pdu_len);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/FRRouting/frr/pull/10566",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/FRRouting/frr/pull/10566: 403 Client Error: Forbidden for url: https://api.github.com/repos/FRRouting/frr/pulls/10566",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.7,
  "Bug Filter Response": "The patch modifies data handling by switching from raw string to base64 encoding, likely to prevent data misinterpretation. However, it's not explicitly clear if this addresses a security flaw.\n\n**Final Classification:** Security Vulnerability Fix; **Confidence:** 0.7\n\nThe change improves data encoding, potentially mitigating injection risks, but lacks explicit security context."
}