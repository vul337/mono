{
  "cve_id": "CVE-2022-45868",
  "cwe_ids": [
    "CWE-312"
  ],
  "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "h2database",
  "commit_msg": "Disallow plain webAdminPassword values to force usage of hashes",
  "commit_hash": "23ee3d0b973923c135fa01356c8eaed40b895393",
  "git_url": "https://github.com/h2database/h2database/commit/23ee3d0b973923c135fa01356c8eaed40b895393",
  "file_path": "h2/src/main/org/h2/tools/Server.java",
  "func_name": "main",
  "func_before": "public static void main(String... args) throws SQLException {\n        new Server().runTool(args);\n    }",
  "abstract_func_before": "public static void main(String... VAR_0) throws SQLException {\n        new Server().runTool(VAR_0);\n    }",
  "func_graph_path_before": "h2database/23ee3d0b973923c135fa01356c8eaed40b895393/Server.java/vul/before/0.json",
  "func": "public static void main(String... args) throws SQLException {\n        Server server = new Server();\n        server.fromCommandLine = true;\n        server.runTool(args);\n    }",
  "abstract_func": "public static void main(String... VAR_0) throws SQLException {\n        Server VAR_1 = new Server();\n        VAR_1.fromCommandLine = true;\n        VAR_1.runTool(VAR_0);\n    }",
  "func_graph_path": "h2database/23ee3d0b973923c135fa01356c8eaed40b895393/Server.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,3 +1,5 @@\n public static void main(String... args) throws SQLException {\n-        new Server().runTool(args);\n+        Server server = new Server();\n+        server.fromCommandLine = true;\n+        server.runTool(args);\n     }",
  "diff_line_info": {
    "deleted_lines": [
      "        new Server().runTool(args);"
    ],
    "added_lines": [
      "        Server server = new Server();",
      "        server.fromCommandLine = true;",
      "        server.runTool(args);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/h2database/h2database/pull/3833",
  "description": {
    "pr_info": {
      "title": "Disallow plain webAdminPassword values to force usage of hashes",
      "number": 3833
    },
    "comment": [
      "`webAdminPassword` setting allowed both clear-text passwords and hashes of salted passwords from the beginning, but there were no documented methods for generation of such hashes. It was possible to write a clear-text password to configuration file and then save settings of H2 Console from H2 Console itself to get a configuration file with hashed password, but this way wasn't documented either.\r\n\r\n1. A new public method is added and documented for this purpose. This method requires at least 12 characters for more safety.\r\n2. Clear-text passwords from all sources are not accepted any more. Old installations with password hashes in configuration files will continue to work after this change.\r\n3. `runTool()` method still allows this parameter to be passed (now only with salted hash), but `main()` method rejects this parameter to make these strange people happy.\r\n\r\n(This setting is probably needed for less than 1% of users, why so many people think that it is something important?)\r\n\r\n@grandinj",
      "+1"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.9"
}