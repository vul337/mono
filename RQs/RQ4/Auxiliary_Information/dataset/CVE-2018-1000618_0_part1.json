{
  "cve_id": "CVE-2018-1000618",
  "cwe_ids": [
    "CWE-674"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "EOSIO/eos",
  "commit_msg": "Add limit to recursion",
  "commit_hash": "cf7209e703e6d3f7a5413e0cb1fe88a4d8e4b38d",
  "git_url": "https://github.com/EOSIO/eos/commit/cf7209e703e6d3f7a5413e0cb1fe88a4d8e4b38d",
  "file_path": "libraries/chain/include/eosio/chain/abi_serializer.hpp",
  "func_name": "abi_to_variant::add",
  "func_before": "void abi_to_variant::add( mutable_variant_object &mvo, const char* name, const M& v, Resolver resolver ) {\n      mutable_variant_object member_mvo;\n      fc::reflector<M>::visit( impl::abi_to_variant_visitor<M, Resolver>( member_mvo, v, resolver ) );\n      mvo(name, std::move(member_mvo));\n   }",
  "abstract_func_before": "void abi_to_variant::add( mutable_variant_object &VAR_0, const char* VAR_1, const M& VAR_2, Resolver VAR_3 ) {\n      mutable_variant_object VAR_4;\n      fc::reflector<M>::visit( impl::VAR_5<M, Resolver>( VAR_4, VAR_2, VAR_3 ) );\n      VAR_0(VAR_1, std::move(VAR_4));\n   }",
  "func_graph_path_before": "EOSIO/eos/cf7209e703e6d3f7a5413e0cb1fe88a4d8e4b38d/abi_serializer.hpp/vul/before/1.json",
  "func": "void abi_to_variant::add( mutable_variant_object &mvo, const char* name, const M& v, Resolver resolver, size_t recursion_depth ) {\n      FC_ASSERT( ++recursion_depth < abi_serializer::max_recursion_depth, \"recursive definition, max_recursion_depth\" );\n      mutable_variant_object member_mvo;\n      fc::reflector<M>::visit( impl::abi_to_variant_visitor<M, Resolver>( member_mvo, v, resolver, recursion_depth ) );\n      mvo(name, std::move(member_mvo));\n   }",
  "abstract_func": "void abi_to_variant::add( mutable_variant_object &VAR_0, const char* VAR_1, const M& VAR_2, Resolver VAR_3, size_t VAR_4 ) {\n      FC_ASSERT( ++VAR_4 < abi_serializer::max_recursion_depth, \"recursive definition, max_recursion_depth\" );\n      mutable_variant_object VAR_5;\n      fc::reflector<M>::visit( impl::VAR_6<M, Resolver>( VAR_5, VAR_2, VAR_3, VAR_4 ) );\n      VAR_0(VAR_1, std::move(VAR_5));\n   }",
  "func_graph_path": "EOSIO/eos/cf7209e703e6d3f7a5413e0cb1fe88a4d8e4b38d/abi_serializer.hpp/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,6 @@\n-void abi_to_variant::add( mutable_variant_object &mvo, const char* name, const M& v, Resolver resolver ) {\n+void abi_to_variant::add( mutable_variant_object &mvo, const char* name, const M& v, Resolver resolver, size_t recursion_depth ) {\n+      FC_ASSERT( ++recursion_depth < abi_serializer::max_recursion_depth, \"recursive definition, max_recursion_depth\" );\n       mutable_variant_object member_mvo;\n-      fc::reflector<M>::visit( impl::abi_to_variant_visitor<M, Resolver>( member_mvo, v, resolver ) );\n+      fc::reflector<M>::visit( impl::abi_to_variant_visitor<M, Resolver>( member_mvo, v, resolver, recursion_depth ) );\n       mvo(name, std::move(member_mvo));\n    }",
  "diff_line_info": {
    "deleted_lines": [
      "void abi_to_variant::add( mutable_variant_object &mvo, const char* name, const M& v, Resolver resolver ) {",
      "      fc::reflector<M>::visit( impl::abi_to_variant_visitor<M, Resolver>( member_mvo, v, resolver ) );"
    ],
    "added_lines": [
      "void abi_to_variant::add( mutable_variant_object &mvo, const char* name, const M& v, Resolver resolver, size_t recursion_depth ) {",
      "      FC_ASSERT( ++recursion_depth < abi_serializer::max_recursion_depth, \"recursive definition, max_recursion_depth\" );",
      "      fc::reflector<M>::visit( impl::abi_to_variant_visitor<M, Resolver>( member_mvo, v, resolver, recursion_depth ) );"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/EOSIO/eos/pull/4112",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/EOSIO/eos/pull/4112: 403 Client Error: Forbidden for url: https://api.github.com/repos/EOSIO/eos/pulls/4112",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.8,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 0.8\n\n**Reasoning:**\n\nThe patch introduces a recursion limit to prevent excessive recursion, which could be exploited for a denial-of-service. The code changes are consistent with the description, indicating a security fix."
}