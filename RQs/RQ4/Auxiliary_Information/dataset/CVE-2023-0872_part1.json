{
  "cve_id": "CVE-2023-0872",
  "cwe_ids": [
    "CWE-269"
  ],
  "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "OpenNMS/opennms",
  "commit_msg": "NMS-15703: Do not allow ROLE_REST to modify users",
  "commit_hash": "34ab169a74b2bc489ab06d0dbf33fee1ed94c93c",
  "git_url": "https://github.com/OpenNMS/opennms/commit/34ab169a74b2bc489ab06d0dbf33fee1ed94c93c",
  "file_path": "opennms-webapp-rest/src/main/java/org/opennms/web/rest/v1/UserRestService.java",
  "func_name": "hasEditRights",
  "func_before": "private static boolean hasEditRights(SecurityContext securityContext) {\n        if (securityContext.isUserInRole(Authentication.ROLE_ADMIN) || securityContext.isUserInRole(Authentication.ROLE_REST)) {\n            return true;\n        } else {\n            return false;\n        }\n    }",
  "abstract_func_before": "private static boolean hasEditRights(SecurityContext VAR_0) {\n        if (VAR_0.isUserInRole(VAR_1.ROLE_ADMIN) || VAR_0.isUserInRole(VAR_1.ROLE_REST)) {\n            return true;\n        } else {\n            return false;\n        }\n    }",
  "func_graph_path_before": "OpenNMS/opennms/34ab169a74b2bc489ab06d0dbf33fee1ed94c93c/UserRestService.java/vul/before/0.json",
  "func": "private static boolean hasEditRights(SecurityContext securityContext) {\n        if (securityContext.isUserInRole(Authentication.ROLE_ADMIN)) {\n            return true;\n        } else {\n            return false;\n        }\n    }",
  "abstract_func": "private static boolean hasEditRights(SecurityContext VAR_0) {\n        if (VAR_0.isUserInRole(VAR_1.ROLE_ADMIN)) {\n            return true;\n        } else {\n            return false;\n        }\n    }",
  "func_graph_path": "OpenNMS/opennms/34ab169a74b2bc489ab06d0dbf33fee1ed94c93c/UserRestService.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,5 @@\n private static boolean hasEditRights(SecurityContext securityContext) {\n-        if (securityContext.isUserInRole(Authentication.ROLE_ADMIN) || securityContext.isUserInRole(Authentication.ROLE_REST)) {\n+        if (securityContext.isUserInRole(Authentication.ROLE_ADMIN)) {\n             return true;\n         } else {\n             return false;",
  "diff_line_info": {
    "deleted_lines": [
      "        if (securityContext.isUserInRole(Authentication.ROLE_ADMIN) || securityContext.isUserInRole(Authentication.ROLE_REST)) {"
    ],
    "added_lines": [
      "        if (securityContext.isUserInRole(Authentication.ROLE_ADMIN)) {"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/OpenNMS/opennms/pull/6354",
  "description": {
    "pr_info": {
      "title": "NMS-15703: Do not allow ROLE_REST to modify users",
      "number": 6354
    },
    "comment": [
      "### All Contributors\r\n\r\n* [ ] Have you read our [Contribution Guidelines](https://github.com/OpenNMS/opennms/blob/develop/CONTRIBUTING.md)?\r\n* [ ] Have you (electronically) signed the [OpenNMS Contributor Agreement](https://cla-assistant.io/OpenNMS/opennms)?\r\n\r\n### Contribution Checklist\r\n\r\n* Please [make an issue in the OpenNMS issue tracker](https://opennms.atlassian.net/) if there isn't one already.<br />Once there is an issue, please:\r\n  1. update the title of this PR to be in the format: `${JIRA-ISSUE-NUMBER}: subject of pull request`\r\n  2. update the Jira link at the bottom of this comment to refer to the real issue number\r\n  3. prefix your commit messages with the issue number, if possible\r\n  4. once you've created this PR, please link to it in a comment in the Jira issue\r\n  Don't worry if this sounds like a lot, we can help you get things set up properly.\r\n* **If this code is likely to affect the UI, did you name your branch with `-smoke` in it to trigger smoke tests?**\r\n* If this is a new or updated feature, is there documentation for the new behavior?\r\n* If this is new code, are there unit and/or integration tests?\r\n* If this PR targets a `foundation-*` branch, does it try to avoid changing files in `$OPENNMS_HOME/etc/`?\r\n\r\n### What's Next?\r\n\r\nA PR should be assigned at least 2 reviewers.  If you know that someone would be a good person to review your code, feel free to add them.\r\n\r\nIf you need help making additions or changes to the documentation related to your changes, please let us know.\r\n\r\nIn any case, if anything is unclear or you want help getting your PR ready for merge, please don't hesitate to say something in the comments here,\r\nor in [the #opennms-development chat channel](https://chat.opennms.com/opennms/channels/opennms-development).\r\n\r\nOnce reviewer(s) accept the PR and the branch passes continuous integration, the PR is eligible for merge.\r\n\r\nAt that time, if you have commit access (are an OpenNMS Group employee or a member of the OGP) you are welcome to merge the PR when you're ready.\r\nOtherwise, a reviewer can merge it for you.\r\n\r\nThanks for taking time to contribute!\r\n\r\n### External References\r\n\r\n* Jira (Issue Tracker): https://opennms.atlassian.net/browse/NMS-15703\r\n\r\n",
      "> looks fine but this should go back to _at least_ `foundation-2023`, ideally `foundation-2019` if it still applies there (probably will)\r\n\r\nwow: rebased across 11180 commits."
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 0.9"
}