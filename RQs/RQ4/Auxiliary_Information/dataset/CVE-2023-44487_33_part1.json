{
  "cve_id": "CVE-2023-44487",
  "cwe_ids": [
    "CWE-400"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "cvss_is_v3": true,
  "repo_name": "facebook/proxygen",
  "commit_msg": "Re-sync with internal repository\n\nThe internal and external repositories are out of sync. This Pull Request attempts to brings them back in sync by patching the GitHub repository. Please carefully review this patch. You must disable ShipIt for your project in order to merge this pull request. DO NOT IMPORT this pull request. Instead, merge it directly on GitHub using the MERGE BUTTON. Re-enable ShipIt after merging.",
  "commit_hash": "0a00c43d64c58a85e6250120f2377302675b0fe3",
  "git_url": "https://github.com/facebook/proxygen/commit/0a00c43d64c58a85e6250120f2377302675b0fe3",
  "file_path": "proxygen/lib/http/codec/ControlMessageRateLimitFilter.h",
  "func_name": "setParams",
  "func_before": "void setParams(\n      uint32_t maxControlMsgsPerInterval,\n      uint32_t maxDirectErrorHandlingPerInterval,\n      std::chrono::milliseconds controlMsgIntervalDuration,\n      std::chrono::milliseconds directErrorHandlingIntervalDuration) {\n    maxControlMsgsPerInterval_ = maxControlMsgsPerInterval;\n    maxDirectErrorHandlingPerInterval_ = maxDirectErrorHandlingPerInterval;\n    controlMsgIntervalDuration_ = controlMsgIntervalDuration;\n    directErrorHandlingIntervalDuration_ = directErrorHandlingIntervalDuration;\n  }",
  "abstract_func_before": "void setParams(\n      uint32_t VAR_0,\n      uint32_t VAR_1,\n      std::chrono::milliseconds VAR_2,\n      std::chrono::milliseconds VAR_3) {\n    VAR_4 = VAR_0;\n    VAR_5 = VAR_1;\n    VAR_6 = VAR_2;\n    VAR_7 = VAR_3;\n  }",
  "func_graph_path_before": "facebook/proxygen/0a00c43d64c58a85e6250120f2377302675b0fe3/ControlMessageRateLimitFilter.h/vul/before/5.json",
  "func": "void setParams(uint32_t maxControlMsgsPerInterval,\n                 uint32_t maxDirectErrorHandlingPerInterval,\n                 uint32_t maxHeadersPerInterval,\n                 std::chrono::milliseconds controlMsgIntervalDuration,\n                 std::chrono::milliseconds directErrorHandlingIntervalDuration,\n                 std::chrono::milliseconds headersIntervalDuration) {\n    maxControlMsgsPerInterval_ = maxControlMsgsPerInterval;\n    maxDirectErrorHandlingPerInterval_ = maxDirectErrorHandlingPerInterval;\n    controlMsgIntervalDuration_ = controlMsgIntervalDuration;\n    directErrorHandlingIntervalDuration_ = directErrorHandlingIntervalDuration;\n    maxHeadersPerInterval_ = maxHeadersPerInterval;\n    headersIntervalDuration_ = headersIntervalDuration;\n  }",
  "abstract_func": "void setParams(uint32_t VAR_0,\n                 uint32_t VAR_1,\n                 uint32_t VAR_2,\n                 std::chrono::milliseconds VAR_3,\n                 std::chrono::milliseconds VAR_4,\n                 std::chrono::milliseconds VAR_5) {\n    VAR_6 = VAR_0;\n    VAR_7 = VAR_1;\n    VAR_8 = VAR_3;\n    VAR_9 = VAR_4;\n    VAR_10 = VAR_2;\n    VAR_11 = VAR_5;\n  }",
  "func_graph_path": "facebook/proxygen/0a00c43d64c58a85e6250120f2377302675b0fe3/ControlMessageRateLimitFilter.h/vul/after/5.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,10 +1,13 @@\n-void setParams(\n-      uint32_t maxControlMsgsPerInterval,\n-      uint32_t maxDirectErrorHandlingPerInterval,\n-      std::chrono::milliseconds controlMsgIntervalDuration,\n-      std::chrono::milliseconds directErrorHandlingIntervalDuration) {\n+void setParams(uint32_t maxControlMsgsPerInterval,\n+                 uint32_t maxDirectErrorHandlingPerInterval,\n+                 uint32_t maxHeadersPerInterval,\n+                 std::chrono::milliseconds controlMsgIntervalDuration,\n+                 std::chrono::milliseconds directErrorHandlingIntervalDuration,\n+                 std::chrono::milliseconds headersIntervalDuration) {\n     maxControlMsgsPerInterval_ = maxControlMsgsPerInterval;\n     maxDirectErrorHandlingPerInterval_ = maxDirectErrorHandlingPerInterval;\n     controlMsgIntervalDuration_ = controlMsgIntervalDuration;\n     directErrorHandlingIntervalDuration_ = directErrorHandlingIntervalDuration;\n+    maxHeadersPerInterval_ = maxHeadersPerInterval;\n+    headersIntervalDuration_ = headersIntervalDuration;\n   }",
  "diff_line_info": {
    "deleted_lines": [
      "void setParams(",
      "      uint32_t maxControlMsgsPerInterval,",
      "      uint32_t maxDirectErrorHandlingPerInterval,",
      "      std::chrono::milliseconds controlMsgIntervalDuration,",
      "      std::chrono::milliseconds directErrorHandlingIntervalDuration) {"
    ],
    "added_lines": [
      "void setParams(uint32_t maxControlMsgsPerInterval,",
      "                 uint32_t maxDirectErrorHandlingPerInterval,",
      "                 uint32_t maxHeadersPerInterval,",
      "                 std::chrono::milliseconds controlMsgIntervalDuration,",
      "                 std::chrono::milliseconds directErrorHandlingIntervalDuration,",
      "                 std::chrono::milliseconds headersIntervalDuration) {",
      "    maxHeadersPerInterval_ = maxHeadersPerInterval;",
      "    headersIntervalDuration_ = headersIntervalDuration;"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/facebook/proxygen/pull/466",
  "description": {
    "pr_info": {
      "title": "Re-sync with internal repository following CVE-2023-44487",
      "number": 466
    },
    "comment": [
      "The internal and external repositories are out of sync. This Pull Request attempts to brings them back in sync by patching the GitHub repository. Please carefully review this patch. You must disable ShipIt for your project in order to merge this pull request. DO NOT IMPORT this pull request. Instead, merge it directly on GitHub using the MERGE BUTTON. Re-enable ShipIt after merging.",
      "This resolves CVE-2023-44487."
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.1,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix\n\n**Confidence:** 0.1\n\nThe analysis indicates that the patch is not a security fix. The changes involve modifying function parameters, which is a core logic update without explicit security references.\n\n**Final Classification:** Defect Remediation & Feature Upgrades\n\n**Confidence:** 0.7\n\nThe code modifies function parameters, suggesting a feature upgrade. However, the commit message's inconsistency lowers confidence slightly."
}