{
  "cve_id": "CVE-2022-25914",
  "cwe_ids": [
    "CWE-Other"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "GoogleContainerTools/jib",
  "commit_msg": "Check if file exists when executable path is passed in through jib dockerClient.executable (#3744)\n\n* Check if file exists when executable path is passed in through jib.dockerClient.executable",
  "commit_hash": "67fa40bc2c484da0546333914ea07a89fe44eaaf",
  "git_url": "https://github.com/GoogleContainerTools/jib/commit/67fa40bc2c484da0546333914ea07a89fe44eaaf",
  "file_path": "jib-core/src/main/java/com/google/cloud/tools/jib/docker/CliDockerClient.java",
  "func_name": "isDefaultDockerInstalled",
  "func_before": "public static boolean isDefaultDockerInstalled() {\n    return isDockerInstalled(DEFAULT_DOCKER_CLIENT);\n  }",
  "abstract_func_before": "public static boolean isDefaultDockerInstalled() {\n    return isDockerInstalled(VAR_0);\n  }",
  "func_graph_path_before": "GoogleContainerTools/jib/67fa40bc2c484da0546333914ea07a89fe44eaaf/CliDockerClient.java/vul/before/1.json",
  "func": "public static boolean isDefaultDockerInstalled() {\n    try {\n      new ProcessBuilder(DEFAULT_DOCKER_CLIENT.toString()).start();\n      return true;\n    } catch (IOException ex) {\n      return false;\n    }\n  }",
  "abstract_func": "public static boolean isDefaultDockerInstalled() {\n    try {\n      new ProcessBuilder(VAR_0.toString()).start();\n      return true;\n    } catch (IOException VAR_1) {\n      return false;\n    }\n  }",
  "func_graph_path": "GoogleContainerTools/jib/67fa40bc2c484da0546333914ea07a89fe44eaaf/CliDockerClient.java/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,3 +1,8 @@\n public static boolean isDefaultDockerInstalled() {\n-    return isDockerInstalled(DEFAULT_DOCKER_CLIENT);\n+    try {\n+      new ProcessBuilder(DEFAULT_DOCKER_CLIENT.toString()).start();\n+      return true;\n+    } catch (IOException ex) {\n+      return false;\n+    }\n   }",
  "diff_line_info": {
    "deleted_lines": [
      "    return isDockerInstalled(DEFAULT_DOCKER_CLIENT);"
    ],
    "added_lines": [
      "    try {",
      "      new ProcessBuilder(DEFAULT_DOCKER_CLIENT.toString()).start();",
      "      return true;",
      "    } catch (IOException ex) {",
      "      return false;",
      "    }"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/GoogleContainerTools/jib/pull/3744",
  "description": {
    "pr_info": {
      "title": "Check if file exists when executable path is passed in through jib dockerClient.executable",
      "number": 3744
    },
    "comment": [
      "Currently, in order to verify if the docker path provided (either default or specified by the user) is installed correctly, we actually run the executable. The side effect of this is that any arbitrary executable can be executed by Jib.\r\n\r\nThis PR avoids the need to run the executable by using Files.isExecutable which verifies if the path provided exists and the JVM has the correct permissions to execute the path. However in the case of verifying whether docker is on PATH, running the `docker` command seems unavoidable at the moment. Reasoning in https://github.com/GoogleContainerTools/jib/pull/3744#discussion_r955307325\r\n\r\nVerified with `./gradlew jib-gradle-plugin:integrationTest`",
      "Kudos, SonarCloud Quality Gate passed!&nbsp; &nbsp; [![Quality Gate passed](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/QualityGateBadge/passed-16px.png 'Quality Gate passed')](https://sonarcloud.io/dashboard?id=GoogleContainerTools_jib&pullRequest=3744)\n\n[![Bug](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/bug-16px.png 'Bug')](https://sonarcloud.io/project/issues?id=GoogleContainerTools_jib&pullRequest=3744&resolved=false&types=BUG) [![A](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A-16px.png 'A')](https://sonarcloud.io/project/issues?id=GoogleContainerTools_jib&pullRequest=3744&resolved=false&types=BUG) [0 Bugs](https://sonarcloud.io/project/issues?id=GoogleContainerTools_jib&pullRequest=3744&resolved=false&types=BUG)  \n[![Vulnerability](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/vulnerability-16px.png 'Vulnerability')](https://sonarcloud.io/project/issues?id=GoogleContainerTools_jib&pullRequest=3744&resolved=false&types=VULNERABILITY) [![A](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A-16px.png 'A')](https://sonarcloud.io/project/issues?id=GoogleContainerTools_jib&pullRequest=3744&resolved=false&types=VULNERABILITY) [0 Vulnerabilities](https://sonarcloud.io/project/issues?id=GoogleContainerTools_jib&pullRequest=3744&resolved=false&types=VULNERABILITY)  \n[![Security Hotspot](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/security_hotspot-16px.png 'Security Hotspot')](https://sonarcloud.io/project/security_hotspots?id=GoogleContainerTools_jib&pullRequest=3744&resolved=false&types=SECURITY_HOTSPOT) [![A](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A-16px.png 'A')](https://sonarcloud.io/project/security_hotspots?id=GoogleContainerTools_jib&pullRequest=3744&resolved=false&types=SECURITY_HOTSPOT) [0 Security Hotspots](https://sonarcloud.io/project/security_hotspots?id=GoogleContainerTools_jib&pullRequest=3744&resolved=false&types=SECURITY_HOTSPOT)  \n[![Code Smell](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/code_smell-16px.png 'Code Smell')](https://sonarcloud.io/project/issues?id=GoogleContainerTools_jib&pullRequest=3744&resolved=false&types=CODE_SMELL) [![A](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A-16px.png 'A')](https://sonarcloud.io/project/issues?id=GoogleContainerTools_jib&pullRequest=3744&resolved=false&types=CODE_SMELL) [0 Code Smells](https://sonarcloud.io/project/issues?id=GoogleContainerTools_jib&pullRequest=3744&resolved=false&types=CODE_SMELL)\n\n[![20.0%](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/CoverageChart/0-16px.png '20.0%')](https://sonarcloud.io/component_measures?id=GoogleContainerTools_jib&pullRequest=3744&metric=new_coverage&view=list) [20.0% Coverage](https://sonarcloud.io/component_measures?id=GoogleContainerTools_jib&pullRequest=3744&metric=new_coverage&view=list)  \n[![0.0%](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/Duplications/3-16px.png '0.0%')](https://sonarcloud.io/component_measures?id=GoogleContainerTools_jib&pullRequest=3744&metric=new_duplicated_lines_density&view=list) [0.0% Duplication](https://sonarcloud.io/component_measures?id=GoogleContainerTools_jib&pullRequest=3744&metric=new_duplicated_lines_density&view=list)\n\n",
      "Thank you for the review @elefeint! Changes also succeeded on continuous build. The integration tests cover both scenarios: when default docker is installed and when docker executable is provided.  Will be merging this PR. "
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.7,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 0.7"
}