{
  "cve_id": "CVE-2021-29978",
  "cwe_ids": [
    "CWE-Other"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C",
  "cvss_is_v3": false,
  "repo_name": "mozilla-mobile/mozilla-vpn-client",
  "commit_msg": "Add rebase",
  "commit_hash": "c8440f464a2f5c4e7d4990152ee5850df8b23f42",
  "git_url": "https://github.com/mozilla-mobile/mozilla-vpn-client/commit/c8440f464a2f5c4e7d4990152ee5850df8b23f42",
  "file_path": "android/src/org/mozilla/firefox/vpn/qt/VPNWebView.java",
  "func_name": "onPageStarted",
  "func_before": "@Override\n        public void onPageStarted(WebView view, String url, Bitmap favicon)\n        {\n            Log.v(TAG, \"Url changed: \" + url);\n\n            super.onPageStarted(view, url, favicon);\n            nativeOnPageStarted(url, favicon);\n        }",
  "abstract_func_before": "@Override\n        public void onPageStarted(WebView VAR_0, String VAR_1, Bitmap VAR_2)\n        {\n            VAR_3.v(VAR_4, \"Url changed: \" + VAR_1);\n\n            super.onPageStarted(VAR_0, VAR_1, VAR_2);\n            nativeOnPageStarted(VAR_1, VAR_2);\n        }",
  "func_graph_path_before": "mozilla-mobile/mozilla-vpn-client/c8440f464a2f5c4e7d4990152ee5850df8b23f42/VPNWebView.java/vul/before/0.json",
  "func": "@Override\n        public void onPageStarted(WebView view, String url, Bitmap favicon) {\n          // While the login view is open, disable the ability to do screenshots.\n          m_activity.getWindow().addFlags(WindowManager.LayoutParams.FLAG_SECURE);\n\n          super.onPageStarted(view, url, favicon);\n          nativeOnPageStarted(url, favicon);\n        }",
  "abstract_func": "@Override\n        public void onPageStarted(WebView VAR_0, String VAR_1, Bitmap VAR_2) {\n          /* COMMENT_0 */\n          VAR_3.getWindow().addFlags(VAR_4.LayoutParams.FLAG_SECURE);\n\n          super.onPageStarted(VAR_0, VAR_1, VAR_2);\n          nativeOnPageStarted(VAR_1, VAR_2);\n        }",
  "func_graph_path": "mozilla-mobile/mozilla-vpn-client/c8440f464a2f5c4e7d4990152ee5850df8b23f42/VPNWebView.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,8 +1,8 @@\n @Override\n-        public void onPageStarted(WebView view, String url, Bitmap favicon)\n-        {\n-            Log.v(TAG, \"Url changed: \" + url);\n+        public void onPageStarted(WebView view, String url, Bitmap favicon) {\n+          // While the login view is open, disable the ability to do screenshots.\n+          m_activity.getWindow().addFlags(WindowManager.LayoutParams.FLAG_SECURE);\n \n-            super.onPageStarted(view, url, favicon);\n-            nativeOnPageStarted(url, favicon);\n+          super.onPageStarted(view, url, favicon);\n+          nativeOnPageStarted(url, favicon);\n         }",
  "diff_line_info": {
    "deleted_lines": [
      "        public void onPageStarted(WebView view, String url, Bitmap favicon)",
      "        {",
      "            Log.v(TAG, \"Url changed: \" + url);",
      "            super.onPageStarted(view, url, favicon);",
      "            nativeOnPageStarted(url, favicon);"
    ],
    "added_lines": [
      "        public void onPageStarted(WebView view, String url, Bitmap favicon) {",
      "          // While the login view is open, disable the ability to do screenshots.",
      "          m_activity.getWindow().addFlags(WindowManager.LayoutParams.FLAG_SECURE);",
      "          super.onPageStarted(view, url, favicon);",
      "          nativeOnPageStarted(url, favicon);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/mozilla-mobile/mozilla-vpn-client/pull/817",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/mozilla-mobile/mozilla-vpn-client/pull/817: 403 Client Error: Forbidden for url: https://api.github.com/repos/mozilla-mobile/mozilla-vpn-client/pulls/817",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "Final Classification: Security Vulnerability Fix; Confidence: 0.9\n\n**Final Classification:** Security Vulnerability Fix; **Confidence:** 0.9"
}