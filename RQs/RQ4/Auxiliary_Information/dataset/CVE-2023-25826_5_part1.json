{
  "cve_id": "CVE-2023-25826",
  "cwe_ids": [
    "CWE-78"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "OpenTSDB/opentsdb",
  "commit_msg": "Improved fix for #2261.\nRegular expressions wouldn't catch the newlines or possibly other\ncontrol characters. Now we'll use the TAG validation code to make\nsure the inputs are only plain ASCII printables first.\nFixes CVE-2018-12972, CVE-2020-35476",
  "commit_hash": "26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25",
  "git_url": "https://github.com/OpenTSDB/opentsdb/commit/26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25",
  "file_path": "test/tsd/TestGraphHandler.java",
  "func_name": "setSmoothParams",
  "func_before": "@Test\n  public void setSmoothParams() throws Exception {\n    assertPlotParam(\"smooth\", \"unique\");\n    assertPlotParam(\"smooth\", \"frequency\");\n    assertPlotParam(\"smooth\", \"fnormal\");\n    assertPlotParam(\"smooth\", \"cumulative\");\n    assertPlotParam(\"smooth\", \"cnormal\");\n    assertPlotParam(\"smooth\", \"bins\");\n    assertPlotParam(\"smooth\", \"csplines\");\n    assertPlotParam(\"smooth\", \"acsplines\");\n    assertPlotParam(\"smooth\", \"mcsplines\");\n    assertPlotParam(\"smooth\", \"bezier\");\n    assertPlotParam(\"smooth\", \"sbezier\");\n    assertPlotParam(\"smooth\", \"unwrap\");\n    assertPlotParam(\"smooth\", \"zsort\");\n    assertInvalidPlotParam(\"smooth\", \"[33:system(%20\");\n  }",
  "abstract_func_before": "@Test\n  public void setSmoothParams() throws Exception {\n    assertPlotParam(\"smooth\", \"unique\");\n    assertPlotParam(\"smooth\", \"frequency\");\n    assertPlotParam(\"smooth\", \"fnormal\");\n    assertPlotParam(\"smooth\", \"cumulative\");\n    assertPlotParam(\"smooth\", \"cnormal\");\n    assertPlotParam(\"smooth\", \"bins\");\n    assertPlotParam(\"smooth\", \"csplines\");\n    assertPlotParam(\"smooth\", \"acsplines\");\n    assertPlotParam(\"smooth\", \"mcsplines\");\n    assertPlotParam(\"smooth\", \"bezier\");\n    assertPlotParam(\"smooth\", \"sbezier\");\n    assertPlotParam(\"smooth\", \"unwrap\");\n    assertPlotParam(\"smooth\", \"zsort\");\n    assertInvalidPlotParam(\"smooth\", \"[33:system(%20\");\n  }",
  "func_graph_path_before": "OpenTSDB/opentsdb/26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25/TestGraphHandler.java/vul/before/6.json",
  "func": "@Test\n  public void setSmoothParams() throws Exception {\n    assertPlotParam(\"smooth\", \"unique\");\n    assertPlotParam(\"smooth\", \"frequency\");\n    assertPlotParam(\"smooth\", \"fnormal\");\n    assertPlotParam(\"smooth\", \"cumulative\");\n    assertPlotParam(\"smooth\", \"cnormal\");\n    assertPlotParam(\"smooth\", \"bins\");\n    assertPlotParam(\"smooth\", \"csplines\");\n    assertPlotParam(\"smooth\", \"acsplines\");\n    assertPlotParam(\"smooth\", \"mcsplines\");\n    assertPlotParam(\"smooth\", \"bezier\");\n    assertPlotParam(\"smooth\", \"sbezier\");\n    assertPlotParam(\"smooth\", \"unwrap\");\n    assertPlotParam(\"smooth\", \"zsort\");\n    assertInvalidPlotParam(\"smooth\", \"bezier%20system(%20\");\n    assertInvalidPlotParam(\"smooth\", \"fnormal%0asystem(%20\");\n  }",
  "abstract_func": "@Test\n  public void setSmoothParams() throws Exception {\n    assertPlotParam(\"smooth\", \"unique\");\n    assertPlotParam(\"smooth\", \"frequency\");\n    assertPlotParam(\"smooth\", \"fnormal\");\n    assertPlotParam(\"smooth\", \"cumulative\");\n    assertPlotParam(\"smooth\", \"cnormal\");\n    assertPlotParam(\"smooth\", \"bins\");\n    assertPlotParam(\"smooth\", \"csplines\");\n    assertPlotParam(\"smooth\", \"acsplines\");\n    assertPlotParam(\"smooth\", \"mcsplines\");\n    assertPlotParam(\"smooth\", \"bezier\");\n    assertPlotParam(\"smooth\", \"sbezier\");\n    assertPlotParam(\"smooth\", \"unwrap\");\n    assertPlotParam(\"smooth\", \"zsort\");\n    assertInvalidPlotParam(\"smooth\", \"bezier%20system(%20\");\n    assertInvalidPlotParam(\"smooth\", \"fnormal%0asystem(%20\");\n  }",
  "func_graph_path": "OpenTSDB/opentsdb/26be40a5e5b6ce8b0b1e4686c4b0d7911e5d8a25/TestGraphHandler.java/vul/after/6.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -13,5 +13,6 @@\n     assertPlotParam(\"smooth\", \"sbezier\");\n     assertPlotParam(\"smooth\", \"unwrap\");\n     assertPlotParam(\"smooth\", \"zsort\");\n-    assertInvalidPlotParam(\"smooth\", \"[33:system(%20\");\n+    assertInvalidPlotParam(\"smooth\", \"bezier%20system(%20\");\n+    assertInvalidPlotParam(\"smooth\", \"fnormal%0asystem(%20\");\n   }",
  "diff_line_info": {
    "deleted_lines": [
      "    assertInvalidPlotParam(\"smooth\", \"[33:system(%20\");"
    ],
    "added_lines": [
      "    assertInvalidPlotParam(\"smooth\", \"bezier%20system(%20\");",
      "    assertInvalidPlotParam(\"smooth\", \"fnormal%0asystem(%20\");"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/OpenTSDB/opentsdb/pull/2275",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/OpenTSDB/opentsdb/pull/2275: 403 Client Error: Forbidden for url: https://api.github.com/repos/OpenTSDB/opentsdb/pulls/2275",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "Final Classification: Security Vulnerability Fix; Confidence: 0.9"
}