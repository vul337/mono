{
  "cve_id": "CVE-2021-25924",
  "cwe_ids": [
    "CWE-352"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:C/I:C/A:C",
  "cvss_is_v3": false,
  "repo_name": "gocd",
  "commit_msg": "#000 - Add missing Content-Type check",
  "commit_hash": "7d0baab0d361c377af84994f95ba76c280048548",
  "git_url": "https://github.com/gocd/gocd/commit/7d0baab0d361c377af84994f95ba76c280048548",
  "file_path": "api/api-backup-config-v1/src/main/java/com/thoughtworks/go/apiv1/backupconfig/BackupConfigControllerV1.java",
  "func_name": "setupRoutes",
  "func_before": "@Override\n    public void setupRoutes() {\n        path(controllerBasePath(), () -> {\n            before(\"\", mimeType, this::setContentType);\n\n\n            // change the line below to enable appropriate security\n            before(\"\", mimeType, this.apiAuthenticationHelper::checkAdminUserAnd403);\n\n            get(\"\", mimeType, this::show);\n\n            post(\"\", mimeType, this::createOrUpdate);\n            put(\"\", mimeType, this::createOrUpdate);\n\n            delete(\"\", mimeType, this::deleteBackupConfig);\n        });\n    }",
  "abstract_func_before": "@Override\n    public void setupRoutes() {\n        path(controllerBasePath(), () -> {\n            before(\"\", VAR_0, this::VAR_1);\n\n\n            /* COMMENT_0 */\n            before(\"\", VAR_0, this.apiAuthenticationHelper::VAR_2);\n\n            get(\"\", VAR_0, this::VAR_3);\n\n            post(\"\", VAR_0, this::VAR_4);\n            put(\"\", VAR_0, this::VAR_4);\n\n            delete(\"\", VAR_0, this::VAR_5);\n        });\n    }",
  "func_graph_path_before": "gocd/7d0baab0d361c377af84994f95ba76c280048548/BackupConfigControllerV1.java/vul/before/0.json",
  "func": "@Override\n    public void setupRoutes() {\n        path(controllerBasePath(), () -> {\n            before(\"\", mimeType, this::setContentType);\n            before(\"/*\", mimeType, this::setContentType);\n            before(\"\", mimeType, this::verifyContentType);\n            before(\"/*\", mimeType, this::verifyContentType);\n\n            // change the line below to enable appropriate security\n            before(\"\", mimeType, this.apiAuthenticationHelper::checkAdminUserAnd403);\n\n            get(\"\", mimeType, this::show);\n\n            post(\"\", mimeType, this::createOrUpdate);\n            put(\"\", mimeType, this::createOrUpdate);\n\n            delete(\"\", mimeType, this::deleteBackupConfig);\n        });\n    }",
  "abstract_func": "@Override\n    public void setupRoutes() {\n        path(controllerBasePath(), () -> {\n            before(\"\", VAR_0, this::VAR_1);\n            before(\"/*\", VAR_0, this::VAR_1);\n            before(\"\", VAR_0, this::VAR_2);\n            before(\"/*\", VAR_0, this::VAR_2);\n\n            /* COMMENT_0 */\n            before(\"\", VAR_0, this.apiAuthenticationHelper::VAR_3);\n\n            get(\"\", VAR_0, this::VAR_4);\n\n            post(\"\", VAR_0, this::VAR_5);\n            put(\"\", VAR_0, this::VAR_5);\n\n            delete(\"\", VAR_0, this::VAR_6);\n        });\n    }",
  "func_graph_path": "gocd/7d0baab0d361c377af84994f95ba76c280048548/BackupConfigControllerV1.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -2,7 +2,9 @@\n     public void setupRoutes() {\n         path(controllerBasePath(), () -> {\n             before(\"\", mimeType, this::setContentType);\n-\n+            before(\"/*\", mimeType, this::setContentType);\n+            before(\"\", mimeType, this::verifyContentType);\n+            before(\"/*\", mimeType, this::verifyContentType);\n \n             // change the line below to enable appropriate security\n             before(\"\", mimeType, this.apiAuthenticationHelper::checkAdminUserAnd403);",
  "diff_line_info": {
    "deleted_lines": [
      ""
    ],
    "added_lines": [
      "            before(\"/*\", mimeType, this::setContentType);",
      "            before(\"\", mimeType, this::verifyContentType);",
      "            before(\"/*\", mimeType, this::verifyContentType);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/gocd/gocd/pull/9073",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/gocd/gocd/pull/9073: 403 Client Error: Forbidden for url: https://api.github.com/repos/gocd/gocd/pulls/9073",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 0.95"
}