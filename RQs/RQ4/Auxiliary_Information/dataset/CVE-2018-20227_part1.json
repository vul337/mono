{
  "cve_id": "CVE-2018-20227",
  "cwe_ids": [
    "CWE-22"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "eclipse-rdf4j/rdf4j",
  "commit_msg": "Verify that zip file entries don't try to escape the parent dir + test\n\nSigned-off-by: Bart Hanssens <bart.hanssens@bosa.fgov.be>",
  "commit_hash": "df15a4d7a8f2789c043b27c9eafe1b30316cfa79",
  "git_url": "https://github.com/eclipse-rdf4j/rdf4j/commit/df15a4d7a8f2789c043b27c9eafe1b30316cfa79",
  "file_path": "util/src/main/java/org/eclipse/rdf4j/common/io/ZipUtil.java",
  "func_name": "extract",
  "func_before": "public static void extract(File zipFile, File destDir)\n\t\tthrows IOException\n\t{\n\t\ttry (ZipFile zf = new ZipFile(zipFile)) {\n\t\t\textract(zf, destDir);\n\t\t}\n\t}",
  "abstract_func_before": "public static void extract(File VAR_0, File VAR_1)\n\t\tthrows IOException\n\t{\n\t\ttry (ZipFile VAR_2 = new ZipFile(VAR_0)) {\n\t\t\textract(VAR_2, VAR_1);\n\t\t}\n\t}",
  "func_graph_path_before": "eclipse-rdf4j/rdf4j/df15a4d7a8f2789c043b27c9eafe1b30316cfa79/ZipUtil.java/vul/before/0.json",
  "func": "public static void extract(File zipFile, File destDir) throws IOException {\n\t\ttry (ZipFile zf = new ZipFile(zipFile)) {\n\t\t\textract(zf, destDir);\n\t\t}\n\t}",
  "abstract_func": "public static void extract(File VAR_0, File VAR_1) throws IOException {\n\t\ttry (ZipFile VAR_2 = new ZipFile(VAR_0)) {\n\t\t\textract(VAR_2, VAR_1);\n\t\t}\n\t}",
  "func_graph_path": "eclipse-rdf4j/rdf4j/df15a4d7a8f2789c043b27c9eafe1b30316cfa79/ZipUtil.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,6 +1,4 @@\n-public static void extract(File zipFile, File destDir)\n-\t\tthrows IOException\n-\t{\n+public static void extract(File zipFile, File destDir) throws IOException {\n \t\ttry (ZipFile zf = new ZipFile(zipFile)) {\n \t\t\textract(zf, destDir);\n \t\t}",
  "diff_line_info": {
    "deleted_lines": [
      "public static void extract(File zipFile, File destDir)",
      "\t\tthrows IOException",
      "\t{"
    ],
    "added_lines": [
      "public static void extract(File zipFile, File destDir) throws IOException {"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/eclipse-rdf4j/rdf4j/pull/1211",
  "description": {
    "pr_info": {
      "title": "Verify that zip file entries don't try to escape the parent dir + test",
      "number": 1211
    },
    "comment": [
      "This PR addresses GitHub issue: #1210 .\r\n\r\nBriefly describe the changes proposed in this PR:\r\n\r\n* Check if zip file entries try to 'escape' / 'break out' of the directory  (i.e. tricks like `../../../etc/`)\r\n* Added test to check if a file \r\n* Minor code formatting\r\n",
      "Great that you made tests!"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.9\n\nThe changes address a possible zip file directory traversal vulnerability, adding a check and a test, clearly a security fix."
}