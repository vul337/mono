{
  "cve_id": "CVE-2019-9843",
  "cwe_ids": [
    "CWE-611"
  ],
  "cvss_vector": "AV:N/AC:H/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "diffplug/spotless",
  "commit_msg": "Applied Spotless. Refactored preferences. Updated README.",
  "commit_hash": "451251ff6a8534173e0db7cbd9dd7cbc26522cf7",
  "git_url": "https://github.com/diffplug/spotless/commit/451251ff6a8534173e0db7cbd9dd7cbc26522cf7",
  "file_path": "_ext/eclipse-wtp/src/main/java/com/diffplug/spotless/extra/eclipse/wtp/EclipseXmlFormatterStepImpl.java",
  "func_name": "setupFramework",
  "func_before": "private static void setupFramework(boolean resolveExternalURI) throws BundleException {\n\t\tif (SpotlessEclipseFramework.setup(\n\t\t\t\tplugins -> {\n\t\t\t\t\tplugins.applyDefault();\n\t\t\t\t\t//The WST XML formatter\n\t\t\t\t\tplugins.add(new XMLCorePlugin());\n\t\t\t\t\t//XSDs/DTDs must be resolved by URI\n\t\t\t\t\tplugins.add(new URIResolverPlugin());\n\t\t\t\t\t//Support formatting based on DTD restrictions\n\t\t\t\t\tplugins.add(new DTDCorePlugin());\n\t\t\t\t\t//Support formatting based on XSD restrictions\n\t\t\t\t\tplugins.add(new XSDCorePlugin());\n\t\t\t\t\tif(!resolveExternalURI) {\n\t\t\t\t\t\tplugins.add(new PreventExternalURIResolverExtension());\n\t\t\t\t\t}\n\t\t\t\t})) {\n\t\t\tPREFERENCE_FACTORY = new XmlFormattingPreferencesFactory();\n\t\t\t//Register required EMF factories\n\t\t\tXSDSchemaBuildingTools.getXSDFactory();\n\t\t}\n\t}",
  "abstract_func_before": "private static void setupFramework(boolean VAR_0) throws BundleException {\n\t\tif (VAR_1.setup(\n\t\t\t\tVAR_2 -> {\n\t\t\t\t\tVAR_2.applyDefault();\n\t\t\t\t\t/* COMMENT_0 */\n\t\t\t\t\tVAR_2.add(new XMLCorePlugin());\n\t\t\t\t\t/* COMMENT_1 */\n\t\t\t\t\tVAR_2.add(new URIResolverPlugin());\n\t\t\t\t\t/* COMMENT_2 */\n\t\t\t\t\tVAR_2.add(new DTDCorePlugin());\n\t\t\t\t\t/* COMMENT_3 */\n\t\t\t\t\tVAR_2.add(new XSDCorePlugin());\n\t\t\t\t\tif(!VAR_0) {\n\t\t\t\t\t\tVAR_2.add(new PreventExternalURIResolverExtension());\n\t\t\t\t\t}\n\t\t\t\t})) {\n\t\t\tVAR_3 = new XmlFormattingPreferencesFactory();\n\t\t\t/* COMMENT_4 */\n\t\t\tVAR_4.getXSDFactory();\n\t\t}\n\t}",
  "func_graph_path_before": "diffplug/spotless/451251ff6a8534173e0db7cbd9dd7cbc26522cf7/EclipseXmlFormatterStepImpl.java/vul/before/0.json",
  "func": "private static void setupFramework(boolean resolveExternalURI) throws BundleException {\n\t\tif (SpotlessEclipseFramework.setup(\n\t\t\t\tplugins -> {\n\t\t\t\t\tplugins.applyDefault();\n\t\t\t\t\t//The WST XML formatter\n\t\t\t\t\tplugins.add(new XMLCorePlugin());\n\t\t\t\t\t//XSDs/DTDs must be resolved by URI\n\t\t\t\t\tplugins.add(new URIResolverPlugin());\n\t\t\t\t\t//Support formatting based on DTD restrictions\n\t\t\t\t\tplugins.add(new DTDCorePlugin());\n\t\t\t\t\t//Support formatting based on XSD restrictions\n\t\t\t\t\tplugins.add(new XSDCorePlugin());\n\t\t\t\t\tif (!resolveExternalURI) {\n\t\t\t\t\t\tplugins.add(new PreventExternalURIResolverExtension());\n\t\t\t\t\t}\n\t\t\t\t})) {\n\t\t\tPREFERENCE_FACTORY = new XmlFormattingPreferencesFactory();\n\t\t\t//Register required EMF factories\n\t\t\tXSDSchemaBuildingTools.getXSDFactory();\n\t\t}\n\t}",
  "abstract_func": "private static void setupFramework(boolean VAR_0) throws BundleException {\n\t\tif (VAR_1.setup(\n\t\t\t\tVAR_2 -> {\n\t\t\t\t\tVAR_2.applyDefault();\n\t\t\t\t\t/* COMMENT_0 */\n\t\t\t\t\tVAR_2.add(new XMLCorePlugin());\n\t\t\t\t\t/* COMMENT_1 */\n\t\t\t\t\tVAR_2.add(new URIResolverPlugin());\n\t\t\t\t\t/* COMMENT_2 */\n\t\t\t\t\tVAR_2.add(new DTDCorePlugin());\n\t\t\t\t\t/* COMMENT_3 */\n\t\t\t\t\tVAR_2.add(new XSDCorePlugin());\n\t\t\t\t\tif (!VAR_0) {\n\t\t\t\t\t\tVAR_2.add(new PreventExternalURIResolverExtension());\n\t\t\t\t\t}\n\t\t\t\t})) {\n\t\t\tVAR_3 = new XmlFormattingPreferencesFactory();\n\t\t\t/* COMMENT_4 */\n\t\t\tVAR_4.getXSDFactory();\n\t\t}\n\t}",
  "func_graph_path": "diffplug/spotless/451251ff6a8534173e0db7cbd9dd7cbc26522cf7/EclipseXmlFormatterStepImpl.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -10,7 +10,7 @@\n \t\t\t\t\tplugins.add(new DTDCorePlugin());\n \t\t\t\t\t//Support formatting based on XSD restrictions\n \t\t\t\t\tplugins.add(new XSDCorePlugin());\n-\t\t\t\t\tif(!resolveExternalURI) {\n+\t\t\t\t\tif (!resolveExternalURI) {\n \t\t\t\t\t\tplugins.add(new PreventExternalURIResolverExtension());\n \t\t\t\t\t}\n \t\t\t\t})) {",
  "diff_line_info": {
    "deleted_lines": [
      "\t\t\t\t\tif(!resolveExternalURI) {"
    ],
    "added_lines": [
      "\t\t\t\t\tif (!resolveExternalURI) {"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/diffplug/spotless/pull/369",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/diffplug/spotless/pull/369: 403 Client Error: Forbidden for url: https://api.github.com/repos/diffplug/spotless/pulls/369",
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Defect Remediation & Feature Upgrades; **Confidence:** 0.95\n\nStep-by-Step Explanation:\n\n1. **Commit Message Analysis:** The commit includes Spotless, refactoring, and README update, indicating code organization and documentation changes.\n\n2. **Vulnerability Description Insight:** The issue is about preventing Build errors due to unresolvable URIs, not related to security exploits.\n\n3. **Code Diff Review:** The change modifies the condition to ignore external URIs, enhancing build reliability.\n\n4. **Purpose Evaluation:** The fix addresses a functional bug affecting CI, not a security risk.\n\n5. **Security Assessment:** No security-related terms or vulnerabilities are present in the description or code.\n\n6. **Confidence Scoring:** High confidence as the changes directly address a non-security bug affecting build processes."
}