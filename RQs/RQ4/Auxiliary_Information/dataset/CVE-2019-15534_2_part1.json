{
  "cve_id": "CVE-2019-15534",
  "cwe_ids": [
    "CWE-89"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "folio-org/raml-module-builder",
  "commit_msg": "RMB-200: Single quote SQL Injection in PostgresClient.update(table, updateSection, ...)",
  "commit_hash": "b7ef741133e57add40aa4cb19430a0065f378a94",
  "git_url": "https://github.com/folio-org/raml-module-builder/commit/b7ef741133e57add40aa4cb19430a0065f378a94",
  "file_path": "domain-models-runtime/src/main/java/org/folio/rest/persist/Criteria/UpdateSection.java",
  "func_name": "addField",
  "func_before": "public UpdateSection addField(String field){\n    fieldHierarchy.add(field);\n    return this;\n  }",
  "abstract_func_before": "public UpdateSection addField(String VAR_0){\n    VAR_1.add(VAR_0);\n    return this;\n  }",
  "func_graph_path_before": "folio-org/raml-module-builder/b7ef741133e57add40aa4cb19430a0065f378a94/UpdateSection.java/vul/before/0.json",
  "func": "public UpdateSection addField(String field){\n    if (! fieldPattern.matcher(field).matches()) {\n      throw new IllegalArgumentException(\"Field name with illegal character: '\" + field + \"'\");\n    }\n    fieldHierarchy.add(field);\n    return this;\n  }",
  "abstract_func": "public UpdateSection addField(String VAR_0){\n    if (! VAR_1.matcher(VAR_0).matches()) {\n      throw new IllegalArgumentException(\"Field name with illegal character: '\" + VAR_0 + \"'\");\n    }\n    VAR_2.add(VAR_0);\n    return this;\n  }",
  "func_graph_path": "folio-org/raml-module-builder/b7ef741133e57add40aa4cb19430a0065f378a94/UpdateSection.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,7 @@\n public UpdateSection addField(String field){\n+    if (! fieldPattern.matcher(field).matches()) {\n+      throw new IllegalArgumentException(\"Field name with illegal character: '\" + field + \"'\");\n+    }\n     fieldHierarchy.add(field);\n     return this;\n   }",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "    if (! fieldPattern.matcher(field).matches()) {",
      "      throw new IllegalArgumentException(\"Field name with illegal character: '\" + field + \"'\");",
      "    }"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/folio-org/raml-module-builder/pull/501",
  "description": {
    "pr_info": {
      "title": "RMB-200: Single quote SQL Injection in PostgresClient.update with updateSection",
      "number": 501
    },
    "comment": [
      "CVE-2019-15534 has been assigned to this vulnerability: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-15534\r\n\r\nLink to our issue tracker: https://issues.folio.org/browse/RMB-200\r\n\r\nAffected versions: All below 27.0.0.",
      "Everything seems fine with this change."
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0  \nThe commit explicitly addresses a SQL injection vulnerability with a CVE ID, and the code adds validation to prevent such attacks, indicating a clear security fix."
}