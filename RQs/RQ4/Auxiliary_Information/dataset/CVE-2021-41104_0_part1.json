{
  "cve_id": "CVE-2021-41104",
  "cwe_ids": [
    "CWE-306"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
  "cvss_is_v3": false,
  "repo_name": "esphome",
  "commit_msg": "Fix lint issues in web_server_base",
  "commit_hash": "207cde1667d8c799a197b78ca8a5a14de8d5ca1e",
  "git_url": "https://github.com/esphome/esphome/commit/207cde1667d8c799a197b78ca8a5a14de8d5ca1e",
  "file_path": "esphome/components/web_server_base/web_server_base.h",
  "func_name": "set_auth_password",
  "func_before": "void set_auth_password(std::string auth_password) { credentials_.password = auth_password; }",
  "abstract_func_before": "void set_auth_password(std::string VAR_0) { VAR_1.password = VAR_0; }",
  "func_graph_path_before": "esphome/207cde1667d8c799a197b78ca8a5a14de8d5ca1e/web_server_base.h/vul/before/1.json",
  "func": "void set_auth_password(std::string auth_password) { credentials_.password = std::move(auth_password); }",
  "abstract_func": "void set_auth_password(std::string VAR_0) { VAR_1.password = std::move(VAR_0); }",
  "func_graph_path": "esphome/207cde1667d8c799a197b78ca8a5a14de8d5ca1e/web_server_base.h/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1 +1 @@\n-void set_auth_password(std::string auth_password) { credentials_.password = auth_password; }\n+void set_auth_password(std::string auth_password) { credentials_.password = std::move(auth_password); }",
  "diff_line_info": {
    "deleted_lines": [
      "void set_auth_password(std::string auth_password) { credentials_.password = auth_password; }"
    ],
    "added_lines": [
      "void set_auth_password(std::string auth_password) { credentials_.password = std::move(auth_password); }"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/esphome/esphome/pull/2409",
  "description": {
    "pr_info": {
      "title": "Fix lint issues in web_server_base",
      "number": 2409
    },
    "comment": [
      "# What does this implement/fix? \n\nQuick description and explanation of changes\n\n## Types of changes\n\n- [ ] Bugfix (non-breaking change which fixes an issue)\n- [ ] New feature (non-breaking change which adds functionality)\n- [ ] Breaking change (fix or feature that would cause existing functionality to not work as expected)\n- [ ] Other\n\n**Related issue or feature (if applicable):** fixes <link to issue>\n\n**Pull request in [esphome-docs](https://github.com/esphome/esphome-docs) with documentation (if applicable):** esphome/esphome-docs#<esphome-docs PR number goes here>\n\n## Test Environment\n\n- [ ] ESP32\n- [ ] ESP8266\n\n## Example entry for `config.yaml`:\n<!--\n  Supplying a configuration snippet, makes it easier for a maintainer to test\n  your PR. Furthermore, for new integrations, it gives an impression of how\n  the configuration would look like.\n  Note: Remove this section if this PR does not have an example entry.\n-->\n\n```yaml\n# Example config.yaml\n\n```\n\n## Checklist:\n  - [ ] The code change is tested and works locally.\n  - [ ] Tests have been added to verify that the new code works (under `tests/` folder).\n  \nIf user exposed functionality or configuration variables are added/changed:\n  - [ ] Documentation added/updated in [esphome-docs](https://github.com/esphome/esphome-docs).\n",
      "Hey there @ottowinter, mind taking a look at this pull request as it has been labeled with an integration (`web_server_base`) you are listed as a [code owner](https://github.com/esphome/esphome/blob/dev/CODEOWNERS#L178) for? Thanks!\n<sub><sup>(message by CodeOwnersMention)</sup></sub>"
    ]
  },
  "Bug Filter": "Supporting & Non-Core Improvements",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Step-by-Step Explanation:**\n\n1. **Commit Message Analysis:** The commit message mentions fixing lint issues, indicating code style or formatting improvements rather than security fixes.\n\n2. **Vulnerability Description:** The description is generic, focusing on types of changes and testing without mentioning security concerns or CVE identifiers.\n\n3. **Code Diff:** The change involves using `std::move` for potential efficiency gains in a password setting function, but this doesn't address any security vulnerabilities.\n\n4. **Purpose Evaluation:** The change is a code optimization, not a bug fix or feature enhancement related to security.\n\n5. **Classification:** Since the change isn't a security fix, it falls under \"Supporting & Non-Core Improvements\" as it optimizes resource management without affecting core functionality.\n\n**Final Classification:** Supporting & Non-Core Improvements  \n**Confidence:** 0.9\n\n**Explanation:**\nThe patch addresses code linting issues and optimizes resource management through `std::move`. There are no security implications or fixes made in the code, so it's classified as a supporting improvement with high confidence."
}