{
  "cve_id": "CVE-2023-48795",
  "cwe_ids": [
    "CWE-354"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N",
  "cvss_is_v3": true,
  "repo_name": "janmojzis/tinyssh",
  "commit_msg": "packet_{get,put}: add overflow checks",
  "commit_hash": "ca4a78f5e716b568b5c15ec26ef2f11ecf81431b",
  "git_url": "https://github.com/janmojzis/tinyssh/commit/ca4a78f5e716b568b5c15ec26ef2f11ecf81431b",
  "file_path": "tinyssh/packet_get.c",
  "func_name": "packet_get_",
  "func_before": "static int packet_get_(struct buf *b) {\n\n    if (packet.flagkeys) {\n        return sshcrypto_packet_get(b);\n    }\n    else {\n        return packet_get_plain_(b);\n    }\n}",
  "abstract_func_before": "static int packet_get_(struct buf *VAR_0) {\n\n    if (VAR_1.flagkeys) {\n        return sshcrypto_packet_get(VAR_0);\n    }\n    else {\n        return packet_get_plain_(VAR_0);\n    }\n}",
  "func_graph_path_before": "janmojzis/tinyssh/ca4a78f5e716b568b5c15ec26ef2f11ecf81431b/packet_get.c/vul/before/0.json",
  "func": "static int packet_get_(struct buf *b) {\n\n    if (packet.flagkeys) {\n        return sshcrypto_packet_get(b);\n    }\n    else {\n        return packet_get_plain_(b);\n    }\n\n    /* overflow check */\n    if (!packet.receivepacketid) {\n        log_f1(\"receivepacketid overflow\");\n        global_die(111);\n    }\n}",
  "abstract_func": "static int packet_get_(struct buf *VAR_0) {\n\n    if (VAR_1.flagkeys) {\n        return sshcrypto_packet_get(VAR_0);\n    }\n    else {\n        return packet_get_plain_(VAR_0);\n    }\n\n    /* COMMENT_0 */\n    if (!VAR_1.receivepacketid) {\n        log_f1(\"receivepacketid overflow\");\n        global_die(111);\n    }\n}",
  "func_graph_path": "janmojzis/tinyssh/ca4a78f5e716b568b5c15ec26ef2f11ecf81431b/packet_get.c/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -6,4 +6,10 @@\n     else {\n         return packet_get_plain_(b);\n     }\n+\n+    /* overflow check */\n+    if (!packet.receivepacketid) {\n+        log_f1(\"receivepacketid overflow\");\n+        global_die(111);\n+    }\n }",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "",
      "    /* overflow check */",
      "    if (!packet.receivepacketid) {",
      "        log_f1(\"receivepacketid overflow\");",
      "        global_die(111);",
      "    }"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/janmojzis/tinyssh/pull/82",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/janmojzis/tinyssh/pull/82: 403 Client Error: Forbidden for url: https://api.github.com/repos/janmojzis/tinyssh/pulls/82",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0"
}