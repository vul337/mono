{
  "cve_id": "CVE-2021-21253",
  "cwe_ids": [
    "CWE-916"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
  "cvss_is_v3": false,
  "repo_name": "bijaythapaa/OnlineVotingSystem",
  "commit_msg": "Add a salt to SHA-256 hash",
  "commit_hash": "0181cb0272857696c8eb3e44fcf6cb014ff90f09",
  "git_url": "https://github.com/bijaythapaa/OnlineVotingSystem/commit/0181cb0272857696c8eb3e44fcf6cb014ff90f09",
  "file_path": "src/com/bijay/onlinevotingsystem/controller/AdminLoginController.java",
  "func_name": "doPost",
  "func_before": "protected void doPost(HttpServletRequest request, HttpServletResponse response)\n\t\t\tthrows ServletException, IOException {\n\n\t\t// to get values from the login page\n\t\tString userName = request.getParameter(\"aname\");\n\t\tString password = sha.getSHA(request.getParameter(\"pass\"));\n\t\t// String password = request.getParameter(\"pass\");\n\t\tString rememberMe = request.getParameter(\"remember-me\");\n\n\t\t// validation\n\n\t\tif (adminDao.loginValidate(userName, password)) {\n\n\t\t\tif (rememberMe != null) {\n\t\t\t\tCookie cookie1 = new Cookie(\"uname\", userName);\n\t\t\t\tCookie cookie2 = new Cookie(\"pass\", password);\n\n\t\t\t\tcookie1.setMaxAge(24 * 60 * 60);\n\t\t\t\tcookie2.setMaxAge(24 * 60 * 60);\n\n\t\t\t\tresponse.addCookie(cookie1);\n\t\t\t\tresponse.addCookie(cookie2);\n\t\t\t}\n\n\t\t\t// to display the name of logged-in person in home page\n\t\t\tHttpSession session = request.getSession();\n\t\t\tsession.setAttribute(\"username\", userName);\n\n\t\t\t/*\n\t\t\t * RequestDispatcher rd =\n\t\t\t * request.getRequestDispatcher(\"AdminController?actions=admin_list\");\n\t\t\t * rd.forward(request, response);\n\t\t\t */\n\n\t\t\tresponse.sendRedirect(\"AdminController?actions=admin_list\");\n\t\t} else {\n\t\t\tRequestDispatcher rd = request.getRequestDispatcher(\"adminlogin.jsp\");\n\t\t\trequest.setAttribute(\"loginFailMsg\", \"Invalid Username or Password !!\");\n\t\t\trd.include(request, response);\n\t\t}\n\t}",
  "abstract_func_before": "protected void doPost(HttpServletRequest VAR_0, HttpServletResponse VAR_1)\n\t\t\tthrows ServletException, IOException {\n\n\t\t/* COMMENT_0 */\n\t\tString VAR_2 = VAR_0.getParameter(\"aname\");\n\t\tString VAR_3 = VAR_4.getSHA(VAR_0.getParameter(\"pass\"));\n\t\t/* COMMENT_1 */\n\t\tString VAR_5 = VAR_0.getParameter(\"remember-me\");\n\n\t\t/* COMMENT_2 */\n\n\t\tif (VAR_6.loginValidate(VAR_2, VAR_3)) {\n\n\t\t\tif (VAR_5 != null) {\n\t\t\t\tCookie VAR_7 = new Cookie(\"uname\", VAR_2);\n\t\t\t\tCookie VAR_8 = new Cookie(\"pass\", VAR_3);\n\n\t\t\t\tVAR_7.setMaxAge(24 * 60 * 60);\n\t\t\t\tVAR_8.setMaxAge(24 * 60 * 60);\n\n\t\t\t\tVAR_1.addCookie(VAR_7);\n\t\t\t\tVAR_1.addCookie(VAR_8);\n\t\t\t}\n\n\t\t\t/* COMMENT_3 */\n\t\t\tHttpSession VAR_9 = VAR_0.getSession();\n\t\t\tVAR_9.setAttribute(\"username\", VAR_2);\n\n\t\t\t/* COMMENT_4 */\n                            \n                                                                         \n                                    \n      \n\n\t\t\tVAR_1.sendRedirect(\"AdminController?actions=admin_list\");\n\t\t} else {\n\t\t\tRequestDispatcher VAR_10 = VAR_0.getRequestDispatcher(\"adminlogin.jsp\");\n\t\t\tVAR_0.setAttribute(\"loginFailMsg\", \"Invalid Username or Password !!\");\n\t\t\tVAR_10.include(VAR_0, VAR_1);\n\t\t}\n\t}",
  "func_graph_path_before": "bijaythapaa/OnlineVotingSystem/0181cb0272857696c8eb3e44fcf6cb014ff90f09/AdminLoginController.java/vul/before/0.json",
  "func": "protected void doPost(HttpServletRequest request, HttpServletResponse response)\n\t\t\tthrows ServletException, IOException {\n\n\t\t// to get values from the login page\n\t\tString userName = request.getParameter(\"aname\");\n\t\tString password = request.getParameter(\"pass\");\n\t\t// String password = request.getParameter(\"pass\");\n\t\tString rememberMe = request.getParameter(\"remember-me\");\n\n\t\t// validation\n\n\t\tif (adminDao.loginValidate(userName, password)) {\n\n\t\t\tif (rememberMe != null) {\n\t\t\t\tCookie cookie1 = new Cookie(\"uname\", userName);\n\t\t\t\tCookie cookie2 = new Cookie(\"pass\", password);\n\n\t\t\t\tcookie1.setMaxAge(24 * 60 * 60);\n\t\t\t\tcookie2.setMaxAge(24 * 60 * 60);\n\n\t\t\t\tresponse.addCookie(cookie1);\n\t\t\t\tresponse.addCookie(cookie2);\n\t\t\t}\n\n\t\t\t// to display the name of logged-in person in home page\n\t\t\tHttpSession session = request.getSession();\n\t\t\tsession.setAttribute(\"username\", userName);\n\n\t\t\t/*\n\t\t\t * RequestDispatcher rd =\n\t\t\t * request.getRequestDispatcher(\"AdminController?actions=admin_list\");\n\t\t\t * rd.forward(request, response);\n\t\t\t */\n\n\t\t\tresponse.sendRedirect(\"AdminController?actions=admin_list\");\n\t\t} else {\n\t\t\tRequestDispatcher rd = request.getRequestDispatcher(\"adminlogin.jsp\");\n\t\t\trequest.setAttribute(\"loginFailMsg\", \"Invalid Username or Password !!\");\n\t\t\trd.include(request, response);\n\t\t}\n\t}",
  "abstract_func": "protected void doPost(HttpServletRequest VAR_0, HttpServletResponse VAR_1)\n\t\t\tthrows ServletException, IOException {\n\n\t\t/* COMMENT_0 */\n\t\tString VAR_2 = VAR_0.getParameter(\"aname\");\n\t\tString VAR_3 = VAR_0.getParameter(\"pass\");\n\t\t/* COMMENT_1 */\n\t\tString VAR_4 = VAR_0.getParameter(\"remember-me\");\n\n\t\t/* COMMENT_2 */\n\n\t\tif (VAR_5.loginValidate(VAR_2, VAR_3)) {\n\n\t\t\tif (VAR_4 != null) {\n\t\t\t\tCookie VAR_6 = new Cookie(\"uname\", VAR_2);\n\t\t\t\tCookie VAR_7 = new Cookie(\"pass\", VAR_3);\n\n\t\t\t\tVAR_6.setMaxAge(24 * 60 * 60);\n\t\t\t\tVAR_7.setMaxAge(24 * 60 * 60);\n\n\t\t\t\tVAR_1.addCookie(VAR_6);\n\t\t\t\tVAR_1.addCookie(VAR_7);\n\t\t\t}\n\n\t\t\t/* COMMENT_3 */\n\t\t\tHttpSession VAR_8 = VAR_0.getSession();\n\t\t\tVAR_8.setAttribute(\"username\", VAR_2);\n\n\t\t\t/* COMMENT_4 */\n                            \n                                                                         \n                                    \n      \n\n\t\t\tVAR_1.sendRedirect(\"AdminController?actions=admin_list\");\n\t\t} else {\n\t\t\tRequestDispatcher VAR_9 = VAR_0.getRequestDispatcher(\"adminlogin.jsp\");\n\t\t\tVAR_0.setAttribute(\"loginFailMsg\", \"Invalid Username or Password !!\");\n\t\t\tVAR_9.include(VAR_0, VAR_1);\n\t\t}\n\t}",
  "func_graph_path": "bijaythapaa/OnlineVotingSystem/0181cb0272857696c8eb3e44fcf6cb014ff90f09/AdminLoginController.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -3,7 +3,7 @@\n \n \t\t// to get values from the login page\n \t\tString userName = request.getParameter(\"aname\");\n-\t\tString password = sha.getSHA(request.getParameter(\"pass\"));\n+\t\tString password = request.getParameter(\"pass\");\n \t\t// String password = request.getParameter(\"pass\");\n \t\tString rememberMe = request.getParameter(\"remember-me\");\n ",
  "diff_line_info": {
    "deleted_lines": [
      "\t\tString password = sha.getSHA(request.getParameter(\"pass\"));"
    ],
    "added_lines": [
      "\t\tString password = request.getParameter(\"pass\");"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/bijaythapaa/OnlineVotingSystem/pull/2",
  "description": {
    "pr_info": {
      "title": "Add a salt to SHA-256 hash",
      "number": 2
    },
    "comment": [
      "Use a 16 byte salt in the class <code>src/com/bijay/onlinevotingsystem/controller/SHA256.java</code> to avoid dictionary attacks.\r\n\r\nAnd add a <code>validatePassword</code> method to check whether a hashed password with salt is valid or not."
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.4,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.4  \n\nThe commit aims to enhance security by adding a salt, but the code diff shows a potential regression, causing low confidence."
}