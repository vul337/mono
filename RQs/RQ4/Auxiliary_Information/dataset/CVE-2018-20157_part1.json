{
  "cve_id": "CVE-2018-20157",
  "cwe_ids": [
    "CWE-611"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
  "cvss_is_v3": false,
  "repo_name": "OpenRefine",
  "commit_msg": "Disable DTDs in XML importer. Closes #1907.",
  "commit_hash": "6a0d7d56e4ffb420316ce7849fde881344fbf881",
  "git_url": "https://github.com/OpenRefine/OpenRefine/commit/6a0d7d56e4ffb420316ce7849fde881344fbf881",
  "file_path": "main/src/com/google/refine/importers/XmlImporter.java",
  "func_name": "createXMLStreamReader",
  "func_before": "final static private XMLStreamReader createXMLStreamReader(InputStream inputStream) throws XMLStreamException, IOException {\n        XMLInputFactory factory = XMLInputFactory.newInstance();\n        factory.setProperty(XMLInputFactory.IS_COALESCING, true);\n        factory.setProperty(XMLInputFactory.IS_REPLACING_ENTITY_REFERENCES, true);\n        \n        return factory.createXMLStreamReader(wrapPrefixRemovingInputStream(inputStream));\n    }",
  "abstract_func_before": "final static private XMLStreamReader createXMLStreamReader(InputStream VAR_0) throws XMLStreamException, IOException {\n        XMLInputFactory VAR_1 = VAR_2.newInstance();\n        VAR_1.setProperty(VAR_2.IS_COALESCING, true);\n        VAR_1.setProperty(VAR_2.IS_REPLACING_ENTITY_REFERENCES, true);\n        \n        return VAR_1.createXMLStreamReader(wrapPrefixRemovingInputStream(VAR_0));\n    }",
  "func_graph_path_before": "OpenRefine/6a0d7d56e4ffb420316ce7849fde881344fbf881/XmlImporter.java/vul/before/0.json",
  "func": "final static private XMLStreamReader createXMLStreamReader(InputStream inputStream) throws XMLStreamException, IOException {\n        XMLInputFactory factory = XMLInputFactory.newInstance();\n        factory.setProperty(XMLInputFactory.IS_COALESCING, true);\n        factory.setProperty(XMLInputFactory.IS_REPLACING_ENTITY_REFERENCES, true);\n        factory.setProperty(XMLInputFactory.SUPPORT_DTD, false);\n        \n        return factory.createXMLStreamReader(wrapPrefixRemovingInputStream(inputStream));\n    }",
  "abstract_func": "final static private XMLStreamReader createXMLStreamReader(InputStream VAR_0) throws XMLStreamException, IOException {\n        XMLInputFactory VAR_1 = VAR_2.newInstance();\n        VAR_1.setProperty(VAR_2.IS_COALESCING, true);\n        VAR_1.setProperty(VAR_2.IS_REPLACING_ENTITY_REFERENCES, true);\n        VAR_1.setProperty(VAR_2.SUPPORT_DTD, false);\n        \n        return VAR_1.createXMLStreamReader(wrapPrefixRemovingInputStream(VAR_0));\n    }",
  "func_graph_path": "OpenRefine/6a0d7d56e4ffb420316ce7849fde881344fbf881/XmlImporter.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -2,6 +2,7 @@\n         XMLInputFactory factory = XMLInputFactory.newInstance();\n         factory.setProperty(XMLInputFactory.IS_COALESCING, true);\n         factory.setProperty(XMLInputFactory.IS_REPLACING_ENTITY_REFERENCES, true);\n+        factory.setProperty(XMLInputFactory.SUPPORT_DTD, false);\n         \n         return factory.createXMLStreamReader(wrapPrefixRemovingInputStream(inputStream));\n     }",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "        factory.setProperty(XMLInputFactory.SUPPORT_DTD, false);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/OpenRefine/OpenRefine/pull/1924",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/OpenRefine/OpenRefine/pull/1924: 403 Client Error: Forbidden for url: https://api.github.com/repos/OpenRefine/OpenRefine/pulls/1924",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Step-by-Step Explanation:**\n\n1. **Commit Message Analysis:** The message indicates disabling DTDs in XML importer, which is a security measure against XXE attacks.\n\n2. **Vulnerability Description:** Confirms it's a reported security issue needing confirmation, indicating a security fix.\n\n3. **Code Diff Analysis:** The code disables DTD support, a known security enhancement.\n\n4. **Alignment Check:** The changes align perfectly with the commit message and the security context.\n\n5. **Security Impact:** Disabling DTDs mitigates security risks, confirming it's a security fix.\n\n**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.95"
}