{
  "cve_id": "CVE-2020-36640",
  "cwe_ids": [
    "CWE-611"
  ],
  "cvss_vector": "AV:A/AC:M/Au:S/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "bonitasoft/bonita-connector-webservice",
  "commit_msg": "fix(vulnerabilities): fix XXE attacks vulnerabilities and other code smell (#17)\n\n* Access to external entities and network access should always be\r\ndisable to avoid XXS attacks vulnerabilities.\r\n* Log error properly\r\n* refactor logger name to be compliant with java naming conventions",
  "commit_hash": "a12ad691c05af19e9061d7949b6b828ce48815d5",
  "git_url": "https://github.com/bonitasoft/bonita-connector-webservice/commit/a12ad691c05af19e9061d7949b6b828ce48815d5",
  "file_path": "src/main/java/org/bonitasoft/connectors/ws/SecureWSConnector.java",
  "func_name": "getTransformer",
  "func_before": "Transformer getTransformer() throws TransformerConfigurationException {\n        if (transformer == null) {\n            transformer = TransformerFactory.newInstance().newTransformer();\n            transformer.setOutputProperty(OutputKeys.INDENT, \"yes\");\n            transformer.setOutputProperty(\"{http://xml.apache.org/xslt}indent-amount\", \"2\");\n        }\n        return transformer;\n    }",
  "abstract_func_before": "Transformer getTransformer() throws TransformerConfigurationException {\n        if (VAR_0 == null) {\n            VAR_0 = VAR_1.newInstance().newTransformer();\n            VAR_0.setOutputProperty(VAR_2.INDENT, \"yes\");\n            VAR_0.setOutputProperty(\"{http://xml.apache.org/xslt}indent-amount\", \"2\");\n        }\n        return VAR_0;\n    }",
  "func_graph_path_before": "bonitasoft/bonita-connector-webservice/a12ad691c05af19e9061d7949b6b828ce48815d5/SecureWSConnector.java/vul/before/0.json",
  "func": "Transformer getTransformer() throws TransformerConfigurationException {\n        if (transformer == null) {\n            TransformerFactory transformerFactory = TransformerFactory.newInstance();\n            transformerFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\n            transformerFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, \"\");\n            transformer = transformerFactory.newTransformer();\n            transformer.setOutputProperty(OutputKeys.INDENT, \"yes\");\n            transformer.setOutputProperty(\"{http://xml.apache.org/xslt}indent-amount\", \"2\");\n        }\n        return transformer;\n    }",
  "abstract_func": "Transformer getTransformer() throws TransformerConfigurationException {\n        if (VAR_0 == null) {\n            TransformerFactory VAR_1 = VAR_2.newInstance();\n            VAR_1.setAttribute(VAR_3.ACCESS_EXTERNAL_DTD, \"\");\n            VAR_1.setAttribute(VAR_3.ACCESS_EXTERNAL_STYLESHEET, \"\");\n            VAR_0 = VAR_1.newTransformer();\n            VAR_0.setOutputProperty(VAR_4.INDENT, \"yes\");\n            VAR_0.setOutputProperty(\"{http://xml.apache.org/xslt}indent-amount\", \"2\");\n        }\n        return VAR_0;\n    }",
  "func_graph_path": "bonitasoft/bonita-connector-webservice/a12ad691c05af19e9061d7949b6b828ce48815d5/SecureWSConnector.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,6 +1,9 @@\n Transformer getTransformer() throws TransformerConfigurationException {\n         if (transformer == null) {\n-            transformer = TransformerFactory.newInstance().newTransformer();\n+            TransformerFactory transformerFactory = TransformerFactory.newInstance();\n+            transformerFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\n+            transformerFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, \"\");\n+            transformer = transformerFactory.newTransformer();\n             transformer.setOutputProperty(OutputKeys.INDENT, \"yes\");\n             transformer.setOutputProperty(\"{http://xml.apache.org/xslt}indent-amount\", \"2\");\n         }",
  "diff_line_info": {
    "deleted_lines": [
      "            transformer = TransformerFactory.newInstance().newTransformer();"
    ],
    "added_lines": [
      "            TransformerFactory transformerFactory = TransformerFactory.newInstance();",
      "            transformerFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");",
      "            transformerFactory.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, \"\");",
      "            transformer = transformerFactory.newTransformer();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/bonitasoft/bonita-connector-webservice/pull/17",
  "description": {
    "pr_info": {
      "title": "fix(vulnerabilities): fix XXE attacks vulnerabilities and other code smell",
      "number": 17
    },
    "comment": [
      "* Access to external entities and network access should always be\r\ndisable to avoid XXS attacks vulnerabilities.",
      "SonarCloud Quality Gate failed.\n\n[<img src='https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/bug.png' alt='Bug' width='16' height='16' />](https://sonarcloud.io/project/issues?id=bonitasoft_bonita-connector-webservice&pullRequest=17&resolved=false&types=BUG) [<img src='https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A.png' alt='A' width='16' height='16' />](https://sonarcloud.io/project/issues?id=bonitasoft_bonita-connector-webservice&pullRequest=17&resolved=false&types=BUG) [0 Bugs](https://sonarcloud.io/project/issues?id=bonitasoft_bonita-connector-webservice&pullRequest=17&resolved=false&types=BUG)  \n[<img src='https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/vulnerability.png' alt='Vulnerability' width='16' height='16' />](https://sonarcloud.io/project/issues?id=bonitasoft_bonita-connector-webservice&pullRequest=17&resolved=false&types=VULNERABILITY) [<img src='https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A.png' alt='A' width='16' height='16' />](https://sonarcloud.io/project/issues?id=bonitasoft_bonita-connector-webservice&pullRequest=17&resolved=false&types=VULNERABILITY) [0 Vulnerabilities](https://sonarcloud.io/project/issues?id=bonitasoft_bonita-connector-webservice&pullRequest=17&resolved=false&types=VULNERABILITY) (and [<img src='https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/security_hotspot.png' alt='Security Hotspot' width='16' height='16' />](https://sonarcloud.io/project/issues?id=bonitasoft_bonita-connector-webservice&pullRequest=17&resolved=false&types=SECURITY_HOTSPOT) [0 Security Hotspots](https://sonarcloud.io/project/issues?id=bonitasoft_bonita-connector-webservice&pullRequest=17&resolved=false&types=SECURITY_HOTSPOT) to review)  \n[<img src='https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/code_smell.png' alt='Code Smell' width='16' height='16' />](https://sonarcloud.io/project/issues?id=bonitasoft_bonita-connector-webservice&pullRequest=17&resolved=false&types=CODE_SMELL) [<img src='https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A.png' alt='A' width='16' height='16' />](https://sonarcloud.io/project/issues?id=bonitasoft_bonita-connector-webservice&pullRequest=17&resolved=false&types=CODE_SMELL) [0 Code Smells](https://sonarcloud.io/project/issues?id=bonitasoft_bonita-connector-webservice&pullRequest=17&resolved=false&types=CODE_SMELL)\n\n[<img src='https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/CoverageChart/60.png' alt='68.8%' width='16' height='16' />](https://sonarcloud.io/component_measures?id=bonitasoft_bonita-connector-webservice&pullRequest=17&metric=new_coverage&view=list) [68.8% Coverage](https://sonarcloud.io/component_measures?id=bonitasoft_bonita-connector-webservice&pullRequest=17&metric=new_coverage&view=list)  \n[<img src='https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/Duplications/3.png' alt='0.0%' width='16' height='16' />](https://sonarcloud.io/component_measures?id=bonitasoft_bonita-connector-webservice&pullRequest=17&metric=new_duplicated_lines_density&view=list) [0.0% Duplication](https://sonarcloud.io/component_measures?id=bonitasoft_bonita-connector-webservice&pullRequest=17&metric=new_duplicated_lines_density&view=list)\n\n<img src='https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/message_warning.png' alt='warning' width='16' height='16' /> The version of Java (1.8.0_265) you have used to run this analysis is deprecated and we will stop accepting it from October 2020. Please update to at least Java 11.\nRead more [here](https://sonarcloud.io/documentation/upcoming/)\n\n\n"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.95"
}