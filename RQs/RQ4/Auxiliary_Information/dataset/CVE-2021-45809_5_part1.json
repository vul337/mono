{
  "cve_id": "CVE-2021-45809",
  "cwe_ids": [
    "CWE-Other"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C",
  "cvss_is_v3": false,
  "repo_name": "yuezk/GlobalProtect-openconnect",
  "commit_msg": "add configuration file for gpservice",
  "commit_hash": "767286b898f2d1d361c3834de1d4d0b5836ffecd",
  "git_url": "https://github.com/yuezk/GlobalProtect-openconnect/commit/767286b898f2d1d361c3834de1d4d0b5836ffecd",
  "file_path": "GPClient/gpclient.cpp",
  "func_name": "GPClient::onGatewaySuccess",
  "func_before": "void GPClient::onGatewaySuccess(const QString &authCookie)\n{\n    PLOGI << \"Gateway login succeeded, got the cookie \" << authCookie;\n\n    isQuickConnect = false;\n    QList<QString> gatewayAddresses;\n    for (GPGateway &gw : allGateways()) {\n      gatewayAddresses.push_back(gw.address());\n    }\n    vpn->connect(currentGateway().address(), gatewayAddresses, portalConfig.username(), authCookie, settings::get(\"extraArgs\", \"\").toString());\n    ui->statusLabel->setText(\"Connecting...\");\n    updateConnectionStatus(VpnStatus::pending);\n}",
  "abstract_func_before": "void GPClient::onGatewaySuccess(const QString &VAR_0)\n{\n    VAR_1 << \"Gateway login succeeded, got the cookie \" << VAR_0;\n\n    VAR_2 = false;\n    QList<QString> VAR_3;\n    for (GPGateway &VAR_4 : allGateways()) {\n      VAR_3.push_back(VAR_4.address());\n    }\n    VAR_5->connect(currentGateway().address(), VAR_3, VAR_6.username(), VAR_0, settings::get(\"extraArgs\", \"\").toString());\n    VAR_7->statusLabel->setText(\"Connecting...\");\n    updateConnectionStatus(VpnStatus::pending);\n}",
  "func_graph_path_before": "yuezk/GlobalProtect-openconnect/767286b898f2d1d361c3834de1d4d0b5836ffecd/gpclient.cpp/vul/before/0.json",
  "func": "void GPClient::onGatewaySuccess(const QString &authCookie)\n{\n    PLOGI << \"Gateway login succeeded, got the cookie \" << authCookie;\n\n    isQuickConnect = false;\n    QList<QString> gatewayAddresses;\n    for (GPGateway &gw : allGateways()) {\n      gatewayAddresses.push_back(gw.address());\n    }\n    vpn->connect(currentGateway().address(), gatewayAddresses, portalConfig.username(), authCookie);\n    ui->statusLabel->setText(\"Connecting...\");\n    updateConnectionStatus(VpnStatus::pending);\n}",
  "abstract_func": "void GPClient::onGatewaySuccess(const QString &VAR_0)\n{\n    VAR_1 << \"Gateway login succeeded, got the cookie \" << VAR_0;\n\n    VAR_2 = false;\n    QList<QString> VAR_3;\n    for (GPGateway &VAR_4 : allGateways()) {\n      VAR_3.push_back(VAR_4.address());\n    }\n    VAR_5->connect(currentGateway().address(), VAR_3, VAR_6.username(), VAR_0);\n    VAR_7->statusLabel->setText(\"Connecting...\");\n    updateConnectionStatus(VpnStatus::pending);\n}",
  "func_graph_path": "yuezk/GlobalProtect-openconnect/767286b898f2d1d361c3834de1d4d0b5836ffecd/gpclient.cpp/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -7,7 +7,7 @@\n     for (GPGateway &gw : allGateways()) {\n       gatewayAddresses.push_back(gw.address());\n     }\n-    vpn->connect(currentGateway().address(), gatewayAddresses, portalConfig.username(), authCookie, settings::get(\"extraArgs\", \"\").toString());\n+    vpn->connect(currentGateway().address(), gatewayAddresses, portalConfig.username(), authCookie);\n     ui->statusLabel->setText(\"Connecting...\");\n     updateConnectionStatus(VpnStatus::pending);\n }",
  "diff_line_info": {
    "deleted_lines": [
      "    vpn->connect(currentGateway().address(), gatewayAddresses, portalConfig.username(), authCookie, settings::get(\"extraArgs\", \"\").toString());"
    ],
    "added_lines": [
      "    vpn->connect(currentGateway().address(), gatewayAddresses, portalConfig.username(), authCookie);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/yuezk/GlobalProtect-openconnect/pull/149",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/yuezk/GlobalProtect-openconnect/pull/149: 403 Client Error: Forbidden for url: https://api.github.com/repos/yuezk/GlobalProtect-openconnect/pulls/149",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.7,
  "Bug Filter Response": "The commit's primary purpose seems to be configuration-related, although the presence of a security issue in the description suggests it might also address a vulnerability. However, the code change is limited to removing `extraArgs`, which isn't obviously a security fix. \n\n**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.7  \n(Reasoning: While the description mentions a security problem, the code change doesn't clearly fix a known exploit, leading to moderate confidence.)"
}