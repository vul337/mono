{
  "cve_id": "CVE-2022-0265",
  "cwe_ids": [
    "CWE-611"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "hazelcast",
  "commit_msg": "Add helper method to XmlUtil to enable XXE protection in the SAXParserFactory and XMLInputFactory (#20407)",
  "commit_hash": "4d6b666cd0291abd618c3b95cdbb51aa4208e748",
  "git_url": "https://github.com/hazelcast/hazelcast/commit/4d6b666cd0291abd618c3b95cdbb51aa4208e748",
  "file_path": "hazelcast/src/main/java/com/hazelcast/internal/util/XmlUtil.java",
  "func_name": "getNsAwareDocumentBuilderFactory",
  "func_before": "public static DocumentBuilderFactory getNsAwareDocumentBuilderFactory() throws ParserConfigurationException {\n        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n        dbf.setNamespaceAware(true);\n        setFeature(dbf, \"http://apache.org/xml/features/disallow-doctype-decl\");\n        return dbf;\n    }",
  "abstract_func_before": "public static DocumentBuilderFactory getNsAwareDocumentBuilderFactory() throws ParserConfigurationException {\n        DocumentBuilderFactory VAR_0 = VAR_1.newInstance();\n        VAR_0.setNamespaceAware(true);\n        setFeature(VAR_0, \"http://apache.org/xml/features/disallow-doctype-decl\");\n        return VAR_0;\n    }",
  "func_graph_path_before": "hazelcast/4d6b666cd0291abd618c3b95cdbb51aa4208e748/XmlUtil.java/vul/before/1.json",
  "func": "public static DocumentBuilderFactory getNsAwareDocumentBuilderFactory() throws ParserConfigurationException {\n        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n        dbf.setNamespaceAware(true);\n        setFeature(dbf, FEATURES_DISALLOW_DOCTYPE);\n        return dbf;\n    }",
  "abstract_func": "public static DocumentBuilderFactory getNsAwareDocumentBuilderFactory() throws ParserConfigurationException {\n        DocumentBuilderFactory VAR_0 = VAR_1.newInstance();\n        VAR_0.setNamespaceAware(true);\n        setFeature(VAR_0, VAR_2);\n        return VAR_0;\n    }",
  "func_graph_path": "hazelcast/4d6b666cd0291abd618c3b95cdbb51aa4208e748/XmlUtil.java/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,6 +1,6 @@\n public static DocumentBuilderFactory getNsAwareDocumentBuilderFactory() throws ParserConfigurationException {\n         DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n         dbf.setNamespaceAware(true);\n-        setFeature(dbf, \"http://apache.org/xml/features/disallow-doctype-decl\");\n+        setFeature(dbf, FEATURES_DISALLOW_DOCTYPE);\n         return dbf;\n     }",
  "diff_line_info": {
    "deleted_lines": [
      "        setFeature(dbf, \"http://apache.org/xml/features/disallow-doctype-decl\");"
    ],
    "added_lines": [
      "        setFeature(dbf, FEATURES_DISALLOW_DOCTYPE);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/hazelcast/hazelcast/pull/20407",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/hazelcast/hazelcast/pull/20407: 403 Client Error: Forbidden for url: https://api.github.com/repos/hazelcast/hazelcast/pulls/20407",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "The commit message clearly indicates that the patch is intended to address an XXE (XML External Entity) vulnerability. The code changes involve enabling a security feature in the XML parser to prevent such attacks. The vulnerability was reported through a security-focused platform, further confirming its security nature. The code changes are consistent with the stated intent, hence the classification as a security fix with high confidence.\n\n**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0"
}