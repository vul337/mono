{
  "cve_id": "CVE-2018-1000618",
  "cwe_ids": [
    "CWE-674"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "EOSIO/eos",
  "commit_msg": "Add limit to recursion",
  "commit_hash": "cf7209e703e6d3f7a5413e0cb1fe88a4d8e4b38d",
  "git_url": "https://github.com/EOSIO/eos/commit/cf7209e703e6d3f7a5413e0cb1fe88a4d8e4b38d",
  "file_path": "libraries/chain/include/eosio/chain/abi_serializer.hpp",
  "func_name": "operator()",
  "func_before": "void operator()( T& v )const\n         {\n            add(obj_mvo, \"_\", v, resolver);\n         }",
  "abstract_func_before": "void operator()( T& VAR_0 )const\n         {\n            add(VAR_1, \"_\", VAR_0, VAR_2);\n         }",
  "func_graph_path_before": "EOSIO/eos/cf7209e703e6d3f7a5413e0cb1fe88a4d8e4b38d/abi_serializer.hpp/vul/before/2.json",
  "func": "void operator()( T& v )const\n         {\n            add(obj_mvo, \"_\", v, resolver, recursion_depth);\n         }",
  "abstract_func": "void operator()( T& VAR_0 )const\n         {\n            add(VAR_1, \"_\", VAR_0, VAR_2, VAR_3);\n         }",
  "func_graph_path": "EOSIO/eos/cf7209e703e6d3f7a5413e0cb1fe88a4d8e4b38d/abi_serializer.hpp/vul/after/2.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,4 @@\n void operator()( T& v )const\n          {\n-            add(obj_mvo, \"_\", v, resolver);\n+            add(obj_mvo, \"_\", v, resolver, recursion_depth);\n          }",
  "diff_line_info": {
    "deleted_lines": [
      "            add(obj_mvo, \"_\", v, resolver);"
    ],
    "added_lines": [
      "            add(obj_mvo, \"_\", v, resolver, recursion_depth);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/EOSIO/eos/pull/4112",
  "description": {
    "pr_info": {
      "title": "Pretty print transactions",
      "number": 4112
    },
    "comment": [
      "Enhanced the abi_serializer to be able to deserialize transactions even if they have invalid abi set on the contract. So even with invalid abi the transaction can still be pretty-printed. In the case of invalid abi the action data is left in hex since there is no way to deserialize it. This allows indexers like the mongodb plugin to serialize the parts of transaction that are serializable without the user provided abi.\r\n\r\nI suspect this will fix issue #4111 that was just submitted.",
      "@heifner My issue is still there. [issue#4111](https://github.com/EOSIO/eos/issues/4111)\r\nThis is the error I'm getting:\r\nInvalid packed transaction\r\npivot != std::string::npos: No delimiter in string, cannot determine type: EOSK59ovuuemzcGX1QKATF4pEVg2AmUT2rjQAH8MrC52SpmBZ59YPVYMFYTBg7XNgCDQcX18vMyDsjEp4SbyDnkcUvruZ94BX\r\nFailed to deserialize variant",
      "This is the command I'm using and getting error:\r\ncleos -H node1.eosphere.io --wallet-host localhost --wallet-port 8888 set contract eosuser build/contracts/eosio.token -p eosuser\r\n\r\nGetting same error for every contract\r\n\r\ncleos version client: 15953cc1\r\n\r\nPlease, help me to fix this.\r\nThanks",
      "@heifner The problem is coming from here /eos/libraries/fc/src/crypto/signature.cpp:\r\n const auto pivot = base58str.find('_');\r\n      FC_ASSERT(pivot != std::string::npos, \"No delimiter in string, cannot determine type: ${str}\", (\"str\", base58str));\r\n"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.8,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.8  \n\nThe patch addresses recursion limits, which can prevent potential Denial of Service attacks, though the vulnerability description focuses more on functionality than security. However, the code change clearly targets a security concern."
}