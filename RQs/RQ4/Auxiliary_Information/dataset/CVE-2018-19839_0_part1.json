{
  "cve_id": "CVE-2018-19839",
  "cwe_ids": [
    "CWE-125"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "sass/libsass",
  "commit_msg": "Update utfcpp to v2.3.6\n\nFixes #2657\n\nIncorporates the following utfcpp patches:\n\n1. Sass addition of `retreat`.\n   https://github.com/nemtrif/utfcpp/pull/20\n\n2. Fix for `replace_invalid` throwing on incomplete sequence at the end\n   of the input.\n   https://github.com/nemtrif/utfcpp/pull/21",
  "commit_hash": "a2dff1b59ea8c8ec10680f9e8e5593e4b38554a1",
  "git_url": "https://github.com/sass/libsass/commit/a2dff1b59ea8c8ec10680f9e8e5593e4b38554a1",
  "file_path": "src/utf8/checked.h",
  "func_name": "retreat",
  "func_before": "void retreat (octet_iterator& it, distance_type n, octet_iterator start)\n    {\n        for (distance_type i = 0; i < n; ++i)\n            utf8::prior(it, start);\n    }",
  "abstract_func_before": "void retreat (octet_iterator& VAR_0, distance_type VAR_1, octet_iterator VAR_2)\n    {\n        for (distance_type VAR_3 = 0; VAR_3 < VAR_1; ++VAR_3)\n            utf8::prior(VAR_0, VAR_2);\n    }",
  "func_graph_path_before": "sass/libsass/a2dff1b59ea8c8ec10680f9e8e5593e4b38554a1/checked.h/vul/before/1.json",
  "func": "void retreat (octet_iterator& it, distance_type n, octet_iterator end)\n    {\n        for (distance_type i = 0; i < n; ++i)\n            utf8::prior(it, end);\n    }",
  "abstract_func": "void retreat (octet_iterator& VAR_0, distance_type VAR_1, octet_iterator VAR_2)\n    {\n        for (distance_type VAR_3 = 0; VAR_3 < VAR_1; ++VAR_3)\n            utf8::prior(VAR_0, VAR_2);\n    }",
  "func_graph_path": "sass/libsass/a2dff1b59ea8c8ec10680f9e8e5593e4b38554a1/checked.h/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,5 @@\n-void retreat (octet_iterator& it, distance_type n, octet_iterator start)\n+void retreat (octet_iterator& it, distance_type n, octet_iterator end)\n     {\n         for (distance_type i = 0; i < n; ++i)\n-            utf8::prior(it, start);\n+            utf8::prior(it, end);\n     }",
  "diff_line_info": {
    "deleted_lines": [
      "void retreat (octet_iterator& it, distance_type n, octet_iterator start)",
      "            utf8::prior(it, start);"
    ],
    "added_lines": [
      "void retreat (octet_iterator& it, distance_type n, octet_iterator end)",
      "            utf8::prior(it, end);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/sass/libsass/pull/2767",
  "description": {
    "pr_info": {
      "title": "Update utfcpp to v2.3.6",
      "number": 2767
    },
    "comment": [
      "Updates to v2.3.6 with the following patches:\r\n\r\n1. Sass addition of `retreat`. https://github.com/nemtrif/utfcpp/pull/20\r\n\r\n2. Fix for `replace_invalid` throwing on incomplete sequence at the end of the input. https://github.com/nemtrif/utfcpp/pull/21\r\n\r\nFixes #2657. The buffer overflow had already been fixed in #2755. This PR also fixes the error message: previously it just said `Internal Error: Not enough space`, now it outputs the correct error with trace, such as:\r\n\r\n```\r\nError: Invalid UTF-8 sequence\r\n        on line 1:1 of ../../../tmp/libsass-2657/test_m001.txt\r\n>> ï¿½\r\n   ^\r\n```",
      "Thanks"
    ]
  },
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Defect Remediation & Feature Upgrades  \n**Confidence:** 0.9\n\nThe code changes address a bug in handling invalid UTF-8 sequences and improve error messages, falling under defect remediation. While related to input handling, it doesn't directly fix a security vulnerability."
}