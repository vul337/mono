{
  "cve_id": "CVE-2018-7868",
  "cwe_ids": [
    "CWE-119",
    "CWE-476",
    "CWE-125"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "libming",
  "commit_msg": "Fix heap-buffer-overflows when accessing pool\n\nConstants are usually retrieved from the constant pool without verifying\nthat the pool actually contains them, which may lead to various heap\nbuffer overflow issues.\n\nIn this patch we add a counter keeping track of how many elements the pool\ncontains, and checks making sure that whenever the pool is accessed, the\nconstant in present in the pool (constant position < pool counter).\n\nAlso, do not return \"\" when a pointer is excepted (it should be legal to free\nthis return value).\n\nThis patch fixes #112 (CVE-2018-7875), fixes #120 (CVE-2018-7871),\nfixes #117 (CVE-2018-7870), fixes #114 (CVE-2018-7872), fixes #122,\nfixes #113 (CVE-2018-7868), fixes #123.",
  "commit_hash": "3a000c7b6fe978dd9925266bb6847709e06dbaa3",
  "git_url": "https://github.com/libming/libming/commit/3a000c7b6fe978dd9925266bb6847709e06dbaa3",
  "file_path": "util/decompile.c",
  "func_name": "decompileCONSTANTPOOL",
  "func_before": "static void\ndecompileCONSTANTPOOL (SWF_ACTION *act)\n{\n\tOUT_BEGIN(SWF_ACTIONCONSTANTPOOL);\n\tpool=sact->ConstantPool;\n}",
  "abstract_func_before": "static void\ndecompileCONSTANTPOOL (SWF_ACTION *VAR_0)\n{\n\tOUT_BEGIN(VAR_1);\n\tVAR_2=VAR_3->ConstantPool;\n}",
  "func_graph_path_before": "libming/3a000c7b6fe978dd9925266bb6847709e06dbaa3/decompile.c/vul/before/2.json",
  "func": "static void\ndecompileCONSTANTPOOL (SWF_ACTION *act)\n{\n\tOUT_BEGIN(SWF_ACTIONCONSTANTPOOL);\n\tpool=sact->ConstantPool;\n\tpoolcounter = sact->Count;\n}",
  "abstract_func": "static void\ndecompileCONSTANTPOOL (SWF_ACTION *VAR_0)\n{\n\tOUT_BEGIN(VAR_1);\n\tVAR_2=VAR_3->ConstantPool;\n\tVAR_4 = VAR_3->Count;\n}",
  "func_graph_path": "libming/3a000c7b6fe978dd9925266bb6847709e06dbaa3/decompile.c/vul/after/2.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -3,4 +3,5 @@\n {\n \tOUT_BEGIN(SWF_ACTIONCONSTANTPOOL);\n \tpool=sact->ConstantPool;\n+\tpoolcounter = sact->Count;\n }",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "\tpoolcounter = sact->Count;"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/libming/libming/pull/125",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/libming/libming/pull/125: 403 Client Error: Forbidden for url: https://api.github.com/repos/libming/libming/pulls/125",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 1.0"
}