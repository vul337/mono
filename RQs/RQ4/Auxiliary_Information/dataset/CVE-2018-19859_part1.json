{
  "cve_id": "CVE-2018-19859",
  "cwe_ids": [
    "CWE-22"
  ],
  "cvss_vector": "AV:N/AC:L/Au:S/C:N/I:P/A:N",
  "cvss_is_v3": false,
  "repo_name": "OpenRefine",
  "commit_msg": "Create dedicated temporary dir for zip slip test",
  "commit_hash": "79994e86da1a3eecc62723f4ba90f14a63ad0e72",
  "git_url": "https://github.com/OpenRefine/OpenRefine/commit/79994e86da1a3eecc62723f4ba90f14a63ad0e72",
  "file_path": "main/tests/server/src/com/google/refine/tests/importing/ImportingUtilitiesTests.java",
  "func_name": "testZipSlip",
  "func_before": "@Test(expectedExceptions=IllegalArgumentException.class)\n    public void testZipSlip() {\n        // For CVE-2018-19859, issue #1840\n    \tImportingUtilities.allocateFile(workspaceDir, \"../../script.sh\");\n    }",
  "abstract_func_before": "@Test(VAR_0=IllegalArgumentException.class)\n    public void testZipSlip() {\n        /* COMMENT_0 */\n    \tVAR_1.allocateFile(VAR_2, \"../../script.sh\");\n    }",
  "func_graph_path_before": "OpenRefine/79994e86da1a3eecc62723f4ba90f14a63ad0e72/ImportingUtilitiesTests.java/vul/before/0.json",
  "func": "@Test(expectedExceptions=IllegalArgumentException.class)\n    public void testZipSlip() throws IOException {\n    \tFile tempDir = TestUtils.createTempDirectory(\"openrefine-zip-slip-test\");\n        // For CVE-2018-19859, issue #1840\n    \tImportingUtilities.allocateFile(tempDir, \"../../tmp/script.sh\");\n    }",
  "abstract_func": "@Test(VAR_0=IllegalArgumentException.class)\n    public void testZipSlip() throws IOException {\n    \tFile VAR_1 = VAR_2.createTempDirectory(\"openrefine-zip-slip-test\");\n        /* COMMENT_0 */\n    \tVAR_3.allocateFile(VAR_1, \"../../tmp/script.sh\");\n    }",
  "func_graph_path": "OpenRefine/79994e86da1a3eecc62723f4ba90f14a63ad0e72/ImportingUtilitiesTests.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,6 @@\n @Test(expectedExceptions=IllegalArgumentException.class)\n-    public void testZipSlip() {\n+    public void testZipSlip() throws IOException {\n+    \tFile tempDir = TestUtils.createTempDirectory(\"openrefine-zip-slip-test\");\n         // For CVE-2018-19859, issue #1840\n-    \tImportingUtilities.allocateFile(workspaceDir, \"../../script.sh\");\n+    \tImportingUtilities.allocateFile(tempDir, \"../../tmp/script.sh\");\n     }",
  "diff_line_info": {
    "deleted_lines": [
      "    public void testZipSlip() {",
      "    \tImportingUtilities.allocateFile(workspaceDir, \"../../script.sh\");"
    ],
    "added_lines": [
      "    public void testZipSlip() throws IOException {",
      "    \tFile tempDir = TestUtils.createTempDirectory(\"openrefine-zip-slip-test\");",
      "    \tImportingUtilities.allocateFile(tempDir, \"../../tmp/script.sh\");"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/OpenRefine/OpenRefine/pull/1901",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/OpenRefine/OpenRefine/pull/1901: 403 Client Error: Forbidden for url: https://api.github.com/repos/OpenRefine/OpenRefine/pulls/1901",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "The commit aims to fix a known security vulnerability (CVE-2018-19859) by creating a dedicated temporary directory, preventing zip slip attacks. All elements from the commit message, vulnerability description, and code changes consistently point to a security fix.\n\n**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 1.0"
}