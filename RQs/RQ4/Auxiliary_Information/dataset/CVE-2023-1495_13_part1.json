{
  "cve_id": "CVE-2023-1495",
  "cwe_ids": [
    "CWE-89"
  ],
  "cvss_vector": "AV:N/AC:L/Au:S/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "getrebuild/rebuild",
  "commit_msg": "H5 sync2 (#595)\n\n* style: 目录样式gh\r\n\r\n* style: J_new\r\n\r\n* feat: advListFilterTabs\r\n\r\n* feat: nav-copyto\r\n\r\n* enh: 助记码全拼\r\n\r\n* enh: 地图搜索选点\r\n\r\n* enh: topnav\r\n\r\n* list pn\r\n\r\n* .form-line.v33\r\n\r\n* open TAG\r\n\r\n* KVS addShutdownHook\r\n\r\n* fix: #594\r\n\r\n---------\r\n\r\nCo-authored-by: devezhao <zhaofang123@gmail.com>",
  "commit_hash": "c9474f84e5f376dd2ade2078e3039961a9425da7",
  "git_url": "https://github.com/getrebuild/rebuild/commit/c9474f84e5f376dd2ade2078e3039961a9425da7",
  "file_path": "src/main/java/com/rebuild/web/configuration/NavSettings.java",
  "func_name": "setsTopNav",
  "func_before": "@PostMapping(\"nav-settings/topnav\")\n    public RespBody setsTopNav(HttpServletRequest request) {\n        String s = ServletUtils.getRequestString(request);\n        KVStorage.setCustomValue(\"TopNav32\", s);\n        return RespBody.ok();\n    }",
  "abstract_func_before": "@PostMapping(\"nav-settings/topnav\")\n    public RespBody setsTopNav(HttpServletRequest VAR_0) {\n        String VAR_1 = VAR_2.getRequestString(VAR_0);\n        VAR_3.setCustomValue(\"TopNav32\", VAR_1);\n        return VAR_4.ok();\n    }",
  "func_graph_path_before": "getrebuild/rebuild/c9474f84e5f376dd2ade2078e3039961a9425da7/NavSettings.java/vul/before/0.json",
  "func": "@PostMapping(\"nav-settings/topnav\")\n    public RespBody setsTopNav(HttpServletRequest request) {\n        if (!UserHelper.isAdmin(getRequestUser(request))) return RespBody.error();\n\n        String s = ServletUtils.getRequestString(request);\n        KVStorage.setCustomValue(\"TopNav32\", s);\n        return RespBody.ok();\n    }",
  "abstract_func": "@PostMapping(\"nav-settings/topnav\")\n    public RespBody setsTopNav(HttpServletRequest VAR_0) {\n        if (!VAR_1.isAdmin(getRequestUser(VAR_0))) return VAR_2.error();\n\n        String VAR_3 = VAR_4.getRequestString(VAR_0);\n        VAR_5.setCustomValue(\"TopNav32\", VAR_3);\n        return VAR_2.ok();\n    }",
  "func_graph_path": "getrebuild/rebuild/c9474f84e5f376dd2ade2078e3039961a9425da7/NavSettings.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,7 @@\n @PostMapping(\"nav-settings/topnav\")\n     public RespBody setsTopNav(HttpServletRequest request) {\n+        if (!UserHelper.isAdmin(getRequestUser(request))) return RespBody.error();\n+\n         String s = ServletUtils.getRequestString(request);\n         KVStorage.setCustomValue(\"TopNav32\", s);\n         return RespBody.ok();",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "        if (!UserHelper.isAdmin(getRequestUser(request))) return RespBody.error();",
      ""
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/getrebuild/rebuild/pull/595",
  "description": {
    "pr_info": {
      "title": "H5 sync2",
      "number": 595
    },
    "comment": [
      "Most styles:\r\n1. Nav copy\r\n2. Arrow for form line \r\n3. Quick-code full-pinyin\r\n4. Open Tag of field\r\n5. feat: `advListFilterTabs` (boss-key)\r\n6. Map search\r\n7. feat: Can input page-no on list\r\n8. CVE fix"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 0.9\n\n**Step-by-Step Explanation:**\n\n1. **Input Analysis:**\n   - The commit message includes keywords like \"style,\" \"feat,\" \"enh,\" \"fix,\" indicating a variety of changes. The vulnerability description mentions a CVE fix and security-related features.\n   - The code diff shows an added admin check in the `setsTopNav` function, which restricts access to admin users.\n\n2. **Consistency Check:**\n   - The commit message's \"fix\" aligns with the code change, which addresses an unauthorized access issue.\n\n3. **Purpose Evaluation:**\n   - The change introduces an authorization check to prevent unauthorized modifications, directly affecting core logic to enhance security.\n\n4. **Security Vulnerability Assessment:**\n   - The fix adds a security check against potential unauthorized access, fulfilling the intent of a security patch.\n\n5. **Confidence Scoring:**\n   - The presence of a CVE reference and clear security-related code changes make the classification strong."
}