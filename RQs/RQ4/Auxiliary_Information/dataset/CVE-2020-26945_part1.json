{
  "cve_id": "CVE-2020-26945",
  "cwe_ids": [
    "CWE-502"
  ],
  "cvss_vector": "AV:N/AC:H/Au:N/C:P/I:P/A:P",
  "cvss_is_v3": false,
  "repo_name": "mybatis/mybatis-3",
  "commit_msg": "Output warning when deserializing object stream with no JEP-290 filter defined",
  "commit_hash": "9caf480e05c389548c9889362c2cb080d728b5d8",
  "git_url": "https://github.com/mybatis/mybatis-3/commit/9caf480e05c389548c9889362c2cb080d728b5d8",
  "file_path": "src/main/java/org/apache/ibatis/cache/decorators/SerializedCache.java",
  "func_name": "deserialize",
  "func_before": "private Serializable deserialize(byte[] value) {\n    Serializable result;\n    try (ByteArrayInputStream bis = new ByteArrayInputStream(value);\n        ObjectInputStream ois = new CustomObjectInputStream(bis)) {\n      result = (Serializable) ois.readObject();\n    } catch (Exception e) {\n      throw new CacheException(\"Error deserializing object.  Cause: \" + e, e);\n    }\n    return result;\n  }",
  "abstract_func_before": "private Serializable deserialize(byte[] VAR_0) {\n    Serializable VAR_1;\n    try (ByteArrayInputStream VAR_2 = new ByteArrayInputStream(VAR_0);\n        ObjectInputStream VAR_3 = new CustomObjectInputStream(VAR_2)) {\n      VAR_1 = (Serializable) VAR_3.readObject();\n    } catch (Exception VAR_4) {\n      throw new CacheException(\"Error deserializing object.  Cause: \" + VAR_4, VAR_4);\n    }\n    return VAR_1;\n  }",
  "func_graph_path_before": "mybatis/mybatis-3/9caf480e05c389548c9889362c2cb080d728b5d8/SerializedCache.java/vul/before/0.json",
  "func": "private Serializable deserialize(byte[] value) {\n    SerialFilterChecker.check();\n    Serializable result;\n    try (ByteArrayInputStream bis = new ByteArrayInputStream(value);\n        ObjectInputStream ois = new CustomObjectInputStream(bis)) {\n      result = (Serializable) ois.readObject();\n    } catch (Exception e) {\n      throw new CacheException(\"Error deserializing object.  Cause: \" + e, e);\n    }\n    return result;\n  }",
  "abstract_func": "private Serializable deserialize(byte[] VAR_0) {\n    VAR_1.check();\n    Serializable VAR_2;\n    try (ByteArrayInputStream VAR_3 = new ByteArrayInputStream(VAR_0);\n        ObjectInputStream VAR_4 = new CustomObjectInputStream(VAR_3)) {\n      VAR_2 = (Serializable) VAR_4.readObject();\n    } catch (Exception VAR_5) {\n      throw new CacheException(\"Error deserializing object.  Cause: \" + VAR_5, VAR_5);\n    }\n    return VAR_2;\n  }",
  "func_graph_path": "mybatis/mybatis-3/9caf480e05c389548c9889362c2cb080d728b5d8/SerializedCache.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,5 @@\n private Serializable deserialize(byte[] value) {\n+    SerialFilterChecker.check();\n     Serializable result;\n     try (ByteArrayInputStream bis = new ByteArrayInputStream(value);\n         ObjectInputStream ois = new CustomObjectInputStream(bis)) {",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "    SerialFilterChecker.check();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/mybatis/mybatis-3/pull/2079",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/mybatis/mybatis-3/pull/2079: 403 Client Error: Forbidden for url: https://api.github.com/repos/mybatis/mybatis-3/pulls/2079",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix;  \n**Confidence:** 1.0"
}