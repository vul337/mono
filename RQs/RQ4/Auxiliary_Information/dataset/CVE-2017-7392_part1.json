{
  "cve_id": "CVE-2017-7392",
  "cwe_ids": [
    "CWE-772"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "TigerVNC/tigervnc",
  "commit_msg": "Delete underlying ssecurity in SSecurityVeNCrypt.\n\nOtherwise it gets leaked which would allow even not authenticated clients to exhaust server memory.",
  "commit_hash": "8f3e8663b3cf57c0b62d939d6953fbfcc112aadd",
  "git_url": "https://github.com/TigerVNC/tigervnc/commit/8f3e8663b3cf57c0b62d939d6953fbfcc112aadd",
  "file_path": "common/rfb/SSecurityVeNCrypt.cxx",
  "func_name": "SSecurityVeNCrypt::~SSecurityVeNCrypt",
  "func_before": "SSecurityVeNCrypt::~SSecurityVeNCrypt()\n{\n  if (subTypes) {\n    delete [] subTypes;\n    subTypes = NULL;\n  }\n}",
  "abstract_func_before": "SSecurityVeNCrypt::~VAR_0()\n{\n  if (VAR_1) {\n    delete [] VAR_1;\n    VAR_1 = NULL;\n  }\n}",
  "func_graph_path_before": "TigerVNC/tigervnc/8f3e8663b3cf57c0b62d939d6953fbfcc112aadd/SSecurityVeNCrypt.cxx/vul/before/0.json",
  "func": "SSecurityVeNCrypt::~SSecurityVeNCrypt()\n{\n  delete ssecurity;\n\n  if (subTypes) {\n    delete [] subTypes;\n    subTypes = NULL;\n  }\n}",
  "abstract_func": "SSecurityVeNCrypt::~VAR_0()\n{\n  delete VAR_1;\n\n  if (VAR_2) {\n    delete [] VAR_2;\n    VAR_2 = NULL;\n  }\n}",
  "func_graph_path": "TigerVNC/tigervnc/8f3e8663b3cf57c0b62d939d6953fbfcc112aadd/SSecurityVeNCrypt.cxx/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,7 @@\n SSecurityVeNCrypt::~SSecurityVeNCrypt()\n {\n+  delete ssecurity;\n+\n   if (subTypes) {\n     delete [] subTypes;\n     subTypes = NULL;",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "  delete ssecurity;",
      ""
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/TigerVNC/tigervnc/pull/441",
  "description": {
    "pr_info": {
      "title": "Delete underlying ssecurity in SSecurityVeNCrypt.",
      "number": 441
    },
    "comment": [
      "Otherwise it gets leaked which would allow even not authenticated clients to exhaust server memory.",
      "This has been assigned CVE-2017-7392"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "The patch addresses a security issue where sensitive data (ssecurity) was leaking, allowing unauthenticated clients to cause memory exhaustion. The code change deletes the object to prevent this leak, confirming it's a security fix. \n\n**Final Classification:** Security Vulnerability Fix; **Confidence:** 0.95"
}