{
  "cve_id": "CVE-2022-39308",
  "cwe_ids": [
    "CWE-697"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
  "cvss_is_v3": true,
  "repo_name": "gocd",
  "commit_msg": "Access Token APIs  (#5797)\n\n* Define a AuthTokenSqlMapDao to store and retrieve token information from DB\r\n\r\n* Introduce Auth Token API to manage auth tokens\r\n\r\n* Store the hashed token instead of storing the raw value\r\n\r\n* Some tests\r\n\r\n* Store information of the user who has created the auth token\r\n\r\n* Use SHA-256 instead of MD5 for hashing token value\r\n\r\n* Change username data type from VARCHAR to VARCHAR_IGNORECASE\r\n\r\n* Introduce AuthTokenMother to create authToken in tests\r\n\r\n* Fix auth token controller specs\r\n\r\n* Remove unused class variable from test\r\n\r\n* Introduce auth token index endpoint to fetch all the tokens belonging to me\r\n\r\n* Add extra attributes to auth token\r\n* Salt Id\r\n* Salt Value\r\n* Auth Config Id\r\n* Revoked At\r\n\r\n* Add support for revoking access tokens\r\nAdd a method to validate and fetch access token object provided access token\r\n\r\n* Rename controller package and module\r\n\r\n* rename service and dao\r\n\r\n* Rename auth token package\r\n\r\n* Rename rules under url rewrite\r\n\r\n* Renamed few more occurences of auth token to acccess tokens",
  "commit_hash": "236d4baf92e6607f2841c151c855adcc477238b8",
  "git_url": "https://github.com/gocd/gocd/commit/236d4baf92e6607f2841c151c855adcc477238b8",
  "file_path": "spark/spark-base/src/main/java/com/thoughtworks/go/spark/Routes.java",
  "func_name": "find",
  "func_before": "public static String find() {\n            return BASE + UUID;\n        }",
  "abstract_func_before": "public static String find() {\n            return VAR_0 + VAR_1;\n        }",
  "func_graph_path_before": "gocd/236d4baf92e6607f2841c151c855adcc477238b8/Routes.java/vul/before/0.json",
  "func": "public static String find() {\n            return BASE + TOKEN_NAME;\n        }",
  "abstract_func": "public static String find() {\n            return VAR_0 + VAR_1;\n        }",
  "func_graph_path": "gocd/236d4baf92e6607f2841c151c855adcc477238b8/Routes.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,3 +1,3 @@\n public static String find() {\n-            return BASE + UUID;\n+            return BASE + TOKEN_NAME;\n         }",
  "diff_line_info": {
    "deleted_lines": [
      "            return BASE + UUID;"
    ],
    "added_lines": [
      "            return BASE + TOKEN_NAME;"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/gocd/gocd/pull/5797",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/gocd/gocd/pull/5797: 403 Client Error: Forbidden for url: https://api.github.com/repos/gocd/gocd/pulls/5797",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.7,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.7\n\nThe patch introduces security improvements such as switching from MD5 to SHA-256 and better token management, though it's part of broader API enhancements and lacks a specific CVE reference."
}