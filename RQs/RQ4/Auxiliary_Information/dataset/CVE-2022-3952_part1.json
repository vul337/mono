{
  "cve_id": "CVE-2022-3952",
  "cwe_ids": [
    "CWE-668"
  ],
  "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
  "cvss_is_v3": true,
  "repo_name": "ManyDesigns/Portofino",
  "commit_msg": "vuln-fix: Temporary Directory Hijacking or Information Disclosure\n\n\n\nThis fixes either Temporary Directory Hijacking, or Temporary Directory Local Information Disclosure.\n\nWeakness: CWE-379: Creation of Temporary File in Directory with Insecure Permissions\nSeverity: High\nCVSSS: 7.3\nDetection: CodeQL & OpenRewrite (https://public.moderne.io/recipes/org.openrewrite.java.security.UseFilesCreateTempDirectory)\n\nReported-by: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>\nSigned-off-by: Jonathan Leitschuh <Jonathan.Leitschuh@gmail.com>\n\nBug-tracker: https://github.com/JLLeitschuh/security-research/issues/10\n\n\nCo-authored-by: Moderne <team@moderne.io>",
  "commit_hash": "94653cb357806c9cf24d8d294e6afea33f8f0775",
  "git_url": "https://github.com/ManyDesigns/Portofino/commit/94653cb357806c9cf24d8d294e6afea33f8f0775",
  "file_path": "microservices/launcher/src/main/java/com/manydesigns/portofino/microservices/launcher/WarFileLauncher.java",
  "func_name": "createTempDir",
  "func_before": "public static File createTempDir(int port) throws IOException {\n        File tempDir = File.createTempFile(\"portofino.tomcat.\", \".\" + port);\n        tempDir.delete();\n        tempDir.mkdir();\n        tempDir.deleteOnExit();\n        return tempDir;\n    }",
  "abstract_func_before": "public static File createTempDir(int VAR_0) throws IOException {\n        File VAR_1 = VAR_2.createTempFile(\"portofino.tomcat.\", \".\" + VAR_0);\n        VAR_1.delete();\n        VAR_1.mkdir();\n        VAR_1.deleteOnExit();\n        return VAR_1;\n    }",
  "func_graph_path_before": "ManyDesigns/Portofino/94653cb357806c9cf24d8d294e6afea33f8f0775/WarFileLauncher.java/vul/before/0.json",
  "func": "public static File createTempDir(int port) throws IOException {\n        File tempDir = Files.createTempDirectory(\"portofino.tomcat.\" + \".\" + port).toFile();\n        tempDir.deleteOnExit();\n        return tempDir;\n    }",
  "abstract_func": "public static File createTempDir(int VAR_0) throws IOException {\n        File VAR_1 = VAR_2.createTempDirectory(\"portofino.tomcat.\" + \".\" + VAR_0).toFile();\n        VAR_1.deleteOnExit();\n        return VAR_1;\n    }",
  "func_graph_path": "ManyDesigns/Portofino/94653cb357806c9cf24d8d294e6afea33f8f0775/WarFileLauncher.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,7 +1,5 @@\n public static File createTempDir(int port) throws IOException {\n-        File tempDir = File.createTempFile(\"portofino.tomcat.\", \".\" + port);\n-        tempDir.delete();\n-        tempDir.mkdir();\n+        File tempDir = Files.createTempDirectory(\"portofino.tomcat.\" + \".\" + port).toFile();\n         tempDir.deleteOnExit();\n         return tempDir;\n     }",
  "diff_line_info": {
    "deleted_lines": [
      "        File tempDir = File.createTempFile(\"portofino.tomcat.\", \".\" + port);",
      "        tempDir.delete();",
      "        tempDir.mkdir();"
    ],
    "added_lines": [
      "        File tempDir = Files.createTempDirectory(\"portofino.tomcat.\" + \".\" + port).toFile();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/ManyDesigns/Portofino/pull/580",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/ManyDesigns/Portofino/pull/580: 403 Client Error: Forbidden for url: https://api.github.com/repos/ManyDesigns/Portofino/pulls/580",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0"
}