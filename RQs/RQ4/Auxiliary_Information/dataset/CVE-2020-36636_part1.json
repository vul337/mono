{
  "cve_id": "CVE-2020-36636",
  "cwe_ids": [
    "CWE-79"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
  "cvss_is_v3": true,
  "repo_name": "openmrs/openmrs-module-adminui",
  "commit_msg": "RA-1865: Fix possible xss in account setup (#57)",
  "commit_hash": "702fbfdac7c4418f23bb5f6452482b4a88020061",
  "git_url": "https://github.com/openmrs/openmrs-module-adminui/commit/702fbfdac7c4418f23bb5f6452482b4a88020061",
  "file_path": "omod/src/main/java/org/openmrs/module/adminui/page/controller/systemadmin/accounts/AccountPageController.java",
  "func_name": "get",
  "func_before": "public void get(PageModel model, @MethodParam(\"getAccount\") Account account,\n\t                @SpringBean(\"adminAccountService\") AccountService accountService,\n\t                @SpringBean(\"adminService\") AdministrationService administrationService,\n\t                @SpringBean(\"providerManagementService\") ProviderManagementService providerManagementService,\n\t\t\t\t\tUiUtils uu,\n\t\t\t\t\t@SpringBean(\"appFrameworkService\") AppFrameworkService appFrameworkService)\n\t    throws IOException {\n\t\t\n\t\tsetModelAttributes(model, account, null, accountService, administrationService, providerManagementService, uu, appFrameworkService);\n\t\tif (account.getPerson().getPersonId() == null) {\n\t\t\tsetJsonFormData(model, account, null);\n\t\t}\n\t}",
  "abstract_func_before": "public void get(PageModel VAR_0, @MethodParam(\"getAccount\") Account VAR_1,\n\t                @SpringBean(\"adminAccountService\") AccountService VAR_2,\n\t                @SpringBean(\"adminService\") AdministrationService VAR_3,\n\t                @SpringBean(\"providerManagementService\") ProviderManagementService VAR_4,\n\t\t\t\t\tUiUtils VAR_5,\n\t\t\t\t\t@SpringBean(\"appFrameworkService\") AppFrameworkService VAR_6)\n\t    throws IOException {\n\t\t\n\t\tsetModelAttributes(VAR_0, VAR_1, null, VAR_2, VAR_3, VAR_4, VAR_5, VAR_6);\n\t\tif (VAR_1.getPerson().getPersonId() == null) {\n\t\t\tsetJsonFormData(VAR_0, VAR_1, null);\n\t\t}\n\t}",
  "func_graph_path_before": "openmrs/openmrs-module-adminui/702fbfdac7c4418f23bb5f6452482b4a88020061/AccountPageController.java/vul/before/0.json",
  "func": "public void get(PageModel model, @MethodParam(\"getAccount\") Account account,\n\t                @SpringBean(\"adminAccountService\") AccountService accountService,\n\t                @SpringBean(\"adminService\") AdministrationService administrationService,\n\t                @SpringBean(\"providerManagementService\") ProviderManagementService providerManagementService,\n\t\t\t\t\tUiUtils uu,\n\t\t\t\t\t@SpringBean(\"appFrameworkService\") AppFrameworkService appFrameworkService)\n\t    throws IOException {\n\t\t\n\t\tsetModelAttributes(model, account, null, accountService, administrationService, providerManagementService, uu, appFrameworkService);\n\t\tif (account.getPerson().getPersonId() == null) {\n\t\t\tsetJsonFormData(model, account, null, uu);\n\t\t}\n\t}",
  "abstract_func": "public void get(PageModel VAR_0, @MethodParam(\"getAccount\") Account VAR_1,\n\t                @SpringBean(\"adminAccountService\") AccountService VAR_2,\n\t                @SpringBean(\"adminService\") AdministrationService VAR_3,\n\t                @SpringBean(\"providerManagementService\") ProviderManagementService VAR_4,\n\t\t\t\t\tUiUtils VAR_5,\n\t\t\t\t\t@SpringBean(\"appFrameworkService\") AppFrameworkService VAR_6)\n\t    throws IOException {\n\t\t\n\t\tsetModelAttributes(VAR_0, VAR_1, null, VAR_2, VAR_3, VAR_4, VAR_5, VAR_6);\n\t\tif (VAR_1.getPerson().getPersonId() == null) {\n\t\t\tsetJsonFormData(VAR_0, VAR_1, null, VAR_5);\n\t\t}\n\t}",
  "func_graph_path": "openmrs/openmrs-module-adminui/702fbfdac7c4418f23bb5f6452482b4a88020061/AccountPageController.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -8,6 +8,6 @@\n \t\t\n \t\tsetModelAttributes(model, account, null, accountService, administrationService, providerManagementService, uu, appFrameworkService);\n \t\tif (account.getPerson().getPersonId() == null) {\n-\t\t\tsetJsonFormData(model, account, null);\n+\t\t\tsetJsonFormData(model, account, null, uu);\n \t\t}\n \t}",
  "diff_line_info": {
    "deleted_lines": [
      "\t\t\tsetJsonFormData(model, account, null);"
    ],
    "added_lines": [
      "\t\t\tsetJsonFormData(model, account, null, uu);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/openmrs/openmrs-module-adminui/pull/57",
  "description": {
    "pr_info": {
      "title": "RA-1865: Fix possible xss in account setup",
      "number": 57
    },
    "comment": [
      "**Why?**\r\n\r\nPossible XSS bug identified by NC State team in account setup pages\r\n\r\n**What Changed?**\r\n\r\nAdded HTML encoding before user-controlled variables such as username are added to the model.\r\n\r\n**Decisions Made**\r\n\r\nDecided to do the most aggressive html-encoding because the values in question should not have any html-encodable characters anyway. In the unlikely event that this causes anything to break, though, more targeted xss prevention can be done in the .gsp frontend",
      "Thanks @isears üëç "
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0  \nThe commit addresses an XSS vulnerability by adding HTML encoding, consistent with the description and code changes, confirming it's a security fix.\n\nStep-by-Step Explanation:\n\n1. Input Analysis: The commit and vulnerability description both mention fixing an XSS bug, indicating a security issue. The code change adds an argument, showing encoding was implemented.\n\n2. Consistency Check: All parts (commit, description, code) align in addressing an XSS issue through HTML encoding.\n\n3. Purpose Evaluation: Modifies data handling to prevent XSS, affecting core logic for security.\n\n4. Security Assessment: XSS is a security risk, and the fix (HTML encoding) addresses it, making it a security patch.\n\n5. Confidence: All information is consistent and clear, leading to a high confidence score.\n\n**Final Output:**  \n**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0"
}