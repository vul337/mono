{
  "cve_id": "CVE-2022-36039",
  "cwe_ids": [
    "CWE-787"
  ],
  "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "rizinorg/rizin",
  "commit_msg": "fix #2969 - oob write (1 byte) in dex.c",
  "commit_hash": "1524f85211445e41506f98180f8f69f7bf115406",
  "git_url": "https://github.com/rizinorg/rizin/commit/1524f85211445e41506f98180f8f69f7bf115406",
  "file_path": "librz/bin/format/dex/dex.c",
  "func_name": "dex_resolve_library",
  "func_before": "static char *dex_resolve_library(const char *library) {\n\tif (!library || library[0] != 'L') {\n\t\treturn NULL;\n\t}\n\tchar *demangled = strdup(library + 1);\n\trz_str_replace_ch(demangled, '/', '.', 1);\n\tdemangled[strlen(demangled) - 1] = 0;\n\treturn demangled;\n}",
  "abstract_func_before": "static char *dex_resolve_library(const char *VAR_0) {\n\tif (!VAR_0 || VAR_0[0] != 'L') {\n\t\treturn NULL;\n\t}\n\tchar *VAR_1 = strdup(VAR_0 + 1);\n\trz_str_replace_ch(VAR_1, '/', '.', 1);\n\tVAR_1[strlen(VAR_1) - 1] = 0;\n\treturn VAR_1;\n}",
  "func_graph_path_before": "rizinorg/rizin/1524f85211445e41506f98180f8f69f7bf115406/dex.c/vul/before/1.json",
  "func": "static char *dex_resolve_library(const char *library) {\n\tif (!library || library[0] != 'L') {\n\t\treturn NULL;\n\t}\n\tchar *demangled = strdup(library + 1);\n\trz_str_replace_ch(demangled, '/', '.', 1);\n\tif (RZ_STR_ISNOTEMPTY(demangled)) {\n\t\tdemangled[strlen(demangled) - 1] = 0;\n\t}\n\treturn demangled;\n}",
  "abstract_func": "static char *dex_resolve_library(const char *VAR_0) {\n\tif (!VAR_0 || VAR_0[0] != 'L') {\n\t\treturn NULL;\n\t}\n\tchar *VAR_1 = strdup(VAR_0 + 1);\n\trz_str_replace_ch(VAR_1, '/', '.', 1);\n\tif (RZ_STR_ISNOTEMPTY(VAR_1)) {\n\t\tVAR_1[strlen(VAR_1) - 1] = 0;\n\t}\n\treturn VAR_1;\n}",
  "func_graph_path": "rizinorg/rizin/1524f85211445e41506f98180f8f69f7bf115406/dex.c/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -4,6 +4,8 @@\n \t}\n \tchar *demangled = strdup(library + 1);\n \trz_str_replace_ch(demangled, '/', '.', 1);\n-\tdemangled[strlen(demangled) - 1] = 0;\n+\tif (RZ_STR_ISNOTEMPTY(demangled)) {\n+\t\tdemangled[strlen(demangled) - 1] = 0;\n+\t}\n \treturn demangled;\n }",
  "diff_line_info": {
    "deleted_lines": [
      "\tdemangled[strlen(demangled) - 1] = 0;"
    ],
    "added_lines": [
      "\tif (RZ_STR_ISNOTEMPTY(demangled)) {",
      "\t\tdemangled[strlen(demangled) - 1] = 0;",
      "\t}"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/rizinorg/rizin/pull/2977",
  "description": {
    "pr_info": {
      "title": "Fix multiple vulnerabilities",
      "number": 2977
    },
    "comment": [
      "# DO NOT SQUASH\r\n\r\n**Your checklist for this pull request**\r\n- [x] I've read the [guidelines for contributing](https://github.com/rizinorg/rizin/blob/master/DEVELOPERS.md) to this repository\r\n- [x] I made sure to follow the project's [coding style](https://github.com/rizinorg/rizin/blob/master/DEVELOPERS.md#code-style)\r\n- [x] I've documented or updated the documentation of every function and struct this PR changes. If not so I've explained why.\r\n- [ ] I've added tests that prove my fix is effective or that my feature works (if possible)\r\n- [ ] I've updated the [rizin book](https://github.com/rizinorg/book) with the relevant information (if needed)\r\n\r\n**Detailed description**\r\n\r\nFix #2974\r\nFix #2973\r\nFix #2972\r\nFix #2971\r\nFix #2970\r\nFix #2969\r\nFix #2968\r\nFix #2967\r\nFix #2966\r\nFix #2965\r\nFix #2964\r\nFix #2963\r\nFix #2962\r\nFix #2961\r\nFix #2960\r\nFix #2959\r\nFix #2958\r\nFix #2957\r\nFix #2956\r\nFix #2955\r\nFix #2954\r\nFix #2953\r\nFix #2952",
      "@m4drat please check again from this branch.",
      "> @m4drat please check again from this branch.\r\n\r\nGot new crash, that was not reproducible on the previous branch (fix-multiple-vulns): https://github.com/rizinorg/rizin/issues/2966#issuecomment-1223903256"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 0.9"
}