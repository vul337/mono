{
  "cve_id": "CVE-2023-44487",
  "cwe_ids": [
    "CWE-400"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "cvss_is_v3": true,
  "repo_name": "facebook/proxygen",
  "commit_msg": "Re-sync with internal repository\n\nThe internal and external repositories are out of sync. This Pull Request attempts to brings them back in sync by patching the GitHub repository. Please carefully review this patch. You must disable ShipIt for your project in order to merge this pull request. DO NOT IMPORT this pull request. Instead, merge it directly on GitHub using the MERGE BUTTON. Re-enable ShipIt after merging.",
  "commit_hash": "0a00c43d64c58a85e6250120f2377302675b0fe3",
  "git_url": "https://github.com/facebook/proxygen/commit/0a00c43d64c58a85e6250120f2377302675b0fe3",
  "file_path": "proxygen/lib/http/codec/ControlMessageRateLimitFilter.h",
  "func_name": "detachThreadLocals",
  "func_before": "void detachThreadLocals() {\n    resetControlMessages_.cancelTimeout();\n    resetDirectErrors_.cancelTimeout();\n    timer_ = nullptr;\n    // Free pass when switching threads\n    numControlMsgsInCurrentInterval_ = 0;\n    numDirectErrorHandlingInCurrentInterval_ = 0;\n  }",
  "abstract_func_before": "void detachThreadLocals() {\n    VAR_0.cancelTimeout();\n    VAR_1.cancelTimeout();\n    VAR_2 = nullptr;\n    /* COMMENT_0 */\n    VAR_3 = 0;\n    VAR_4 = 0;\n  }",
  "func_graph_path_before": "facebook/proxygen/0a00c43d64c58a85e6250120f2377302675b0fe3/ControlMessageRateLimitFilter.h/vul/before/3.json",
  "func": "void detachThreadLocals() {\n    resetControlMessages_.cancelTimeout();\n    resetDirectErrors_.cancelTimeout();\n    resetHeaders_.cancelTimeout();\n    timer_ = nullptr;\n    // Free pass when switching threads\n    numControlMsgsInCurrentInterval_ = 0;\n    numDirectErrorHandlingInCurrentInterval_ = 0;\n  }",
  "abstract_func": "void detachThreadLocals() {\n    VAR_0.cancelTimeout();\n    VAR_1.cancelTimeout();\n    VAR_2.cancelTimeout();\n    VAR_3 = nullptr;\n    /* COMMENT_0 */\n    VAR_4 = 0;\n    VAR_5 = 0;\n  }",
  "func_graph_path": "facebook/proxygen/0a00c43d64c58a85e6250120f2377302675b0fe3/ControlMessageRateLimitFilter.h/vul/after/3.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,6 +1,7 @@\n void detachThreadLocals() {\n     resetControlMessages_.cancelTimeout();\n     resetDirectErrors_.cancelTimeout();\n+    resetHeaders_.cancelTimeout();\n     timer_ = nullptr;\n     // Free pass when switching threads\n     numControlMsgsInCurrentInterval_ = 0;",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "    resetHeaders_.cancelTimeout();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/facebook/proxygen/pull/466",
  "description": {
    "pr_info": {
      "title": "Re-sync with internal repository following CVE-2023-44487",
      "number": 466
    },
    "comment": [
      "The internal and external repositories are out of sync. This Pull Request attempts to brings them back in sync by patching the GitHub repository. Please carefully review this patch. You must disable ShipIt for your project in order to merge this pull request. DO NOT IMPORT this pull request. Instead, merge it directly on GitHub using the MERGE BUTTON. Re-enable ShipIt after merging.",
      "This resolves CVE-2023-44487."
    ]
  },
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.6,
  "Bug Filter Response": "The commit message discusses syncing repositories, but the code changes modify core thread management logic, indicating a non-security defect fix.\n\n**Final Classification:** Defect Remediation & Feature Upgrades; **Confidence:** 0.6\n\n**Step-by-Step Explanation:**\n\n1. **Input Analysis & Consistency Check**\n   - The commit message talks about syncing repositories, unrelated to the code changes.\n   - Code modifies `detachThreadLocals()`, affecting core logic.\n\n2. **Purpose Evaluation**\n   - Changes address thread management, likely a bug fix or feature enhancement.\n\n3. **Security Assessment**\n   - No security terms; changes don't address vulnerabilities.\n\n4. **Classification**\n   - Non-security, falling under core logic fixes.\n\n**Confidence Score:**\n- Lower due to mismatches but primarily a core fix.\n\n**Answer:**\n**Final Classification:** Defect Remediation & Feature Upgrades; **Confidence:** 0.6"
}