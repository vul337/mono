{
  "cve_id": "CVE-2021-28167",
  "cwe_ids": [
    "CWE-909"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:N",
  "cvss_is_v3": false,
  "repo_name": "eclipse-openj9/openj9",
  "commit_msg": "Correctly load/initialize classes when using ConstantPool\n\n- do not load classes in the \"ifLoaded\" calls\n- never intitialize classes in the natives\n- do not update the constant pool when querying from the natives\n\nFixes: #12016\n\n[ci skip]\n\nSigned-off-by: Graham Chapman <graham_chapman@ca.ibm.com>",
  "commit_hash": "840f3af31a5b8d2d395d9367c826ed756e380fb9",
  "git_url": "https://github.com/eclipse-openj9/openj9/commit/840f3af31a5b8d2d395d9367c826ed756e380fb9",
  "file_path": "runtime/jcl/common/sun_reflect_ConstantPool.c",
  "func_name": "Java_sun_reflect_ConstantPool_getFieldAt0",
  "func_before": "jobject JNICALL\nJava_sun_reflect_ConstantPool_getFieldAt0(JNIEnv *env, jobject unusedObject, jobject constantPoolOop, jint cpIndex)\n{\n\treturn getFieldAt(env, constantPoolOop, cpIndex, J9_RESOLVE_FLAG_RUNTIME_RESOLVE | J9_RESOLVE_FLAG_NO_THROW_ON_FAIL);\n}",
  "abstract_func_before": "jobject VAR_0\nJava_sun_reflect_ConstantPool_getFieldAt0(JNIEnv *VAR_1, jobject VAR_2, jobject VAR_3, jint VAR_4)\n{\n\treturn getFieldAt(VAR_1, VAR_3, VAR_4, VAR_5 | VAR_6);\n}",
  "func_graph_path_before": null,
  "func": "jobject JNICALL\nJava_sun_reflect_ConstantPool_getFieldAt0(JNIEnv *env, jobject unusedObject, jobject constantPoolOop, jint cpIndex)\n{\n\treturn getFieldAt(env, constantPoolOop, cpIndex, 0);\n}",
  "abstract_func": "jobject VAR_0\nJava_sun_reflect_ConstantPool_getFieldAt0(JNIEnv *VAR_1, jobject VAR_2, jobject VAR_3, jint VAR_4)\n{\n\treturn getFieldAt(VAR_1, VAR_3, VAR_4, 0);\n}",
  "func_graph_path": null,
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,5 @@\n jobject JNICALL\n Java_sun_reflect_ConstantPool_getFieldAt0(JNIEnv *env, jobject unusedObject, jobject constantPoolOop, jint cpIndex)\n {\n-\treturn getFieldAt(env, constantPoolOop, cpIndex, J9_RESOLVE_FLAG_RUNTIME_RESOLVE | J9_RESOLVE_FLAG_NO_THROW_ON_FAIL);\n+\treturn getFieldAt(env, constantPoolOop, cpIndex, 0);\n }",
  "diff_line_info": {
    "deleted_lines": [
      "\treturn getFieldAt(env, constantPoolOop, cpIndex, J9_RESOLVE_FLAG_RUNTIME_RESOLVE | J9_RESOLVE_FLAG_NO_THROW_ON_FAIL);"
    ],
    "added_lines": [
      "\treturn getFieldAt(env, constantPoolOop, cpIndex, 0);"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/eclipse-openj9/openj9/pull/12148",
  "description": {
    "pr_info": {
      "title": "Correctly load/initialize classes when using ConstantPool",
      "number": 12148
    },
    "comment": [
      "- do not load classes in the \"ifLoaded\" calls\r\n- never intitialize classes in the natives\r\n- do not update the constant pool when querying from the natives\r\n\r\nFixes: #12016\r\n\r\n[ci skip]\r\n\r\nSigned-off-by: Graham Chapman <graham_chapman@ca.ibm.com>",
      "jenkins test sanity,extended zlinux jdk11",
      "jenkins compile win jdk8",
      "@gacholio can you please open another PR for the 0.26 stream",
      "https://github.com/eclipse/openj9/pull/12164"
    ]
  },
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.7,
  "Bug Filter Response": "**Final Classification:** Defect Remediation & Feature Upgrades; **Confidence:** 0.7"
}