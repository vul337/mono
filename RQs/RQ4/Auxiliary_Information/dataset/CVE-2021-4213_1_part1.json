{
  "cve_id": "CVE-2021-4213",
  "cwe_ids": [
    "CWE-401"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
  "cvss_is_v3": true,
  "repo_name": "dogtagpki/jss",
  "commit_msg": "Fix memory leak on each TLS connection\n\nEach TLS connection is leaking a bunch of data that isn't in the heap\nand so after 25k requests Tomcat uses about 2.5GB resident memory.\n\nThere are large number of relationships that point at each other and we\nneed to break the cycle so JSSEngineReferenceImpl's finalizer can run\nand clear all the native resources these point at.\n\nThe lowest impact place to break the cycle was at SSLAlertEvent.engine.\nThis relationship doesn't seem to be used anywhere.  Once the cycle is\nbroken, JSSEngineReferenceImpl can be garbage collected and the\nfinalizer can run.\n\nSigned-off-by: Chris Kelley <ckelley@redhat.com>",
  "commit_hash": "5922560a78d0dee61af8a33cc9cfbf4cfa291448",
  "git_url": "https://github.com/dogtagpki/jss/commit/5922560a78d0dee61af8a33cc9cfbf4cfa291448",
  "file_path": "src/main/java/org/mozilla/jss/util/GlobalRefProxy.java",
  "func_name": "releaseNativeResources",
  "func_before": "@Override\n    protected synchronized void releaseNativeResources() {\n        clear();\n    }",
  "abstract_func_before": "@Override\n    protected synchronized void releaseNativeResources() {\n        clear();\n    }",
  "func_graph_path_before": "dogtagpki/jss/5922560a78d0dee61af8a33cc9cfbf4cfa291448/GlobalRefProxy.java/vul/before/0.json",
  "func": "@Override\n    protected native void releaseNativeResources();",
  "abstract_func": "@Override\n    protected native void releaseNativeResources();",
  "func_graph_path": "dogtagpki/jss/5922560a78d0dee61af8a33cc9cfbf4cfa291448/GlobalRefProxy.java/vul/after/0.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,2 @@\n @Override\n-    protected synchronized void releaseNativeResources() {\n-        clear();\n-    }\n+    protected native void releaseNativeResources();",
  "diff_line_info": {
    "deleted_lines": [
      "    protected synchronized void releaseNativeResources() {",
      "        clear();",
      "    }"
    ],
    "added_lines": [
      "    protected native void releaseNativeResources();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/dogtagpki/jss/pull/844",
  "description": {
    "pr_info": {
      "title": "Fix memory leak on each TLS connection",
      "number": 844
    },
    "comment": [
      "Each TLS connection is leaking a bunch of data that isn't in the heap\r\nand so after 25k requests Tomcat uses about 2.5GB resident memory.\r\n\r\nThere are large number of relationships that point at each other and we\r\nneed to break the cycle so JSSEngineReferenceImpl's finalizer can run\r\nand clear all the native resources these point at.\r\n\r\nThe lowest impact place to break the cycle was at SSLAlertEvent.engine.\r\nThis relationship doesn't seem to be used anywhere.  Once the cycle is\r\nbroken, JSSEngineReferenceImpl can be garbage collected and the\r\nfinalizer can run.\r\n\r\nSigned-off-by: Chris Kelley <ckelley@redhat.com>",
      "I have verified this fix against F35.",
      "Kudos, SonarCloud Quality Gate passed!&nbsp; &nbsp; ![Quality Gate passed](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/QualityGateBadge/passed-16px.png 'Quality Gate passed')\n\n[![Bug](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/bug-16px.png 'Bug')](https://sonarcloud.io/project/issues?id=dogtagpki_jss&pullRequest=844&resolved=false&types=BUG) [![A](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A-16px.png 'A')](https://sonarcloud.io/project/issues?id=dogtagpki_jss&pullRequest=844&resolved=false&types=BUG) [0 Bugs](https://sonarcloud.io/project/issues?id=dogtagpki_jss&pullRequest=844&resolved=false&types=BUG)  \n[![Vulnerability](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/vulnerability-16px.png 'Vulnerability')](https://sonarcloud.io/project/issues?id=dogtagpki_jss&pullRequest=844&resolved=false&types=VULNERABILITY) [![A](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A-16px.png 'A')](https://sonarcloud.io/project/issues?id=dogtagpki_jss&pullRequest=844&resolved=false&types=VULNERABILITY) [0 Vulnerabilities](https://sonarcloud.io/project/issues?id=dogtagpki_jss&pullRequest=844&resolved=false&types=VULNERABILITY)  \n[![Security Hotspot](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/security_hotspot-16px.png 'Security Hotspot')](https://sonarcloud.io/project/security_hotspots?id=dogtagpki_jss&pullRequest=844&resolved=false&types=SECURITY_HOTSPOT) [![A](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A-16px.png 'A')](https://sonarcloud.io/project/security_hotspots?id=dogtagpki_jss&pullRequest=844&resolved=false&types=SECURITY_HOTSPOT) [0 Security Hotspots](https://sonarcloud.io/project/security_hotspots?id=dogtagpki_jss&pullRequest=844&resolved=false&types=SECURITY_HOTSPOT)  \n[![Code Smell](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/code_smell-16px.png 'Code Smell')](https://sonarcloud.io/project/issues?id=dogtagpki_jss&pullRequest=844&resolved=false&types=CODE_SMELL) [![A](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A-16px.png 'A')](https://sonarcloud.io/project/issues?id=dogtagpki_jss&pullRequest=844&resolved=false&types=CODE_SMELL) [2 Code Smells](https://sonarcloud.io/project/issues?id=dogtagpki_jss&pullRequest=844&resolved=false&types=CODE_SMELL)\n\n[![0.0%](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/CoverageChart/0-16px.png '0.0%')](https://sonarcloud.io/component_measures?id=dogtagpki_jss&pullRequest=844&metric=new_coverage&view=list) [0.0% Coverage](https://sonarcloud.io/component_measures?id=dogtagpki_jss&pullRequest=844&metric=new_coverage&view=list)  \n[![0.0%](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/Duplications/3-16px.png '0.0%')](https://sonarcloud.io/component_measures?id=dogtagpki_jss&pullRequest=844&metric=new_duplicated_lines_density&view=list) [0.0% Duplication](https://sonarcloud.io/component_measures?id=dogtagpki_jss&pullRequest=844&metric=new_duplicated_lines_density&view=list)\n\n"
    ]
  },
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Defect Remediation & Feature Upgrades  \n**Confidence:** 0.9  \n\n**Reasoning:**  \nThe patch addresses a memory leak in TLS connections, which is a defect in resource management. The code changes fix the core logic by adjusting how native resources are released. It is not a security fix as it doesn't address an exploit or vulnerability, but rather an efficiency issue."
}