{
  "cve_id": "CVE-2022-38667",
  "cwe_ids": [
    "CWE-416"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "CrowCpp/Crow",
  "commit_msg": "Prevent HTTP pipelining which Crow doesn't support.",
  "commit_hash": "fba01dc76d6ea940ad7c8392e8f39f9647241d8e",
  "git_url": "https://github.com/CrowCpp/Crow/commit/fba01dc76d6ea940ad7c8392e8f39f9647241d8e",
  "file_path": "include/crow/parser.h",
  "func_name": "clear",
  "func_before": "void clear()\n        {\n            req = crow::request();\n            header_field.clear();\n            header_value.clear();\n            header_building_state = 0;\n            qs_point = 0;\n        }",
  "abstract_func_before": "void clear()\n        {\n            VAR_0 = crow::request();\n            VAR_1.clear();\n            VAR_2.clear();\n            VAR_3 = 0;\n            VAR_4 = 0;\n        }",
  "func_graph_path_before": "CrowCpp/Crow/fba01dc76d6ea940ad7c8392e8f39f9647241d8e/parser.h/vul/before/2.json",
  "func": "void clear()\n        {\n            req = crow::request();\n            header_field.clear();\n            header_value.clear();\n            header_building_state = 0;\n            qs_point = 0;\n            message_complete = false;\n            state = CROW_NEW_MESSAGE();\n        }",
  "abstract_func": "void clear()\n        {\n            VAR_0 = crow::request();\n            VAR_1.clear();\n            VAR_2.clear();\n            VAR_3 = 0;\n            VAR_4 = 0;\n            VAR_5 = false;\n            VAR_6 = CROW_NEW_MESSAGE();\n        }",
  "func_graph_path": "CrowCpp/Crow/fba01dc76d6ea940ad7c8392e8f39f9647241d8e/parser.h/vul/after/2.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -5,4 +5,6 @@\n             header_value.clear();\n             header_building_state = 0;\n             qs_point = 0;\n+            message_complete = false;\n+            state = CROW_NEW_MESSAGE();\n         }",
  "diff_line_info": {
    "deleted_lines": [],
    "added_lines": [
      "            message_complete = false;",
      "            state = CROW_NEW_MESSAGE();"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/CrowCpp/Crow/pull/524",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/CrowCpp/Crow/pull/524: 403 Client Error: Forbidden for url: https://api.github.com/repos/CrowCpp/Crow/pulls/524",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 1.0  \n**Confidence Explanation:** The patch explicitly addresses a use-after-free security vulnerability, with code changes that reset state variables, preventing the exploitation of the issue. The vulnerability description and commit message align with the code modifications."
}