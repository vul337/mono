{
  "cve_id": "CVE-2023-36812",
  "cwe_ids": [
    "CWE-74"
  ],
  "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "OpenTSDB/opentsdb",
  "commit_msg": "Improved fix for #2261.\nRegular expressions wouldn't catch the newlines or possibly other\ncontrol characters. Now we'll use the TAG validation code to make\nsure the inputs are only plain ASCII printables first.\nFixes CVE-2018-12972, CVE-2020-35476",
  "commit_hash": "07c4641471c6f5c2ab5aab615969e97211eb50d9",
  "git_url": "https://github.com/OpenTSDB/opentsdb/commit/07c4641471c6f5c2ab5aab615969e97211eb50d9",
  "file_path": "test/tsd/TestGraphHandler.java",
  "func_name": "setLabelParams",
  "func_before": "@Test\n  public void setLabelParams() throws Exception {\n    assertPlotParam(\"ylabel\", \"This is good\");\n    assertPlotParam(\"ylabel\", \" and so Is this - _ yay\");\n    assertInvalidPlotParam(\"ylabel\", \"[33:system(%20\");\n    assertInvalidPlotParam(\"title\", \"[33:system(%20\");\n    assertInvalidPlotParam(\"y2label\", \"[33:system(%20\");\n  }",
  "abstract_func_before": "@Test\n  public void setLabelParams() throws Exception {\n    assertPlotParam(\"ylabel\", \"This is good\");\n    assertPlotParam(\"ylabel\", \" and so Is this - _ yay\");\n    assertInvalidPlotParam(\"ylabel\", \"[33:system(%20\");\n    assertInvalidPlotParam(\"title\", \"[33:system(%20\");\n    assertInvalidPlotParam(\"y2label\", \"[33:system(%20\");\n  }",
  "func_graph_path_before": "OpenTSDB/opentsdb/07c4641471c6f5c2ab5aab615969e97211eb50d9/TestGraphHandler.java/vul/before/2.json",
  "func": "@Test\n  public void setLabelParams() throws Exception {\n    assertPlotParam(\"ylabel\", \"This is good\");\n    assertPlotParam(\"ylabel\", \" and so Is this - _ yay\");\n    assertInvalidPlotParam(\"ylabel\", \"system(%20no%0anewlines\");\n    assertInvalidPlotParam(\"title\", \"system(%20no%0anewlines\");\n    assertInvalidPlotParam(\"y2label\", \"system(%20no%0anewlines\");\n  }",
  "abstract_func": "@Test\n  public void setLabelParams() throws Exception {\n    assertPlotParam(\"ylabel\", \"This is good\");\n    assertPlotParam(\"ylabel\", \" and so Is this - _ yay\");\n    assertInvalidPlotParam(\"ylabel\", \"system(%20no%0anewlines\");\n    assertInvalidPlotParam(\"title\", \"system(%20no%0anewlines\");\n    assertInvalidPlotParam(\"y2label\", \"system(%20no%0anewlines\");\n  }",
  "func_graph_path": "OpenTSDB/opentsdb/07c4641471c6f5c2ab5aab615969e97211eb50d9/TestGraphHandler.java/vul/after/2.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -2,7 +2,7 @@\n   public void setLabelParams() throws Exception {\n     assertPlotParam(\"ylabel\", \"This is good\");\n     assertPlotParam(\"ylabel\", \" and so Is this - _ yay\");\n-    assertInvalidPlotParam(\"ylabel\", \"[33:system(%20\");\n-    assertInvalidPlotParam(\"title\", \"[33:system(%20\");\n-    assertInvalidPlotParam(\"y2label\", \"[33:system(%20\");\n+    assertInvalidPlotParam(\"ylabel\", \"system(%20no%0anewlines\");\n+    assertInvalidPlotParam(\"title\", \"system(%20no%0anewlines\");\n+    assertInvalidPlotParam(\"y2label\", \"system(%20no%0anewlines\");\n   }",
  "diff_line_info": {
    "deleted_lines": [
      "    assertInvalidPlotParam(\"ylabel\", \"[33:system(%20\");",
      "    assertInvalidPlotParam(\"title\", \"[33:system(%20\");",
      "    assertInvalidPlotParam(\"y2label\", \"[33:system(%20\");"
    ],
    "added_lines": [
      "    assertInvalidPlotParam(\"ylabel\", \"system(%20no%0anewlines\");",
      "    assertInvalidPlotParam(\"title\", \"system(%20no%0anewlines\");",
      "    assertInvalidPlotParam(\"y2label\", \"system(%20no%0anewlines\");"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/OpenTSDB/opentsdb/pull/2275",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/OpenTSDB/opentsdb/pull/2275: 403 Client Error: Forbidden for url: https://api.github.com/repos/OpenTSDB/opentsdb/pulls/2275",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix; **Confidence:** 0.95\n\n**Step-by-Step Explanation:**\n\n1. **Security Indicators:** The commit message and vulnerability description reference specific CVEs (2018-12972 and 2020-35476), which are indicators of known security issues. Additionally, the patch addresses input validation to prevent security risks by ensuring inputs are plain ASCII printables, a common security fix.\n\n2. **Code Changes:** The code diff reflects modifications to input validation, specifically updating test cases to include newline characters, which aligns with the security-related issue of not catching control characters.\n\n3. **Purpose:** The changes are aimed at enhancing security by fixing a vulnerability, which directly impacts the system's security posture.\n\n4. **Consistency:** The modifications are consistent with the described vulnerabilities and the fixes mentioned.\n\nThe high confidence score (0.95) reflects the clear presence of security-related information and consistent code changes."
}