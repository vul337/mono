{
  "cve_id": "CVE-2018-5294",
  "cwe_ids": [
    "CWE-190"
  ],
  "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
  "cvss_is_v3": false,
  "repo_name": "libming",
  "commit_msg": "Fix integer overflow vulnerability in util/read.c.\n\nThis vulnerability is caused by a regression introduced in\nd468907.\n\nIn this commit we cast the result of readUInt8(f) before left\nshifting by 24 in order to avoid out of range shift.\n\nThis commit fixes CVE-2018-5251 (fixes #98).",
  "commit_hash": "c14d07ef20c3f403fcfa59502b74c66933473431",
  "git_url": "https://github.com/libming/libming/commit/c14d07ef20c3f403fcfa59502b74c66933473431",
  "file_path": "util/read.c",
  "func_name": "readSInt32",
  "func_before": "long readSInt32(FILE *f)\n{\n  long result = 0;\n  result |= readUInt8(f);\n  result |= readUInt8(f) << 8;\n  result |= readUInt8(f) << 16;\n  result |= readUInt8(f) << 24;\n  return result;\n}",
  "abstract_func_before": "long readSInt32(FILE *VAR_0)\n{\n  long VAR_1 = 0;\n  VAR_1 |= readUInt8(VAR_0);\n  VAR_1 |= readUInt8(VAR_0) << 8;\n  VAR_1 |= readUInt8(VAR_0) << 16;\n  VAR_1 |= readUInt8(VAR_0) << 24;\n  return VAR_1;\n}",
  "func_graph_path_before": "libming/c14d07ef20c3f403fcfa59502b74c66933473431/read.c/vul/before/1.json",
  "func": "long readSInt32(FILE *f)\n{\n  long result = 0;\n  result |= readUInt8(f);\n  result |= readUInt8(f) << 8;\n  result |= readUInt8(f) << 16;\n  result |= (long) readUInt8(f) << 24;\n  return result;\n}",
  "abstract_func": "long readSInt32(FILE *VAR_0)\n{\n  long VAR_1 = 0;\n  VAR_1 |= readUInt8(VAR_0);\n  VAR_1 |= readUInt8(VAR_0) << 8;\n  VAR_1 |= readUInt8(VAR_0) << 16;\n  VAR_1 |= (long) readUInt8(VAR_0) << 24;\n  return VAR_1;\n}",
  "func_graph_path": "libming/c14d07ef20c3f403fcfa59502b74c66933473431/read.c/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -4,6 +4,6 @@\n   result |= readUInt8(f);\n   result |= readUInt8(f) << 8;\n   result |= readUInt8(f) << 16;\n-  result |= readUInt8(f) << 24;\n+  result |= (long) readUInt8(f) << 24;\n   return result;\n }",
  "diff_line_info": {
    "deleted_lines": [
      "  result |= readUInt8(f) << 24;"
    ],
    "added_lines": [
      "  result |= (long) readUInt8(f) << 24;"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/libming/libming/pull/100",
  "description": "Failed to get PR details: HTTP Request Error for PR https://github.com/libming/libming/pull/100: 403 Client Error: Forbidden for url: https://api.github.com/repos/libming/libming/pulls/100",
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix  \n**Confidence:** 1.0"
}