{
  "cve_id": "CVE-2022-41882",
  "cwe_ids": [
    "CWE-94"
  ],
  "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
  "cvss_is_v3": true,
  "repo_name": "nextcloud/desktop",
  "commit_msg": "makes JsonApiJob share common code with SimpleApiJob\n\nSigned-off-by: Matthieu Gallien <matthieu.gallien@nextcloud.com>",
  "commit_hash": "615c02e3d3ee5daa62f8780e43d28bb631b55df8",
  "git_url": "https://github.com/nextcloud/desktop/commit/615c02e3d3ee5daa62f8780e43d28bb631b55df8",
  "file_path": "src/libsync/networkjobs.cpp",
  "func_name": "JsonApiJob::JsonApiJob",
  "func_before": "JsonApiJob::JsonApiJob(const AccountPtr &account, const QString &path, QObject *parent)\n    : AbstractNetworkJob(account, path, parent)\n{\n}",
  "abstract_func_before": "JsonApiJob::JsonApiJob(const AccountPtr &VAR_0, const QString &VAR_1, QObject *VAR_2)\n    : AbstractNetworkJob(VAR_0, VAR_1, VAR_2)\n{\n}",
  "func_graph_path_before": "nextcloud/desktop/615c02e3d3ee5daa62f8780e43d28bb631b55df8/networkjobs.cpp/vul/before/1.json",
  "func": "JsonApiJob::JsonApiJob(const AccountPtr &account, const QString &path, QObject *parent)\n    : SimpleApiJob(account, path, parent)\n{\n}",
  "abstract_func": "JsonApiJob::JsonApiJob(const AccountPtr &VAR_0, const QString &VAR_1, QObject *VAR_2)\n    : SimpleApiJob(VAR_0, VAR_1, VAR_2)\n{\n}",
  "func_graph_path": "nextcloud/desktop/615c02e3d3ee5daa62f8780e43d28bb631b55df8/networkjobs.cpp/vul/after/1.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,4 @@\n JsonApiJob::JsonApiJob(const AccountPtr &account, const QString &path, QObject *parent)\n-    : AbstractNetworkJob(account, path, parent)\n+    : SimpleApiJob(account, path, parent)\n {\n }",
  "diff_line_info": {
    "deleted_lines": [
      "    : AbstractNetworkJob(account, path, parent)"
    ],
    "added_lines": [
      "    : SimpleApiJob(account, path, parent)"
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/nextcloud/desktop/pull/5039",
  "description": {
    "pr_info": {
      "title": "Bugfix/check token for edit locally requests",
      "number": 5039
    },
    "comment": [
      "<!-- \r\nThanks for opening a pull request on the Nextcloud desktop client.\r\n\r\nInstead of a Contributor License Agreement (CLA) we use a Developer Certificate of Origin (DCO).\r\nhttps://en.wikipedia.org/wiki/Developer_Certificate_of_Origin\r\n\r\nTo accept that DCO, please make sure that you add a line like\r\nSigned-off-by: Random Developer <random@developer.example.org>\r\nat the end of each commit message.\r\n\r\nThis Signed-off-by trailer can be added automatically by git if you pass --signoff or -s to git commit.\r\nSee also:\r\nhttps://git-scm.com/docs/git-commit#Documentation/git-commit.txt---no-signoff\r\n-->\r\n",
      "@mgallien Please do not forget clean-up the history",
      "AppImage file: [nextcloud-PR-5039-f9949ee0de1b8a42412f528dc1f64e080eb44316-x86_64.AppImage](https://github.com/nextcloud-desktop-bot/ci-builds/releases/download/PR-5039/nextcloud-PR-5039-f9949ee0de1b8a42412f528dc1f64e080eb44316-x86_64.AppImage) <br/><br/>To test this change/fix you can simply download above AppImage file and test it. <br/><br/>Please make sure to quit your existing Nextcloud app and backup your data. ",
      "SonarCloud Quality Gate failed.&nbsp; &nbsp; [![Quality Gate failed](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/QualityGateBadge/failed-16px.png 'Quality Gate failed')](https://sonarcloud.io/dashboard?id=nextcloud_desktop&pullRequest=5039)\n\n[![Bug](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/bug-16px.png 'Bug')](https://sonarcloud.io/project/issues?id=nextcloud_desktop&pullRequest=5039&resolved=false&types=BUG) [![A](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A-16px.png 'A')](https://sonarcloud.io/project/issues?id=nextcloud_desktop&pullRequest=5039&resolved=false&types=BUG) [0 Bugs](https://sonarcloud.io/project/issues?id=nextcloud_desktop&pullRequest=5039&resolved=false&types=BUG)  \n[![Vulnerability](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/vulnerability-16px.png 'Vulnerability')](https://sonarcloud.io/project/issues?id=nextcloud_desktop&pullRequest=5039&resolved=false&types=VULNERABILITY) [![A](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A-16px.png 'A')](https://sonarcloud.io/project/issues?id=nextcloud_desktop&pullRequest=5039&resolved=false&types=VULNERABILITY) [0 Vulnerabilities](https://sonarcloud.io/project/issues?id=nextcloud_desktop&pullRequest=5039&resolved=false&types=VULNERABILITY)  \n[![Security Hotspot](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/security_hotspot-16px.png 'Security Hotspot')](https://sonarcloud.io/project/security_hotspots?id=nextcloud_desktop&pullRequest=5039&resolved=false&types=SECURITY_HOTSPOT) [![A](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A-16px.png 'A')](https://sonarcloud.io/project/security_hotspots?id=nextcloud_desktop&pullRequest=5039&resolved=false&types=SECURITY_HOTSPOT) [0 Security Hotspots](https://sonarcloud.io/project/security_hotspots?id=nextcloud_desktop&pullRequest=5039&resolved=false&types=SECURITY_HOTSPOT)  \n[![Code Smell](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/common/code_smell-16px.png 'Code Smell')](https://sonarcloud.io/project/issues?id=nextcloud_desktop&pullRequest=5039&resolved=false&types=CODE_SMELL) [![A](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/RatingBadge/A-16px.png 'A')](https://sonarcloud.io/project/issues?id=nextcloud_desktop&pullRequest=5039&resolved=false&types=CODE_SMELL) [9 Code Smells](https://sonarcloud.io/project/issues?id=nextcloud_desktop&pullRequest=5039&resolved=false&types=CODE_SMELL)\n\n[![46.2%](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/CoverageChart/40-16px.png '46.2%')](https://sonarcloud.io/component_measures?id=nextcloud_desktop&pullRequest=5039&metric=new_coverage&view=list) [46.2% Coverage](https://sonarcloud.io/component_measures?id=nextcloud_desktop&pullRequest=5039&metric=new_coverage&view=list)  \n[![0.0%](https://sonarsource.github.io/sonarcloud-github-static-resources/v2/checks/Duplications/3-16px.png '0.0%')](https://sonarcloud.io/component_measures?id=nextcloud_desktop&pullRequest=5039&metric=new_duplicated_lines_density&view=list) [0.0% Duplication](https://sonarcloud.io/component_measures?id=nextcloud_desktop&pullRequest=5039&metric=new_duplicated_lines_density&view=list)\n\n",
      "# [Codecov](https://codecov.io/gh/nextcloud/desktop/pull/5039?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=nextcloud) Report\n> Merging [#5039](https://codecov.io/gh/nextcloud/desktop/pull/5039?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=nextcloud) (f9949ee) into [master](https://codecov.io/gh/nextcloud/desktop/commit/bde2f90de914e43bbb72a2103828112468326af9?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=nextcloud) (bde2f90) will **increase** coverage by `0.03%`.\n> The diff coverage is `64.91%`.\n\n<details><summary>Additional details and impacted files</summary>\n\n\n```diff\n@@            Coverage Diff             @@\n##           master    #5039      +/-   ##\n==========================================\n+ Coverage   57.34%   57.37%   +0.03%     \n==========================================\n  Files         138      138              \n  Lines       17391    17418      +27     \n==========================================\n+ Hits         9972     9993      +21     \n- Misses       7419     7425       +6     \n```\n\n\n\n| [Impacted Files](https://codecov.io/gh/nextcloud/desktop/pull/5039?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=nextcloud) | Coverage Î” | |\n|---|---|---|\n| [src/libsync/networkjobs.h](https://codecov.io/gh/nextcloud/desktop/pull/5039/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=nextcloud#diff-c3JjL2xpYnN5bmMvbmV0d29ya2pvYnMuaA==) | `4.76% <50.00%> (-0.24%)` | :arrow_down: |\n| [src/libsync/networkjobs.cpp](https://codecov.io/gh/nextcloud/desktop/pull/5039/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=nextcloud#diff-c3JjL2xpYnN5bmMvbmV0d29ya2pvYnMuY3Bw) | `50.28% <65.45%> (+0.28%)` | :arrow_up: |\n| [src/libsync/discovery.cpp](https://codecov.io/gh/nextcloud/desktop/pull/5039/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=nextcloud#diff-c3JjL2xpYnN5bmMvZGlzY292ZXJ5LmNwcA==) | `84.05% <0.00%> (+0.28%)` | :arrow_up: |\n| [src/libsync/propagateremotemkdir.cpp](https://codecov.io/gh/nextcloud/desktop/pull/5039/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=nextcloud#diff-c3JjL2xpYnN5bmMvcHJvcGFnYXRlcmVtb3RlbWtkaXIuY3Bw) | `65.73% <0.00%> (+0.69%)` | :arrow_up: |\n| [src/libsync/propagatorjobs.cpp](https://codecov.io/gh/nextcloud/desktop/pull/5039/diff?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=nextcloud#diff-c3JjL2xpYnN5bmMvcHJvcGFnYXRvcmpvYnMuY3Bw) | `73.23% <0.00%> (+1.40%)` | :arrow_up: |\n\n</details>",
      "/backport to stable-3.6"
    ]
  },
  "Bug Filter": "Supporting & Non-Core Improvements",
  "Bug Filter Confidence": 0.9,
  "Bug Filter Response": "**Final Classification:** Supporting & Non-Core Improvements; **Confidence:** 0.9\n\nStep-by-step explanation:\n1. **Input Analysis:** The commit aims to refactor code, sharing functionality between classes without addressing security.\n2. **Consistency Check:** The code change matches the commit message about code sharing.\n3. **Purpose Evaluation:** Refactoring to improve maintainability, not a security fix.\n4. **Security Assessment:** No mention of security issues; focuses on code structure.\n5. **Non-Security Classification:** Supports code improvement, falls under Supporting & Non-Core.\n6. **Confidence Scoring:** Clear and consistent, high confidence in classification."
}