{
  "cve_id": "CVE-2017-5495",
  "cwe_ids": [
    "CWE-119"
  ],
  "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:N/A:C",
  "cvss_is_v3": false,
  "repo_name": "FRRouting/frr",
  "commit_msg": "lib: limit size of vty buffer to 4096 bytes\n\nThis removes the automatic resizing of the vty input buffer and places a\nhard size cap of 4096 bytes. It also fixes a potentially unsafe strcpy.\n\nSigned-off-by: Quentin Young <qlyoung@cumulusnetworks.com>",
  "commit_hash": "2af38873d89e20bd039255418366c1601aa99e64",
  "git_url": "https://github.com/FRRouting/frr/commit/2af38873d89e20bd039255418366c1601aa99e64",
  "file_path": "lib/vty.c",
  "func_name": "vty_self_insert",
  "func_before": "static void\nvty_self_insert (struct vty *vty, char c)\n{\n  int i;\n  int length;\n\n  vty_ensure (vty, vty->length + 1);\n  length = vty->length - vty->cp;\n  memmove (&vty->buf[vty->cp + 1], &vty->buf[vty->cp], length);\n  vty->buf[vty->cp] = c;\n\n  vty_write (vty, &vty->buf[vty->cp], length + 1);\n  for (i = 0; i < length; i++)\n    vty_write (vty, &telnet_backward_char, 1);\n\n  vty->cp++;\n  vty->length++;\n}",
  "abstract_func_before": "static void\nvty_self_insert (struct vty *vty, char VAR_0)\n{\n  int VAR_1;\n  int VAR_2;\n\n  vty_ensure (vty, vty->length + 1);\n  VAR_2 = vty->length - vty->cp;\n  memmove (&vty->buf[vty->cp + 1], &vty->buf[vty->cp], VAR_2);\n  vty->buf[vty->cp] = VAR_0;\n\n  vty_write (vty, &vty->buf[vty->cp], VAR_2 + 1);\n  for (VAR_1 = 0; VAR_1 < VAR_2; VAR_1++)\n    vty_write (vty, &VAR_3, 1);\n\n  vty->cp++;\n  vty->length++;\n}",
  "func_graph_path_before": "FRRouting/frr/2af38873d89e20bd039255418366c1601aa99e64/vty.c/vul/before/2.json",
  "func": "static void\nvty_self_insert (struct vty *vty, char c)\n{\n  int i;\n  int length;\n\n  if (vty->length + 1 > VTY_BUFSIZ)\n    return;\n\n  length = vty->length - vty->cp;\n  memmove (&vty->buf[vty->cp + 1], &vty->buf[vty->cp], length);\n  vty->buf[vty->cp] = c;\n\n  vty_write (vty, &vty->buf[vty->cp], length + 1);\n  for (i = 0; i < length; i++)\n    vty_write (vty, &telnet_backward_char, 1);\n\n  vty->cp++;\n  vty->length++;\n}",
  "abstract_func": "static void\nvty_self_insert (struct vty *vty, char VAR_0)\n{\n  int VAR_1;\n  int VAR_2;\n\n  if (vty->length + 1 > VAR_3)\n    return;\n\n  VAR_2 = vty->length - vty->cp;\n  memmove (&vty->buf[vty->cp + 1], &vty->buf[vty->cp], VAR_2);\n  vty->buf[vty->cp] = VAR_0;\n\n  vty_write (vty, &vty->buf[vty->cp], VAR_2 + 1);\n  for (VAR_1 = 0; VAR_1 < VAR_2; VAR_1++)\n    vty_write (vty, &VAR_4, 1);\n\n  vty->cp++;\n  vty->length++;\n}",
  "func_graph_path": "FRRouting/frr/2af38873d89e20bd039255418366c1601aa99e64/vty.c/vul/after/2.json",
  "diff_func": "--- func_before\n+++ func_after\n@@ -4,7 +4,9 @@\n   int i;\n   int length;\n \n-  vty_ensure (vty, vty->length + 1);\n+  if (vty->length + 1 > VTY_BUFSIZ)\n+    return;\n+\n   length = vty->length - vty->cp;\n   memmove (&vty->buf[vty->cp + 1], &vty->buf[vty->cp], length);\n   vty->buf[vty->cp] = c;",
  "diff_line_info": {
    "deleted_lines": [
      "  vty_ensure (vty, vty->length + 1);"
    ],
    "added_lines": [
      "  if (vty->length + 1 > VTY_BUFSIZ)",
      "    return;",
      ""
    ]
  },
  "is_vul": true,
  "pr_url": "https://github.com/FRRouting/frr/pull/63",
  "description": {
    "pr_info": {
      "title": "lib: limit size of vty buffer to 4096 bytes",
      "number": 63
    },
    "comment": [
      "This removes the automatic resizing of the vty input buffer and places a\r\nhard size cap of 4096 bytes. It also fixes a potentially unsafe strcpy.\r\n\r\nSigned-off-by: Quentin Young <qlyoung@cumulusnetworks.com>",
      "# Continous Integration Result: SUCCESSFUL\n\nCongratulations, this patch passed basic tests\n\nTested-by: NetDEF / OpenSourceRouting.org CI System\n\n__CI System Testrun URL: https://ci1.netdef.org/browse/FRR-FRRPULLREQ-34/__\n\nThis is a comment from an EXPERIMENTAL automated CI system.\nFor questions and feedback in regards to this CI system, please feel free to email\nMartin Winter - mwinter (at) opensourcerouting.org.\n\n",
      "This is [CVE-2017-5495](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5495)"
    ]
  },
  "Bug Filter": "Security Vulnerability Fix",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "**Final Classification:** Security Vulnerability Fix;  \n**Confidence:** 1.0"
}