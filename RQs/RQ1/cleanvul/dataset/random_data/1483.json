{
  "id": 1483,
  "language": "Java",
  "commit_url": "https://github.com/wildfly-security/wildfly-elytron/commit/1e386fd9a2889611d1e597b3083612c5b2e143f6",
  "commit_sha": "1e386fd9a2889611d1e597b3083612c5b2e143f6",
  "commit_msg": "ELY-2430: Update AbstractX509CertificateChainCredential to make use of MessageDigest#isEqual to avoid a potential timing attack",
  "pr_url": "https://github.com/wildfly-security/wildfly-elytron/pull/1809",
  "pr_info": "Issue: https://issues.redhat.com/browse/JBEAP-23946\r\n\r\nUpstream issue: https://issues.redhat.com/browse/ELY-2418\r\nIncluded upstream issues and PRs:\r\nhttps://issues.redhat.com/browse/ELY-2419         https://github.com/wildfly-security/wildfly-elytron/pull/1776\r\nhttps://issues.redhat.com/browse/ELY-2420\thttps://github.com/wildfly-security/wildfly-elytron/pull/1779\r\nhttps://issues.redhat.com/browse/ELY-2421         https://github.com/wildfly-security/wildfly-elytron/pull/1786\r\nhttps://issues.redhat.com/browse/ELY-2422 \thttps://github.com/wildfly-security/wildfly-elytron/pull/1786\r\nhttps://issues.redhat.com/browse/ELY-2423\thttps://github.com/wildfly-security/wildfly-elytron/pull/1786\r\nhttps://issues.redhat.com/browse/ELY-2424\thttps://github.com/wildfly-security/wildfly-elytron/pull/1786\r\nhttps://issues.redhat.com/browse/ELY-2431 \thttps://github.com/wildfly-security/wildfly-elytron/pull/1786\r\nhttps://issues.redhat.com/browse/ELY-2425\thttps://github.com/wildfly-security/wildfly-elytron/pull/1778\r\nhttps://issues.redhat.com/browse/ELY-2426\thttps://github.com/wildfly-security/wildfly-elytron/pull/1778\r\nhttps://issues.redhat.com/browse/ELY-2427 \thttps://github.com/wildfly-security/wildfly-elytron/pull/1778\r\nhttps://issues.redhat.com/browse/ELY-2428\thttps://github.com/wildfly-security/wildfly-elytron/pull/1778\r\nhttps://issues.redhat.com/browse/ELY-2429\thttps://github.com/wildfly-security/wildfly-elytron/pull/1778\r\nhttps://issues.redhat.com/browse/ELY-2430\thttps://github.com/wildfly-security/wildfly-elytron/pull/1778\r\nhttps://issues.redhat.com/browse/ELY-2432\thttps://github.com/wildfly-security/wildfly-elytron/pull/1775\r\nhttps://issues.redhat.com/browse/ELY-2433\thttps://github.com/wildfly-security/wildfly-elytron/pull/1775\r\nhttps://issues.redhat.com/browse/ELY-2434\thttps://github.com/wildfly-security/wildfly-elytron/pull/1775\r\nhttps://issues.redhat.com/browse/ELY-2435\thttps://github.com/wildfly-security/wildfly-elytron/pull/1775\r\nhttps://issues.redhat.com/browse/ELY-2436\thttps://github.com/wildfly-security/wildfly-elytron/pull/1765\r\nhttps://issues.redhat.com/browse/ELY-2437 \thttps://github.com/wildfly-security/wildfly-elytron/pull/1770\r\nhttps://issues.redhat.com/browse/ELY-2438\thttps://github.com/wildfly-security/wildfly-elytron/pull/1773\r\n\r\n",
  "file_name": "credential/base/src/main/java/org/wildfly/security/credential/AbstractX509CertificateChainCredential.java",
  "func_name": "verify",
  "func_before": "public boolean verify(final Evidence evidence) {\n        if (evidence instanceof X509PeerCertificateChainEvidence) {\n            final X509PeerCertificateChainEvidence peerCertificateChainEvidence = (X509PeerCertificateChainEvidence) evidence;\n            try {\n                return getAlgorithm().equals(peerCertificateChainEvidence.getAlgorithm()) && Arrays.equals(getFirstCertificate().getEncoded(), peerCertificateChainEvidence.getFirstCertificate().getEncoded());\n            } catch (CertificateEncodingException e) {\n            }\n        }\n        return false;\n    }",
  "func_after": "public boolean verify(final Evidence evidence) {\n        if (evidence instanceof X509PeerCertificateChainEvidence) {\n            final X509PeerCertificateChainEvidence peerCertificateChainEvidence = (X509PeerCertificateChainEvidence) evidence;\n            try {\n                return getAlgorithm().equals(peerCertificateChainEvidence.getAlgorithm()) && MessageDigest.isEqual(getFirstCertificate().getEncoded(), peerCertificateChainEvidence.getFirstCertificate().getEncoded());\n            } catch (CertificateEncodingException e) {\n            }\n        }\n        return false;\n    }",
  "diff_func": "--- func_before\n+++ func_after\n public boolean verify(final Evidence evidence) {\n         if (evidence instanceof X509PeerCertificateChainEvidence) {\n             final X509PeerCertificateChainEvidence peerCertificateChainEvidence = (X509PeerCertificateChainEvidence) evidence;\n             try {\n-                return getAlgorithm().equals(peerCertificateChainEvidence.getAlgorithm()) && Arrays.equals(getFirstCertificate().getEncoded(), peerCertificateChainEvidence.getFirstCertificate().getEncoded());\n+                return getAlgorithm().equals(peerCertificateChainEvidence.getAlgorithm()) && MessageDigest.isEqual(getFirstCertificate().getEncoded(), peerCertificateChainEvidence.getFirstCertificate().getEncoded());\n             } catch (CertificateEncodingException e) {\n             }\n         }\n         return false;\n     }",
  "diff_source": "custom"
}