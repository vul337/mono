{
  "id": 3084,
  "language": "Java",
  "commit_url": "https://github.com/qwq233/Nullgram/commit/7afb23810138f0ba99f1996b79a693c31920ebce",
  "commit_sha": "7afb23810138f0ba99f1996b79a693c31920ebce",
  "commit_msg": "fix: crash when access restricted groups\n\nSigned-off-by: qwq233 <qwq233@qwq2333.top>",
  "pr_url": null,
  "pr_info": "no more info",
  "file_name": "TMessagesProj/src/main/java/org/telegram/ui/ProfileActivity.java",
  "func_name": "updateProfileData",
  "func_before": "private void updateProfileData() {\n        if (avatarContainer == null || nameTextView == null) {\n            return;\n        }\n        String onlineTextOverride;\n        int currentConnectionState = getConnectionsManager().getConnectionState();\n        if (currentConnectionState == ConnectionsManager.ConnectionStateWaitingForNetwork) {\n            onlineTextOverride = LocaleController.getString(\"WaitingForNetwork\",\n                R.string.WaitingForNetwork);\n        } else if (currentConnectionState == ConnectionsManager.ConnectionStateConnecting) {\n            onlineTextOverride = LocaleController.getString(\"Connecting\", R.string.Connecting);\n        } else if (currentConnectionState == ConnectionsManager.ConnectionStateUpdating) {\n            onlineTextOverride = LocaleController.getString(\"Updating\", R.string.Updating);\n        } else if (currentConnectionState == ConnectionsManager.ConnectionStateConnectingToProxy) {\n            onlineTextOverride = LocaleController.getString(\"ConnectingToProxy\",\n                R.string.ConnectingToProxy);\n        } else {\n            onlineTextOverride = null;\n        }\n\n        long id = 0;\n        if (userId != 0) {\n            TLRPC.User user = getMessagesController().getUser(userId);\n            if (user == null) {\n                return;\n            }\n            TLRPC.FileLocation photoBig = null;\n            if (user.photo != null) {\n                photoBig = user.photo.photo_big;\n            }\n            avatarDrawable.setInfo(user);\n\n            final ImageLocation imageLocation = ImageLocation.getForUserOrChat(user,\n                ImageLocation.TYPE_BIG);\n            final ImageLocation thumbLocation = ImageLocation.getForUserOrChat(user,\n                ImageLocation.TYPE_SMALL);\n            final ImageLocation videoLocation = avatarsViewPager.getCurrentVideoLocation(\n                thumbLocation, imageLocation);\n            avatarsViewPager.initIfEmpty(imageLocation, thumbLocation);\n            String filter;\n            if (videoLocation != null\n                && videoLocation.imageType == FileLoader.IMAGE_TYPE_ANIMATION) {\n                filter = ImageLoader.AUTOPLAY_FILTER;\n            } else {\n                filter = null;\n            }\n            if (avatarBig == null) {\n                avatarImage.setImage(videoLocation, filter, thumbLocation, \"50_50\", avatarDrawable,\n                    user);\n            }\n            if (thumbLocation != null && setAvatarRow != -1\n                || thumbLocation == null && setAvatarRow == -1) {\n                updateListAnimated(false);\n                needLayout(true);\n            }\n            if (imageLocation != null && (prevLoadedImageLocation == null\n                || imageLocation.photoId != prevLoadedImageLocation.photoId)) {\n                prevLoadedImageLocation = imageLocation;\n                getFileLoader().loadFile(imageLocation, user, null, 0, 1);\n            }\n\n            String newString = UserObject.getUserName(user);\n            String newString2;\n            if (user.id == getUserConfig().getClientUserId()) {\n                newString2 = LocaleController.getString(\"Online\", R.string.Online);\n            } else if (user.id == 333000 || user.id == 777000 || user.id == 42777) {\n                newString2 = LocaleController.getString(\"ServiceNotifications\",\n                    R.string.ServiceNotifications);\n            } else if (MessagesController.isSupportUser(user)) {\n                newString2 = LocaleController.getString(\"SupportStatus\", R.string.SupportStatus);\n            } else if (isBot) {\n                newString2 = LocaleController.getString(\"Bot\", R.string.Bot);\n            } else {\n                isOnline[0] = false;\n                newString2 = LocaleController.formatUserStatus(currentAccount, user, isOnline);\n                if (onlineTextView[1] != null && !mediaHeaderVisible) {\n                    String key = isOnline[0] ? Theme.key_profile_status\n                        : Theme.key_avatar_subtitleInProfileBlue;\n                    onlineTextView[1].setTag(key);\n                    if (!isPulledDown) {\n                        onlineTextView[1].setTextColor(Theme.getColor(key));\n                    }\n                }\n            }\n            for (int a = 0; a < 2; a++) {\n                if (nameTextView[a] == null) {\n                    continue;\n                }\n                if (!nameTextView[a].getText().equals(newString)) {\n                    nameTextView[a].setText(newString);\n                }\n                if (a == 0 && onlineTextOverride != null) {\n                    onlineTextView[a].setText(onlineTextOverride);\n                } else {\n                    onlineTextView[a].setText(newString2);\n                }\n                Drawable leftIcon = currentEncryptedChat != null ? getLockIconDrawable() : null;\n                Drawable rightIcon = null;\n                if (a == 0) {\n                    if (user.scam || user.fake) {\n                        rightIcon = getScamDrawable(user.scam ? 0 : 1);\n                    } else {\n                        rightIcon = getMessagesController().isDialogMuted(\n                            dialogId != 0 ? dialogId : userId) ? Theme.chat_muteIconDrawable\n                            : null;\n                    }\n                } else if (user.scam || user.fake) {\n                    rightIcon = getScamDrawable(user.scam ? 0 : 1);\n                } else if (user.verifiedExtended()) {\n                    rightIcon = getVerifiedCrossfadeDrawable();\n                }\n                nameTextView[a].setLeftDrawable(leftIcon);\n                nameTextView[a].setRightDrawable(rightIcon);\n            }\n\n            avatarImage.getImageReceiver().setVisible(!PhotoViewer.isShowingImage(photoBig), false);\n\n            id = userId;\n            if (user.photo != null && user.photo.dc_id != 0) {\n                idTextView.setText(\"ID: \" + id + \", DC: \" + user.photo.dc_id);\n                idTextView.setOnClickListener(v -> showIdHint(user.photo.dc_id));\n            } else {\n                idTextView.setText(\"ID: \" + id);\n            }\n        } else if (chatId != 0) {\n            TLRPC.Chat chat = getMessagesController().getChat(chatId);\n            if (chat != null) {\n                currentChat = chat;\n            } else {\n                chat = currentChat;\n            }\n\n            String statusString;\n            String profileStatusString;\n            if (ChatObject.isChannel(chat)) {\n                if (chatInfo == null || !currentChat.megagroup && (chatInfo.participants_count == 0\n                    || ChatObject.hasAdminRights(currentChat)\n                    || chatInfo.can_view_participants)) {\n                    if (currentChat.megagroup) {\n                        statusString = profileStatusString = LocaleController.getString(\"Loading\",\n                            R.string.Loading).toLowerCase();\n                    } else {\n                        if ((chat.flags & TLRPC.CHAT_FLAG_IS_PUBLIC) != 0) {\n                            statusString = profileStatusString = LocaleController.getString(\n                                \"ChannelPublic\", R.string.ChannelPublic).toLowerCase();\n                        } else {\n                            statusString = profileStatusString = LocaleController.getString(\n                                \"ChannelPrivate\", R.string.ChannelPrivate).toLowerCase();\n                        }\n                    }\n                } else {\n                    if (currentChat.megagroup) {\n                        if (onlineCount > 1 && chatInfo.participants_count != 0) {\n                            statusString = String.format(\"%s, %s\",\n                                LocaleController.formatPluralString(\"Members\",\n                                    chatInfo.participants_count),\n                                LocaleController.formatPluralString(\"OnlineCount\",\n                                    Math.min(onlineCount, chatInfo.participants_count)));\n                            profileStatusString = String.format(\"%s, %s\",\n                                LocaleController.formatPluralStringComma(\"Members\",\n                                    chatInfo.participants_count),\n                                LocaleController.formatPluralStringComma(\"OnlineCount\",\n                                    Math.min(onlineCount, chatInfo.participants_count)));\n                        } else {\n                            if (chatInfo.participants_count == 0) {\n                                if (chat.has_geo) {\n                                    statusString = profileStatusString = LocaleController.getString(\n                                        \"MegaLocation\", R.string.MegaLocation).toLowerCase();\n                                } else if (!TextUtils.isEmpty(chat.username)) {\n                                    statusString = profileStatusString = LocaleController.getString(\n                                        \"MegaPublic\", R.string.MegaPublic).toLowerCase();\n                                } else {\n                                    statusString = profileStatusString = LocaleController.getString(\n                                        \"MegaPrivate\", R.string.MegaPrivate).toLowerCase();\n                                }\n                            } else {\n                                statusString = LocaleController.formatPluralString(\"Members\",\n                                    chatInfo.participants_count);\n                                profileStatusString = LocaleController.formatPluralStringComma(\n                                    \"Members\", chatInfo.participants_count);\n                            }\n                        }\n                    } else {\n                        int[] result = new int[1];\n                        String shortNumber = LocaleController.formatShortNumber(\n                            chatInfo.participants_count, result);\n                        if (currentChat.megagroup) {\n                            statusString = LocaleController.formatPluralString(\"Members\",\n                                chatInfo.participants_count);\n                            profileStatusString = LocaleController.formatPluralStringComma(\n                                \"Members\", chatInfo.participants_count);\n                        } else {\n                            statusString = LocaleController.formatPluralString(\"Subscribers\",\n                                chatInfo.participants_count);\n                            profileStatusString = LocaleController.formatPluralStringComma(\n                                \"Subscribers\", chatInfo.participants_count);\n                        }\n                    }\n                }\n            } else {\n                if (ChatObject.isKickedFromChat(chat)) {\n                    statusString = profileStatusString = LocaleController.getString(\"YouWereKicked\",\n                        R.string.YouWereKicked);\n                } else if (ChatObject.isLeftFromChat(chat)) {\n                    statusString = profileStatusString = LocaleController.getString(\"YouLeft\",\n                        R.string.YouLeft);\n                } else {\n                    int count = chat.participants_count;\n                    if (chatInfo != null) {\n                        count = chatInfo.participants.participants.size();\n                    }\n                    if (count != 0 && onlineCount > 1) {\n                        statusString = profileStatusString = String.format(\"%s, %s\",\n                            LocaleController.formatPluralString(\"Members\", count),\n                            LocaleController.formatPluralString(\"OnlineCount\", onlineCount));\n                    } else {\n                        statusString = profileStatusString = LocaleController.formatPluralString(\n                            \"Members\", count);\n                    }\n                }\n            }\n\n            boolean changed = false;\n            for (int a = 0; a < 2; a++) {\n                if (nameTextView[a] == null) {\n                    continue;\n                }\n                if (chat.title != null) {\n                    if (nameTextView[a].setText(chat.title)) {\n                        changed = true;\n                    }\n                }\n                nameTextView[a].setLeftDrawable(null);\n                if (a != 0) {\n                    if (chat.scam || chat.fake) {\n                        nameTextView[a].setRightDrawable(getScamDrawable(chat.scam ? 0 : 1));\n                    } else if (chat.verifiedExtended()) {\n                        nameTextView[a].setRightDrawable(getVerifiedCrossfadeDrawable());\n                    } else {\n                        nameTextView[a].setRightDrawable(null);\n                    }\n                } else {\n                    if (chat.scam || chat.fake) {\n                        nameTextView[a].setRightDrawable(getScamDrawable(chat.scam ? 0 : 1));\n                    } else {\n                        nameTextView[a].setRightDrawable(\n                            getMessagesController().isDialogMuted(-chatId)\n                                ? Theme.chat_muteIconDrawable : null);\n                    }\n                }\n                if (a == 0 && onlineTextOverride != null) {\n                    onlineTextView[a].setText(onlineTextOverride);\n                } else {\n                    if (currentChat.megagroup && chatInfo != null && onlineCount > 0) {\n                        onlineTextView[a].setText(a == 0 ? statusString : profileStatusString);\n                    } else if (a == 0 && ChatObject.isChannel(currentChat) && chatInfo != null\n                        && chatInfo.participants_count != 0 && (currentChat.megagroup\n                        || currentChat.broadcast)) {\n                        int[] result = new int[1];\n                        String shortNumber = LocaleController.formatShortNumber(\n                            chatInfo.participants_count, result);\n                        if (currentChat.megagroup) {\n                            if (chatInfo.participants_count == 0) {\n                                if (chat.has_geo) {\n                                    onlineTextView[a].setText(\n                                        LocaleController.getString(\"MegaLocation\",\n                                            R.string.MegaLocation).toLowerCase());\n                                } else if (!TextUtils.isEmpty(chat.username)) {\n                                    onlineTextView[a].setText(\n                                        LocaleController.getString(\"MegaPublic\",\n                                            R.string.MegaPublic).toLowerCase());\n                                } else {\n                                    onlineTextView[a].setText(\n                                        LocaleController.getString(\"MegaPrivate\",\n                                            R.string.MegaPrivate).toLowerCase());\n                                }\n                            } else {\n                                onlineTextView[a].setText(\n                                    LocaleController.formatPluralString(\"Members\", result[0])\n                                        .replace(String.format(\"%d\", result[0]),\n                                            shortNumber));\n                            }\n                        } else {\n                            onlineTextView[a].setText(\n                                LocaleController.formatPluralString(\"Subscribers\", result[0])\n                                    .replace(String.format(\"%d\", result[0]), shortNumber));\n                        }\n                    } else {\n                        onlineTextView[a].setText(a == 0 ? statusString : profileStatusString);\n                    }\n                }\n            }\n            if (changed) {\n                needLayout(true);\n            }\n\n            TLRPC.FileLocation photoBig = null;\n            if (chat.photo != null) {\n                photoBig = chat.photo.photo_big;\n            }\n            avatarDrawable.setInfo(chat);\n            final ImageLocation imageLocation = ImageLocation.getForUserOrChat(chat,\n                ImageLocation.TYPE_BIG);\n            final ImageLocation thumbLocation = ImageLocation.getForUserOrChat(chat,\n                ImageLocation.TYPE_SMALL);\n            final ImageLocation videoLocation = avatarsViewPager.getCurrentVideoLocation(\n                thumbLocation, imageLocation);\n            boolean initied = avatarsViewPager.initIfEmpty(imageLocation, thumbLocation);\n            if ((imageLocation == null || initied) && isPulledDown) {\n                final View view = layoutManager.findViewByPosition(0);\n                if (view != null) {\n                    listView.smoothScrollBy(0, view.getTop() - AndroidUtilities.dp(88),\n                        CubicBezierInterpolator.EASE_OUT_QUINT);\n                }\n            }\n            String filter;\n            if (videoLocation != null\n                && videoLocation.imageType == FileLoader.IMAGE_TYPE_ANIMATION) {\n                filter = ImageLoader.AUTOPLAY_FILTER;\n            } else {\n                filter = null;\n            }\n            if (avatarBig == null) {\n                avatarImage.setImage(videoLocation, filter, thumbLocation, \"50_50\", avatarDrawable,\n                    chat);\n            }\n            if (imageLocation != null && (prevLoadedImageLocation == null\n                || imageLocation.photoId != prevLoadedImageLocation.photoId)) {\n                prevLoadedImageLocation = imageLocation;\n                getFileLoader().loadFile(imageLocation, chat, null, 0, 1);\n            }\n            avatarImage.getImageReceiver().setVisible(!PhotoViewer.isShowingImage(photoBig), false);\n\n            if (ConfigManager.getBooleanOrFalse(Defines.showBotAPIID)) {\n                if (ChatObject.isChannel(chat)) {\n                    id = -1000000000000L - chat.id;\n                } else {\n                    id = -chat.id;\n                }\n            } else {\n                id = chatId;\n            }\n            idTextView.setText(\"ID: \" + id);\n        }\n        if (id != 0) {\n            long finalId = id;\n            idTextView.setOnLongClickListener(v -> {\n                AlertDialog.Builder builder = new AlertDialog.Builder(getParentActivity());\n                builder.setItems(\n                    new CharSequence[]{LocaleController.getString(\"Copy\", R.string.Copy)},\n                    (dialogInterface, i) -> {\n                        if (i == 0) {\n                            AndroidUtilities.addToClipboard(String.valueOf(finalId));\n                            BulletinFactory.of(this).createCopyBulletin(\n                                LocaleController.formatString(\"TextCopied\",\n                                    R.string.TextCopied)).show();\n                        }\n                    });\n                showDialog(builder.create());\n                return false;\n            });\n        }\n\n        if (qrItem != null) {\n            qrItem.setVisibility(searchTransitionProgress > 0.5f && isQrNeedVisible() ? View.VISIBLE : View.GONE);\n        }\n    }",
  "func_after": "private void updateProfileData() {\n        if (avatarContainer == null || nameTextView == null) {\n            return;\n        }\n        String onlineTextOverride;\n        int currentConnectionState = getConnectionsManager().getConnectionState();\n        if (currentConnectionState == ConnectionsManager.ConnectionStateWaitingForNetwork) {\n            onlineTextOverride = LocaleController.getString(\"WaitingForNetwork\", R.string.WaitingForNetwork);\n        } else if (currentConnectionState == ConnectionsManager.ConnectionStateConnecting) {\n            onlineTextOverride = LocaleController.getString(\"Connecting\", R.string.Connecting);\n        } else if (currentConnectionState == ConnectionsManager.ConnectionStateUpdating) {\n            onlineTextOverride = LocaleController.getString(\"Updating\", R.string.Updating);\n        } else if (currentConnectionState == ConnectionsManager.ConnectionStateConnectingToProxy) {\n            onlineTextOverride = LocaleController.getString(\"ConnectingToProxy\", R.string.ConnectingToProxy);\n        } else {\n            onlineTextOverride = null;\n        }\n\n        long id = 0;\n        if (userId != 0) {\n            TLRPC.User user = getMessagesController().getUser(userId);\n            if (user == null) {\n                return;\n            }\n            TLRPC.FileLocation photoBig = null;\n            if (user.photo != null) {\n                photoBig = user.photo.photo_big;\n            }\n            avatarDrawable.setInfo(user);\n\n            final ImageLocation imageLocation = ImageLocation.getForUserOrChat(user, ImageLocation.TYPE_BIG);\n            final ImageLocation thumbLocation = ImageLocation.getForUserOrChat(user, ImageLocation.TYPE_SMALL);\n            final ImageLocation videoLocation = avatarsViewPager.getCurrentVideoLocation(thumbLocation, imageLocation);\n            avatarsViewPager.initIfEmpty(imageLocation, thumbLocation);\n            String filter;\n            if (videoLocation != null && videoLocation.imageType == FileLoader.IMAGE_TYPE_ANIMATION) {\n                filter = ImageLoader.AUTOPLAY_FILTER;\n            } else {\n                filter = null;\n            }\n            if (avatarBig == null) {\n                avatarImage.setImage(videoLocation, filter, thumbLocation, \"50_50\", avatarDrawable, user);\n            }\n            if (thumbLocation != null && setAvatarRow != -1 || thumbLocation == null && setAvatarRow == -1) {\n                updateListAnimated(false);\n                needLayout(true);\n            }\n            if (imageLocation != null && (prevLoadedImageLocation == null || imageLocation.photoId != prevLoadedImageLocation.photoId)) {\n                prevLoadedImageLocation = imageLocation;\n                getFileLoader().loadFile(imageLocation, user, null, 0, 1);\n            }\n\n            String newString = UserObject.getUserName(user);\n            String newString2;\n            if (user.id == getUserConfig().getClientUserId()) {\n                newString2 = LocaleController.getString(\"Online\", R.string.Online);\n            } else if (user.id == 333000 || user.id == 777000 || user.id == 42777) {\n                newString2 = LocaleController.getString(\"ServiceNotifications\", R.string.ServiceNotifications);\n            } else if (MessagesController.isSupportUser(user)) {\n                newString2 = LocaleController.getString(\"SupportStatus\", R.string.SupportStatus);\n            } else if (isBot) {\n                newString2 = LocaleController.getString(\"Bot\", R.string.Bot);\n            } else {\n                isOnline[0] = false;\n                newString2 = LocaleController.formatUserStatus(currentAccount, user, isOnline);\n                if (onlineTextView[1] != null && !mediaHeaderVisible) {\n                    String key = isOnline[0] ? Theme.key_profile_status : Theme.key_avatar_subtitleInProfileBlue;\n                    onlineTextView[1].setTag(key);\n                    if (!isPulledDown) {\n                        onlineTextView[1].setTextColor(Theme.getColor(key));\n                    }\n                }\n            }\n            for (int a = 0; a < 2; a++) {\n                if (nameTextView[a] == null) {\n                    continue;\n                }\n                if (!nameTextView[a].getText().equals(newString)) {\n                    nameTextView[a].setText(newString);\n                }\n                if (a == 0 && onlineTextOverride != null) {\n                    onlineTextView[a].setText(onlineTextOverride);\n                } else {\n                    onlineTextView[a].setText(newString2);\n                }\n                Drawable leftIcon = currentEncryptedChat != null ? getLockIconDrawable() : null;\n                Drawable rightIcon = null;\n                if (a == 0) {\n                    if (user.scam || user.fake) {\n                        rightIcon = getScamDrawable(user.scam ? 0 : 1);\n                    } else {\n                        rightIcon = getMessagesController().isDialogMuted(dialogId != 0 ? dialogId : userId) ? Theme.chat_muteIconDrawable : null;\n                    }\n                } else if (user.scam || user.fake) {\n                    rightIcon = getScamDrawable(user.scam ? 0 : 1);\n                } else if (user.verifiedExtended()) {\n                    rightIcon = getVerifiedCrossfadeDrawable();\n                }\n                nameTextView[a].setLeftDrawable(leftIcon);\n                nameTextView[a].setRightDrawable(rightIcon);\n            }\n\n            avatarImage.getImageReceiver().setVisible(!PhotoViewer.isShowingImage(photoBig), false);\n\n            id = userId;\n            if (user.photo != null && user.photo.dc_id != 0) {\n                idTextView.setText(\"ID: \" + id + \", DC: \" + user.photo.dc_id);\n                idTextView.setOnClickListener(v -> showIdHint(user.photo.dc_id));\n            } else {\n                idTextView.setText(\"ID: \" + id);\n            }\n        } else if (chatId != 0) {\n            TLRPC.Chat chat = getMessagesController().getChat(chatId);\n            if (chat != null) {\n                currentChat = chat;\n            } else {\n                chat = currentChat;\n            }\n\n            String statusString;\n            String profileStatusString;\n            if (ChatObject.isChannel(chat)) {\n                if (chatInfo == null || !currentChat.megagroup && (chatInfo.participants_count == 0 || ChatObject.hasAdminRights(currentChat) || chatInfo.can_view_participants)) {\n                    if (currentChat.megagroup) {\n                        statusString = profileStatusString = LocaleController.getString(\"Loading\", R.string.Loading).toLowerCase();\n                    } else {\n                        if ((chat.flags & TLRPC.CHAT_FLAG_IS_PUBLIC) != 0) {\n                            statusString = profileStatusString = LocaleController.getString(\"ChannelPublic\", R.string.ChannelPublic).toLowerCase();\n                        } else {\n                            statusString = profileStatusString = LocaleController.getString(\"ChannelPrivate\", R.string.ChannelPrivate).toLowerCase();\n                        }\n                    }\n                } else {\n                    if (currentChat.megagroup) {\n                        if (onlineCount > 1 && chatInfo.participants_count != 0) {\n                            statusString = String.format(\"%s, %s\", LocaleController.formatPluralString(\"Members\", chatInfo.participants_count), LocaleController.formatPluralString(\"OnlineCount\", Math.min(onlineCount, chatInfo.participants_count)));\n                            profileStatusString = String.format(\"%s, %s\", LocaleController.formatPluralStringComma(\"Members\", chatInfo.participants_count), LocaleController.formatPluralStringComma(\"OnlineCount\", Math.min(onlineCount, chatInfo.participants_count)));\n                        } else {\n                            if (chatInfo.participants_count == 0) {\n                                if (chat.has_geo) {\n                                    statusString = profileStatusString = LocaleController.getString(\"MegaLocation\", R.string.MegaLocation).toLowerCase();\n                                } else if (!TextUtils.isEmpty(chat.username)) {\n                                    statusString = profileStatusString = LocaleController.getString(\"MegaPublic\", R.string.MegaPublic).toLowerCase();\n                                } else {\n                                    statusString = profileStatusString = LocaleController.getString(\"MegaPrivate\", R.string.MegaPrivate).toLowerCase();\n                                }\n                            } else {\n                                statusString = LocaleController.formatPluralString(\"Members\", chatInfo.participants_count);\n                                profileStatusString = LocaleController.formatPluralStringComma(\"Members\", chatInfo.participants_count);\n                            }\n                        }\n                    } else {\n                        int[] result = new int[1];\n                        String shortNumber = LocaleController.formatShortNumber(chatInfo.participants_count, result);\n                        if (currentChat.megagroup) {\n                            statusString = LocaleController.formatPluralString(\"Members\", chatInfo.participants_count);\n                            profileStatusString = LocaleController.formatPluralStringComma(\"Members\", chatInfo.participants_count);\n                        } else {\n                            statusString = LocaleController.formatPluralString(\"Subscribers\", chatInfo.participants_count);\n                            profileStatusString = LocaleController.formatPluralStringComma(\"Subscribers\", chatInfo.participants_count);\n                        }\n                    }\n                }\n            } else {\n                if (ChatObject.isKickedFromChat(chat)) {\n                    statusString = profileStatusString = LocaleController.getString(\"YouWereKicked\", R.string.YouWereKicked);\n                } else if (ChatObject.isLeftFromChat(chat)) {\n                    statusString = profileStatusString = LocaleController.getString(\"YouLeft\", R.string.YouLeft);\n                } else {\n                    int count = chat.participants_count;\n                    if (chatInfo != null) {\n                        count = chatInfo.participants.participants.size();\n                    }\n                    if (count != 0 && onlineCount > 1) {\n                        statusString = profileStatusString = String.format(\"%s, %s\", LocaleController.formatPluralString(\"Members\", count), LocaleController.formatPluralString(\"OnlineCount\", onlineCount));\n                    } else {\n                        statusString = profileStatusString = LocaleController.formatPluralString(\"Members\", count);\n                    }\n                }\n            }\n\n            boolean changed = false;\n            for (int a = 0; a < 2; a++) {\n                if (nameTextView[a] == null) {\n                    continue;\n                }\n                if (chat.title != null) {\n                    if (nameTextView[a].setText(chat.title)) {\n                        changed = true;\n                    }\n                }\n                nameTextView[a].setLeftDrawable(null);\n                if (a != 0) {\n                    if (chat.scam || chat.fake) {\n                        nameTextView[a].setRightDrawable(getScamDrawable(chat.scam ? 0 : 1));\n                    } else if (chat.verifiedExtended()) {\n                        nameTextView[a].setRightDrawable(getVerifiedCrossfadeDrawable());\n                    } else {\n                        nameTextView[a].setRightDrawable(null);\n                    }\n                } else {\n                    if (chat.scam || chat.fake) {\n                        nameTextView[a].setRightDrawable(getScamDrawable(chat.scam ? 0 : 1));\n                    } else {\n                        nameTextView[a].setRightDrawable(getMessagesController().isDialogMuted(-chatId) ? Theme.chat_muteIconDrawable : null);\n                    }\n                }\n                if (a == 0 && onlineTextOverride != null) {\n                    onlineTextView[a].setText(onlineTextOverride);\n                } else {\n                    if (currentChat.megagroup && chatInfo != null && onlineCount > 0) {\n                        onlineTextView[a].setText(a == 0 ? statusString : profileStatusString);\n                    } else if (a == 0 && ChatObject.isChannel(currentChat) && chatInfo != null && chatInfo.participants_count != 0 && (currentChat.megagroup || currentChat.broadcast)) {\n                        int[] result = new int[1];\n                        String shortNumber = LocaleController.formatShortNumber(chatInfo.participants_count, result);\n                        if (currentChat.megagroup) {\n                            if (chatInfo.participants_count == 0) {\n                                if (chat.has_geo) {\n                                    onlineTextView[a].setText(LocaleController.getString(\"MegaLocation\", R.string.MegaLocation).toLowerCase());\n                                } else if (!TextUtils.isEmpty(chat.username)) {\n                                    onlineTextView[a].setText(LocaleController.getString(\"MegaPublic\", R.string.MegaPublic).toLowerCase());\n                                } else {\n                                    onlineTextView[a].setText(LocaleController.getString(\"MegaPrivate\", R.string.MegaPrivate).toLowerCase());\n                                }\n                            } else {\n                                onlineTextView[a].setText(LocaleController.formatPluralString(\"Members\", result[0]).replace(String.format(\"%d\", result[0]), shortNumber));\n                            }\n                        } else {\n                            onlineTextView[a].setText(LocaleController.formatPluralString(\"Subscribers\", result[0]).replace(String.format(\"%d\", result[0]), shortNumber));\n                        }\n                    } else {\n                        onlineTextView[a].setText(a == 0 ? statusString : profileStatusString);\n                    }\n                }\n            }\n            if (changed) {\n                needLayout(true);\n            }\n\n            TLRPC.FileLocation photoBig = null;\n            if (chat.photo != null) {\n                photoBig = chat.photo.photo_big;\n            }\n            avatarDrawable.setInfo(chat);\n            final ImageLocation imageLocation = ImageLocation.getForUserOrChat(chat, ImageLocation.TYPE_BIG);\n            final ImageLocation thumbLocation = ImageLocation.getForUserOrChat(chat, ImageLocation.TYPE_SMALL);\n            final ImageLocation videoLocation = avatarsViewPager.getCurrentVideoLocation(thumbLocation, imageLocation);\n            boolean initied = avatarsViewPager.initIfEmpty(imageLocation, thumbLocation);\n            if ((imageLocation == null || initied) && isPulledDown) {\n                final View view = layoutManager.findViewByPosition(0);\n                if (view != null) {\n                    listView.smoothScrollBy(0, view.getTop() - AndroidUtilities.dp(88), CubicBezierInterpolator.EASE_OUT_QUINT);\n                }\n            }\n            String filter;\n            if (videoLocation != null && videoLocation.imageType == FileLoader.IMAGE_TYPE_ANIMATION) {\n                filter = ImageLoader.AUTOPLAY_FILTER;\n            } else {\n                filter = null;\n            }\n            if (avatarBig == null) {\n                avatarImage.setImage(videoLocation, filter, thumbLocation, \"50_50\", avatarDrawable, chat);\n            }\n            if (imageLocation != null && (prevLoadedImageLocation == null || imageLocation.photoId != prevLoadedImageLocation.photoId)) {\n                prevLoadedImageLocation = imageLocation;\n                getFileLoader().loadFile(imageLocation, chat, null, 0, 1);\n            }\n            avatarImage.getImageReceiver().setVisible(!PhotoViewer.isShowingImage(photoBig), false);\n\n            if (ConfigManager.getBooleanOrFalse(Defines.showBotAPIID)) {\n                if (ChatObject.isChannel(chat)) {\n                    id = -1000000000000L - chat.id;\n                } else {\n                    id = -chat.id;\n                }\n            } else {\n                id = chatId;\n            }\n            idTextView.setText(\"ID: \" + id);\n        }\n        if (id != 0) {\n            long finalId = id;\n            idTextView.setOnLongClickListener(v -> {\n                AlertDialog.Builder builder = new AlertDialog.Builder(getParentActivity());\n                builder.setItems(new CharSequence[]{LocaleController.getString(\"Copy\", R.string.Copy)}, (dialogInterface, i) -> {\n                    if (i == 0) {\n                        AndroidUtilities.addToClipboard(String.valueOf(finalId));\n                        BulletinFactory.of(this).createCopyBulletin(LocaleController.formatString(\"TextCopied\", R.string.TextCopied)).show();\n                    }\n                });\n                showDialog(builder.create());\n                return false;\n            });\n        }\n\n        if (qrItem != null) {\n            qrItem.setVisibility(searchTransitionProgress > 0.5f && isQrNeedVisible() ? View.VISIBLE : View.GONE);\n        }\n    }",
  "diff_func": "--- func_before\n+++ func_after\n private void updateProfileData() {\n         if (avatarContainer == null || nameTextView == null) {\n             return;\n         }\n         String onlineTextOverride;\n         int currentConnectionState = getConnectionsManager().getConnectionState();\n         if (currentConnectionState == ConnectionsManager.ConnectionStateWaitingForNetwork) {\n-            onlineTextOverride = LocaleController.getString(\"WaitingForNetwork\",\n+            onlineTextOverride = LocaleController.getString(\"WaitingForNetwork\", R.string.WaitingForNetwork);\n-                R.string.WaitingForNetwork);\n         } else if (currentConnectionState == ConnectionsManager.ConnectionStateConnecting) {\n             onlineTextOverride = LocaleController.getString(\"Connecting\", R.string.Connecting);\n         } else if (currentConnectionState == ConnectionsManager.ConnectionStateUpdating) {\n             onlineTextOverride = LocaleController.getString(\"Updating\", R.string.Updating);\n         } else if (currentConnectionState == ConnectionsManager.ConnectionStateConnectingToProxy) {\n-            onlineTextOverride = LocaleController.getString(\"ConnectingToProxy\",\n+            onlineTextOverride = LocaleController.getString(\"ConnectingToProxy\", R.string.ConnectingToProxy);\n-                R.string.ConnectingToProxy);\n         } else {\n             onlineTextOverride = null;\n         }\n \n         long id = 0;\n         if (userId != 0) {\n             TLRPC.User user = getMessagesController().getUser(userId);\n             if (user == null) {\n                 return;\n             }\n             TLRPC.FileLocation photoBig = null;\n             if (user.photo != null) {\n                 photoBig = user.photo.photo_big;\n             }\n             avatarDrawable.setInfo(user);\n \n-            final ImageLocation imageLocation = ImageLocation.getForUserOrChat(user,\n+            final ImageLocation imageLocation = ImageLocation.getForUserOrChat(user, ImageLocation.TYPE_BIG);\n-      ",
  "diff_source": "custom",
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.85,
  "Bug Filter Response": "\n\nFinal Classification: Defect Remediation & Feature Upgrades  \nConfidence Score: 0.85"
}