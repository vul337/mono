{
  "id": 1463,
  "language": "Java",
  "commit_url": "https://github.com/wildfly-security/wildfly-elytron/commit/3d353e9ae542994e9408f05ae3ee0c4ea8996a87",
  "commit_sha": "3d353e9ae542994e9408f05ae3ee0c4ea8996a87",
  "commit_msg": "ELY-2422\nUpdate SaltedSimpleDigestPasswordImpl to make use of\nMessageDigest#isEqual to avoid a potential timing attack",
  "pr_url": "https://github.com/wildfly-security/wildfly-elytron/pull/1809",
  "pr_info": "Issue: https://issues.redhat.com/browse/JBEAP-23946\r\n\r\nUpstream issue: https://issues.redhat.com/browse/ELY-2418\r\nIncluded upstream issues and PRs:\r\nhttps://issues.redhat.com/browse/ELY-2419         https://github.com/wildfly-security/wildfly-elytron/pull/1776\r\nhttps://issues.redhat.com/browse/ELY-2420\thttps://github.com/wildfly-security/wildfly-elytron/pull/1779\r\nhttps://issues.redhat.com/browse/ELY-2421         https://github.com/wildfly-security/wildfly-elytron/pull/1786\r\nhttps://issues.redhat.com/browse/ELY-2422 \thttps://github.com/wildfly-security/wildfly-elytron/pull/1786\r\nhttps://issues.redhat.com/browse/ELY-2423\thttps://github.com/wildfly-security/wildfly-elytron/pull/1786\r\nhttps://issues.redhat.com/browse/ELY-2424\thttps://github.com/wildfly-security/wildfly-elytron/pull/1786\r\nhttps://issues.redhat.com/browse/ELY-2431 \thttps://github.com/wildfly-security/wildfly-elytron/pull/1786\r\nhttps://issues.redhat.com/browse/ELY-2425\thttps://github.com/wildfly-security/wildfly-elytron/pull/1778\r\nhttps://issues.redhat.com/browse/ELY-2426\thttps://github.com/wildfly-security/wildfly-elytron/pull/1778\r\nhttps://issues.redhat.com/browse/ELY-2427 \thttps://github.com/wildfly-security/wildfly-elytron/pull/1778\r\nhttps://issues.redhat.com/browse/ELY-2428\thttps://github.com/wildfly-security/wildfly-elytron/pull/1778\r\nhttps://issues.redhat.com/browse/ELY-2429\thttps://github.com/wildfly-security/wildfly-elytron/pull/1778\r\nhttps://issues.redhat.com/browse/ELY-2430\thttps://github.com/wildfly-security/wildfly-elytron/pull/1778\r\nhttps://issues.redhat.com/browse/ELY-2432\thttps://github.com/wildfly-security/wildfly-elytron/pull/1775\r\nhttps://issues.redhat.com/browse/ELY-2433\thttps://github.com/wildfly-security/wildfly-elytron/pull/1775\r\nhttps://issues.redhat.com/browse/ELY-2434\thttps://github.com/wildfly-security/wildfly-elytron/pull/1775\r\nhttps://issues.redhat.com/browse/ELY-2435\thttps://github.com/wildfly-security/wildfly-elytron/pull/1775\r\nhttps://issues.redhat.com/browse/ELY-2436\thttps://github.com/wildfly-security/wildfly-elytron/pull/1765\r\nhttps://issues.redhat.com/browse/ELY-2437 \thttps://github.com/wildfly-security/wildfly-elytron/pull/1770\r\nhttps://issues.redhat.com/browse/ELY-2438\thttps://github.com/wildfly-security/wildfly-elytron/pull/1773\r\n\r\n",
  "file_name": "password/impl/src/main/java/org/wildfly/security/password/impl/SaltedSimpleDigestPasswordImpl.java",
  "func_name": "InvalidKeyException",
  "func_before": "@Override\n    boolean verify(char[] guess) throws InvalidKeyException {\n        try {\n            return Arrays.equals(digest, digestOf(algorithm, salt, guess));\n        } catch (NoSuchAlgorithmException e) {\n            throw log.invalidKeyNoSuchMessageDigestAlgorithm(algorithm);\n        }\n    }",
  "func_after": "@Override\n    boolean verify(char[] guess) throws InvalidKeyException {\n        try {\n            return MessageDigest.isEqual(digest, digestOf(algorithm, salt, guess));\n        } catch (NoSuchAlgorithmException e) {\n            throw log.invalidKeyNoSuchMessageDigestAlgorithm(algorithm);\n        }\n    }",
  "diff_func": "--- func_before\n+++ func_after\n @Override\n     boolean verify(char[] guess) throws InvalidKeyException {\n         try {\n-            return Arrays.equals(digest, digestOf(algorithm, salt, guess));\n+            return MessageDigest.isEqual(digest, digestOf(algorithm, salt, guess));\n         } catch (NoSuchAlgorithmException e) {\n             throw log.invalidKeyNoSuchMessageDigestAlgorithm(algorithm);\n         }\n     }",
  "diff_source": "custom",
  "Bug Filter": "Security Vulnerability Fix\nConfidence Score: 1.0",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "\n\nThe patch addresses a timing attack vulnerability by replacing Arrays.equals with MessageDigest.isEqual, which is designed to prevent such attacks. This change is a clear security fix.\n\n**Final Output:**\nAnalysis: The patch modifies the password verification method to use a secure comparison technique, mitigating a timing attack vulnerability. The commit message and code change indicate a security fix.\nFinal Classification: Security Vulnerability Fix\nConfidence Score: 1.0"
}