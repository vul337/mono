{
  "id": 89,
  "language": "c",
  "cwe": "CWE-17",
  "commit_url": "https://github.com/99degree/openssl/commit/c3c7fb07dc975dc3c9de0eddb7d8fd79fc9c67c1",
  "commit_sha": "c3c7fb07dc975dc3c9de0eddb7d8fd79fc9c67c1",
  "commit_msg": "Fix ASN1_TYPE_cmp\n\nFix segmentation violation when ASN1_TYPE_cmp is passed a boolean type. This\ncan be triggered during certificate verification so could be a DoS attack\nagainst a client or a server enabling client authentication.\n\nCVE-2015-0286\n\nReviewed-by: Richard Levitte <levitte@openssl.org>",
  "pr_url": null,
  "pr_info": null,
  "file_name": "crypto/asn1/a_type.c",
  "func_name": "",
  "raw_func_from_json": "int ASN1_TYPE_cmp(const ASN1_TYPE *a, const ASN1_TYPE *b)\n{\n    int result = -1;\n\n    if (!a || !b || a->type != b->type)\n        return -1;\n\n    switch (a->type) {\n     case V_ASN1_OBJECT:\n         result = OBJ_cmp(a->value.object, b->value.object);\n         break;\n     case V_ASN1_NULL:\n         result = 0;             /* They do not have content. */\n         break;\n    case V_ASN1_NEG_ENUMERATED:\n    case V_ASN1_BIT_STRING:\n    case V_ASN1_OCTET_STRING:\n    case V_ASN1_SEQUENCE:\n    case V_ASN1_SET:\n    case V_ASN1_NUMERICSTRING:\n    case V_ASN1_PRINTABLESTRING:\n    case V_ASN1_T61STRING:\n    case V_ASN1_VIDEOTEXSTRING:\n    case V_ASN1_IA5STRING:\n    case V_ASN1_UTCTIME:\n    case V_ASN1_GENERALIZEDTIME:\n    case V_ASN1_GRAPHICSTRING:\n    case V_ASN1_VISIBLESTRING:\n    case V_ASN1_GENERALSTRING:\n    case V_ASN1_UNIVERSALSTRING:\n    case V_ASN1_BMPSTRING:\n    case V_ASN1_UTF8STRING:\n    case V_ASN1_OTHER:\n    default:\n        result = ASN1_STRING_cmp((ASN1_STRING *)a->value.ptr,\n                                 (ASN1_STRING *)b->value.ptr);\n        break;\n    }\n\n    return result;\n}\n",
  "diff_func": "@@ -119,6 +119,9 @@ int ASN1_TYPE_cmp(const ASN1_TYPE *a, const ASN1_TYPE *b)\n     case V_ASN1_OBJECT:\n         result = OBJ_cmp(a->value.object, b->value.object);\n         break;\n+    case V_ASN1_BOOLEAN:\n+        result = a->value.boolean - b->value.boolean;\n+        break;\n     case V_ASN1_NULL:\n         result = 0;             /* They do not have content. */\n         break;",
  "project": "openssl",
  "commit_id": "c3c7fb07dc975dc3c9de0eddb7d8fd79fc9c67c1",
  "target": 1,
  "func": "int ASN1_TYPE_cmp(const ASN1_TYPE *a, const ASN1_TYPE *b)\n{\n    int result = -1;\n\n    if (!a || !b || a->type != b->type)\n        return -1;\n\n    switch (a->type) {\n     case V_ASN1_OBJECT:\n         result = OBJ_cmp(a->value.object, b->value.object);\n         break;\n     case V_ASN1_NULL:\n         result = 0;             /* They do not have content. */\n         break;\n    case V_ASN1_NEG_ENUMERATED:\n    case V_ASN1_BIT_STRING:\n    case V_ASN1_OCTET_STRING:\n    case V_ASN1_SEQUENCE:\n    case V_ASN1_SET:\n    case V_ASN1_NUMERICSTRING:\n    case V_ASN1_PRINTABLESTRING:\n    case V_ASN1_T61STRING:\n    case V_ASN1_VIDEOTEXSTRING:\n    case V_ASN1_IA5STRING:\n    case V_ASN1_UTCTIME:\n    case V_ASN1_GENERALIZEDTIME:\n    case V_ASN1_GRAPHICSTRING:\n    case V_ASN1_VISIBLESTRING:\n    case V_ASN1_GENERALSTRING:\n    case V_ASN1_UNIVERSALSTRING:\n    case V_ASN1_BMPSTRING:\n    case V_ASN1_UTF8STRING:\n    case V_ASN1_OTHER:\n    default:\n        result = ASN1_STRING_cmp((ASN1_STRING *)a->value.ptr,\n                                 (ASN1_STRING *)b->value.ptr);\n        break;\n    }\n\n    return result;\n}\n",
  "big_vul_idx": 177983,
  "idx": 155,
  "hash": 210178361702841664613263558093095710758
}