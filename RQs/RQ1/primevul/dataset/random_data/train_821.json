{
  "id": 821,
  "language": "c",
  "cwe": "CWE-119",
  "commit_url": "https://github.com/sailfishos-mirror/file/commit/35c94dc6acc418f1ad7f6241a6680e5327495793",
  "commit_sha": "35c94dc6acc418f1ad7f6241a6680e5327495793",
  "commit_msg": "Fix always true condition (Thomas Jarosch)",
  "pr_url": null,
  "pr_info": null,
  "file_name": "src/readelf.c",
  "func_name": "",
  "raw_func_from_json": "do_bid_note(struct magic_set *ms, unsigned char *nbuf, uint32_t type,\n    int swap __attribute__((__unused__)), uint32_t namesz, uint32_t descsz,\n     size_t noff, size_t doff, int *flags)\n {\n \tif (namesz == 4 && strcmp((char *)&nbuf[noff], \"GNU\") == 0 &&\n\t    type == NT_GNU_BUILD_ID && (descsz >= 4 || descsz <= 20)) {\n \t\tuint8_t desc[20];\n \t\tconst char *btype;\n \t\tuint32_t i;\n\t\t*flags |= FLAGS_DID_BUILD_ID;\n\t\tswitch (descsz) {\n\t\tcase 8:\n\t\t    btype = \"xxHash\";\n\t\t    break;\n\t\tcase 16:\n\t\t    btype = \"md5/uuid\";\n\t\t    break;\n\t\tcase 20:\n\t\t    btype = \"sha1\";\n\t\t    break;\n\t\tdefault:\n\t\t    btype = \"unknown\";\n\t\t    break;\n\t\t}\n\t\tif (file_printf(ms, \", BuildID[%s]=\", btype) == -1)\n\t\t\treturn 1;\n\t\t(void)memcpy(desc, &nbuf[doff], descsz);\n\t\tfor (i = 0; i < descsz; i++)\n\t\t    if (file_printf(ms, \"%02x\", desc[i]) == -1)\n\t\t\treturn 1;\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n",
  "diff_func": "@@ -27,7 +27,7 @@\n #include \"file.h\"\n \n #ifndef lint\n-FILE_RCSID(\"@(#)$File: readelf.c,v 1.137 2017/08/13 00:21:47 christos Exp $\")\n+FILE_RCSID(\"@(#)$File: readelf.c,v 1.138 2017/08/27 07:55:02 christos Exp $\")\n #endif\n \n #ifdef BUILTIN_ELF\n@@ -511,7 +511,7 @@ do_bid_note(struct magic_set *ms, unsigned char *nbuf, uint32_t type,\n     size_t noff, size_t doff, int *flags)\n {\n \tif (namesz == 4 && strcmp((char *)&nbuf[noff], \"GNU\") == 0 &&\n-\t    type == NT_GNU_BUILD_ID && (descsz >= 4 || descsz <= 20)) {\n+\t    type == NT_GNU_BUILD_ID && (descsz >= 4 && descsz <= 20)) {\n \t\tuint8_t desc[20];\n \t\tconst char *btype;\n \t\tuint32_t i;",
  "project": "file",
  "commit_id": "35c94dc6acc418f1ad7f6241a6680e5327495793",
  "target": 1,
  "func": "do_bid_note(struct magic_set *ms, unsigned char *nbuf, uint32_t type,\n    int swap __attribute__((__unused__)), uint32_t namesz, uint32_t descsz,\n     size_t noff, size_t doff, int *flags)\n {\n \tif (namesz == 4 && strcmp((char *)&nbuf[noff], \"GNU\") == 0 &&\n\t    type == NT_GNU_BUILD_ID && (descsz >= 4 || descsz <= 20)) {\n \t\tuint8_t desc[20];\n \t\tconst char *btype;\n \t\tuint32_t i;\n\t\t*flags |= FLAGS_DID_BUILD_ID;\n\t\tswitch (descsz) {\n\t\tcase 8:\n\t\t    btype = \"xxHash\";\n\t\t    break;\n\t\tcase 16:\n\t\t    btype = \"md5/uuid\";\n\t\t    break;\n\t\tcase 20:\n\t\t    btype = \"sha1\";\n\t\t    break;\n\t\tdefault:\n\t\t    btype = \"unknown\";\n\t\t    break;\n\t\t}\n\t\tif (file_printf(ms, \", BuildID[%s]=\", btype) == -1)\n\t\t\treturn 1;\n\t\t(void)memcpy(desc, &nbuf[doff], descsz);\n\t\tfor (i = 0; i < descsz; i++)\n\t\t    if (file_printf(ms, \"%02x\", desc[i]) == -1)\n\t\t\treturn 1;\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n",
  "big_vul_idx": 180800,
  "idx": 2354,
  "hash": 125277570129377130993833351272884504631
}