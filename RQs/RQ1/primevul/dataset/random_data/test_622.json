{
  "id": 622,
  "language": "c",
  "cwe": "",
  "commit_url": "https://github.com/ibouazizi/gpac-mvhevc/commit/3dbe11b37d65c8472faf0654410068e5500b3adb",
  "commit_sha": "3dbe11b37d65c8472faf0654410068e5500b3adb",
  "commit_msg": "fixed #2175",
  "pr_url": null,
  "pr_info": null,
  "file_name": "src/isomedia/box_code_3gpp.c",
  "func_name": "",
  "raw_func_from_json": "GF_Err diST_box_read(GF_Box *s, GF_BitStream *bs)\n{\n\tu32 i;\n\tchar str[1024];\n\tGF_DIMSScriptTypesBox *p = (GF_DIMSScriptTypesBox *)s;\n\n\ti=0;\n\tstr[0]=0;\n\twhile (1) {\n\t\tstr[i] = gf_bs_read_u8(bs);\n\t\tif (!str[i]) break;\n\t\ti++;\n\t}\n\tISOM_DECREASE_SIZE(p, i);\n\n\tp->content_script_types = gf_strdup(str);\n\treturn GF_OK;\n}",
  "diff_func": "@@ -1128,20 +1128,12 @@ void diST_box_del(GF_Box *s)\n \n GF_Err diST_box_read(GF_Box *s, GF_BitStream *bs)\n {\n-\tu32 i;\n-\tchar str[1024];\n \tGF_DIMSScriptTypesBox *p = (GF_DIMSScriptTypesBox *)s;\n \n-\ti=0;\n-\tstr[0]=0;\n-\twhile (1) {\n-\t\tstr[i] = gf_bs_read_u8(bs);\n-\t\tif (!str[i]) break;\n-\t\ti++;\n-\t}\n-\tISOM_DECREASE_SIZE(p, i);\n-\n-\tp->content_script_types = gf_strdup(str);\n+\tp->content_script_types = gf_malloc(sizeof(char) * (s->size+1));\n+\tif (!p->content_script_types) return GF_OUT_OF_MEM;\n+\tgf_bs_read_data(bs, p->content_script_types, s->size);\n+\tp->content_script_types[s->size] = 0;\n \treturn GF_OK;\n }\n ",
  "func": "GF_Err diST_box_read(GF_Box *s, GF_BitStream *bs)\n{\n\tu32 i;\n\tchar str[1024];\n\tGF_DIMSScriptTypesBox *p = (GF_DIMSScriptTypesBox *)s;\n\n\ti=0;\n\tstr[0]=0;\n\twhile (1) {\n\t\tstr[i] = gf_bs_read_u8(bs);\n\t\tif (!str[i]) break;\n\t\ti++;\n\t}\n\tISOM_DECREASE_SIZE(p, i);\n\n\tp->content_script_types = gf_strdup(str);\n\treturn GF_OK;\n}",
  "project": "gpac",
  "hash": 106220362428987220004954577919715973308,
  "size": 18,
  "commit_id": "3dbe11b37d65c8472faf0654410068e5500b3adb",
  "message": "fixed #2175",
  "target": 1,
  "dataset": "other",
  "idx": 195984
}