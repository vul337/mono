{
  "id": 620,
  "language": "c",
  "cwe": "",
  "commit_url": "https://github.com/zhzhz/myRedis/commit/789f10156009b404950ad717642a9496ed887083",
  "commit_sha": "789f10156009b404950ad717642a9496ed887083",
  "commit_msg": "Fix integer overflow in intset (CVE-2021-29478)\n\nAn integer overflow bug in Redis 6.2 could be exploited to corrupt the heap and\npotentially result with remote code execution.\n\nThe vulnerability involves changing the default set-max-intset-entries\nconfiguration value, creating a large set key that consists of integer values\nand using the COPY command to duplicate it.\n\nThe integer overflow bug exists in all versions of Redis starting with 2.6,\nwhere it could result with a corrupted RDB or DUMP payload, but not exploited\nthrough COPY (which did not exist before 6.2).\n\n(cherry picked from commit 29900d4e6bccdf3691bedf0ea9a5d84863fa3592)",
  "pr_url": null,
  "pr_info": null,
  "file_name": "src/intset.c",
  "func_name": "",
  "raw_func_from_json": "size_t intsetBlobLen(intset *is) {\n    return sizeof(intset)+intrev32ifbe(is->length)*intrev32ifbe(is->encoding);\n}",
  "diff_func": "@@ -278,7 +278,7 @@ uint32_t intsetLen(const intset *is) {\n \n /* Return intset blob size in bytes. */\n size_t intsetBlobLen(intset *is) {\n-    return sizeof(intset)+intrev32ifbe(is->length)*intrev32ifbe(is->encoding);\n+    return sizeof(intset)+(size_t)intrev32ifbe(is->length)*intrev32ifbe(is->encoding);\n }\n \n #ifdef REDIS_TEST",
  "func": "size_t intsetBlobLen(intset *is) {\n    return sizeof(intset)+intrev32ifbe(is->length)*intrev32ifbe(is->encoding);\n}",
  "project": "redis",
  "hash": 61618186628749728684651827175100336534,
  "size": 3,
  "commit_id": "789f10156009b404950ad717642a9496ed887083",
  "message": "Fix integer overflow in intset (CVE-2021-29478)\n\nAn integer overflow bug in Redis 6.2 could be exploited to corrupt the heap and\npotentially result with remote code execution.\n\nThe vulnerability involves changing the default set-max-intset-entries\nconfiguration value, creating a large set key that consists of integer values\nand using the COPY command to duplicate it.\n\nThe integer overflow bug exists in all versions of Redis starting with 2.6,\nwhere it could result with a corrupted RDB or DUMP payload, but not exploited\nthrough COPY (which did not exist before 6.2).\n\n(cherry picked from commit 29900d4e6bccdf3691bedf0ea9a5d84863fa3592)",
  "target": 1,
  "dataset": "other",
  "idx": 199227
}