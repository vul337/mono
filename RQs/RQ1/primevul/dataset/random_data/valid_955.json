{
  "id": 955,
  "language": "unknown",
  "cwe": "",
  "commit_url": "https://github.com/m-holger/mypdf/commit/dc92574c10f3e2516ec6445b88c5d584f40df4e5",
  "commit_sha": "dc92574c10f3e2516ec6445b88c5d584f40df4e5",
  "commit_msg": "Fix some pipelines to be safe if downstream write fails (fuzz issue 28262)",
  "pr_url": null,
  "pr_info": null,
  "file_name": "ChangeLog",
  "func_name": "",
  "raw_func_from_json": "Pl_ASCII85Decoder::flush()\n{\n    if (this->pos == 0)\n    {\n\tQTC::TC(\"libtests\", \"Pl_ASCII85Decoder no-op flush\");\n\treturn;\n    }\n    unsigned long lval = 0;\n    for (int i = 0; i < 5; ++i)\n    {\n\tlval *= 85;\n\tlval += (this->inbuf[i] - 33U);\n    }\n\n    unsigned char outbuf[4];\n    memset(outbuf, 0, 4);\n    for (int i = 3; i >= 0; --i)\n    {\n\toutbuf[i] = lval & 0xff;\n\tlval >>= 8;\n    }\n\n    QTC::TC(\"libtests\", \"Pl_ASCII85Decoder partial flush\",\n\t    (this->pos == 5) ? 0 : 1);\n    getNext()->write(outbuf, this->pos - 1);\n\n    this->pos = 0;\n    memset(this->inbuf, 117, 5);\n}",
  "diff_func": "@@ -1,3 +1,9 @@\n+2021-01-04  Jay Berkenbilt  <ejb@ql.org>\n+\n+\t* Move getNext()->write() calls in some pipelines to ensure that\n+\tstate gates properly reset even if the next pipeline's write\n+\tthrows an exception (fuzz issue 28262).\n+\n 2021-01-03  Jay Berkenbilt  <ejb@ql.org>\n \n \t* Don't include -o nospace with zsh completion setup so file",
  "func": "Pl_ASCII85Decoder::flush()\n{\n    if (this->pos == 0)\n    {\n\tQTC::TC(\"libtests\", \"Pl_ASCII85Decoder no-op flush\");\n\treturn;\n    }\n    unsigned long lval = 0;\n    for (int i = 0; i < 5; ++i)\n    {\n\tlval *= 85;\n\tlval += (this->inbuf[i] - 33U);\n    }\n\n    unsigned char outbuf[4];\n    memset(outbuf, 0, 4);\n    for (int i = 3; i >= 0; --i)\n    {\n\toutbuf[i] = lval & 0xff;\n\tlval >>= 8;\n    }\n\n    QTC::TC(\"libtests\", \"Pl_ASCII85Decoder partial flush\",\n\t    (this->pos == 5) ? 0 : 1);\n    getNext()->write(outbuf, this->pos - 1);\n\n    this->pos = 0;\n    memset(this->inbuf, 117, 5);\n}",
  "project": "qpdf",
  "hash": 85528360671820919508396699545533821192,
  "size": 29,
  "commit_id": "dc92574c10f3e2516ec6445b88c5d584f40df4e5",
  "message": "Fix some pipelines to be safe if downstream write fails (fuzz issue 28262)",
  "target": 1,
  "dataset": "other",
  "idx": 212375
}