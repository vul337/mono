{
  "id": 1027,
  "language": "c",
  "cwe": "CWE-369",
  "commit_url": "https://github.com/jsummers/imageworsener/commit/dc49c807926b96e503bd7c0dec35119eecd6c6fe",
  "commit_sha": "dc49c807926b96e503bd7c0dec35119eecd6c6fe",
  "commit_msg": "Double-check that the input image's density is valid\n\nFixes a bug that could result in division by zero, at least for a JPEG\nsource image.\nFixes issues #19, #20",
  "pr_url": null,
  "pr_info": null,
  "file_name": "src/imagew-api.c",
  "func_name": "",
  "raw_func_from_json": "IW_IMPL(int) iw_get_input_density(struct iw_context *ctx,\n   double *px, double *py, int *pcode)\n {\n \t*px = 1.0;\n \t*py = 1.0;\n\t*pcode = ctx->img1.density_code;\n\tif(ctx->img1.density_code!=IW_DENSITY_UNKNOWN) {\n\t\t*px = ctx->img1.density_x;\n\t\t*py = ctx->img1.density_y;\n\t\treturn 1;\n \t}\n\treturn 0;\n }\n",
  "diff_func": "@@ -483,13 +483,20 @@ IW_IMPL(int) iw_get_input_density(struct iw_context *ctx,\n {\n \t*px = 1.0;\n \t*py = 1.0;\n-\t*pcode = ctx->img1.density_code;\n-\tif(ctx->img1.density_code!=IW_DENSITY_UNKNOWN) {\n-\t\t*px = ctx->img1.density_x;\n-\t\t*py = ctx->img1.density_y;\n-\t\treturn 1;\n+\t*pcode = IW_DENSITY_UNKNOWN;\n+\n+\tif(ctx->img1.density_code==IW_DENSITY_UNKNOWN) {\n+\t\treturn 0;\n \t}\n-\treturn 0;\n+\tif(!iw_is_valid_density(ctx->img1.density_x, ctx->img1.density_y,\n+\t\tctx->img1.density_code))\n+\t{\n+\t\treturn 0;\n+\t}\n+\t*px = ctx->img1.density_x;\n+\t*py = ctx->img1.density_y;\n+\t*pcode = ctx->img1.density_code;\n+\treturn 1;\n }\n \n IW_IMPL(void) iw_set_output_density(struct iw_context *ctx,",
  "project": "imageworsener",
  "commit_id": "dc49c807926b96e503bd7c0dec35119eecd6c6fe",
  "target": 1,
  "func": "IW_IMPL(int) iw_get_input_density(struct iw_context *ctx,\n   double *px, double *py, int *pcode)\n {\n \t*px = 1.0;\n \t*py = 1.0;\n\t*pcode = ctx->img1.density_code;\n\tif(ctx->img1.density_code!=IW_DENSITY_UNKNOWN) {\n\t\t*px = ctx->img1.density_x;\n\t\t*py = ctx->img1.density_y;\n\t\treturn 1;\n \t}\n\treturn 0;\n }\n",
  "big_vul_idx": 181291,
  "idx": 2777,
  "hash": 145137936264817808854895927204592388742
}