{
  "id": 850,
  "language": "c",
  "cwe": "",
  "commit_url": "https://github.com/davidar/bootsh/commit/d2af3bc375e2a77139c3a28d6128c60cd8d08655",
  "commit_sha": "d2af3bc375e2a77139c3a28d6128c60cd8d08655",
  "commit_msg": "parse: Check for non-empty command/rspfile/rspfile_content\n\nThis matches ninja behavior and prevents the possibility of a rule\nwith an empty (NULL) command string.\n\nFixes #68.",
  "pr_url": "https://github.com/davidar/bootsh/pull/2",
  "pr_info": null,
  "file_name": "parse.c",
  "func_name": "",
  "raw_func_from_json": "parserule(struct scanner *s, struct environment *env)\n{\n\tstruct rule *r;\n\tchar *var;\n\tstruct evalstring *val;\n\tbool hascommand = false, hasrspfile = false, hasrspcontent = false;\n\n\tr = mkrule(scanname(s));\n\tscannewline(s);\n\twhile (scanindent(s)) {\n\t\tvar = scanname(s);\n\t\tparselet(s, &val);\n\t\truleaddvar(r, var, val);\n\t\tif (strcmp(var, \"command\") == 0)\n\t\t\thascommand = true;\n\t\telse if (strcmp(var, \"rspfile\") == 0)\n\t\t\thasrspfile = true;\n\t\telse if (strcmp(var, \"rspfile_content\") == 0)\n\t\t\thasrspcontent = true;\n\t}\n\tif (!hascommand)\n\t\tfatal(\"rule '%s' has no command\", r->name);\n\tif (hasrspfile != hasrspcontent)\n\t\tfatal(\"rule '%s' has rspfile and no rspfile_content or vice versa\", r->name);\n\tenvaddrule(env, r);\n}",
  "diff_func": "@@ -42,6 +42,8 @@ parserule(struct scanner *s, struct environment *env)\n \t\tvar = scanname(s);\n \t\tparselet(s, &val);\n \t\truleaddvar(r, var, val);\n+\t\tif (!val)\n+\t\t\tcontinue;\n \t\tif (strcmp(var, \"command\") == 0)\n \t\t\thascommand = true;\n \t\telse if (strcmp(var, \"rspfile\") == 0)",
  "func": "parserule(struct scanner *s, struct environment *env)\n{\n\tstruct rule *r;\n\tchar *var;\n\tstruct evalstring *val;\n\tbool hascommand = false, hasrspfile = false, hasrspcontent = false;\n\n\tr = mkrule(scanname(s));\n\tscannewline(s);\n\twhile (scanindent(s)) {\n\t\tvar = scanname(s);\n\t\tparselet(s, &val);\n\t\truleaddvar(r, var, val);\n\t\tif (strcmp(var, \"command\") == 0)\n\t\t\thascommand = true;\n\t\telse if (strcmp(var, \"rspfile\") == 0)\n\t\t\thasrspfile = true;\n\t\telse if (strcmp(var, \"rspfile_content\") == 0)\n\t\t\thasrspcontent = true;\n\t}\n\tif (!hascommand)\n\t\tfatal(\"rule '%s' has no command\", r->name);\n\tif (hasrspfile != hasrspcontent)\n\t\tfatal(\"rule '%s' has rspfile and no rspfile_content or vice versa\", r->name);\n\tenvaddrule(env, r);\n}",
  "project": "samurai",
  "hash": 335382966921873606289133752083182751104,
  "size": 26,
  "commit_id": "d2af3bc375e2a77139c3a28d6128c60cd8d08655",
  "message": "parse: Check for non-empty command/rspfile/rspfile_content\n\nThis matches ninja behavior and prevents the possibility of a rule\nwith an empty (NULL) command string.\n\nFixes #68.",
  "target": 1,
  "dataset": "other",
  "idx": 208509
}