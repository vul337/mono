{
  "id": 778,
  "language": "c",
  "cwe": "CWE-200",
  "commit_url": "https://github.com/viaembedded/arm-soc/commit/ab676b7d6fbf4b294bf198fb27ade5b0e865c7ce",
  "commit_sha": "ab676b7d6fbf4b294bf198fb27ade5b0e865c7ce",
  "commit_msg": "pagemap: do not leak physical addresses to non-privileged userspace\n\nAs pointed by recent post[1] on exploiting DRAM physical imperfection,\n/proc/PID/pagemap exposes sensitive information which can be used to do\nattacks.\n\nThis disallows anybody without CAP_SYS_ADMIN to read the pagemap.\n\n[1] http://googleprojectzero.blogspot.com/2015/03/exploiting-dram-rowhammer-bug-to-gain.html\n\n[ Eventually we might want to do anything more finegrained, but for now\n  this is the simple model.   - Linus ]\n\nSigned-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com>\nAcked-by: Konstantin Khlebnikov <khlebnikov@openvz.org>\nAcked-by: Andy Lutomirski <luto@amacapital.net>\nCc: Pavel Emelyanov <xemul@parallels.com>\nCc: Andrew Morton <akpm@linux-foundation.org>\nCc: Mark Seaborn <mseaborn@chromium.org>\nCc: stable@vger.kernel.org\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "pr_url": null,
  "pr_info": null,
  "file_name": "fs/proc/task_mmu.c",
  "func_name": "",
  "raw_func_from_json": " static int pagemap_open(struct inode *inode, struct file *file)\n {\n \tpr_warn_once(\"Bits 55-60 of /proc/PID/pagemap entries are about \"\n \t\t\t\"to stop being page-shift some time soon. See the \"\n \t\t\t\"linux/Documentation/vm/pagemap.txt for details.\\n\");\n\treturn 0;\n}\n",
  "diff_func": "@@ -1325,6 +1325,9 @@ static ssize_t pagemap_read(struct file *file, char __user *buf,\n \n static int pagemap_open(struct inode *inode, struct file *file)\n {\n+\t/* do not disclose physical addresses: attack vector */\n+\tif (!capable(CAP_SYS_ADMIN))\n+\t\treturn -EPERM;\n \tpr_warn_once(\"Bits 55-60 of /proc/PID/pagemap entries are about \"\n \t\t\t\"to stop being page-shift some time soon. See the \"\n \t\t\t\"linux/Documentation/vm/pagemap.txt for details.\\n\");",
  "project": "linux",
  "commit_id": "ab676b7d6fbf4b294bf198fb27ade5b0e865c7ce",
  "target": 1,
  "func": " static int pagemap_open(struct inode *inode, struct file *file)\n {\n \tpr_warn_once(\"Bits 55-60 of /proc/PID/pagemap entries are about \"\n \t\t\t\"to stop being page-shift some time soon. See the \"\n \t\t\t\"linux/Documentation/vm/pagemap.txt for details.\\n\");\n\treturn 0;\n}\n",
  "big_vul_idx": 180622,
  "idx": 2198,
  "hash": 103258194490197490402688500703510835841
}