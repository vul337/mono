{
  "id": 156,
  "language": "cpp",
  "cwe": "CWE-78",
  "commit_url": "https://github.com/benemorius/plasma-workspace/commit/9db872df82c258315c6ebad800af59e81ffb9212",
  "commit_sha": "9db872df82c258315c6ebad800af59e81ffb9212",
  "commit_msg": "Make sure device paths are quoted\n\nin the case a vfat removable device has $() or `` in its label,\nsuch as $(touch foo) the quoted command may get executed,\nleaving an attack vector. Use KMacroExpander::expandMacrosShellQuote\nto make sure everything is quoted and not interpreted as a command\n\nBUG:389815",
  "pr_url": null,
  "pr_info": null,
  "file_name": "soliduiserver/deviceserviceaction.cpp",
  "func_name": "",
  "raw_func_from_json": "void DelayedExecutor::delayedExecute(const QString &udi)\n{\n    Solid::Device device(udi);\n \n     QString exec = m_service.exec();\n     MacroExpander mx(device);\n    mx.expandMacros(exec);\n \n     KRun::runCommand(exec, QString(), m_service.icon(), 0);\n     deleteLater();\n}\n",
  "diff_func": "@@ -158,7 +158,7 @@ void DelayedExecutor::delayedExecute(const QString &udi)\n \n     QString exec = m_service.exec();\n     MacroExpander mx(device);\n-    mx.expandMacros(exec);\n+    mx.expandMacrosShellQuote(exec);\n \n     KRun::runCommand(exec, QString(), m_service.icon(), 0);\n     deleteLater();",
  "project": "kde",
  "commit_id": "9db872df82c258315c6ebad800af59e81ffb9212",
  "target": 1,
  "func": "void DelayedExecutor::delayedExecute(const QString &udi)\n{\n    Solid::Device device(udi);\n \n     QString exec = m_service.exec();\n     MacroExpander mx(device);\n    mx.expandMacros(exec);\n \n     KRun::runCommand(exec, QString(), m_service.icon(), 0);\n     deleteLater();\n}\n",
  "big_vul_idx": 178196,
  "idx": 278,
  "hash": 185460399545264476872601191691271963408
}