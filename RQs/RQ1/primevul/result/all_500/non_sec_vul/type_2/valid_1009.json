{
  "id": 1009,
  "language": "md",
  "cwe": "",
  "commit_url": "https://github.com/michaelrsweet/htmldoc/commit/19c582fb32eac74b57e155cffbb529377a9e751a",
  "commit_sha": "19c582fb32eac74b57e155cffbb529377a9e751a",
  "commit_msg": "Fix a crash bug with malformed URIs (Issue #418)",
  "pr_url": null,
  "pr_info": null,
  "file_name": "CHANGES.md",
  "func_name": "",
  "raw_func_from_json": "file_extension(const char *s)\t/* I - Filename or URL */\n{\n  const char\t*extension;\t/* Pointer to directory separator */\n  static char\tbuf[1024];\t/* Buffer for files with targets */\n\n\n  if (s == NULL)\n    return (NULL);\n  else if (!strncmp(s, \"data:image/bmp;\", 15))\n    return (\"bmp\");\n  else if (!strncmp(s, \"data:image/gif;\", 15))\n    return (\"gif\");\n  else if (!strncmp(s, \"data:image/jpeg;\", 16))\n    return (\"jpg\");\n  else if (!strncmp(s, \"data:image/png;\", 15))\n    return (\"png\");\n  else if ((extension = strrchr(s, '/')) != NULL)\n    extension ++;\n  else if ((extension = strrchr(s, '\\\\')) != NULL)\n    extension ++;\n  else\n    extension = s;\n\n  if ((extension = strrchr(extension, '.')) == NULL)\n    return (\"\");\n  else\n    extension ++;\n\n  if (strchr(extension, '#') == NULL)\n    return (extension);\n\n  strlcpy(buf, extension, sizeof(buf));\n\n  *(char *)strchr(buf, '#') = '\\0';\n\n  return (buf);\n}",
  "diff_func": "@@ -1,6 +1,7 @@\n # Changes in HTMLDOC v1.9.12\n \n - Fixed a crash bug with \"data:\" URIs and EPUB output (Issue #410)\n+- Fixed a crash bug with malformed URIs (Issue #418)\n - Fixed some issues reported by Coverity.\n \n ",
  "func": "file_extension(const char *s)\t/* I - Filename or URL */\n{\n  const char\t*extension;\t/* Pointer to directory separator */\n  static char\tbuf[1024];\t/* Buffer for files with targets */\n\n\n  if (s == NULL)\n    return (NULL);\n  else if (!strncmp(s, \"data:image/bmp;\", 15))\n    return (\"bmp\");\n  else if (!strncmp(s, \"data:image/gif;\", 15))\n    return (\"gif\");\n  else if (!strncmp(s, \"data:image/jpeg;\", 16))\n    return (\"jpg\");\n  else if (!strncmp(s, \"data:image/png;\", 15))\n    return (\"png\");\n  else if ((extension = strrchr(s, '/')) != NULL)\n    extension ++;\n  else if ((extension = strrchr(s, '\\\\')) != NULL)\n    extension ++;\n  else\n    extension = s;\n\n  if ((extension = strrchr(extension, '.')) == NULL)\n    return (\"\");\n  else\n    extension ++;\n\n  if (strchr(extension, '#') == NULL)\n    return (extension);\n\n  strlcpy(buf, extension, sizeof(buf));\n\n  *(char *)strchr(buf, '#') = '\\0';\n\n  return (buf);\n}",
  "project": "htmldoc",
  "hash": 280585056567040876864437377935161743610,
  "size": 37,
  "commit_id": "19c582fb32eac74b57e155cffbb529377a9e751a",
  "message": "Fix a crash bug with malformed URIs (Issue #418)",
  "target": 1,
  "dataset": "other",
  "idx": 214946,
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.8,
  "Bug Filter Response": "\n\nThe patch addresses a crash bug related to malformed URIs, which improves stability but doesn't directly fix a security vulnerability. The code diff only updates release notes, indicating a supporting improvement.\n\n**Final Classification:** Defect Remediation & Feature Upgrades  \n**Confidence Score:** 0.8"
}