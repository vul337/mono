{
  "id": 865,
  "language": "c",
  "cwe": "",
  "commit_url": "https://github.com/AcmeUI/android_external_selinux/commit/c49a8ea09501ad66e799ea41b8154b6770fec2c8",
  "commit_sha": "c49a8ea09501ad66e799ea41b8154b6770fec2c8",
  "commit_msg": "libsepol/cil: cil_reset_classperms_set() should not reset classpermission\n\nIn struct cil_classperms_set, the set field is a pointer to a\nstruct cil_classpermission which is looked up in the symbol table.\nSince the cil_classperms_set does not create the cil_classpermission,\nit should not reset it.\n\nSet the set field to NULL instead of resetting the classpermission\nthat it points to.\n\nSigned-off-by: James Carter <jwcart2@gmail.com>",
  "pr_url": null,
  "pr_info": null,
  "file_name": "libsepol/cil/src/cil_reset_ast.c",
  "func_name": "",
  "raw_func_from_json": "static void cil_reset_classperms_set(struct cil_classperms_set *cp_set)\n{\n\tcil_reset_classpermission(cp_set->set);\n}",
  "diff_func": "@@ -59,7 +59,11 @@ static void cil_reset_classpermission(struct cil_classpermission *cp)\n \n static void cil_reset_classperms_set(struct cil_classperms_set *cp_set)\n {\n-\tcil_reset_classpermission(cp_set->set);\n+\tif (cp_set == NULL) {\n+\t\treturn;\n+\t}\n+\n+\tcp_set->set = NULL;\n }\n \n static inline void cil_reset_classperms_list(struct cil_list *cp_list)",
  "func": "static void cil_reset_classperms_set(struct cil_classperms_set *cp_set)\n{\n\tcil_reset_classpermission(cp_set->set);\n}",
  "project": "selinux",
  "hash": 228898186887741153148874390102479645011,
  "size": 4,
  "commit_id": "c49a8ea09501ad66e799ea41b8154b6770fec2c8",
  "message": "libsepol/cil: cil_reset_classperms_set() should not reset classpermission\n\nIn struct cil_classperms_set, the set field is a pointer to a\nstruct cil_classpermission which is looked up in the symbol table.\nSince the cil_classperms_set does not create the cil_classpermission,\nit should not reset it.\n\nSet the set field to NULL instead of resetting the classpermission\nthat it points to.\n\nSigned-off-by: James Carter <jwcart2@gmail.com>",
  "target": 1,
  "dataset": "other",
  "idx": 208940,
  "Bug Filter": "Defect Remediation & Feature Upgrades",
  "Bug Filter Confidence": 0.85,
  "Bug Filter Response": "\n\n**Final Output:**\n\nAnalysis: The patch modifies the `cil_reset_classperms_set` function to correctly handle a pointer by setting it to NULL instead of resetting it. This prevents incorrect modifications of the classpermission it doesn't own, addressing a potential bug that could cause undefined behavior or crashes. However, it doesn't directly address a security vulnerability as it doesn't prevent unauthorized access or data compromise.\n\nFinal Classification: Defect Remediation & Feature Upgrades  \nConfidence Score: 0.85"
}