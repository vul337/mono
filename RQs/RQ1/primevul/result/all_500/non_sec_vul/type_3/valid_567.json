{
  "id": 567,
  "language": "cc",
  "cwe": "",
  "commit_url": "https://github.com/taktik/electron-ffmpeg/commit/18613925610ba319da7f497b6deed85ad712c59b",
  "commit_sha": "18613925610ba319da7f497b6deed85ad712c59b",
  "commit_msg": "refactor: wire will-navigate up to a navigation throttle instead of OpenURL (#25108)\n\n* refactor: wire will-navigate up to a navigation throttle instead of OpenURL (#25065)\r\n\r\n* refactor: wire will-navigate up to a navigation throttle instead of OpenURL\r\n\r\n* spec: add test for x-site _top navigation\r\n\r\n* chore: old code be old",
  "pr_url": null,
  "pr_info": null,
  "file_name": "shell/browser/api/electron_api_web_contents.cc",
  "func_name": "",
  "raw_func_from_json": "content::WebContents* WebContents::OpenURLFromTab(\n    content::WebContents* source,\n    const content::OpenURLParams& params) {\n  if (params.disposition != WindowOpenDisposition::CURRENT_TAB) {\n    Emit(\"-new-window\", params.url, \"\", params.disposition, \"\", params.referrer,\n         params.post_data);\n    return nullptr;\n  }\n\n  // Give user a chance to cancel navigation.\n  if (Emit(\"will-navigate\", params.url))\n    return nullptr;\n\n  // Don't load the URL if the web contents was marked as destroyed from a\n  // will-navigate event listener\n  if (IsDestroyed())\n    return nullptr;\n\n  return CommonWebContentsDelegate::OpenURLFromTab(source, params);\n}",
  "diff_func": "@@ -743,12 +743,6 @@ content::WebContents* WebContents::OpenURLFromTab(\n     return nullptr;\n   }\n \n-  // Give user a chance to cancel navigation.\n-  if (Emit(\"will-navigate\", params.url))\n-    return nullptr;\n-\n-  // Don't load the URL if the web contents was marked as destroyed from a\n-  // will-navigate event listener\n   if (IsDestroyed())\n     return nullptr;\n ",
  "func": "content::WebContents* WebContents::OpenURLFromTab(\n    content::WebContents* source,\n    const content::OpenURLParams& params) {\n  if (params.disposition != WindowOpenDisposition::CURRENT_TAB) {\n    Emit(\"-new-window\", params.url, \"\", params.disposition, \"\", params.referrer,\n         params.post_data);\n    return nullptr;\n  }\n\n  // Give user a chance to cancel navigation.\n  if (Emit(\"will-navigate\", params.url))\n    return nullptr;\n\n  // Don't load the URL if the web contents was marked as destroyed from a\n  // will-navigate event listener\n  if (IsDestroyed())\n    return nullptr;\n\n  return CommonWebContentsDelegate::OpenURLFromTab(source, params);\n}",
  "project": "electron",
  "hash": 266355652945031614418015863162348662454,
  "size": 20,
  "commit_id": "18613925610ba319da7f497b6deed85ad712c59b",
  "message": "refactor: wire will-navigate up to a navigation throttle instead of OpenURL (#25108)\n\n* refactor: wire will-navigate up to a navigation throttle instead of OpenURL (#25065)\r\n\r\n* refactor: wire will-navigate up to a navigation throttle instead of OpenURL\r\n\r\n* spec: add test for x-site _top navigation\r\n\r\n* chore: old code be old",
  "target": 1,
  "dataset": "other",
  "idx": 198143,
  "Bug Filter": "Supporting & Non-Core Improvements",
  "Bug Filter Confidence": 0.8,
  "Bug Filter Response": "\n\nThe patch involves refactoring the handling of the \"will-navigate\" event, moving it to a navigation throttle. The code change removes the event emission from the OpenURLFromTab function. The commit message suggests a structural change rather than a security fix. Without explicit evidence of a security issue, the classification is based on the refactor and added test.\n\n**Final Output:**\n\nAnalysis: The patch refactors the handling of the \"will-navigate\" event, moving it to a navigation throttle. The code removes the event emission, indicating a structural change rather than a security fix. The commit message and code diff do not explicitly address a security vulnerability.\n\nFinal Classification: Supporting & Non-Core Improvements\n\nConfidence Score: 0.8"
}