{
  "id": 239,
  "language": "c",
  "cwe": "CWE-20",
  "commit_url": "https://github.com/sheumann/hush/commit/4e314faa0aecb66717418e9a47a4451aec59262b",
  "commit_sha": "4e314faa0aecb66717418e9a47a4451aec59262b",
  "commit_msg": "modprobe,rmmod: reject module names with slashes\n\nfunction                                             old     new   delta\nadd_probe                                             86     113     +27\n\nSigned-off-by: Denys Vlasenko <vda.linux@googlemail.com>",
  "pr_url": null,
  "pr_info": null,
  "file_name": "modutils/modprobe.c",
  "func_name": "",
  "raw_func_from_json": "static void add_probe(const char *name)\n {\n \tstruct module_entry *m;\n \n \tm = get_or_add_modentry(name);\n \tif (!(option_mask32 & (OPT_REMOVE | OPT_SHOW_DEPS))\n \t && (m->flags & MODULE_FLAG_LOADED)\n\t && strncmp(m->modname, \"symbol:\", 7) == 0\n\t) {\n\t\tG.need_symbols = 1;\n\t}\n}\n",
  "diff_func": "@@ -238,6 +238,17 @@ static void add_probe(const char *name)\n {\n \tstruct module_entry *m;\n \n+\t/*\n+\t * get_or_add_modentry() strips path from name and works\n+\t * on remaining basename.\n+\t * This would make \"rmmod dir/name\" and \"modprobe dir/name\"\n+\t * to work like \"rmmod name\" and \"modprobe name\",\n+\t * which is wrong, and can be abused via implicit modprobing:\n+\t * \"ifconfig /usbserial up\" tries to modprobe netdev-/usbserial.\n+\t */\n+\tif (strchr(name, '/'))\n+\t\tbb_error_msg_and_die(\"malformed module name '%s'\", name);\n+\n \tm = get_or_add_modentry(name);\n \tif (!(option_mask32 & (OPT_REMOVE | OPT_SHOW_DEPS))\n \t && (m->flags & MODULE_FLAG_LOADED)",
  "project": "busybox",
  "commit_id": "4e314faa0aecb66717418e9a47a4451aec59262b",
  "target": 1,
  "func": "static void add_probe(const char *name)\n {\n \tstruct module_entry *m;\n \n \tm = get_or_add_modentry(name);\n \tif (!(option_mask32 & (OPT_REMOVE | OPT_SHOW_DEPS))\n \t && (m->flags & MODULE_FLAG_LOADED)\n\t && strncmp(m->modname, \"symbol:\", 7) == 0\n\t) {\n\t\tG.need_symbols = 1;\n\t}\n}\n",
  "big_vul_idx": 178570,
  "idx": 493,
  "hash": 226438009548517158634898284321538934651,
  "Bug Filter": "Security Vulnerability Fix\nConfidence Score: 0.95",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "\n\nThe patch introduces a security fix by rejecting module names containing slashes, preventing potential exploitation.\n\n**Final Output:**\nAnalysis: The patch modifies the add_probe function to reject module names with slashes, preventing potential security exploits. The code change directly addresses a security vulnerability by validating module names, thus mitigating unauthorized module loading or code execution.\nFinal Classification: Security Vulnerability Fix\nConfidence Score: 0.95"
}