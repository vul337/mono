{
  "id": 1012,
  "language": "c",
  "cwe": "",
  "commit_url": "https://github.com/HKL-Kevin/msm8998-mainline/commit/8cae8cd89f05f6de223d63e6d15e31c8ba9cf53b",
  "commit_sha": "8cae8cd89f05f6de223d63e6d15e31c8ba9cf53b",
  "commit_msg": "seq_file: disallow extremely large seq buffer allocations\n\nThere is no reasonable need for a buffer larger than this, and it avoids\nint overflow pitfalls.\n\nFixes: 058504edd026 (\"fs/seq_file: fallback to vmalloc allocation\")\nSuggested-by: Al Viro <viro@zeniv.linux.org.uk>\nReported-by: Qualys Security Advisory <qsa@qualys.com>\nSigned-off-by: Eric Sandeen <sandeen@redhat.com>\nCc: stable@kernel.org\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "pr_url": null,
  "pr_info": null,
  "file_name": "fs/seq_file.c",
  "func_name": "",
  "raw_func_from_json": "static void *seq_buf_alloc(unsigned long size)\n{\n\treturn kvmalloc(size, GFP_KERNEL_ACCOUNT);\n}",
  "diff_func": "@@ -32,6 +32,9 @@ static void seq_set_overflow(struct seq_file *m)\n \n static void *seq_buf_alloc(unsigned long size)\n {\n+\tif (unlikely(size > MAX_RW_COUNT))\n+\t\treturn NULL;\n+\n \treturn kvmalloc(size, GFP_KERNEL_ACCOUNT);\n }\n ",
  "func": "static void *seq_buf_alloc(unsigned long size)\n{\n\treturn kvmalloc(size, GFP_KERNEL_ACCOUNT);\n}",
  "project": "linux",
  "hash": 97148506821253610384021441624150243008,
  "size": 4,
  "commit_id": "8cae8cd89f05f6de223d63e6d15e31c8ba9cf53b",
  "message": "seq_file: disallow extremely large seq buffer allocations\n\nThere is no reasonable need for a buffer larger than this, and it avoids\nint overflow pitfalls.\n\nFixes: 058504edd026 (\"fs/seq_file: fallback to vmalloc allocation\")\nSuggested-by: Al Viro <viro@zeniv.linux.org.uk>\nReported-by: Qualys Security Advisory <qsa@qualys.com>\nSigned-off-by: Eric Sandeen <sandeen@redhat.com>\nCc: stable@kernel.org\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "target": 1,
  "dataset": "other",
  "idx": 210203,
  "Bug Filter": "** Security Vulnerability Fix  \n**Confidence Score:** 0.95\n\n**Analysis:**\n- The commit message and code diff indicate a fix for preventing large buffer allocations that could cause integer overflows and memory issues.\n- The involvement of a security advisory from Qualys supports the classification as a security fix.\n- The code change directly addresses a potential exploit vector, confirming it as a security vulnerability fix.",
  "Bug Filter Confidence": 0.95,
  "Bug Filter Response": "\n\nThe patch addresses a potential security vulnerability by preventing extremely large buffer allocations, which could lead to integer overflows and memory exhaustion. The code change adds a check to disallow sizes exceeding MAX_RW_COUNT, thus mitigating security risks.\n\n**Final Classification:** Security Vulnerability Fix  \n**Confidence Score:** 0.95\n\n**Analysis:**\n- The commit message and code diff indicate a fix for preventing large buffer allocations that could cause integer overflows and memory issues.\n- The involvement of a security advisory from Qualys supports the classification as a security fix.\n- The code change directly addresses a potential exploit vector, confirming it as a security vulnerability fix."
}