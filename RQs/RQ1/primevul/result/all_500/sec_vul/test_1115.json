{
  "id": 1115,
  "language": "c",
  "cwe": "",
  "commit_url": "https://github.com/adi-g15-ibm/qemu/commit/8c92060d3c0248bd4d515719a35922cd2391b9b4",
  "commit_sha": "8c92060d3c0248bd4d515719a35922cd2391b9b4",
  "commit_msg": "sungem: switch to use qemu_receive_packet() for loopback\n\nThis patch switches to use qemu_receive_packet() which can detect\nreentrancy and return early.\n\nThis is intended to address CVE-2021-3416.\n\nCc: Prasad J Pandit <ppandit@redhat.com>\nCc: qemu-stable@nongnu.org\nReviewed-by: Mark Cave-Ayland <mark.cave-ayland@ilande.co.uk>\nReviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com>\nReviewed-by: Alistair Francis <alistair.francis@wdc.com>\nSigned-off-by: Jason Wang <jasowang@redhat.com>",
  "pr_url": null,
  "pr_info": null,
  "file_name": "hw/net/sungem.c",
  "func_name": "",
  "raw_func_from_json": "static void sungem_send_packet(SunGEMState *s, const uint8_t *buf,\n                               int size)\n{\n    NetClientState *nc = qemu_get_queue(s->nic);\n\n    if (s->macregs[MAC_XIFCFG >> 2] & MAC_XIFCFG_LBCK) {\n        nc->info->receive(nc, buf, size);\n    } else {\n        qemu_send_packet(nc, buf, size);\n    }\n}",
  "diff_func": "@@ -306,7 +306,7 @@ static void sungem_send_packet(SunGEMState *s, const uint8_t *buf,\n     NetClientState *nc = qemu_get_queue(s->nic);\n \n     if (s->macregs[MAC_XIFCFG >> 2] & MAC_XIFCFG_LBCK) {\n-        nc->info->receive(nc, buf, size);\n+        qemu_receive_packet(nc, buf, size);\n     } else {\n         qemu_send_packet(nc, buf, size);\n     }",
  "func": "static void sungem_send_packet(SunGEMState *s, const uint8_t *buf,\n                               int size)\n{\n    NetClientState *nc = qemu_get_queue(s->nic);\n\n    if (s->macregs[MAC_XIFCFG >> 2] & MAC_XIFCFG_LBCK) {\n        nc->info->receive(nc, buf, size);\n    } else {\n        qemu_send_packet(nc, buf, size);\n    }\n}",
  "project": "qemu",
  "hash": 22164789416916763534513212272225664326,
  "size": 11,
  "commit_id": "8c92060d3c0248bd4d515719a35922cd2391b9b4",
  "message": "sungem: switch to use qemu_receive_packet() for loopback\n\nThis patch switches to use qemu_receive_packet() which can detect\nreentrancy and return early.\n\nThis is intended to address CVE-2021-3416.\n\nCc: Prasad J Pandit <ppandit@redhat.com>\nCc: qemu-stable@nongnu.org\nReviewed-by: Mark Cave-Ayland <mark.cave-ayland@ilande.co.uk>\nReviewed-by: Philippe Mathieu-Daudé <philmd@redhat.com>\nReviewed-by: Alistair Francis <alistair.francis@wdc.com>\nSigned-off-by: Jason Wang <jasowang@redhat.com>",
  "target": 1,
  "dataset": "other",
  "idx": 212927,
  "Bug Filter": "** Security Vulnerability Fix  \n**Confidence Score:** 1.0",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "\n\nThe patch modifies the packet handling in QEMU to address a known security vulnerability (CVE-2021-3416) by preventing reentrant function calls, thus mitigating a potential denial of service.\n\n**Final Classification:** Security Vulnerability Fix  \n**Confidence Score:** 1.0"
}