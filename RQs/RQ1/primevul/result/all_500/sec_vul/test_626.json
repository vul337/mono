{
  "id": 626,
  "language": "c",
  "cwe": "",
  "commit_url": "https://github.com/kageds/barebox/commit/0a9f9a7410681e55362f8311537ebc7be9ad0fbe",
  "commit_sha": "0a9f9a7410681e55362f8311537ebc7be9ad0fbe",
  "commit_msg": "crypto: digest: use crypto_memneq()\n\nWhen verifying a digest it is important not to leak timing information\nthrough memcmp(). Use crypto_memneq() instead.\n\nSigned-off-by: Sascha Hauer <s.hauer@pengutronix.de>",
  "pr_url": null,
  "pr_info": null,
  "file_name": "crypto/digest.c",
  "func_name": "",
  "raw_func_from_json": "int digest_generic_verify(struct digest *d, const unsigned char *md)\n{\n\tint ret;\n\tint len = digest_length(d);\n\tunsigned char *tmp;\n\n\ttmp = xmalloc(len);\n\n\tret = digest_final(d, tmp);\n\tif (ret)\n\t\tgoto end;\n\n\tret = memcmp(md, tmp, len);\n\tret = ret ? -EINVAL : 0;\nend:\n\tfree(tmp);\n\treturn ret;\n}",
  "diff_func": "@@ -22,6 +22,7 @@\n #include <errno.h>\n #include <module.h>\n #include <linux/err.h>\n+#include <crypto.h>\n #include <crypto/internal.h>\n \n static LIST_HEAD(digests);\n@@ -47,8 +48,10 @@ int digest_generic_verify(struct digest *d, const unsigned char *md)\n \tif (ret)\n \t\tgoto end;\n \n-\tret = memcmp(md, tmp, len);\n-\tret = ret ? -EINVAL : 0;\n+\tif (crypto_memneq(md, tmp, len))\n+\t\tret = -EINVAL;\n+\telse\n+\t\tret = 0;\n end:\n \tfree(tmp);\n \treturn ret;",
  "func": "int digest_generic_verify(struct digest *d, const unsigned char *md)\n{\n\tint ret;\n\tint len = digest_length(d);\n\tunsigned char *tmp;\n\n\ttmp = xmalloc(len);\n\n\tret = digest_final(d, tmp);\n\tif (ret)\n\t\tgoto end;\n\n\tret = memcmp(md, tmp, len);\n\tret = ret ? -EINVAL : 0;\nend:\n\tfree(tmp);\n\treturn ret;\n}",
  "project": "barebox",
  "hash": 78392329714916786850884103185275418998,
  "size": 18,
  "commit_id": "0a9f9a7410681e55362f8311537ebc7be9ad0fbe",
  "message": "crypto: digest: use crypto_memneq()\n\nWhen verifying a digest it is important not to leak timing information\nthrough memcmp(). Use crypto_memneq() instead.\n\nSigned-off-by: Sascha Hauer <s.hauer@pengutronix.de>",
  "target": 1,
  "dataset": "other",
  "idx": 196316,
  "Bug Filter": "** Security Vulnerability Fix  \n**Confidence Score:** 1.0",
  "Bug Filter Confidence": 1.0,
  "Bug Filter Response": "\n\nThe patch addresses a security issue by replacing memcmp with crypto_memneq to prevent timing attacks during digest verification. This change is critical for maintaining the confidentiality and integrity of cryptographic operations.\n\n**Final Classification:** Security Vulnerability Fix  \n**Confidence Score:** 1.0"
}