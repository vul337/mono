{
    "cve_id": "CVE-2020-1714",
    "cwe_ids": [
        "CWE-20"
    ],
    "cvss_vector": "AV:N/AC:L/Au:S/C:P/I:P/A:P",
    "cvss_is_v3": false,
    "repo_name": "keycloak",
    "commit_msg": "[Keycloak-10162] Usage of ObjectInputStream without checking the object types",
    "commit_hash": "d5483d884de797e2ef6e69f92085bc10bf87e864",
    "git_url": "https://github.com/keycloak/keycloak/commit/d5483d884de797e2ef6e69f92085bc10bf87e864",
    "file_path": "core/src/main/java/org/keycloak/KeycloakSecurityContext.java",
    "func_name": "readObject",
    "func_before": "private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException {\n        in.defaultReadObject();\n\n        token = parseToken(tokenString, AccessToken.class);\n        idToken = parseToken(idTokenString, IDToken.class);\n    }",
    "abstract_func_before": "private void readObject(ObjectInputStream VAR_0) throws IOException, ClassNotFoundException {\n        VAR_0.defaultReadObject();\n\n        VAR_1 = parseToken(VAR_2, AccessToken.class);\n        VAR_3 = parseToken(VAR_4, IDToken.class);\n    }",
    "func_graph_path_before": "keycloak/d5483d884de797e2ef6e69f92085bc10bf87e864/KeycloakSecurityContext.java/vul/before/0.json",
    "func": "private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException {\n        DelegatingSerializationFilter filter = new DelegatingSerializationFilter();\n        filter.setFilter(in, \"org.keycloak.KeycloakSecurityContext;!*\");\n        in.defaultReadObject();\n\n        token = parseToken(tokenString, AccessToken.class);\n        idToken = parseToken(idTokenString, IDToken.class);\n    }",
    "abstract_func": "private void readObject(ObjectInputStream VAR_0) throws IOException, ClassNotFoundException {\n        DelegatingSerializationFilter VAR_1 = new DelegatingSerializationFilter();\n        VAR_1.setFilter(VAR_0, \"org.keycloak.KeycloakSecurityContext;!*\");\n        VAR_0.defaultReadObject();\n\n        VAR_2 = parseToken(VAR_3, AccessToken.class);\n        VAR_4 = parseToken(VAR_5, IDToken.class);\n    }",
    "func_graph_path": "keycloak/d5483d884de797e2ef6e69f92085bc10bf87e864/KeycloakSecurityContext.java/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,6 @@\n private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException {\n+        DelegatingSerializationFilter filter = new DelegatingSerializationFilter();\n+        filter.setFilter(in, \"org.keycloak.KeycloakSecurityContext;!*\");\n         in.defaultReadObject();\n \n         token = parseToken(tokenString, AccessToken.class);",
    "diff_line_info": {
        "deleted_lines": [],
        "added_lines": [
            "        DelegatingSerializationFilter filter = new DelegatingSerializationFilter();",
            "        filter.setFilter(in, \"org.keycloak.KeycloakSecurityContext;!*\");"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}