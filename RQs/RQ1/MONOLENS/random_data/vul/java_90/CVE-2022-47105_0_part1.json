{
    "cve_id": "CVE-2022-47105",
    "cwe_ids": [
        "CWE-89"
    ],
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cvss_is_v3": true,
    "repo_name": "jeecgboot/jeecg-boot",
    "commit_msg": "\u4fee\u590d sql\u6ce8\u5165\u6f0f\u6d1e #4393",
    "commit_hash": "0fc374de4745eac52620eeb8caf6a7b76127529a",
    "git_url": "https://github.com/jeecgboot/jeecg-boot/commit/0fc374de4745eac52620eeb8caf6a7b76127529a",
    "file_path": "jeecg-boot-base-core/src/main/java/org/jeecg/common/util/SqlInjectionUtil.java",
    "func_name": "specialFilterContentForOnlineReport",
    "func_before": "public static void specialFilterContentForOnlineReport(String value) {\n\t\tString specialXssStr = \" exec |extractvalue|updatexml| insert | delete | update | drop | chr | mid | master | truncate | char | declare |user()\";\n\t\tString[] xssArr = specialXssStr.split(\"\\\\|\");\n\t\tif (value == null || \"\".equals(value)) {\n\t\t\treturn;\n\t\t}\n\t\t// \u6821\u9a8csql\u6ce8\u91ca \u4e0d\u5141\u8bb8\u6709sql\u6ce8\u91ca\n\t\tcheckSqlAnnotation(value);\n\t\t// \u7edf\u4e00\u8f6c\u4e3a\u5c0f\u5199\n\t\tvalue = value.toLowerCase();\n\t\t//SQL\u6ce8\u5165\u68c0\u6d4b\u5b58\u5728\u7ed5\u8fc7\u98ce\u9669 https://gitee.com/jeecg/jeecg-boot/issues/I4NZGE\n\t\t//value = value.replaceAll(\"/\\\\*.*\\\\*/\",\" \");\n\n\t\tfor (int i = 0; i < xssArr.length; i++) {\n\t\t\tif (value.indexOf(xssArr[i]) > -1 || value.startsWith(xssArr[i].trim())) {\n\t\t\t\tlog.error(\"\u8bf7\u6ce8\u610f\uff0c\u5b58\u5728SQL\u6ce8\u5165\u5173\u952e\u8bcd---> {}\", xssArr[i]);\n\t\t\t\tlog.error(\"\u8bf7\u6ce8\u610f\uff0c\u503c\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u98ce\u9669!---> {}\", value);\n\t\t\t\tthrow new RuntimeException(\"\u8bf7\u6ce8\u610f\uff0c\u503c\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u98ce\u9669!--->\" + value);\n\t\t\t}\n\t\t}\n\n\t\tif(Pattern.matches(SHOW_TABLES, value) || Pattern.matches(REGULAR_EXPRE_USER, value)){\n\t\t\tthrow new RuntimeException(\"\u8bf7\u6ce8\u610f\uff0c\u503c\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u98ce\u9669!--->\" + value);\n\t\t}\n\t\treturn;\n\t}",
    "abstract_func_before": "public static void specialFilterContentForOnlineReport(String VAR_0) {\n\t\tString VAR_1 = \" exec |extractvalue|updatexml| insert | delete | update | drop | chr | mid | master | truncate | char | declare |user()\";\n\t\tString[] VAR_2 = VAR_1.split(\"\\\\|\");\n\t\tif (VAR_0 == null || \"\".equals(VAR_0)) {\n\t\t\treturn;\n\t\t}\n\t\t/* COMMENT_0 */\n\t\tcheckSqlAnnotation(VAR_0);\n\t\t/* COMMENT_1 */\n\t\tVAR_0 = VAR_0.toLowerCase();\n\t\t/* COMMENT_2 */\n\t\t/* COMMENT_3 */\n\n\t\tfor (int VAR_3 = 0; VAR_3 < VAR_2.length; VAR_3++) {\n\t\t\tif (VAR_0.indexOf(VAR_2[VAR_3]) > -1 || VAR_0.startsWith(VAR_2[VAR_3].trim())) {\n\t\t\t\tVAR_4.error(\"\u8bf7\u6ce8\u610f\uff0c\u5b58\u5728SQL\u6ce8\u5165\u5173\u952e\u8bcd---> {}\", xssArr[i]);\n$$$$$$$$$$$$$$$$\t\t\t\tVAR_4.error(\"\u8bf7\u6ce8\u610f\uff0c\u503c\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u98ce\u9669!---> {}\", value);\n$$$$$$$$\t\t\t\tthrow new RuntimeException(\"\u8bf7\u6ce8\u610f\uff0c\u503c\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u98ce\u9669!--->\" + value);\n$$$$$$$$\t\t\t}\n\t\t}\n\n\t\tif(VAR_5.matches(VAR_6, VAR_0) || VAR_5.matches(VAR_7, VAR_0)){\n\t\t\tthrow new RuntimeException(\"\u8bf7\u6ce8\u610f\uff0c\u503c\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u98ce\u9669!--->\" + value);\n$$$$$$$$\t\t}\n\t\treturn;\n\t}",
    "func_graph_path_before": "jeecgboot/jeecg-boot/0fc374de4745eac52620eeb8caf6a7b76127529a/SqlInjectionUtil.java/vul/before/0.json",
    "func": "public static void specialFilterContentForOnlineReport(String value) {\n\t\tString specialXssStr = \" exec |extractvalue|updatexml|geohash|gtid_subset|gtid_subtract| insert | delete | update | drop | chr | mid | master | truncate | char | declare |user()\";\n\t\tString[] xssArr = specialXssStr.split(\"\\\\|\");\n\t\tif (value == null || \"\".equals(value)) {\n\t\t\treturn;\n\t\t}\n\t\t// \u6821\u9a8csql\u6ce8\u91ca \u4e0d\u5141\u8bb8\u6709sql\u6ce8\u91ca\n\t\tcheckSqlAnnotation(value);\n\t\t// \u7edf\u4e00\u8f6c\u4e3a\u5c0f\u5199\n\t\tvalue = value.toLowerCase();\n\t\t//SQL\u6ce8\u5165\u68c0\u6d4b\u5b58\u5728\u7ed5\u8fc7\u98ce\u9669 https://gitee.com/jeecg/jeecg-boot/issues/I4NZGE\n\t\t//value = value.replaceAll(\"/\\\\*.*\\\\*/\",\" \");\n\n\t\tfor (int i = 0; i < xssArr.length; i++) {\n\t\t\tif (value.indexOf(xssArr[i]) > -1 || value.startsWith(xssArr[i].trim())) {\n\t\t\t\tlog.error(\"\u8bf7\u6ce8\u610f\uff0c\u5b58\u5728SQL\u6ce8\u5165\u5173\u952e\u8bcd---> {}\", xssArr[i]);\n\t\t\t\tlog.error(\"\u8bf7\u6ce8\u610f\uff0c\u503c\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u98ce\u9669!---> {}\", value);\n\t\t\t\tthrow new RuntimeException(\"\u8bf7\u6ce8\u610f\uff0c\u503c\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u98ce\u9669!--->\" + value);\n\t\t\t}\n\t\t}\n\n\t\tif(Pattern.matches(SHOW_TABLES, value) || Pattern.matches(REGULAR_EXPRE_USER, value)){\n\t\t\tthrow new RuntimeException(\"\u8bf7\u6ce8\u610f\uff0c\u503c\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u98ce\u9669!--->\" + value);\n\t\t}\n\t\treturn;\n\t}",
    "abstract_func": "public static void specialFilterContentForOnlineReport(String VAR_0) {\n\t\tString VAR_1 = \" exec |extractvalue|updatexml|geohash|gtid_subset|gtid_subtract| insert | delete | update | drop | chr | mid | master | truncate | char | declare |user()\";\n\t\tString[] VAR_2 = VAR_1.split(\"\\\\|\");\n\t\tif (VAR_0 == null || \"\".equals(VAR_0)) {\n\t\t\treturn;\n\t\t}\n\t\t/* COMMENT_0 */\n\t\tcheckSqlAnnotation(VAR_0);\n\t\t/* COMMENT_1 */\n\t\tVAR_0 = VAR_0.toLowerCase();\n\t\t/* COMMENT_2 */\n\t\t/* COMMENT_3 */\n\n\t\tfor (int VAR_3 = 0; VAR_3 < VAR_2.length; VAR_3++) {\n\t\t\tif (VAR_0.indexOf(VAR_2[VAR_3]) > -1 || VAR_0.startsWith(VAR_2[VAR_3].trim())) {\n\t\t\t\tVAR_4.error(\"\u8bf7\u6ce8\u610f\uff0c\u5b58\u5728SQL\u6ce8\u5165\u5173\u952e\u8bcd---> {}\", xssArr[i]);\n$$$$$$$$$$$$$$$$\t\t\t\tVAR_4.error(\"\u8bf7\u6ce8\u610f\uff0c\u503c\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u98ce\u9669!---> {}\", value);\n$$$$$$$$\t\t\t\tthrow new RuntimeException(\"\u8bf7\u6ce8\u610f\uff0c\u503c\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u98ce\u9669!--->\" + value);\n$$$$$$$$\t\t\t}\n\t\t}\n\n\t\tif(VAR_5.matches(VAR_6, VAR_0) || VAR_5.matches(VAR_7, VAR_0)){\n\t\t\tthrow new RuntimeException(\"\u8bf7\u6ce8\u610f\uff0c\u503c\u53ef\u80fd\u5b58\u5728SQL\u6ce8\u5165\u98ce\u9669!--->\" + value);\n$$$$$$$$\t\t}\n\t\treturn;\n\t}",
    "func_graph_path": "jeecgboot/jeecg-boot/0fc374de4745eac52620eeb8caf6a7b76127529a/SqlInjectionUtil.java/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,5 @@\n public static void specialFilterContentForOnlineReport(String value) {\n-\t\tString specialXssStr = \" exec |extractvalue|updatexml| insert | delete | update | drop | chr | mid | master | truncate | char | declare |user()\";\n+\t\tString specialXssStr = \" exec |extractvalue|updatexml|geohash|gtid_subset|gtid_subtract| insert | delete | update | drop | chr | mid | master | truncate | char | declare |user()\";\n \t\tString[] xssArr = specialXssStr.split(\"\\\\|\");\n \t\tif (value == null || \"\".equals(value)) {\n \t\t\treturn;",
    "diff_line_info": {
        "deleted_lines": [
            "\t\tString specialXssStr = \" exec |extractvalue|updatexml| insert | delete | update | drop | chr | mid | master | truncate | char | declare |user()\";"
        ],
        "added_lines": [
            "\t\tString specialXssStr = \" exec |extractvalue|updatexml|geohash|gtid_subset|gtid_subtract| insert | delete | update | drop | chr | mid | master | truncate | char | declare |user()\";"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}