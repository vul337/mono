{
    "cve_id": "CVE-2020-11002",
    "cwe_ids": [
        "CWE-74"
    ],
    "cvss_vector": "AV:N/AC:L/Au:S/C:C/I:C/A:C",
    "cvss_is_v3": false,
    "repo_name": "dropwizard",
    "commit_msg": "Disable message interpolation in ConstraintViolations by default (#3208)\n\nDisable message interpolation in ConstraintViolations by default but allow enabling it explicitly with `SelfValidating#escapeExpressions()`.\r\n\r\nAdditionally, `ConstraintViolations` now provides a set of methods which take a map of message parameters for interpolation.\r\nThe message parameters will be escaped by default.\r\n\r\nRefs #3153\r\nRefs #3157",
    "commit_hash": "d5a512f7abf965275f2a6b913ac4fe778e424242",
    "git_url": "https://github.com/dropwizard/dropwizard/commit/d5a512f7abf965275f2a6b913ac4fe778e424242",
    "file_path": "dropwizard-validation/src/main/java/io/dropwizard/validation/selfvalidating/SelfValidatingValidator.java",
    "func_name": "initialize",
    "func_before": "@Override\n    public void initialize(SelfValidating constraintAnnotation) {\n    }",
    "abstract_func_before": "@Override\n    public void initialize(SelfValidating VAR_0) {\n    }",
    "func_graph_path_before": "dropwizard/d5a512f7abf965275f2a6b913ac4fe778e424242/SelfValidatingValidator.java/vul/before/1.json",
    "func": "@Override\n    public void initialize(SelfValidating constraintAnnotation) {\n        escapeExpressions = constraintAnnotation.escapeExpressions();\n    }",
    "abstract_func": "@Override\n    public void initialize(SelfValidating VAR_0) {\n        VAR_1 = VAR_0.escapeExpressions();\n    }",
    "func_graph_path": "dropwizard/d5a512f7abf965275f2a6b913ac4fe778e424242/SelfValidatingValidator.java/vul/after/1.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,3 +1,4 @@\n @Override\n     public void initialize(SelfValidating constraintAnnotation) {\n+        escapeExpressions = constraintAnnotation.escapeExpressions();\n     }",
    "diff_line_info": {
        "deleted_lines": [],
        "added_lines": [
            "        escapeExpressions = constraintAnnotation.escapeExpressions();"
        ]
    },
    "is_vul": true,
    "pr_url": "https://github.com/dropwizard/dropwizard/pull/3208",
    "description": "Disable message interpolation in `ConstraintViolations` by default but allow enabling it explicitly with `SelfValidating#escapeExpressions()`.\r\n\r\nAdditionally, `ConstraintViolations` now provides a set of methods which take a map of message parameters for interpolation. These message parameters are be escaped by default.\r\n\r\nThanks to @pwntester and @gsmet for their invaluable input!\r\n\r\nRefs #3153\r\nRefs #3157"
}