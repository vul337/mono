{
    "cve_id": "CVE-2023-47324",
    "cwe_ids": [
        "CWE-79"
    ],
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cvss_is_v3": true,
    "repo_name": "Silverpeas/Silverpeas-Core",
    "commit_msg": "Bug #13811: fixing stored XSS leading to full account takeover\n\n* making HTML sanitize processing accessible for JSTL instructions\n* sanitizing user notification title and contents on registering\n* sanitizing user notification title and contents on rendering\n* sanitizing browse bar parts\n* modifying the user and group saving action names in order to get the user token verifications\n* applying the token validation from component request router abstraction",
    "commit_hash": "9a55728729a3b431847045c674b3e883507d1e1a",
    "git_url": "https://github.com/Silverpeas/Silverpeas-Core/commit/9a55728729a3b431847045c674b3e883507d1e1a",
    "file_path": "core-rs/src/main/java/org/silverpeas/core/web/token/SynchronizerTokenService.java",
    "func_name": "throwTokenInvalidException",
    "func_before": "private void throwTokenInvalidException() throws TokenValidationException {\n    String now = TemporalFormatter.toBaseIso8601(OffsetDateTime.now(), true);\n    throw new TokenValidationException(\"Attempt of a CSRF attack detected at \" + now);\n  }",
    "abstract_func_before": "private void throwTokenInvalidException() throws TokenValidationException {\n    String VAR_0 = VAR_1.toBaseIso8601(VAR_2.now(), true);\n    throw new TokenValidationException(\"Attempt of a CSRF attack detected at \" + VAR_0);\n  }",
    "func_graph_path_before": "Silverpeas/Silverpeas-Core/9a55728729a3b431847045c674b3e883507d1e1a/SynchronizerTokenService.java/vul/before/0.json",
    "func": "private void throwTokenInvalidException(final HttpServletRequest request)\n      throws TokenValidationException {\n    String now = TemporalFormatter.toBaseIso8601(OffsetDateTime.now(), true);\n    final TokenValidationException exception = new TokenValidationException(\n        \"Attempt of a CSRF attack detected at \" + now);\n    logger.error(\"The request for path {0} isn''t valid: {1}\", request.getRequestURI(),\n        exception.getMessage());\n    throw exception;\n  }",
    "abstract_func": "private void throwTokenInvalidException(final HttpServletRequest VAR_0)\n      throws TokenValidationException {\n    String VAR_1 = VAR_2.toBaseIso8601(VAR_3.now(), true);\n    final TokenValidationException VAR_4 = new TokenValidationException(\n        \"Attempt of a CSRF attack detected at \" + VAR_1);\n    VAR_5.error(\"The request for path {0} isn''t valid: {1}\", VAR_0.getRequestURI(),\n        VAR_4.getMessage());\n    throw VAR_4;\n  }",
    "func_graph_path": "Silverpeas/Silverpeas-Core/9a55728729a3b431847045c674b3e883507d1e1a/SynchronizerTokenService.java/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,9 @@\n-private void throwTokenInvalidException() throws TokenValidationException {\n+private void throwTokenInvalidException(final HttpServletRequest request)\n+      throws TokenValidationException {\n     String now = TemporalFormatter.toBaseIso8601(OffsetDateTime.now(), true);\n-    throw new TokenValidationException(\"Attempt of a CSRF attack detected at \" + now);\n+    final TokenValidationException exception = new TokenValidationException(\n+        \"Attempt of a CSRF attack detected at \" + now);\n+    logger.error(\"The request for path {0} isn''t valid: {1}\", request.getRequestURI(),\n+        exception.getMessage());\n+    throw exception;\n   }",
    "diff_line_info": {
        "deleted_lines": [
            "private void throwTokenInvalidException() throws TokenValidationException {",
            "    throw new TokenValidationException(\"Attempt of a CSRF attack detected at \" + now);"
        ],
        "added_lines": [
            "private void throwTokenInvalidException(final HttpServletRequest request)",
            "      throws TokenValidationException {",
            "    final TokenValidationException exception = new TokenValidationException(",
            "        \"Attempt of a CSRF attack detected at \" + now);",
            "    logger.error(\"The request for path {0} isn''t valid: {1}\", request.getRequestURI(),",
            "        exception.getMessage());",
            "    throw exception;"
        ]
    },
    "is_vul": true,
    "pr_url": "https://github.com/Silverpeas/Silverpeas-Core/pull/1298",
    "description": "no more info"
}