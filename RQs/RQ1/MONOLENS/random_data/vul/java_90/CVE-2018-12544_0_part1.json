{
    "cve_id": "CVE-2018-12544",
    "cwe_ids": [
        "CWE-611"
    ],
    "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
    "cvss_is_v3": false,
    "repo_name": "vert-x3/vertx-web",
    "commit_msg": "Added a test to verify XXE",
    "commit_hash": "26db16c7b32e655b489d1a71605f9a785f788e41",
    "git_url": "https://github.com/vert-x3/vertx-web/commit/26db16c7b32e655b489d1a71605f9a785f788e41",
    "file_path": "vertx-web-api-contract/src/main/java/io/vertx/ext/web/api/validation/impl/XMLTypeValidator.java",
    "func_name": "createXMLTypeValidator",
    "func_before": "public static XMLTypeValidator createXMLTypeValidator(String xmlSchema) {\n      try {\n        // create a SchemaFactory capable of understanding WXS schemas\n        SchemaFactory factory = createSchemaFactoryInstance();\n        // load a WXS schema, represented by a Schema instance\n        Source xmlSchemaSource = new StreamSource(new StringReader(xmlSchema));\n        return new XMLTypeValidator(factory.newSchema(xmlSchemaSource).newValidator());\n      } catch (SAXException e) {\n        e.printStackTrace();\n        return null;\n      }\n    }",
    "abstract_func_before": "public static XMLTypeValidator createXMLTypeValidator(String VAR_0) {\n      try {\n        /* COMMENT_0 */\n        SchemaFactory VAR_1 = createSchemaFactoryInstance();\n        /* COMMENT_1 */\n        Source VAR_2 = new StreamSource(new StringReader(VAR_0));\n        return new XMLTypeValidator(VAR_1.newSchema(VAR_2).newValidator());\n      } catch (SAXException VAR_3) {\n        VAR_3.printStackTrace();\n        return null;\n      }\n    }",
    "func_graph_path_before": "vert-x3/vertx-web/26db16c7b32e655b489d1a71605f9a785f788e41/XMLTypeValidator.java/vul/before/1.json",
    "func": "public static XMLTypeValidator createXMLTypeValidator(String xmlSchema) {\n      try {\n        // create a SchemaFactory capable of understanding WXS schemas\n        SchemaFactory factory = createSchemaFactoryInstance();\n        // load a WXS schema, represented by a Schema instance\n        Source xmlSchemaSource = new StreamSource(new StringReader(xmlSchema));\n        return new XMLTypeValidator(factory.newSchema(xmlSchemaSource).newValidator());\n      } catch (SAXException e) {\n        throw new RuntimeException(e);\n      }\n    }",
    "abstract_func": "public static XMLTypeValidator createXMLTypeValidator(String VAR_0) {\n      try {\n        /* COMMENT_0 */\n        SchemaFactory VAR_1 = createSchemaFactoryInstance();\n        /* COMMENT_1 */\n        Source VAR_2 = new StreamSource(new StringReader(VAR_0));\n        return new XMLTypeValidator(VAR_1.newSchema(VAR_2).newValidator());\n      } catch (SAXException VAR_3) {\n        throw new RuntimeException(VAR_3);\n      }\n    }",
    "func_graph_path": "vert-x3/vertx-web/26db16c7b32e655b489d1a71605f9a785f788e41/XMLTypeValidator.java/vul/after/1.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -6,7 +6,6 @@\n         Source xmlSchemaSource = new StreamSource(new StringReader(xmlSchema));\n         return new XMLTypeValidator(factory.newSchema(xmlSchemaSource).newValidator());\n       } catch (SAXException e) {\n-        e.printStackTrace();\n-        return null;\n+        throw new RuntimeException(e);\n       }\n     }",
    "diff_line_info": {
        "deleted_lines": [
            "        e.printStackTrace();",
            "        return null;"
        ],
        "added_lines": [
            "        throw new RuntimeException(e);"
        ]
    },
    "is_vul": true,
    "pr_url": "https://github.com/vert-x3/vertx-web/pull/1022",
    "description": "Fixes #1021 "
}