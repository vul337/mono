{
    "cve_id": "CVE-2016-1000339",
    "cwe_ids": [
        "CWE-310"
    ],
    "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
    "cvss_is_v3": false,
    "repo_name": "bcgit/bc-java",
    "commit_msg": "Added table use obfuscation to AESFastEngine\nJDK 1.4 compiler updates.",
    "commit_hash": "8a73f08931450c17c749af067b6a8185abdfd2c0",
    "git_url": "https://github.com/bcgit/bc-java/commit/8a73f08931450c17c749af067b6a8185abdfd2c0",
    "file_path": "prov/src/main/java/org/bouncycastle/jcajce/provider/drbg/DRBG.java",
    "func_name": "generateNonceIVPersonalizationString",
    "func_before": "private static byte[] generateNonceIVPersonalizationString()\n    {\n        return Arrays.concatenate(Strings.toByteArray(\"Default\"), Strings.toUTF8ByteArray(getVIMID()),\n            Pack.longToLittleEndian(Thread.currentThread().getId()), Pack.longToLittleEndian(System.currentTimeMillis()));\n    }",
    "abstract_func_before": "private static byte[] generateNonceIVPersonalizationString()\n    {\n        return VAR_0.concatenate(VAR_1.toByteArray(\"Default\"), VAR_1.toUTF8ByteArray(getVIMID()),\n            VAR_2.longToLittleEndian(VAR_3.currentThread().getId()), VAR_2.longToLittleEndian(VAR_4.currentTimeMillis()));\n    }",
    "func_graph_path_before": "bcgit/bc-java/8a73f08931450c17c749af067b6a8185abdfd2c0/DRBG.java/vul/before/3.json",
    "func": "private static byte[] generateNonceIVPersonalizationString(SecureRandom random)\n    {\n        return Arrays.concatenate(Strings.toByteArray(\"Nonce\"), random.generateSeed(16),\n            Pack.longToLittleEndian(Thread.currentThread().getId()), Pack.longToLittleEndian(System.currentTimeMillis()));\n    }",
    "abstract_func": "private static byte[] generateNonceIVPersonalizationString(SecureRandom VAR_0)\n    {\n        return VAR_1.concatenate(VAR_2.toByteArray(\"Nonce\"), VAR_0.generateSeed(16),\n            VAR_3.longToLittleEndian(VAR_4.currentThread().getId()), VAR_3.longToLittleEndian(VAR_5.currentTimeMillis()));\n    }",
    "func_graph_path": "bcgit/bc-java/8a73f08931450c17c749af067b6a8185abdfd2c0/DRBG.java/vul/after/3.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,5 @@\n-private static byte[] generateNonceIVPersonalizationString()\n+private static byte[] generateNonceIVPersonalizationString(SecureRandom random)\n     {\n-        return Arrays.concatenate(Strings.toByteArray(\"Default\"), Strings.toUTF8ByteArray(getVIMID()),\n+        return Arrays.concatenate(Strings.toByteArray(\"Nonce\"), random.generateSeed(16),\n             Pack.longToLittleEndian(Thread.currentThread().getId()), Pack.longToLittleEndian(System.currentTimeMillis()));\n     }",
    "diff_line_info": {
        "deleted_lines": [
            "private static byte[] generateNonceIVPersonalizationString()",
            "        return Arrays.concatenate(Strings.toByteArray(\"Default\"), Strings.toUTF8ByteArray(getVIMID()),"
        ],
        "added_lines": [
            "private static byte[] generateNonceIVPersonalizationString(SecureRandom random)",
            "        return Arrays.concatenate(Strings.toByteArray(\"Nonce\"), random.generateSeed(16),"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}