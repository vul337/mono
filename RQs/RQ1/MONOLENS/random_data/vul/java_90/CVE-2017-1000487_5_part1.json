{
    "cve_id": "CVE-2017-1000487",
    "cwe_ids": [
        "CWE-78"
    ],
    "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
    "cvss_is_v3": false,
    "repo_name": "codehaus-plexus/plexus-utils",
    "commit_msg": "[PLXUTILS-161] Commandline shell injection problems\n\nPatch by Charles Duffy, applied unmodified",
    "commit_hash": "b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "git_url": "https://github.com/codehaus-plexus/plexus-utils/commit/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41",
    "file_path": "src/main/java/org/codehaus/plexus/util/cli/shell/BourneShell.java",
    "func_name": "getExecutionPreamble",
    "func_before": "protected String getExecutionPreamble()\n    {\n        if ( getWorkingDirectoryAsString() == null )\n        {\n            return null;\n        }\n\n        String dir = getWorkingDirectoryAsString();\n        StringBuilder sb = new StringBuilder();\n        sb.append( \"cd \" );\n\n        sb.append( unifyQuotes( dir ) );\n        sb.append( \" && \" );\n\n        return sb.toString();\n    }",
    "abstract_func_before": "protected String getExecutionPreamble()\n    {\n        if ( getWorkingDirectoryAsString() == null )\n        {\n            return null;\n        }\n\n        String VAR_0 = getWorkingDirectoryAsString();\n        StringBuilder VAR_1 = new StringBuilder();\n        VAR_1.append( \"cd \" );\n\n        VAR_1.append( unifyQuotes( VAR_0 ) );\n        VAR_1.append( \" && \" );\n\n        return VAR_1.toString();\n    }",
    "func_graph_path_before": "codehaus-plexus/plexus-utils/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41/BourneShell.java/vul/before/0.json",
    "func": "protected String getExecutionPreamble()\n    {\n        if ( getWorkingDirectoryAsString() == null )\n        {\n            return null;\n        }\n\n        String dir = getWorkingDirectoryAsString();\n        StringBuilder sb = new StringBuilder();\n        sb.append( \"cd \" );\n\n        sb.append( quoteOneItem( dir, false ) );\n        sb.append( \" && \" );\n\n        return sb.toString();\n    }",
    "abstract_func": "protected String getExecutionPreamble()\n    {\n        if ( getWorkingDirectoryAsString() == null )\n        {\n            return null;\n        }\n\n        String VAR_0 = getWorkingDirectoryAsString();\n        StringBuilder VAR_1 = new StringBuilder();\n        VAR_1.append( \"cd \" );\n\n        VAR_1.append( quoteOneItem( VAR_0, false ) );\n        VAR_1.append( \" && \" );\n\n        return VAR_1.toString();\n    }",
    "func_graph_path": "codehaus-plexus/plexus-utils/b38a1b3a4352303e4312b2bb601a0d7ec6e28f41/BourneShell.java/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -9,7 +9,7 @@\n         StringBuilder sb = new StringBuilder();\n         sb.append( \"cd \" );\n \n-        sb.append( unifyQuotes( dir ) );\n+        sb.append( quoteOneItem( dir, false ) );\n         sb.append( \" && \" );\n \n         return sb.toString();",
    "diff_line_info": {
        "deleted_lines": [
            "        sb.append( unifyQuotes( dir ) );"
        ],
        "added_lines": [
            "        sb.append( quoteOneItem( dir, false ) );"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}