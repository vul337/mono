{
    "cve_id": "CVE-2022-39208",
    "cwe_ids": [
        "CWE-552"
    ],
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cvss_is_v3": true,
    "repo_name": "theonedev/onedev",
    "commit_msg": "Fix security vulnerability issue regarding site/* access",
    "commit_hash": "8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822",
    "git_url": "https://github.com/theonedev/onedev/commit/8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822",
    "file_path": "server-core/src/main/java/io/onedev/server/web/avatar/DefaultAvatarManager.java",
    "func_name": "getUploaded",
    "func_before": "@Override\n\tpublic File getUploaded(User user) {\n\t\treturn new File(Bootstrap.getSiteDir(), \"avatars/uploaded/users/\" + user.getId() + \".jpg\");\n\t}",
    "abstract_func_before": "@Override\n\tpublic File getUploaded(User VAR_0) {\n\t\treturn new File(VAR_1.getSiteDir(), \"avatars/uploaded/users/\" + VAR_0.getId() + \".jpg\");\n\t}",
    "func_graph_path_before": "theonedev/onedev/8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822/DefaultAvatarManager.java/vul/before/0.json",
    "func": "@Override\n\tpublic File getUploaded(User user) {\n\t\treturn new File(Bootstrap.getSiteDir(), \"assets/avatars/uploaded/users/\" + user.getId() + \".jpg\");\n\t}",
    "abstract_func": "@Override\n\tpublic File getUploaded(User VAR_0) {\n\t\treturn new File(VAR_1.getSiteDir(), \"assets/avatars/uploaded/users/\" + VAR_0.getId() + \".jpg\");\n\t}",
    "func_graph_path": "theonedev/onedev/8aa94e0daf8447cdf76d4f27bfda0a85a7ea5822/DefaultAvatarManager.java/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,4 @@\n @Override\n \tpublic File getUploaded(User user) {\n-\t\treturn new File(Bootstrap.getSiteDir(), \"avatars/uploaded/users/\" + user.getId() + \".jpg\");\n+\t\treturn new File(Bootstrap.getSiteDir(), \"assets/avatars/uploaded/users/\" + user.getId() + \".jpg\");\n \t}",
    "diff_line_info": {
        "deleted_lines": [
            "\t\treturn new File(Bootstrap.getSiteDir(), \"avatars/uploaded/users/\" + user.getId() + \".jpg\");"
        ],
        "added_lines": [
            "\t\treturn new File(Bootstrap.getSiteDir(), \"assets/avatars/uploaded/users/\" + user.getId() + \".jpg\");"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}