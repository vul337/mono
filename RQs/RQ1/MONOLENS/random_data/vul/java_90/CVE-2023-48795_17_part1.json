{
    "cve_id": "CVE-2023-48795",
    "cwe_ids": [
        "CWE-354"
    ],
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N",
    "cvss_is_v3": true,
    "repo_name": "connectbot/sshlib",
    "commit_msg": "Implement kex-strict from OpenSSH\n\nImplement's OpenSSH's mitigation for the Terrapin attack.",
    "commit_hash": "5c8b534f6e97db7ac0e0e579331213aa25c173ab",
    "git_url": "https://github.com/connectbot/sshlib/commit/5c8b534f6e97db7ac0e0e579331213aa25c173ab",
    "file_path": "src/main/java/com/trilead/ssh2/transport/TransportManager.java",
    "func_name": "changeSendCipher",
    "func_before": "public void changeSendCipher(BlockCipher bc, MAC mac)\n\t{\n\t\ttc.changeSendCipher(bc, mac);\n\t}",
    "abstract_func_before": "public void changeSendCipher(BlockCipher VAR_0, MAC VAR_1)\n\t{\n\t\tVAR_2.changeSendCipher(VAR_0, VAR_1);\n\t}",
    "func_graph_path_before": "connectbot/sshlib/5c8b534f6e97db7ac0e0e579331213aa25c173ab/TransportManager.java/vul/before/2.json",
    "func": "public void changeSendCipher(BlockCipher bc, MAC mac)\n\t{\n\t\ttc.changeSendCipher(bc, mac);\n\t\tif (km.isStrictKex())\n\t\t\ttc.resetSendSequenceNumber();\n\t}",
    "abstract_func": "public void changeSendCipher(BlockCipher VAR_0, MAC VAR_1)\n\t{\n\t\tVAR_2.changeSendCipher(VAR_0, VAR_1);\n\t\tif (VAR_3.isStrictKex())\n\t\t\tVAR_2.resetSendSequenceNumber();\n\t}",
    "func_graph_path": "connectbot/sshlib/5c8b534f6e97db7ac0e0e579331213aa25c173ab/TransportManager.java/vul/after/2.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,6 @@\n public void changeSendCipher(BlockCipher bc, MAC mac)\n \t{\n \t\ttc.changeSendCipher(bc, mac);\n+\t\tif (km.isStrictKex())\n+\t\t\ttc.resetSendSequenceNumber();\n \t}",
    "diff_line_info": {
        "deleted_lines": [],
        "added_lines": [
            "\t\tif (km.isStrictKex())",
            "\t\t\ttc.resetSendSequenceNumber();"
        ]
    },
    "is_vul": true,
    "pr_url": "https://github.com/connectbot/sshlib/pull/295",
    "description": "no more info"
}