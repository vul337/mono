{
    "cve_id": "CVE-2022-24832",
    "cwe_ids": [
        "CWE-74"
    ],
    "cvss_vector": "AV:N/AC:M/Au:S/C:P/I:P/A:N",
    "cvss_is_v3": false,
    "repo_name": "gocd/gocd-ldap-authentication-plugin",
    "commit_msg": "Escape/encode values when building search filters.",
    "commit_hash": "87fa7dac5d899b3960ab48e151881da4793cfcc3",
    "git_url": "https://github.com/gocd/gocd-ldap-authentication-plugin/commit/87fa7dac5d899b3960ab48e151881da4793cfcc3",
    "file_path": "src/main/java/cd/go/apacheds/ApacheDsLdapClient.java",
    "func_name": "validate",
    "func_before": "@Override\n    public void validate() {\n        final String filter = format(ldapConfiguration.getUserSearchFilter(), \"test\");\n        ldapConnectionTemplate.searchFirst(ldapConfiguration.getSearchBases().get(0), filter, SearchScope.SUBTREE, entry -> entry);\n    }",
    "abstract_func_before": "@Override\n    public void validate() {\n        final String VAR_0 = format(VAR_1.getUserSearchFilter(), \"test\");\n        VAR_2.searchFirst(VAR_1.getSearchBases().get(0), VAR_0, VAR_3.SUBTREE, VAR_4 -> VAR_4);\n    }",
    "func_graph_path_before": "gocd/gocd-ldap-authentication-plugin/87fa7dac5d899b3960ab48e151881da4793cfcc3/ApacheDsLdapClient.java/vul/before/0.json",
    "func": "@Override\n    public void validate() {\n        final String filter = FilterEncoder.format(ldapConfiguration.getUserSearchFilter(), \"test\");\n        ldapConnectionTemplate.searchFirst(ldapConfiguration.getSearchBases().get(0), filter, SearchScope.SUBTREE, entry -> entry);\n    }",
    "abstract_func": "@Override\n    public void validate() {\n        final String VAR_0 = VAR_1.format(VAR_2.getUserSearchFilter(), \"test\");\n        VAR_3.searchFirst(VAR_2.getSearchBases().get(0), VAR_0, VAR_4.SUBTREE, VAR_5 -> VAR_5);\n    }",
    "func_graph_path": "gocd/gocd-ldap-authentication-plugin/87fa7dac5d899b3960ab48e151881da4793cfcc3/ApacheDsLdapClient.java/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,5 @@\n @Override\n     public void validate() {\n-        final String filter = format(ldapConfiguration.getUserSearchFilter(), \"test\");\n+        final String filter = FilterEncoder.format(ldapConfiguration.getUserSearchFilter(), \"test\");\n         ldapConnectionTemplate.searchFirst(ldapConfiguration.getSearchBases().get(0), filter, SearchScope.SUBTREE, entry -> entry);\n     }",
    "diff_line_info": {
        "deleted_lines": [
            "        final String filter = format(ldapConfiguration.getUserSearchFilter(), \"test\");"
        ],
        "added_lines": [
            "        final String filter = FilterEncoder.format(ldapConfiguration.getUserSearchFilter(), \"test\");"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}