{
    "cve_id": "CVE-2023-31544",
    "cwe_ids": [
        "CWE-79"
    ],
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cvss_is_v3": true,
    "repo_name": "alkacon/opencms-core",
    "commit_msg": "Fixed XSS issue in gallery result view (github issue #652).",
    "commit_hash": "21bfbeaf6b038e2c03bb421ce7f0933dd7a7633e",
    "git_url": "https://github.com/alkacon/opencms-core/commit/21bfbeaf6b038e2c03bb421ce7f0933dd7a7633e",
    "file_path": "src-gwt/org/opencms/ade/galleries/client/ui/CmsResultItemWidget.java",
    "func_name": "generateTooltipHtml",
    "func_before": "private String generateTooltipHtml(CmsListInfoBean infoBean) {\n\n        StringBuffer result = new StringBuffer();\n        result.append(\"<p><b>\").append(CmsClientStringUtil.shortenString(infoBean.getTitle(), 70)).append(\"</b></p>\");\n        if (infoBean.hasAdditionalInfo()) {\n            for (CmsAdditionalInfoBean additionalInfo : infoBean.getAdditionalInfo()) {\n                result.append(\"<p>\").append(additionalInfo.getName()).append(\":&nbsp;\");\n                // shorten the value to max 45 characters\n                result.append(CmsClientStringUtil.shortenString(additionalInfo.getValue(), 45)).append(\"</p>\");\n            }\n        }\n        return result.toString();\n    }",
    "abstract_func_before": "private String generateTooltipHtml(CmsListInfoBean VAR_0) {\n\n        StringBuffer VAR_1 = new StringBuffer();\n        VAR_1.append(\"<p><b>\").append(VAR_2.shortenString(VAR_0.getTitle(), 70)).append(\"</b></p>\");\n        if (VAR_0.hasAdditionalInfo()) {\n            for (CmsAdditionalInfoBean VAR_3 : VAR_0.getAdditionalInfo()) {\n                VAR_1.append(\"<p>\").append(VAR_3.getName()).append(\":&nbsp;\");\n                /* COMMENT_0 */\n                VAR_1.append(VAR_2.shortenString(VAR_3.getValue(), 45)).append(\"</p>\");\n            }\n        }\n        return VAR_1.toString();\n    }",
    "func_graph_path_before": "alkacon/opencms-core/21bfbeaf6b038e2c03bb421ce7f0933dd7a7633e/CmsResultItemWidget.java/vul/before/0.json",
    "func": "private String generateTooltipHtml(CmsListInfoBean infoBean) {\n\n        Element root = DOM.createElement(\"div\");\n        appendDom(appendDom(root, \"p\"), \"b\").setInnerText(CmsClientStringUtil.shortenString(infoBean.getTitle(), 70));\n        if (infoBean.hasAdditionalInfo()) {\n            for (CmsAdditionalInfoBean additionalInfo : infoBean.getAdditionalInfo()) {\n                appendDom(root, \"p\").setInnerText(\n                    additionalInfo.getName()\n                        + \":\\u00a0\"\n                        + CmsClientStringUtil.shortenString(additionalInfo.getValue(), 45));\n            }\n        }\n        return root.getInnerHTML();\n    }",
    "abstract_func": "private String generateTooltipHtml(CmsListInfoBean VAR_0) {\n\n        Element VAR_1 = VAR_2.createElement(\"div\");\n        appendDom(appendDom(VAR_1, \"p\"), \"b\").setInnerText(VAR_3.shortenString(VAR_0.getTitle(), 70));\n        if (VAR_0.hasAdditionalInfo()) {\n            for (CmsAdditionalInfoBean VAR_4 : VAR_0.getAdditionalInfo()) {\n                appendDom(VAR_1, \"p\").setInnerText(\n                    VAR_4.getName()\n                        + \":\\u00a0\"\n                        + VAR_3.shortenString(VAR_4.getValue(), 45));\n            }\n        }\n        return VAR_1.getInnerHTML();\n    }",
    "func_graph_path": "alkacon/opencms-core/21bfbeaf6b038e2c03bb421ce7f0933dd7a7633e/CmsResultItemWidget.java/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,13 +1,14 @@\n private String generateTooltipHtml(CmsListInfoBean infoBean) {\n \n-        StringBuffer result = new StringBuffer();\n-        result.append(\"<p><b>\").append(CmsClientStringUtil.shortenString(infoBean.getTitle(), 70)).append(\"</b></p>\");\n+        Element root = DOM.createElement(\"div\");\n+        appendDom(appendDom(root, \"p\"), \"b\").setInnerText(CmsClientStringUtil.shortenString(infoBean.getTitle(), 70));\n         if (infoBean.hasAdditionalInfo()) {\n             for (CmsAdditionalInfoBean additionalInfo : infoBean.getAdditionalInfo()) {\n-                result.append(\"<p>\").append(additionalInfo.getName()).append(\":&nbsp;\");\n-                // shorten the value to max 45 characters\n-                result.append(CmsClientStringUtil.shortenString(additionalInfo.getValue(), 45)).append(\"</p>\");\n+                appendDom(root, \"p\").setInnerText(\n+                    additionalInfo.getName()\n+                        + \":\\u00a0\"\n+                        + CmsClientStringUtil.shortenString(additionalInfo.getValue(), 45));\n             }\n         }\n-        return result.toString();\n+        return root.getInnerHTML();\n     }",
    "diff_line_info": {
        "deleted_lines": [
            "        StringBuffer result = new StringBuffer();",
            "        result.append(\"<p><b>\").append(CmsClientStringUtil.shortenString(infoBean.getTitle(), 70)).append(\"</b></p>\");",
            "                result.append(\"<p>\").append(additionalInfo.getName()).append(\":&nbsp;\");",
            "                // shorten the value to max 45 characters",
            "                result.append(CmsClientStringUtil.shortenString(additionalInfo.getValue(), 45)).append(\"</p>\");",
            "        return result.toString();"
        ],
        "added_lines": [
            "        Element root = DOM.createElement(\"div\");",
            "        appendDom(appendDom(root, \"p\"), \"b\").setInnerText(CmsClientStringUtil.shortenString(infoBean.getTitle(), 70));",
            "                appendDom(root, \"p\").setInnerText(",
            "                    additionalInfo.getName()",
            "                        + \":\\u00a0\"",
            "                        + CmsClientStringUtil.shortenString(additionalInfo.getValue(), 45));",
            "        return root.getInnerHTML();"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}