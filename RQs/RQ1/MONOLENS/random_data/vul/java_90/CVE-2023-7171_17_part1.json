{
    "cve_id": "CVE-2023-7171",
    "cwe_ids": [
        "CWE-79"
    ],
    "cvss_vector": "AV:N/AC:L/Au:M/C:N/I:P/A:N",
    "cvss_is_v3": false,
    "repo_name": "201206030/novel-plus",
    "commit_msg": "fix(novel-admin): \u53cb\u60c5\u94fe\u63a5URL\u683c\u5f0f\u6821\u9a8c",
    "commit_hash": "d6093d8182362422370d7eaf6c53afde9ee45215",
    "git_url": "https://github.com/201206030/novel-plus/commit/d6093d8182362422370d7eaf6c53afde9ee45215",
    "file_path": "novel-admin/src/main/java/com/java2nb/novel/controller/FriendLinkController.java",
    "func_name": "update",
    "func_before": "@ApiOperation(value = \"\u4fee\u6539\", notes = \"\u4fee\u6539\")\n    @ResponseBody\n    @RequestMapping(\"/update\")\n    @RequiresPermissions(\"novel:friendLink:edit\")\n    public R update(FriendLinkDO friendLink) {\n        friendLinkService.update(friendLink);\n        redisTemplate.delete(CacheKey.INDEX_LINK_KEY);\n        return R.ok();\n    }",
    "abstract_func_before": "@ApiOperation(VAR_0 = \"\u4fee\u6539\", note$$$$s = \"$$$$\u4fee\u6539\")\n    @ResponseBody\n    @RequestMapping(\"/update\")\n    @RequiresPermissions(\"novel:friendLink:edit\")\n    public R update(FriendLinkDO VAR_2) {\n        VAR_3.update(VAR_2);\n        VAR_4.delete(VAR_5.INDEX_LINK_KEY);\n        return VAR_6.ok();\n    }",
    "func_graph_path_before": "201206030/novel-plus/d6093d8182362422370d7eaf6c53afde9ee45215/FriendLinkController.java/vul/before/0.json",
    "func": "@ApiOperation(value = \"\u4fee\u6539\", notes = \"\u4fee\u6539\")\n    @ResponseBody\n    @RequestMapping(\"/update\")\n    @RequiresPermissions(\"novel:friendLink:edit\")\n    public R update(@Validated FriendLinkDO friendLink) {\n        friendLinkService.update(friendLink);\n        redisTemplate.delete(CacheKey.INDEX_LINK_KEY);\n        return R.ok();\n    }",
    "abstract_func": "@ApiOperation(VAR_0 = \"\u4fee\u6539\", note$$$$s = \"$$$$\u4fee\u6539\")\n    @ResponseBody\n    @RequestMapping(\"/update\")\n    @RequiresPermissions(\"novel:friendLink:edit\")\n    public R update(@Validated FriendLinkDO VAR_2) {\n        VAR_3.update(VAR_2);\n        VAR_4.delete(VAR_5.INDEX_LINK_KEY);\n        return VAR_6.ok();\n    }",
    "func_graph_path": "201206030/novel-plus/d6093d8182362422370d7eaf6c53afde9ee45215/FriendLinkController.java/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -2,7 +2,7 @@\n     @ResponseBody\n     @RequestMapping(\"/update\")\n     @RequiresPermissions(\"novel:friendLink:edit\")\n-    public R update(FriendLinkDO friendLink) {\n+    public R update(@Validated FriendLinkDO friendLink) {\n         friendLinkService.update(friendLink);\n         redisTemplate.delete(CacheKey.INDEX_LINK_KEY);\n         return R.ok();",
    "diff_line_info": {
        "deleted_lines": [
            "    public R update(FriendLinkDO friendLink) {"
        ],
        "added_lines": [
            "    public R update(@Validated FriendLinkDO friendLink) {"
        ]
    },
    "is_vul": true,
    "pr_url": "https://github.com/201206030/novel-plus/pull/131",
    "description": "no more info"
}