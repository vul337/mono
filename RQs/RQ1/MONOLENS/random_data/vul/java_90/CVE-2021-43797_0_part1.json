{
    "cve_id": "CVE-2021-43797",
    "cwe_ids": [
        "CWE-444"
    ],
    "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
    "cvss_is_v3": false,
    "repo_name": "netty",
    "commit_msg": "Merge pull request from GHSA-wx5j-54mm-rqqq\n\nMotivation:\n\nWe should validate that only OWS is allowed before / after a header name and otherwise throw. At the moment we just \"strip\" everything except OWS.\n\nModifications:\n\n- Adjust code to correctly validate\n- Add unit tests\n\nResult:\n\nMore strict and correct behaviour",
    "commit_hash": "07aa6b5938a8b6ed7a6586e066400e2643897323",
    "git_url": "https://github.com/netty/netty/commit/07aa6b5938a8b6ed7a6586e066400e2643897323",
    "file_path": "codec-http/src/main/java/io/netty/handler/codec/http/DefaultHttpHeaders.java",
    "func_name": "validateHeaderNameElement",
    "func_before": "private static void validateHeaderNameElement(char value) {\n        switch (value) {\n        case 0x00:\n        case '\\t':\n        case '\\n':\n        case 0x0b:\n        case '\\f':\n        case '\\r':\n        case ' ':\n        case ',':\n        case ':':\n        case ';':\n        case '=':\n            throw new IllegalArgumentException(\n               \"a header name cannot contain the following prohibited characters: =,;: \\\\t\\\\r\\\\n\\\\v\\\\f: \" +\n                       value);\n        default:\n            // Check to see if the character is not an ASCII character, or invalid\n            if (value > 127) {\n                throw new IllegalArgumentException(\"a header name cannot contain non-ASCII character: \" +\n                        value);\n            }\n        }\n    }",
    "abstract_func_before": "private static void validateHeaderNameElement(char VAR_0) {\n        switch (VAR_0) {\n        case 0x00:\n        case '\\t':\n        case '\\n':\n        case 0x0b:\n        case '\\f':\n        case '\\r':\n        case ' ':\n        case ',':\n        case ':':\n        case ';':\n        case '=':\n            throw new IllegalArgumentException(\n               \"a header name cannot contain the following prohibited characters: =,;: \\\\t\\\\r\\\\n\\\\v\\\\f: \" +\n                       VAR_0);\n        default:\n            /* COMMENT_0 */\n            if (VAR_0 > 127) {\n                throw new IllegalArgumentException(\"a header name cannot contain non-ASCII character: \" +\n                        VAR_0);\n            }\n        }\n    }",
    "func_graph_path_before": "netty/07aa6b5938a8b6ed7a6586e066400e2643897323/DefaultHttpHeaders.java/vul/before/1.json",
    "func": "private static void validateHeaderNameElement(char value) {\n        switch (value) {\n        case 0x1c:\n        case 0x1d:\n        case 0x1e:\n        case 0x1f:\n        case 0x00:\n        case '\\t':\n        case '\\n':\n        case 0x0b:\n        case '\\f':\n        case '\\r':\n        case ' ':\n        case ',':\n        case ':':\n        case ';':\n        case '=':\n            throw new IllegalArgumentException(\n               \"a header name cannot contain the following prohibited characters: =,;: \\\\t\\\\r\\\\n\\\\v\\\\f: \" +\n                       value);\n        default:\n            // Check to see if the character is not an ASCII character, or invalid\n            if (value > 127) {\n                throw new IllegalArgumentException(\"a header name cannot contain non-ASCII character: \" +\n                        value);\n            }\n        }\n    }",
    "abstract_func": "private static void validateHeaderNameElement(char VAR_0) {\n        switch (VAR_0) {\n        case 0x1c:\n        case 0x1d:\n        case 0x1e:\n        case 0x1f:\n        case 0x00:\n        case '\\t':\n        case '\\n':\n        case 0x0b:\n        case '\\f':\n        case '\\r':\n        case ' ':\n        case ',':\n        case ':':\n        case ';':\n        case '=':\n            throw new IllegalArgumentException(\n               \"a header name cannot contain the following prohibited characters: =,;: \\\\t\\\\r\\\\n\\\\v\\\\f: \" +\n                       VAR_0);\n        default:\n            /* COMMENT_0 */\n            if (VAR_0 > 127) {\n                throw new IllegalArgumentException(\"a header name cannot contain non-ASCII character: \" +\n                        VAR_0);\n            }\n        }\n    }",
    "func_graph_path": "netty/07aa6b5938a8b6ed7a6586e066400e2643897323/DefaultHttpHeaders.java/vul/after/1.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,9 @@\n private static void validateHeaderNameElement(char value) {\n         switch (value) {\n+        case 0x1c:\n+        case 0x1d:\n+        case 0x1e:\n+        case 0x1f:\n         case 0x00:\n         case '\\t':\n         case '\\n':",
    "diff_line_info": {
        "deleted_lines": [],
        "added_lines": [
            "        case 0x1c:",
            "        case 0x1d:",
            "        case 0x1e:",
            "        case 0x1f:"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}