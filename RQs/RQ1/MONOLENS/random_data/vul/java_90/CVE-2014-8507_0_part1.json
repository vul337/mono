{
    "cve_id": "CVE-2014-8507",
    "cwe_ids": [
        "CWE-89"
    ],
    "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
    "cvss_is_v3": false,
    "repo_name": "android",
    "commit_msg": "Externally Reported Moderate Security Issue: SQL Injection in WAPPushManager\n\nBug 17969135\n\nUse query (instead of rawQuery) and pass in arguments instead of building\nthe query with a giant string. Add a unit test that fails with the old\ncode but passes with the new code.\n\nChange-Id: Id04a1db6fb95fcd923e1f36f5ab3b94402590918\n",
    "commit_hash": "48ed835468c6235905459e6ef7df032baf3e4df6",
    "git_url": "https://android.googlesource.com/platform/frameworks/base/+/48ed835468c6235905459e6ef7df032baf3e4df6",
    "file_path": "packages/WAPPushManager/src/com/android/smspush/WapPushManager.java",
    "func_name": "verifyData",
    "func_before": "public boolean verifyData(String x_app_id, String content_type,\n            String package_name, String class_name,\n            int app_type, boolean need_signature, boolean further_processing) {\n        WapPushManDBHelper dbh = getDatabase(this);\n        SQLiteDatabase db = dbh.getReadableDatabase();\n        WapPushManDBHelper.queryData lastapp = dbh.queryLastApp(db, x_app_id, content_type);\n\n        db.close();\n\n        if (lastapp == null) return false;\n\n        if (lastapp.packageName.equals(package_name)\n                && lastapp.className.equals(class_name)\n                && lastapp.appType == app_type\n                &&  lastapp.needSignature == (need_signature ? 1 : 0)\n                &&  lastapp.furtherProcessing == (further_processing ? 1 : 0)) {\n            return true;\n        } else {\n            return false;\n        }\n    }",
    "abstract_func_before": "public boolean verifyData(String VAR_0, String VAR_1,\n            String VAR_2, String VAR_3,\n            int VAR_4, boolean VAR_5, boolean VAR_6) {\n        WapPushManDBHelper VAR_7 = getDatabase(this);\n        SQLiteDatabase VAR_8 = VAR_7.getReadableDatabase();\n        WapPushManDBHelper.queryData VAR_9 = VAR_7.queryLastApp(VAR_8, VAR_0, VAR_1);\n\n        VAR_8.close();\n\n        if (VAR_9 == null) return false;\n\n        if (VAR_9.packageName.equals(VAR_2)\n                && VAR_9.className.equals(VAR_3)\n                && VAR_9.appType == VAR_4\n                &&  VAR_9.needSignature == (VAR_5 ? 1 : 0)\n                &&  VAR_9.furtherProcessing == (VAR_6 ? 1 : 0)) {\n            return true;\n        } else {\n            return false;\n        }\n    }",
    "func_graph_path_before": "android/48ed835468c6235905459e6ef7df032baf3e4df6/WapPushManager.java/vul/before/1.json",
    "func": "public boolean verifyData(String x_app_id, String content_type,\n            String package_name, String class_name,\n            int app_type, boolean need_signature, boolean further_processing) {\n        WapPushManDBHelper dbh = getDatabase(this);\n        SQLiteDatabase db = dbh.getReadableDatabase();\n        WapPushManDBHelper.queryData lastapp = dbh.queryLastApp(db, x_app_id, content_type);\n\n        if (LOCAL_LOGV) Log.v(LOG_TAG, \"verifyData app id: \" + x_app_id + \" content type: \" +\n                content_type + \" lastapp: \" + lastapp);\n\n        db.close();\n\n        if (lastapp == null) return false;\n\n        if (LOCAL_LOGV) Log.v(LOG_TAG, \"verifyData lastapp.packageName: \" + lastapp.packageName +\n                \" lastapp.className: \" + lastapp.className +\n                \" lastapp.appType: \" + lastapp.appType +\n                \" lastapp.needSignature: \" + lastapp.needSignature +\n                \" lastapp.furtherProcessing: \" + lastapp.furtherProcessing);\n\n\n        if (lastapp.packageName.equals(package_name)\n                && lastapp.className.equals(class_name)\n                && lastapp.appType == app_type\n                &&  lastapp.needSignature == (need_signature ? 1 : 0)\n                &&  lastapp.furtherProcessing == (further_processing ? 1 : 0)) {\n            return true;\n        } else {\n            return false;\n        }\n    }",
    "abstract_func": "public boolean verifyData(String VAR_0, String VAR_1,\n            String VAR_2, String VAR_3,\n            int VAR_4, boolean VAR_5, boolean VAR_6) {\n        WapPushManDBHelper VAR_7 = getDatabase(this);\n        SQLiteDatabase VAR_8 = VAR_7.getReadableDatabase();\n        WapPushManDBHelper.queryData VAR_9 = VAR_7.queryLastApp(VAR_8, VAR_0, VAR_1);\n\n        if (VAR_10) VAR_11.v(VAR_12, \"verifyData app id: \" + VAR_0 + \" content type: \" +\n                VAR_1 + \" lastapp: \" + VAR_9);\n\n        VAR_8.close();\n\n        if (VAR_9 == null) return false;\n\n        if (VAR_10) VAR_11.v(VAR_12, \"verifyData lastapp.packageName: \" + VAR_9.packageName +\n                \" lastapp.className: \" + VAR_9.className +\n                \" lastapp.appType: \" + VAR_9.appType +\n                \" lastapp.needSignature: \" + VAR_9.needSignature +\n                \" lastapp.furtherProcessing: \" + VAR_9.furtherProcessing);\n\n\n        if (VAR_9.packageName.equals(VAR_2)\n                && VAR_9.className.equals(VAR_3)\n                && VAR_9.appType == VAR_4\n                &&  VAR_9.needSignature == (VAR_5 ? 1 : 0)\n                &&  VAR_9.furtherProcessing == (VAR_6 ? 1 : 0)) {\n            return true;\n        } else {\n            return false;\n        }\n    }",
    "func_graph_path": "android/48ed835468c6235905459e6ef7df032baf3e4df6/WapPushManager.java/vul/after/1.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -5,9 +5,19 @@\n         SQLiteDatabase db = dbh.getReadableDatabase();\n         WapPushManDBHelper.queryData lastapp = dbh.queryLastApp(db, x_app_id, content_type);\n \n+        if (LOCAL_LOGV) Log.v(LOG_TAG, \"verifyData app id: \" + x_app_id + \" content type: \" +\n+                content_type + \" lastapp: \" + lastapp);\n+\n         db.close();\n \n         if (lastapp == null) return false;\n+\n+        if (LOCAL_LOGV) Log.v(LOG_TAG, \"verifyData lastapp.packageName: \" + lastapp.packageName +\n+                \" lastapp.className: \" + lastapp.className +\n+                \" lastapp.appType: \" + lastapp.appType +\n+                \" lastapp.needSignature: \" + lastapp.needSignature +\n+                \" lastapp.furtherProcessing: \" + lastapp.furtherProcessing);\n+\n \n         if (lastapp.packageName.equals(package_name)\n                 && lastapp.className.equals(class_name)",
    "diff_line_info": {
        "deleted_lines": [],
        "added_lines": [
            "        if (LOCAL_LOGV) Log.v(LOG_TAG, \"verifyData app id: \" + x_app_id + \" content type: \" +",
            "                content_type + \" lastapp: \" + lastapp);",
            "",
            "",
            "        if (LOCAL_LOGV) Log.v(LOG_TAG, \"verifyData lastapp.packageName: \" + lastapp.packageName +",
            "                \" lastapp.className: \" + lastapp.className +",
            "                \" lastapp.appType: \" + lastapp.appType +",
            "                \" lastapp.needSignature: \" + lastapp.needSignature +",
            "                \" lastapp.furtherProcessing: \" + lastapp.furtherProcessing);",
            ""
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}