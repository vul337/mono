{
    "cve_id": "CVE-2016-15026",
    "cwe_ids": [
        "CWE-611"
    ],
    "cvss_vector": "AV:L/AC:L/Au:S/C:P/I:P/A:P",
    "cvss_is_v3": false,
    "repo_name": "3breadt/dd-plist",
    "commit_msg": "1) Take steps to guard against external XXE attacks (except, note that <!DOCTYPE> cannot be disabled in XML plists).\n2) Resolve the actual PLIST DTD from inside the JAR file itself, and prevent resolution of other external XML resources.\n3) Make XMLPlistParser.getDocBuilder public",
    "commit_hash": "8c954e8d9f6f6863729e50105a8abf3f87fff74c",
    "git_url": "https://github.com/3breadt/dd-plist/commit/8c954e8d9f6f6863729e50105a8abf3f87fff74c",
    "file_path": "src/main/java/com/dd/plist/XMLPropertyListParser.java",
    "func_name": "parse",
    "func_before": "public static NSObject parse(File f) throws ParserConfigurationException, IOException, SAXException, PropertyListFormatException, ParseException {\n        DocumentBuilder docBuilder = getDocBuilder();\n\n        Document doc = docBuilder.parse(f);\n\n        return parse(doc);\n    }",
    "abstract_func_before": "public static NSObject parse(File VAR_0) throws ParserConfigurationException, IOException, SAXException, PropertyListFormatException, ParseException {\n        DocumentBuilder VAR_1 = getDocBuilder();\n\n        Document VAR_2 = VAR_1.parse(VAR_0);\n\n        return parse(VAR_2);\n    }",
    "func_graph_path_before": "3breadt/dd-plist/8c954e8d9f6f6863729e50105a8abf3f87fff74c/XMLPropertyListParser.java/vul/before/2.json",
    "func": "public static NSObject parse(File f)\n                throws ParserConfigurationException, IOException, SAXException, PropertyListFormatException, ParseException {\n\n        return parse(getDocBuilder().parse(new FileInputStream(f)));\n    }",
    "abstract_func": "public static NSObject parse(File VAR_0)\n                throws ParserConfigurationException, IOException, SAXException, PropertyListFormatException, ParseException {\n\n        return parse(getDocBuilder().parse(new FileInputStream(VAR_0)));\n    }",
    "func_graph_path": "3breadt/dd-plist/8c954e8d9f6f6863729e50105a8abf3f87fff74c/XMLPropertyListParser.java/vul/after/2.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,7 +1,5 @@\n-public static NSObject parse(File f) throws ParserConfigurationException, IOException, SAXException, PropertyListFormatException, ParseException {\n-        DocumentBuilder docBuilder = getDocBuilder();\n+public static NSObject parse(File f)\n+                throws ParserConfigurationException, IOException, SAXException, PropertyListFormatException, ParseException {\n \n-        Document doc = docBuilder.parse(f);\n-\n-        return parse(doc);\n+        return parse(getDocBuilder().parse(new FileInputStream(f)));\n     }",
    "diff_line_info": {
        "deleted_lines": [
            "public static NSObject parse(File f) throws ParserConfigurationException, IOException, SAXException, PropertyListFormatException, ParseException {",
            "        DocumentBuilder docBuilder = getDocBuilder();",
            "        Document doc = docBuilder.parse(f);",
            "",
            "        return parse(doc);"
        ],
        "added_lines": [
            "public static NSObject parse(File f)",
            "                throws ParserConfigurationException, IOException, SAXException, PropertyListFormatException, ParseException {",
            "        return parse(getDocBuilder().parse(new FileInputStream(f)));"
        ]
    },
    "is_vul": true,
    "pr_url": "https://github.com/3breadt/dd-plist/pull/26",
    "description": "1) Take steps to guard against XXE attacks (note that <!DOCTYPE> cannot be disabled in XML plists). See: https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Prevention_Cheat_Sheet#Java\n2) Resolve the actual PLIST DTD from inside the JAR file itself, and prevent resolution of other external XML resources.\n3) Make XMLPlistParser.getDocBuilder public.\n"
}