{
    "cve_id": "CVE-2015-8012",
    "cwe_ids": [
        "CWE-617"
    ],
    "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
    "cvss_is_v3": false,
    "repo_name": "lldpd",
    "commit_msg": "protocols: don't use assert on paths that can be reached\n\nMalformed packets should not make lldpd crash. Ensure we can handle them\nby not using assert() in this part.",
    "commit_hash": "793526f8884455f43daecd0a2c46772388417a00",
    "git_url": "https://github.com/lldpd/lldpd/commit/793526f8884455f43daecd0a2c46772388417a00",
    "file_path": "src/daemon/lldpd.c",
    "func_name": "lldpd_alloc_mgmt",
    "func_before": "struct lldpd_mgmt *\nlldpd_alloc_mgmt(int family, void *addrptr, size_t addrsize, u_int32_t iface)\n{\n\tstruct lldpd_mgmt *mgmt;\n\n\tlog_debug(\"alloc\", \"allocate a new management address (family: %d)\", family);\n\n\tif (family <= LLDPD_AF_UNSPEC || family >= LLDPD_AF_LAST) {\n\t\terrno = EAFNOSUPPORT;\n\t\treturn NULL;\n\t}\n\tif (addrsize > LLDPD_MGMT_MAXADDRSIZE) {\n\t\terrno = EOVERFLOW;\n\t\treturn NULL;\n\t}\n\tmgmt = calloc(1, sizeof(struct lldpd_mgmt));\n\tif (mgmt == NULL) {\n\t\terrno = ENOMEM;\n\t\treturn NULL;\n\t}\n\tmgmt->m_family = family;\n\tassert(addrsize <= LLDPD_MGMT_MAXADDRSIZE);\n\tmemcpy(&mgmt->m_addr, addrptr, addrsize);\n\tmgmt->m_addrsize = addrsize;\n\tmgmt->m_iface = iface;\n\treturn mgmt;\n}",
    "abstract_func_before": "struct lldpd_mgmt *\nlldpd_alloc_mgmt(int VAR_0, void *VAR_1, size_t VAR_2, u_int32_t VAR_3)\n{\n\tstruct lldpd_mgmt *VAR_4;\n\n\tlog_debug(\"alloc\", \"allocate a new management address (family: %d)\", VAR_0);\n\n\tif (VAR_0 <= VAR_5 || VAR_0 >= VAR_6) {\n\t\tVAR_7 = VAR_8;\n\t\treturn NULL;\n\t}\n\tif (VAR_2 > VAR_9) {\n\t\tVAR_7 = VAR_10;\n\t\treturn NULL;\n\t}\n\tVAR_4 = calloc(1, sizeof(struct lldpd_mgmt));\n\tif (VAR_4 == NULL) {\n\t\tVAR_7 = VAR_11;\n\t\treturn NULL;\n\t}\n\tVAR_4->m_family = VAR_0;\n\tassert(VAR_2 <= VAR_9);\n\tmemcpy(&VAR_4->m_addr, VAR_1, VAR_2);\n\tVAR_4->m_addrsize = VAR_2;\n\tVAR_4->m_iface = VAR_3;\n\treturn VAR_4;\n}",
    "func_graph_path_before": "lldpd/793526f8884455f43daecd0a2c46772388417a00/lldpd.c/vul/before/0.json",
    "func": "struct lldpd_mgmt *\nlldpd_alloc_mgmt(int family, void *addrptr, size_t addrsize, u_int32_t iface)\n{\n\tstruct lldpd_mgmt *mgmt;\n\n\tlog_debug(\"alloc\", \"allocate a new management address (family: %d)\", family);\n\n\tif (family <= LLDPD_AF_UNSPEC || family >= LLDPD_AF_LAST) {\n\t\terrno = EAFNOSUPPORT;\n\t\treturn NULL;\n\t}\n\tif (addrsize > LLDPD_MGMT_MAXADDRSIZE) {\n\t\terrno = EOVERFLOW;\n\t\treturn NULL;\n\t}\n\tmgmt = calloc(1, sizeof(struct lldpd_mgmt));\n\tif (mgmt == NULL) {\n\t\terrno = ENOMEM;\n\t\treturn NULL;\n\t}\n\tmgmt->m_family = family;\n\tmemcpy(&mgmt->m_addr, addrptr, addrsize);\n\tmgmt->m_addrsize = addrsize;\n\tmgmt->m_iface = iface;\n\treturn mgmt;\n}",
    "abstract_func": "struct lldpd_mgmt *\nlldpd_alloc_mgmt(int VAR_0, void *VAR_1, size_t VAR_2, u_int32_t VAR_3)\n{\n\tstruct lldpd_mgmt *VAR_4;\n\n\tlog_debug(\"alloc\", \"allocate a new management address (family: %d)\", VAR_0);\n\n\tif (VAR_0 <= VAR_5 || VAR_0 >= VAR_6) {\n\t\tVAR_7 = VAR_8;\n\t\treturn NULL;\n\t}\n\tif (VAR_2 > VAR_9) {\n\t\tVAR_7 = VAR_10;\n\t\treturn NULL;\n\t}\n\tVAR_4 = calloc(1, sizeof(struct lldpd_mgmt));\n\tif (VAR_4 == NULL) {\n\t\tVAR_7 = VAR_11;\n\t\treturn NULL;\n\t}\n\tVAR_4->m_family = VAR_0;\n\tmemcpy(&VAR_4->m_addr, VAR_1, VAR_2);\n\tVAR_4->m_addrsize = VAR_2;\n\tVAR_4->m_iface = VAR_3;\n\treturn VAR_4;\n}",
    "func_graph_path": "lldpd/793526f8884455f43daecd0a2c46772388417a00/lldpd.c/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -19,7 +19,6 @@\n \t\treturn NULL;\n \t}\n \tmgmt->m_family = family;\n-\tassert(addrsize <= LLDPD_MGMT_MAXADDRSIZE);\n \tmemcpy(&mgmt->m_addr, addrptr, addrsize);\n \tmgmt->m_addrsize = addrsize;\n \tmgmt->m_iface = iface;",
    "diff_line_info": {
        "deleted_lines": [
            "\tassert(addrsize <= LLDPD_MGMT_MAXADDRSIZE);"
        ],
        "added_lines": []
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}