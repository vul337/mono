{
    "cve_id": "CVE-2018-5801",
    "cwe_ids": [
        "CWE-476"
    ],
    "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
    "cvss_is_v3": false,
    "repo_name": "LibRaw",
    "commit_msg": "SA79000 advisory fix",
    "commit_hash": "0df5490b985c419de008d32168650bff17128914",
    "git_url": "https://github.com/LibRaw/LibRaw/commit/0df5490b985c419de008d32168650bff17128914",
    "file_path": "internal/dcraw_common.cpp",
    "func_name": "nikon_yuv_load_raw",
    "func_before": "void CLASS nikon_yuv_load_raw()\n{\n  int row, col, yuv[4], rgb[3], b, c;\n  UINT64 bitbuf = 0;\n  float cmul[4];\n  FORC4 { cmul[c] = cam_mul[c] > 0.001f ? cam_mul[c] : 1.f; }",
    "abstract_func_before": "void VAR_0 nikon_yuv_load_raw()\n{\n  int VAR_1, VAR_2, VAR_3[4], VAR_4[3], VAR_5, VAR_6;\n  UINT64 VAR_7 = 0;\n  float VAR_8[4];\n  FORC4 { VAR_8[VAR_6] = VAR_9[VAR_6] > 0.001f ? VAR_9[VAR_6] : 1.f; }",
    "func_graph_path_before": null,
    "func": "void CLASS nikon_yuv_load_raw()\n{\n#ifdef LIBRAW_LIBRARY_BUILD\n  if(!image)\n    throw LIBRAW_EXCEPTION_IO_CORRUPT;\n#endif\n  int row, col, yuv[4], rgb[3], b, c;\n  UINT64 bitbuf = 0;\n  float cmul[4];\n  FORC4 { cmul[c] = cam_mul[c] > 0.001f ? cam_mul[c] : 1.f; }",
    "abstract_func": "void VAR_0 nikon_yuv_load_raw()\n{\n#ifdef VAR_1\n  if(!VAR_2)\n    throw VAR_3;\n#endif\n  int VAR_4, VAR_5, VAR_6[4], VAR_7[3], VAR_8, VAR_9;\n  UINT64 VAR_10 = 0;\n  float VAR_11[4];\n  FORC4 { VAR_11[VAR_9] = VAR_12[VAR_9] > 0.001f ? VAR_12[VAR_9] : 1.f; }",
    "func_graph_path": null,
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,5 +1,9 @@\n void CLASS nikon_yuv_load_raw()\n {\n+#ifdef LIBRAW_LIBRARY_BUILD\n+  if(!image)\n+    throw LIBRAW_EXCEPTION_IO_CORRUPT;\n+#endif\n   int row, col, yuv[4], rgb[3], b, c;\n   UINT64 bitbuf = 0;\n   float cmul[4];",
    "diff_line_info": {
        "deleted_lines": [],
        "added_lines": [
            "#ifdef LIBRAW_LIBRARY_BUILD",
            "  if(!image)",
            "    throw LIBRAW_EXCEPTION_IO_CORRUPT;",
            "#endif"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}