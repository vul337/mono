{
    "cve_id": "CVE-2011-5244",
    "cwe_ids": [
        "CWE-189"
    ],
    "cvss_vector": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
    "cvss_is_v3": false,
    "repo_name": "GNOME/evince",
    "commit_msg": "backends: Fix several security issues in the dvi-backend.\n\nSee CVE-2010-2640, CVE-2010-2641, CVE-2010-2642 and  CVE-2010-2643.",
    "commit_hash": "d4139205b010",
    "git_url": "https://github.com/GNOME/evince/commit/d4139205b010ed06310d14284e63114e88ec6de2",
    "file_path": "backend/dvi/mdvi-lib/dviread.c",
    "func_name": "special",
    "func_before": "int\tspecial(DviContext *dvi, int opcode)\n{\n\tchar\t*s;\n\tInt32\targ;\n\t\n\targ = dugetn(dvi, opcode - DVI_XXX1 + 1);\n\ts = mdvi_malloc(arg + 1);\n\tdread(dvi, s, arg);\n\ts[arg] = 0;\n\tmdvi_do_special(dvi, s);\n\tSHOWCMD((dvi, \"XXXX\", opcode - DVI_XXX1 + 1,\n\t\t\"[%s]\", s));\n\tmdvi_free(s);\n\treturn 0;\n}",
    "abstract_func_before": "int\tspecial(DviContext *VAR_0, int VAR_1)\n{\n\tchar\t*VAR_2;\n\tInt32\tVAR_3;\n\t\n\tVAR_3 = dugetn(VAR_0, VAR_1 - VAR_4 + 1);\n\tVAR_2 = mdvi_malloc(VAR_3 + 1);\n\tdread(VAR_0, VAR_2, VAR_3);\n\tVAR_2[VAR_3] = 0;\n\tmdvi_do_special(VAR_0, VAR_2);\n\tSHOWCMD((VAR_0, \"XXXX\", VAR_1 - VAR_4 + 1,\n\t\t\"[%s]\", VAR_2));\n\tmdvi_free(VAR_2);\n\treturn 0;\n}",
    "func_graph_path_before": "GNOME/evince/d4139205b010/dviread.c/vul/before/0.json",
    "func": "int\tspecial(DviContext *dvi, int opcode)\n{\n\tchar\t*s;\n\tInt32\targ;\n\t\n\targ = dugetn(dvi, opcode - DVI_XXX1 + 1);\n\tif (arg <= 0) {\n\t\tdvierr(dvi, _(\"malformed special length\\n\"));\n\t\treturn -1;\n\t}\n\ts = mdvi_malloc(arg + 1);\n\tdread(dvi, s, arg);\n\ts[arg] = 0;\n\tmdvi_do_special(dvi, s);\n\tSHOWCMD((dvi, \"XXXX\", opcode - DVI_XXX1 + 1,\n\t\t\"[%s]\", s));\n\tmdvi_free(s);\n\treturn 0;\n}",
    "abstract_func": "int\tspecial(DviContext *VAR_0, int VAR_1)\n{\n\tchar\t*VAR_2;\n\tInt32\tVAR_3;\n\t\n\tVAR_3 = dugetn(VAR_0, VAR_1 - VAR_4 + 1);\n\tif (VAR_3 <= 0) {\n\t\tdvierr(VAR_0, _(\"malformed special length\\n\"));\n\t\treturn -1;\n\t}\n\tVAR_2 = mdvi_malloc(VAR_3 + 1);\n\tdread(VAR_0, VAR_2, VAR_3);\n\tVAR_2[VAR_3] = 0;\n\tmdvi_do_special(VAR_0, VAR_2);\n\tSHOWCMD((VAR_0, \"XXXX\", VAR_1 - VAR_4 + 1,\n\t\t\"[%s]\", VAR_2));\n\tmdvi_free(VAR_2);\n\treturn 0;\n}",
    "func_graph_path": "GNOME/evince/d4139205b010/dviread.c/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -4,6 +4,10 @@\n \tInt32\targ;\n \t\n \targ = dugetn(dvi, opcode - DVI_XXX1 + 1);\n+\tif (arg <= 0) {\n+\t\tdvierr(dvi, _(\"malformed special length\\n\"));\n+\t\treturn -1;\n+\t}\n \ts = mdvi_malloc(arg + 1);\n \tdread(dvi, s, arg);\n \ts[arg] = 0;",
    "diff_line_info": {
        "deleted_lines": [],
        "added_lines": [
            "\tif (arg <= 0) {",
            "\t\tdvierr(dvi, _(\"malformed special length\\n\"));",
            "\t\treturn -1;",
            "\t}"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}