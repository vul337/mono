{
    "cve_id": "CVE-2023-49285",
    "cwe_ids": [
        "CWE-125"
    ],
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "cvss_is_v3": true,
    "repo_name": "squid-cache/squid",
    "commit_msg": "RFC 1123: Fix date parsing (#1538)\n\nThe bug was discovered and detailed by Joshua Rogers at\nhttps://megamansec.github.io/Squid-Security-Audit/datetime-overflow.html\nwhere it was filed as \"1-Byte Buffer OverRead in RFC 1123 date/time\nHandling\".",
    "commit_hash": "77b3fb4df0f126784d5fd4967c28ed40eb8d521b",
    "git_url": "https://github.com/squid-cache/squid/commit/77b3fb4df0f126784d5fd4967c28ed40eb8d521b",
    "file_path": "lib/rfc1123.c",
    "func_name": "make_month",
    "func_before": "static int\nmake_month(const char *s)\n{\n    int i;\n    char month[3];\n\n    month[0] = xtoupper(*s);\n    month[1] = xtolower(*(s + 1));\n    month[2] = xtolower(*(s + 2));\n\n    for (i = 0; i < 12; i++)\n        if (!strncmp(month_names[i], month, 3))\n            return i;\n    return -1;\n}",
    "abstract_func_before": "static int\nmake_month(const char *VAR_0)\n{\n    int VAR_1;\n    char VAR_2[3];\n\n    VAR_2[0] = xtoupper(*VAR_0);\n    VAR_2[1] = xtolower(*(VAR_0 + 1));\n    VAR_2[2] = xtolower(*(VAR_0 + 2));\n\n    for (VAR_1 = 0; VAR_1 < 12; VAR_1++)\n        if (!strncmp(VAR_3[VAR_1], VAR_2, 3))\n            return VAR_1;\n    return -1;\n}",
    "func_graph_path_before": "squid-cache/squid/77b3fb4df0f126784d5fd4967c28ed40eb8d521b/rfc1123.c/vul/before/0.json",
    "func": "static int\nmake_month(const char *s)\n{\n    int i;\n    char month[3];\n\n    month[0] = xtoupper(*s);\n    if (!month[0])\n        return -1; // protects *(s + 1) below\n\n    month[1] = xtolower(*(s + 1));\n    if (!month[1])\n        return -1; // protects *(s + 2) below\n\n    month[2] = xtolower(*(s + 2));\n\n    for (i = 0; i < 12; i++)\n        if (!strncmp(month_names[i], month, 3))\n            return i;\n    return -1;\n}",
    "abstract_func": "static int\nmake_month(const char *VAR_0)\n{\n    int VAR_1;\n    char VAR_2[3];\n\n    VAR_2[0] = xtoupper(*VAR_0);\n    if (!VAR_2[0])\n        return -1; /* COMMENT_0 */\n\n    VAR_2[1] = xtolower(*(VAR_0 + 1));\n    if (!VAR_2[1])\n        return -1; /* COMMENT_1 */\n\n    VAR_2[2] = xtolower(*(VAR_0 + 2));\n\n    for (VAR_1 = 0; VAR_1 < 12; VAR_1++)\n        if (!strncmp(VAR_3[VAR_1], VAR_2, 3))\n            return VAR_1;\n    return -1;\n}",
    "func_graph_path": "squid-cache/squid/77b3fb4df0f126784d5fd4967c28ed40eb8d521b/rfc1123.c/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -5,7 +5,13 @@\n     char month[3];\n \n     month[0] = xtoupper(*s);\n+    if (!month[0])\n+        return -1; // protects *(s + 1) below\n+\n     month[1] = xtolower(*(s + 1));\n+    if (!month[1])\n+        return -1; // protects *(s + 2) below\n+\n     month[2] = xtolower(*(s + 2));\n \n     for (i = 0; i < 12; i++)",
    "diff_line_info": {
        "deleted_lines": [],
        "added_lines": [
            "    if (!month[0])",
            "        return -1; // protects *(s + 1) below",
            "",
            "    if (!month[1])",
            "        return -1; // protects *(s + 2) below",
            ""
        ]
    },
    "is_vul": true,
    "pr_url": "https://github.com/squid-cache/squid/pull/1549",
    "description": "no more info"
}