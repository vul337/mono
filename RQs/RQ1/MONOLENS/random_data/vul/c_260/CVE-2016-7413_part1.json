{
    "cve_id": "CVE-2016-7413",
    "cwe_ids": [
        "CWE-416"
    ],
    "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
    "cvss_is_v3": false,
    "repo_name": "php/php-src",
    "commit_msg": "Fix bug #72860: wddx_deserialize use-after-free",
    "commit_hash": "b88393f08a558eec14964a55d3c680fe67407712",
    "git_url": "https://github.com/php/php-src/commit/b88393f08a558eec14964a55d3c680fe67407712",
    "file_path": "ext/wddx/wddx.c",
    "func_name": "wddx_stack_destroy",
    "func_before": "static int wddx_stack_destroy(wddx_stack *stack)\n{\n\tregister int i;\n\n\tif (stack->elements) {\n\t\tfor (i = 0; i < stack->top; i++) {\n\t\t\tif (((st_entry *)stack->elements[i])->data)\t{\n\t\t\t\tzval_ptr_dtor(&((st_entry *)stack->elements[i])->data);\n\t\t\t}\n\t\t\tif (((st_entry *)stack->elements[i])->varname) {\n\t\t\t\tefree(((st_entry *)stack->elements[i])->varname);\n\t\t\t}\n\t\t\tefree(stack->elements[i]);\n\t\t}\n\t\tefree(stack->elements);\n\t}\n\treturn SUCCESS;\n}",
    "abstract_func_before": "static int wddx_stack_destroy(wddx_stack *VAR_0)\n{\n\tregister int VAR_1;\n\n\tif (VAR_0->elements) {\n\t\tfor (VAR_1 = 0; VAR_1 < VAR_0->top; VAR_1++) {\n\t\t\tif (((st_entry *)VAR_0->elements[VAR_1])->data)\t{\n\t\t\t\tzval_ptr_dtor(&((st_entry *)VAR_0->elements[VAR_1])->data);\n\t\t\t}\n\t\t\tif (((st_entry *)VAR_0->elements[VAR_1])->varname) {\n\t\t\t\tefree(((st_entry *)VAR_0->elements[VAR_1])->varname);\n\t\t\t}\n\t\t\tefree(VAR_0->elements[VAR_1]);\n\t\t}\n\t\tefree(VAR_0->elements);\n\t}\n\treturn VAR_2;\n}",
    "func_graph_path_before": "php/php-src/b88393f08a558eec14964a55d3c680fe67407712/wddx.c/vul/before/0.json",
    "func": "static int wddx_stack_destroy(wddx_stack *stack)\n{\n\tregister int i;\n\n\tif (stack->elements) {\n\t\tfor (i = 0; i < stack->top; i++) {\n\t\t\tif (((st_entry *)stack->elements[i])->data\n\t\t\t\t\t&& ((st_entry *)stack->elements[i])->type != ST_FIELD)\t{\n\t\t\t\tzval_ptr_dtor(&((st_entry *)stack->elements[i])->data);\n\t\t\t}\n\t\t\tif (((st_entry *)stack->elements[i])->varname) {\n\t\t\t\tefree(((st_entry *)stack->elements[i])->varname);\n\t\t\t}\n\t\t\tefree(stack->elements[i]);\n\t\t}\n\t\tefree(stack->elements);\n\t}\n\treturn SUCCESS;\n}",
    "abstract_func": "static int wddx_stack_destroy(wddx_stack *VAR_0)\n{\n\tregister int VAR_1;\n\n\tif (VAR_0->elements) {\n\t\tfor (VAR_1 = 0; VAR_1 < VAR_0->top; VAR_1++) {\n\t\t\tif (((st_entry *)VAR_0->elements[VAR_1])->data\n\t\t\t\t\t&& ((st_entry *)VAR_0->elements[VAR_1])->type != VAR_2)\t{\n\t\t\t\tzval_ptr_dtor(&((st_entry *)VAR_0->elements[VAR_1])->data);\n\t\t\t}\n\t\t\tif (((st_entry *)VAR_0->elements[VAR_1])->varname) {\n\t\t\t\tefree(((st_entry *)VAR_0->elements[VAR_1])->varname);\n\t\t\t}\n\t\t\tefree(VAR_0->elements[VAR_1]);\n\t\t}\n\t\tefree(VAR_0->elements);\n\t}\n\treturn VAR_3;\n}",
    "func_graph_path": "php/php-src/b88393f08a558eec14964a55d3c680fe67407712/wddx.c/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -4,7 +4,8 @@\n \n \tif (stack->elements) {\n \t\tfor (i = 0; i < stack->top; i++) {\n-\t\t\tif (((st_entry *)stack->elements[i])->data)\t{\n+\t\t\tif (((st_entry *)stack->elements[i])->data\n+\t\t\t\t\t&& ((st_entry *)stack->elements[i])->type != ST_FIELD)\t{\n \t\t\t\tzval_ptr_dtor(&((st_entry *)stack->elements[i])->data);\n \t\t\t}\n \t\t\tif (((st_entry *)stack->elements[i])->varname) {",
    "diff_line_info": {
        "deleted_lines": [
            "\t\t\tif (((st_entry *)stack->elements[i])->data)\t{"
        ],
        "added_lines": [
            "\t\t\tif (((st_entry *)stack->elements[i])->data",
            "\t\t\t\t\t&& ((st_entry *)stack->elements[i])->type != ST_FIELD)\t{"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}