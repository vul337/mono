{
    "cve_id": "CVE-2021-41687",
    "cwe_ids": [
        "CWE-415",
        "CWE-401"
    ],
    "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
    "cvss_is_v3": false,
    "repo_name": "DCMTK/dcmtk",
    "commit_msg": "Fixed poss. NULL pointer dereference/double free.\n\nThanks to Jinsheng Ba <bajinsheng@u.nus.edu> for the report and some patches.",
    "commit_hash": "a9697dfeb672b0b9412c00c7d36d801e27ec85cb",
    "git_url": "https://github.com/DCMTK/dcmtk/commit/a9697dfeb672b0b9412c00c7d36d801e27ec85cb",
    "file_path": "dcmnet/libsrc/assoc.cc",
    "func_name": "ASC_destroyAssociation",
    "func_before": "OFCondition\nASC_destroyAssociation(T_ASC_Association ** association)\n{\n    OFCondition cond = EC_Normal;\n\n    /* don't worry if already destroyed */\n    if (association == NULL) return EC_Normal;\n    if (*association == NULL) return EC_Normal;\n\n    if ((*association)->DULassociation != NULL) {\n        ASC_dropAssociation(*association);\n    }\n\n    if ((*association)->params != NULL) {\n        cond = ASC_destroyAssociationParameters(&(*association)->params);\n        if (cond.bad()) return cond;\n    }\n\n    if ((*association)->sendPDVBuffer != NULL)\n        free((*association)->sendPDVBuffer);\n\n    free(*association);\n    *association = NULL;\n\n    return EC_Normal;\n}",
    "abstract_func_before": "OFCondition\nASC_destroyAssociation(T_ASC_Association ** VAR_0)\n{\n    OFCondition VAR_1 = VAR_2;\n\n    /* COMMENT_0 */\n    if (VAR_0 == NULL) return VAR_2;\n    if (*VAR_0 == NULL) return VAR_2;\n\n    if ((*VAR_0)->DULassociation != NULL) {\n        ASC_dropAssociation(*VAR_0);\n    }\n\n    if ((*VAR_0)->params != NULL) {\n        VAR_1 = ASC_destroyAssociationParameters(&(*VAR_0)->params);\n        if (VAR_1.bad()) return VAR_1;\n    }\n\n    if ((*VAR_0)->sendPDVBuffer != NULL)\n        free((*VAR_0)->sendPDVBuffer);\n\n    free(*VAR_0);\n    *VAR_0 = NULL;\n\n    return VAR_2;\n}",
    "func_graph_path_before": "DCMTK/dcmtk/a9697dfeb672b0b9412c00c7d36d801e27ec85cb/assoc.cc/vul/before/0.json",
    "func": "OFCondition\nASC_destroyAssociation(T_ASC_Association ** association)\n{\n    OFCondition cond = EC_Normal;\n\n    /* don't worry if already destroyed */\n    if (association == NULL) return EC_Normal;\n    if (*association == NULL) return EC_Normal;\n\n    if ((*association)->DULassociation != NULL) {\n        ASC_dropAssociation(*association);\n    }\n\n    if ((*association)->params != NULL) {\n        ASC_destroyAssociationParameters(&(*association)->params);\n    }\n\n    if ((*association)->sendPDVBuffer != NULL)\n        free((*association)->sendPDVBuffer);\n\n    free(*association);\n    *association = NULL;\n\n    return EC_Normal;\n}",
    "abstract_func": "OFCondition\nASC_destroyAssociation(T_ASC_Association ** VAR_0)\n{\n    OFCondition VAR_1 = VAR_2;\n\n    /* COMMENT_0 */\n    if (VAR_0 == NULL) return VAR_2;\n    if (*VAR_0 == NULL) return VAR_2;\n\n    if ((*VAR_0)->DULassociation != NULL) {\n        ASC_dropAssociation(*VAR_0);\n    }\n\n    if ((*VAR_0)->params != NULL) {\n        ASC_destroyAssociationParameters(&(*VAR_0)->params);\n    }\n\n    if ((*VAR_0)->sendPDVBuffer != NULL)\n        free((*VAR_0)->sendPDVBuffer);\n\n    free(*VAR_0);\n    *VAR_0 = NULL;\n\n    return VAR_2;\n}",
    "func_graph_path": "DCMTK/dcmtk/a9697dfeb672b0b9412c00c7d36d801e27ec85cb/assoc.cc/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -12,8 +12,7 @@\n     }\n \n     if ((*association)->params != NULL) {\n-        cond = ASC_destroyAssociationParameters(&(*association)->params);\n-        if (cond.bad()) return cond;\n+        ASC_destroyAssociationParameters(&(*association)->params);\n     }\n \n     if ((*association)->sendPDVBuffer != NULL)",
    "diff_line_info": {
        "deleted_lines": [
            "        cond = ASC_destroyAssociationParameters(&(*association)->params);",
            "        if (cond.bad()) return cond;"
        ],
        "added_lines": [
            "        ASC_destroyAssociationParameters(&(*association)->params);"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}