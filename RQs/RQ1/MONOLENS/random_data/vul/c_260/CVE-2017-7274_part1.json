{
    "cve_id": "CVE-2017-7274",
    "cwe_ids": [
        "CWE-476"
    ],
    "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
    "cvss_is_v3": false,
    "repo_name": "radareorg/radare2",
    "commit_msg": "Fix #7152 - Null deref in cms",
    "commit_hash": "7ab66cca5bbdf6cb2d69339ef4f513d95e532dbf",
    "git_url": "https://github.com/radareorg/radare2/commit/7ab66cca5bbdf6cb2d69339ef4f513d95e532dbf",
    "file_path": "libr/util/r_pkcs7.c",
    "func_name": "r_pkcs7_parse_cms",
    "func_before": "RCMS *r_pkcs7_parse_cms (const ut8 *buffer, ut32 length) {\n\tRASN1Object *object;\n\tRCMS *container;\n\tif (!buffer || !length) {\n\t\treturn NULL;\n\t}\n\tcontainer = R_NEW0 (RCMS);\n\tif (!container) {\n\t\treturn NULL;\n\t}\n\tobject = r_asn1_create_object (buffer, length);\n\tif (!object || object->list.length != 2 || !object->list.objects[0] || object->list.objects[1]->list.length != 1) {\n\t\tr_asn1_free_object (object);\n\t\tfree (container);\n\t\treturn NULL;\n\t}\n\tcontainer->contentType = r_asn1_stringify_oid (object->list.objects[0]->sector, object->list.objects[0]->length);\n\tr_pkcs7_parse_signeddata (&container->signedData, object->list.objects[1]->list.objects[0]);\n\tr_asn1_free_object (object);\n\treturn container;\n}",
    "abstract_func_before": "RCMS *r_pkcs7_parse_cms (const ut8 *VAR_0, ut32 VAR_1) {\n\tRASN1Object *VAR_2;\n\tRCMS *VAR_3;\n\tif (!VAR_0 || !VAR_1) {\n\t\treturn NULL;\n\t}\n\tVAR_3 = R_NEW0 (RCMS);\n\tif (!VAR_3) {\n\t\treturn NULL;\n\t}\n\tVAR_2 = r_asn1_create_object (VAR_0, VAR_1);\n\tif (!VAR_2 || VAR_2->list.length != 2 || !VAR_2->list.objects[0] || VAR_2->list.objects[1]->list.length != 1) {\n\t\tr_asn1_free_object (VAR_2);\n\t\tfree (VAR_3);\n\t\treturn NULL;\n\t}\n\tVAR_3->contentType = r_asn1_stringify_oid (VAR_2->list.objects[0]->sector, VAR_2->list.objects[0]->length);\n\tr_pkcs7_parse_signeddata (&VAR_3->signedData, VAR_2->list.objects[1]->list.objects[0]);\n\tr_asn1_free_object (VAR_2);\n\treturn VAR_3;\n}",
    "func_graph_path_before": "radareorg/radare2/7ab66cca5bbdf6cb2d69339ef4f513d95e532dbf/r_pkcs7.c/vul/before/0.json",
    "func": "RCMS *r_pkcs7_parse_cms (const ut8 *buffer, ut32 length) {\n\tRASN1Object *object;\n\tRCMS *container;\n\tif (!buffer || !length) {\n\t\treturn NULL;\n\t}\n\tcontainer = R_NEW0 (RCMS);\n\tif (!container) {\n\t\treturn NULL;\n\t}\n\tobject = r_asn1_create_object (buffer, length);\n\tif (!object || object->list.length != 2 || !object->list.objects ||\n\t\t!object->list.objects[0] || !object->list.objects[1] ||\n\t\tobject->list.objects[1]->list.length != 1) {\n\t\tr_asn1_free_object (object);\n\t\tfree (container);\n\t\treturn NULL;\n\t}\n\tcontainer->contentType = r_asn1_stringify_oid (object->list.objects[0]->sector, object->list.objects[0]->length);\n\tr_pkcs7_parse_signeddata (&container->signedData, object->list.objects[1]->list.objects[0]);\n\tr_asn1_free_object (object);\n\treturn container;\n}",
    "abstract_func": "RCMS *r_pkcs7_parse_cms (const ut8 *VAR_0, ut32 VAR_1) {\n\tRASN1Object *VAR_2;\n\tRCMS *VAR_3;\n\tif (!VAR_0 || !VAR_1) {\n\t\treturn NULL;\n\t}\n\tVAR_3 = R_NEW0 (RCMS);\n\tif (!VAR_3) {\n\t\treturn NULL;\n\t}\n\tVAR_2 = r_asn1_create_object (VAR_0, VAR_1);\n\tif (!VAR_2 || VAR_2->list.length != 2 || !VAR_2->list.objects ||\n\t\t!VAR_2->list.objects[0] || !VAR_2->list.objects[1] ||\n\t\tVAR_2->list.objects[1]->list.length != 1) {\n\t\tr_asn1_free_object (VAR_2);\n\t\tfree (VAR_3);\n\t\treturn NULL;\n\t}\n\tVAR_3->contentType = r_asn1_stringify_oid (VAR_2->list.objects[0]->sector, VAR_2->list.objects[0]->length);\n\tr_pkcs7_parse_signeddata (&VAR_3->signedData, VAR_2->list.objects[1]->list.objects[0]);\n\tr_asn1_free_object (VAR_2);\n\treturn VAR_3;\n}",
    "func_graph_path": "radareorg/radare2/7ab66cca5bbdf6cb2d69339ef4f513d95e532dbf/r_pkcs7.c/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -9,7 +9,9 @@\n \t\treturn NULL;\n \t}\n \tobject = r_asn1_create_object (buffer, length);\n-\tif (!object || object->list.length != 2 || !object->list.objects[0] || object->list.objects[1]->list.length != 1) {\n+\tif (!object || object->list.length != 2 || !object->list.objects ||\n+\t\t!object->list.objects[0] || !object->list.objects[1] ||\n+\t\tobject->list.objects[1]->list.length != 1) {\n \t\tr_asn1_free_object (object);\n \t\tfree (container);\n \t\treturn NULL;",
    "diff_line_info": {
        "deleted_lines": [
            "\tif (!object || object->list.length != 2 || !object->list.objects[0] || object->list.objects[1]->list.length != 1) {"
        ],
        "added_lines": [
            "\tif (!object || object->list.length != 2 || !object->list.objects ||",
            "\t\t!object->list.objects[0] || !object->list.objects[1] ||",
            "\t\tobject->list.objects[1]->list.length != 1) {"
        ]
    },
    "is_vul": true,
    "pr_url": "https://github.com/radareorg/radare2/pull/7153",
    "description": "Fix #7152"
}