{
    "cve_id": "CVE-2017-7264",
    "cwe_ids": [
        "CWE-416",
        "CWE-125"
    ],
    "cvss_vector": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
    "cvss_is_v3": false,
    "repo_name": "ArtifexSoftware/mupdf",
    "commit_msg": "bug 697515: Fix out of bounds read in fz_subsample_pixmap\n\nPointer arithmetic for final special case was going wrong.",
    "commit_hash": "2c4e5867ee699b1081527bc6c6ea0e99a35a5c27",
    "git_url": "https://github.com/ArtifexSoftware/mupdf/commit/2c4e5867ee699b1081527bc6c6ea0e99a35a5c27",
    "file_path": "source/fitz/pixmap.c",
    "func_name": "fz_subsample_pixmap_ARM",
    "func_before": "static void\nfz_subsample_pixmap_ARM(unsigned char *ptr, int w, int h, int f, int factor,\n\t\t\tint n, int fwd, int back, int back2, int fwd2,\n\t\t\tint divX, int back4, int fwd4, int fwd3,\n\t\t\tint divY, int back5, int divXY)\n{\n\tasm volatile(\n\tENTER_ARM\n\t\"stmfd\tr13!,{r1,r4-r11,r14}\t\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"@ r0 = src = ptr\t\t\t\t\t\t\\n\"\n\t\"@ r1 = w\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = h\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"mov\tr9, r0\t\t\t@ r9 = dst = ptr\t\t\\n\"\n\t\"ldr\tr6, [r13,#4*12]\t\t@ r6 = fwd\t\t\t\\n\"\n\t\"ldr\tr7, [r13,#4*13]\t\t@ r7 = back\t\t\t\\n\"\n\t\"subs\tr2, r2, r3\t\t@ r2 = h -= f\t\t\t\\n\"\n\t\"blt\t11f\t\t\t@ Skip if less than a full row\t\\n\"\n\t\"1:\t\t\t\t@ for (y = h; y > 0; y--) {\t\\n\"\n\t\"ldr\tr1, [r13]\t\t@ r1 = w\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ r1 = w -= f\t\t\t\\n\"\n\t\"blt\t6f\t\t\t@ Skip if less than a full col\t\\n\"\n\t\"ldr\tr4, [r13,#4*10]\t\t@ r4 = factor\t\t\t\\n\"\n\t\"ldr\tr8, [r13,#4*14]\t\t@ r8 = back2\t\t\t\\n\"\n\t\"ldr\tr12,[r13,#4*15]\t\t@ r12= fwd2\t\t\t\\n\"\n\t\"2:\t\t\t\t@ for (x = w; x > 0; x--) {\t\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"3:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r3, LSL #8\t@ for (xx = f; xx > 0; x--) {\t\\n\"\n\t\"4:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r3, LSL #16\t@ for (yy = f; yy > 0; y--) {\t\\n\"\n\t\"5:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0], r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t5b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t4b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mov\tr14,r14,LSR r4\t\t@ r14 = v >>= factor\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back2\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t3b\t\t\t@ }\t\t\t\t\\n\"\n\t\"add\tr0, r0, r12\t\t@ s += fwd2\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ x -= f\t\t\t\\n\"\n\t\"bge\t2b\t\t\t@ }\t\t\t\t\\n\"\n\t\"6:\t\t\t\t@ Less than a full column left\t\\n\"\n\t\"adds\tr1, r1, r3\t\t@ x += f\t\t\t\\n\"\n\t\"beq\t11f\t\t\t@ if (x == 0) next row\t\t\\n\"\n\t\"@ r0 = src\t\t\t\t\t\t\t\\n\"\n\t\"@ r1 = x\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = y\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"@ r4 = factor\t\t\t\t\t\t\t\\n\"\n\t\"@ r6 = fwd\t\t\t\t\t\t\t\\n\"\n\t\"@ r7 = back\t\t\t\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"ldr\tr4, [r13,#4*16]\t\t@ r4 = divX\t\t\t\\n\"\n\t\"ldr\tr8, [r13,#4*17]\t\t@ r8 = back4\t\t\t\\n\"\n\t\"ldr\tr12,[r13,#4*18]\t\t@ r12= fwd4\t\t\t\\n\"\n\t\"8:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r1, LSL #8\t@ for (xx = x; xx > 0; x--) {\t\\n\"\n\t\"9:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r3, LSL #16\t@ for (yy = f; yy > 0; y--) {\t\\n\"\n\t\"10:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0], r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t10b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t9b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mul\tr14,r4, r14\t\t@ r14= v *= divX\t\t\\n\"\n\t\"mov\tr14,r14,LSR #16\t\t@ r14= v >>= 16\t\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back4\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t8b\t\t\t@ }\t\t\t\t\\n\"\n\t\"add\tr0, r0, r12\t\t@ s += fwd4\t\t\t\\n\"\n\t\"11:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldr\tr14,[r13,#4*19]\t\t@ r14 = fwd3\t\t\t\\n\"\n\t\"subs\tr2, r2, r3\t\t@ h -= f\t\t\t\\n\"\n\t\"add\tr0, r0, r14\t\t@ s += fwd3\t\t\t\\n\"\n\t\"bge\t1b\t\t\t@ }\t\t\t\t\\n\"\n\t\"adds\tr2, r2, r3\t\t@ h += f\t\t\t\\n\"\n\t\"beq\t21f\t\t\t@ if no stray row, end\t\t\\n\"\n\t\"@ So doing one last (partial) row\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"@ r0 = src = ptr\t\t\t\t\t\t\\n\"\n\t\"@ r1 = w\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = h\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"@ r4 = factor\t\t\t\t\t\t\t\\n\"\n\t\"@ r5 = n\t\t\t\t\t\t\t\\n\"\n\t\"@ r6 = fwd\t\t\t\t\t\t\t\\n\"\n\t\"12:\t\t\t\t@ for (y = h; y > 0; y--) {\t\\n\"\n\t\"ldr\tr1, [r13]\t\t@ r1 = w\t\t\t\\n\"\n\t\"ldr\tr7, [r13,#4*21]\t\t@ r7 = back5\t\t\t\\n\"\n\t\"ldr\tr8, [r13,#4*14]\t\t@ r8 = back2\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ r1 = w -= f\t\t\t\\n\"\n\t\"blt\t17f\t\t\t@ Skip if less than a full col\t\\n\"\n\t\"ldr\tr4, [r13,#4*20]\t\t@ r4 = divY\t\t\t\\n\"\n\t\"ldr\tr12,[r13,#4*15]\t\t@ r12= fwd2\t\t\t\\n\"\n\t\"13:\t\t\t\t@ for (x = w; x > 0; x--) {\t\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"14:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r3, LSL #8\t@ for (xx = f; xx > 0; x--) {\t\\n\"\n\t\"15:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r2, LSL #16\t@ for (yy = y; yy > 0; y--) {\t\\n\"\n\t\"16:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0], r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t16b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back5\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t15b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mul\tr14,r4, r14\t\t@ r14 = x *= divY\t\t\\n\"\n\t\"mov\tr14,r14,LSR #16\t\t@ r14 = v >>= 16\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back2\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t14b\t\t\t@ }\t\t\t\t\\n\"\n\t\"add\tr0, r0, r12\t\t@ s += fwd2\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ x -= f\t\t\t\\n\"\n\t\"bge\t13b\t\t\t@ }\t\t\t\t\\n\"\n\t\"17:\t\t\t\t@ Less than a full column left\t\\n\"\n\t\"adds\tr1, r1, r3\t\t@ x += f\t\t\t\\n\"\n\t\"beq\t21f\t\t\t@ if (x == 0) end\t\t\\n\"\n\t\"@ r0 = src\t\t\t\t\t\t\t\\n\"\n\t\"@ r1 = x\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = y\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"@ r4 = factor\t\t\t\t\t\t\t\\n\"\n\t\"@ r6 = fwd\t\t\t\t\t\t\t\\n\"\n\t\"@ r7 = back5\t\t\t\t\t\t\t\\n\"\n\t\"@ r8 = back2\t\t\t\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"ldr\tr4, [r13,#4*22]\t\t@ r4 = divXY\t\t\t\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"18:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r1, LSL #8\t@ for (xx = x; xx > 0; x--) {\t\\n\"\n\t\"19:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r2, LSL #16\t@ for (yy = y; yy > 0; y--) {\t\\n\"\n\t\"20:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0],r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t20b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back5\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t19b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mul\tr14,r4, r14\t\t@ r14= v *= divX\t\t\\n\"\n\t\"mov\tr14,r14,LSR #16\t\t@ r14= v >>= 16\t\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back2\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t18b\t\t\t@ }\t\t\t\t\\n\"\n\t\"21:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldmfd\tr13!,{r1,r4-r11,PC}\t@ pop, return to thumb\t\t\\n\"\n\tENTER_THUMB\n\t);\n}",
    "abstract_func_before": "static void\nfz_subsample_pixmap_ARM(unsigned char *VAR_0, int VAR_1, int VAR_2, int VAR_3, int VAR_4,\n\t\t\tint VAR_5, int VAR_6, int VAR_7, int VAR_8, int VAR_9,\n\t\t\tint VAR_10, int VAR_11, int VAR_12, int VAR_13,\n\t\t\tint VAR_14, int VAR_15, int VAR_16)\n{\n\tasm volatile(\n\tVAR_17\n\t\"stmfd\tr13!,{r1,r4-r11,r14}\t\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"@ r0 = src = ptr\t\t\t\t\t\t\\n\"\n\t\"@ r1 = w\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = h\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"mov\tr9, r0\t\t\t@ r9 = dst = ptr\t\t\\n\"\n\t\"ldr\tr6, [r13,#4*12]\t\t@ r6 = fwd\t\t\t\\n\"\n\t\"ldr\tr7, [r13,#4*13]\t\t@ r7 = back\t\t\t\\n\"\n\t\"subs\tr2, r2, r3\t\t@ r2 = h -= f\t\t\t\\n\"\n\t\"blt\t11f\t\t\t@ Skip if less than a full row\t\\n\"\n\t\"1:\t\t\t\t@ for (y = h; y > 0; y--) {\t\\n\"\n\t\"ldr\tr1, [r13]\t\t@ r1 = w\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ r1 = w -= f\t\t\t\\n\"\n\t\"blt\t6f\t\t\t@ Skip if less than a full col\t\\n\"\n\t\"ldr\tr4, [r13,#4*10]\t\t@ r4 = factor\t\t\t\\n\"\n\t\"ldr\tr8, [r13,#4*14]\t\t@ r8 = back2\t\t\t\\n\"\n\t\"ldr\tr12,[r13,#4*15]\t\t@ r12= fwd2\t\t\t\\n\"\n\t\"2:\t\t\t\t@ for (x = w; x > 0; x--) {\t\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"3:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r3, LSL #8\t@ for (xx = f; xx > 0; x--) {\t\\n\"\n\t\"4:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r3, LSL #16\t@ for (yy = f; yy > 0; y--) {\t\\n\"\n\t\"5:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0], r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t5b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t4b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mov\tr14,r14,LSR r4\t\t@ r14 = v >>= factor\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back2\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t3b\t\t\t@ }\t\t\t\t\\n\"\n\t\"add\tr0, r0, r12\t\t@ s += fwd2\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ x -= f\t\t\t\\n\"\n\t\"bge\t2b\t\t\t@ }\t\t\t\t\\n\"\n\t\"6:\t\t\t\t@ Less than a full column left\t\\n\"\n\t\"adds\tr1, r1, r3\t\t@ x += f\t\t\t\\n\"\n\t\"beq\t11f\t\t\t@ if (x == 0) next row\t\t\\n\"\n\t\"@ r0 = src\t\t\t\t\t\t\t\\n\"\n\t\"@ r1 = x\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = y\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"@ r4 = factor\t\t\t\t\t\t\t\\n\"\n\t\"@ r6 = fwd\t\t\t\t\t\t\t\\n\"\n\t\"@ r7 = back\t\t\t\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"ldr\tr4, [r13,#4*16]\t\t@ r4 = divX\t\t\t\\n\"\n\t\"ldr\tr8, [r13,#4*17]\t\t@ r8 = back4\t\t\t\\n\"\n\t\"ldr\tr12,[r13,#4*18]\t\t@ r12= fwd4\t\t\t\\n\"\n\t\"8:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r1, LSL #8\t@ for (xx = x; xx > 0; x--) {\t\\n\"\n\t\"9:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r3, LSL #16\t@ for (yy = f; yy > 0; y--) {\t\\n\"\n\t\"10:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0], r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t10b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t9b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mul\tr14,r4, r14\t\t@ r14= v *= divX\t\t\\n\"\n\t\"mov\tr14,r14,LSR #16\t\t@ r14= v >>= 16\t\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back4\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t8b\t\t\t@ }\t\t\t\t\\n\"\n\t\"add\tr0, r0, r12\t\t@ s += fwd4\t\t\t\\n\"\n\t\"11:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldr\tr14,[r13,#4*19]\t\t@ r14 = fwd3\t\t\t\\n\"\n\t\"subs\tr2, r2, r3\t\t@ h -= f\t\t\t\\n\"\n\t\"add\tr0, r0, r14\t\t@ s += fwd3\t\t\t\\n\"\n\t\"bge\t1b\t\t\t@ }\t\t\t\t\\n\"\n\t\"adds\tr2, r2, r3\t\t@ h += f\t\t\t\\n\"\n\t\"beq\t21f\t\t\t@ if no stray row, end\t\t\\n\"\n\t\"@ So doing one last (partial) row\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"@ r0 = src = ptr\t\t\t\t\t\t\\n\"\n\t\"@ r1 = w\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = h\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"@ r4 = factor\t\t\t\t\t\t\t\\n\"\n\t\"@ r5 = n\t\t\t\t\t\t\t\\n\"\n\t\"@ r6 = fwd\t\t\t\t\t\t\t\\n\"\n\t\"12:\t\t\t\t@ for (y = h; y > 0; y--) {\t\\n\"\n\t\"ldr\tr1, [r13]\t\t@ r1 = w\t\t\t\\n\"\n\t\"ldr\tr7, [r13,#4*21]\t\t@ r7 = back5\t\t\t\\n\"\n\t\"ldr\tr8, [r13,#4*14]\t\t@ r8 = back2\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ r1 = w -= f\t\t\t\\n\"\n\t\"blt\t17f\t\t\t@ Skip if less than a full col\t\\n\"\n\t\"ldr\tr4, [r13,#4*20]\t\t@ r4 = divY\t\t\t\\n\"\n\t\"ldr\tr12,[r13,#4*15]\t\t@ r12= fwd2\t\t\t\\n\"\n\t\"13:\t\t\t\t@ for (x = w; x > 0; x--) {\t\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"14:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r3, LSL #8\t@ for (xx = f; xx > 0; x--) {\t\\n\"\n\t\"15:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r2, LSL #16\t@ for (yy = y; yy > 0; y--) {\t\\n\"\n\t\"16:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0], r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t16b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back5\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t15b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mul\tr14,r4, r14\t\t@ r14 = x *= divY\t\t\\n\"\n\t\"mov\tr14,r14,LSR #16\t\t@ r14 = v >>= 16\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back2\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t14b\t\t\t@ }\t\t\t\t\\n\"\n\t\"add\tr0, r0, r12\t\t@ s += fwd2\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ x -= f\t\t\t\\n\"\n\t\"bge\t13b\t\t\t@ }\t\t\t\t\\n\"\n\t\"17:\t\t\t\t@ Less than a full column left\t\\n\"\n\t\"adds\tr1, r1, r3\t\t@ x += f\t\t\t\\n\"\n\t\"beq\t21f\t\t\t@ if (x == 0) end\t\t\\n\"\n\t\"@ r0 = src\t\t\t\t\t\t\t\\n\"\n\t\"@ r1 = x\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = y\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"@ r4 = factor\t\t\t\t\t\t\t\\n\"\n\t\"@ r6 = fwd\t\t\t\t\t\t\t\\n\"\n\t\"@ r7 = back5\t\t\t\t\t\t\t\\n\"\n\t\"@ r8 = back2\t\t\t\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"ldr\tr4, [r13,#4*22]\t\t@ r4 = divXY\t\t\t\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"18:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r1, LSL #8\t@ for (xx = x; xx > 0; x--) {\t\\n\"\n\t\"19:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r2, LSL #16\t@ for (yy = y; yy > 0; y--) {\t\\n\"\n\t\"20:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0],r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t20b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back5\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t19b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mul\tr14,r4, r14\t\t@ r14= v *= divX\t\t\\n\"\n\t\"mov\tr14,r14,LSR #16\t\t@ r14= v >>= 16\t\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back2\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t18b\t\t\t@ }\t\t\t\t\\n\"\n\t\"21:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldmfd\tr13!,{r1,r4-r11,PC}\t@ pop, return to thumb\t\t\\n\"\n\tVAR_18\n\t);\n}",
    "func_graph_path_before": "ArtifexSoftware/mupdf/2c4e5867ee699b1081527bc6c6ea0e99a35a5c27/pixmap.c/vul/before/1.json",
    "func": "static void\nfz_subsample_pixmap_ARM(unsigned char *ptr, int w, int h, int f, int factor,\n\t\t\tint n, int fwd, int back, int back2, int fwd2,\n\t\t\tint divX, int back4, int fwd4, int fwd3,\n\t\t\tint divY, int back5, int divXY)\n{\n\tasm volatile(\n\tENTER_ARM\n\t\"stmfd\tr13!,{r1,r4-r11,r14}\t\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"@ r0 = src = ptr\t\t\t\t\t\t\\n\"\n\t\"@ r1 = w\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = h\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"mov\tr9, r0\t\t\t@ r9 = dst = ptr\t\t\\n\"\n\t\"ldr\tr6, [r13,#4*12]\t\t@ r6 = fwd\t\t\t\\n\"\n\t\"ldr\tr7, [r13,#4*13]\t\t@ r7 = back\t\t\t\\n\"\n\t\"subs\tr2, r2, r3\t\t@ r2 = h -= f\t\t\t\\n\"\n\t\"blt\t11f\t\t\t@ Skip if less than a full row\t\\n\"\n\t\"1:\t\t\t\t@ for (y = h; y > 0; y--) {\t\\n\"\n\t\"ldr\tr1, [r13]\t\t@ r1 = w\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ r1 = w -= f\t\t\t\\n\"\n\t\"blt\t6f\t\t\t@ Skip if less than a full col\t\\n\"\n\t\"ldr\tr4, [r13,#4*10]\t\t@ r4 = factor\t\t\t\\n\"\n\t\"ldr\tr8, [r13,#4*14]\t\t@ r8 = back2\t\t\t\\n\"\n\t\"ldr\tr12,[r13,#4*15]\t\t@ r12= fwd2\t\t\t\\n\"\n\t\"2:\t\t\t\t@ for (x = w; x > 0; x--) {\t\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"3:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r3, LSL #8\t@ for (xx = f; xx > 0; x--) {\t\\n\"\n\t\"4:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r3, LSL #16\t@ for (yy = f; yy > 0; y--) {\t\\n\"\n\t\"5:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0], r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t5b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t4b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mov\tr14,r14,LSR r4\t\t@ r14 = v >>= factor\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back2\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t3b\t\t\t@ }\t\t\t\t\\n\"\n\t\"add\tr0, r0, r12\t\t@ s += fwd2\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ x -= f\t\t\t\\n\"\n\t\"bge\t2b\t\t\t@ }\t\t\t\t\\n\"\n\t\"6:\t\t\t\t@ Less than a full column left\t\\n\"\n\t\"adds\tr1, r1, r3\t\t@ x += f\t\t\t\\n\"\n\t\"beq\t11f\t\t\t@ if (x == 0) next row\t\t\\n\"\n\t\"@ r0 = src\t\t\t\t\t\t\t\\n\"\n\t\"@ r1 = x\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = y\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"@ r4 = factor\t\t\t\t\t\t\t\\n\"\n\t\"@ r6 = fwd\t\t\t\t\t\t\t\\n\"\n\t\"@ r7 = back\t\t\t\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"ldr\tr4, [r13,#4*16]\t\t@ r4 = divX\t\t\t\\n\"\n\t\"ldr\tr8, [r13,#4*17]\t\t@ r8 = back4\t\t\t\\n\"\n\t\"ldr\tr12,[r13,#4*18]\t\t@ r12= fwd4\t\t\t\\n\"\n\t\"8:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r1, LSL #8\t@ for (xx = x; xx > 0; x--) {\t\\n\"\n\t\"9:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r3, LSL #16\t@ for (yy = f; yy > 0; y--) {\t\\n\"\n\t\"10:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0], r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t10b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t9b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mul\tr14,r4, r14\t\t@ r14= v *= divX\t\t\\n\"\n\t\"mov\tr14,r14,LSR #16\t\t@ r14= v >>= 16\t\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back4\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t8b\t\t\t@ }\t\t\t\t\\n\"\n\t\"add\tr0, r0, r12\t\t@ s += fwd4\t\t\t\\n\"\n\t\"11:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldr\tr14,[r13,#4*19]\t\t@ r14 = fwd3\t\t\t\\n\"\n\t\"subs\tr2, r2, r3\t\t@ h -= f\t\t\t\\n\"\n\t\"add\tr0, r0, r14\t\t@ s += fwd3\t\t\t\\n\"\n\t\"bge\t1b\t\t\t@ }\t\t\t\t\\n\"\n\t\"adds\tr2, r2, r3\t\t@ h += f\t\t\t\\n\"\n\t\"beq\t21f\t\t\t@ if no stray row, end\t\t\\n\"\n\t\"@ So doing one last (partial) row\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"@ r0 = src = ptr\t\t\t\t\t\t\\n\"\n\t\"@ r1 = w\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = h\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"@ r4 = factor\t\t\t\t\t\t\t\\n\"\n\t\"@ r5 = n\t\t\t\t\t\t\t\\n\"\n\t\"@ r6 = fwd\t\t\t\t\t\t\t\\n\"\n\t\"12:\t\t\t\t@ for (y = h; y > 0; y--) {\t\\n\"\n\t\"ldr\tr1, [r13]\t\t@ r1 = w\t\t\t\\n\"\n\t\"ldr\tr7, [r13,#4*21]\t\t@ r7 = back5\t\t\t\\n\"\n\t\"ldr\tr8, [r13,#4*14]\t\t@ r8 = back2\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ r1 = w -= f\t\t\t\\n\"\n\t\"blt\t17f\t\t\t@ Skip if less than a full col\t\\n\"\n\t\"ldr\tr4, [r13,#4*20]\t\t@ r4 = divY\t\t\t\\n\"\n\t\"ldr\tr12,[r13,#4*15]\t\t@ r12= fwd2\t\t\t\\n\"\n\t\"13:\t\t\t\t@ for (x = w; x > 0; x--) {\t\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"14:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r3, LSL #8\t@ for (xx = f; xx > 0; x--) {\t\\n\"\n\t\"15:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r2, LSL #16\t@ for (yy = y; yy > 0; y--) {\t\\n\"\n\t\"16:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0], r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t16b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back5\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t15b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mul\tr14,r4, r14\t\t@ r14 = x *= divY\t\t\\n\"\n\t\"mov\tr14,r14,LSR #16\t\t@ r14 = v >>= 16\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back2\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t14b\t\t\t@ }\t\t\t\t\\n\"\n\t\"add\tr0, r0, r12\t\t@ s += fwd2\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ x -= f\t\t\t\\n\"\n\t\"bge\t13b\t\t\t@ }\t\t\t\t\\n\"\n\t\"17:\t\t\t\t@ Less than a full column left\t\\n\"\n\t\"adds\tr1, r1, r3\t\t@ x += f\t\t\t\\n\"\n\t\"beq\t21f\t\t\t@ if (x == 0) end\t\t\\n\"\n\t\"@ r0 = src\t\t\t\t\t\t\t\\n\"\n\t\"@ r1 = x\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = y\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"@ r4 = factor\t\t\t\t\t\t\t\\n\"\n\t\"@ r6 = fwd\t\t\t\t\t\t\t\\n\"\n\t\"@ r7 = back5\t\t\t\t\t\t\t\\n\"\n\t\"@ r8 = back2\t\t\t\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"ldr\tr4, [r13,#4*22]\t\t@ r4 = divXY\t\t\t\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"ldr\tr8, [r13,#4*17]\t\t@ r8 = back4\t\t\t\\n\"\n\t\"18:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r1, LSL #8\t@ for (xx = x; xx > 0; x--) {\t\\n\"\n\t\"19:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r2, LSL #16\t@ for (yy = y; yy > 0; y--) {\t\\n\"\n\t\"20:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0],r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t20b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back5\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t19b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mul\tr14,r4, r14\t\t@ r14= v *= divX\t\t\\n\"\n\t\"mov\tr14,r14,LSR #16\t\t@ r14= v >>= 16\t\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back4\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t18b\t\t\t@ }\t\t\t\t\\n\"\n\t\"21:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldmfd\tr13!,{r1,r4-r11,PC}\t@ pop, return to thumb\t\t\\n\"\n\tENTER_THUMB\n\t);\n}",
    "abstract_func": "static void\nfz_subsample_pixmap_ARM(unsigned char *VAR_0, int VAR_1, int VAR_2, int VAR_3, int VAR_4,\n\t\t\tint VAR_5, int VAR_6, int VAR_7, int VAR_8, int VAR_9,\n\t\t\tint VAR_10, int VAR_11, int VAR_12, int VAR_13,\n\t\t\tint VAR_14, int VAR_15, int VAR_16)\n{\n\tasm volatile(\n\tVAR_17\n\t\"stmfd\tr13!,{r1,r4-r11,r14}\t\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"@ r0 = src = ptr\t\t\t\t\t\t\\n\"\n\t\"@ r1 = w\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = h\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"mov\tr9, r0\t\t\t@ r9 = dst = ptr\t\t\\n\"\n\t\"ldr\tr6, [r13,#4*12]\t\t@ r6 = fwd\t\t\t\\n\"\n\t\"ldr\tr7, [r13,#4*13]\t\t@ r7 = back\t\t\t\\n\"\n\t\"subs\tr2, r2, r3\t\t@ r2 = h -= f\t\t\t\\n\"\n\t\"blt\t11f\t\t\t@ Skip if less than a full row\t\\n\"\n\t\"1:\t\t\t\t@ for (y = h; y > 0; y--) {\t\\n\"\n\t\"ldr\tr1, [r13]\t\t@ r1 = w\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ r1 = w -= f\t\t\t\\n\"\n\t\"blt\t6f\t\t\t@ Skip if less than a full col\t\\n\"\n\t\"ldr\tr4, [r13,#4*10]\t\t@ r4 = factor\t\t\t\\n\"\n\t\"ldr\tr8, [r13,#4*14]\t\t@ r8 = back2\t\t\t\\n\"\n\t\"ldr\tr12,[r13,#4*15]\t\t@ r12= fwd2\t\t\t\\n\"\n\t\"2:\t\t\t\t@ for (x = w; x > 0; x--) {\t\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"3:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r3, LSL #8\t@ for (xx = f; xx > 0; x--) {\t\\n\"\n\t\"4:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r3, LSL #16\t@ for (yy = f; yy > 0; y--) {\t\\n\"\n\t\"5:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0], r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t5b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t4b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mov\tr14,r14,LSR r4\t\t@ r14 = v >>= factor\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back2\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t3b\t\t\t@ }\t\t\t\t\\n\"\n\t\"add\tr0, r0, r12\t\t@ s += fwd2\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ x -= f\t\t\t\\n\"\n\t\"bge\t2b\t\t\t@ }\t\t\t\t\\n\"\n\t\"6:\t\t\t\t@ Less than a full column left\t\\n\"\n\t\"adds\tr1, r1, r3\t\t@ x += f\t\t\t\\n\"\n\t\"beq\t11f\t\t\t@ if (x == 0) next row\t\t\\n\"\n\t\"@ r0 = src\t\t\t\t\t\t\t\\n\"\n\t\"@ r1 = x\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = y\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"@ r4 = factor\t\t\t\t\t\t\t\\n\"\n\t\"@ r6 = fwd\t\t\t\t\t\t\t\\n\"\n\t\"@ r7 = back\t\t\t\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"ldr\tr4, [r13,#4*16]\t\t@ r4 = divX\t\t\t\\n\"\n\t\"ldr\tr8, [r13,#4*17]\t\t@ r8 = back4\t\t\t\\n\"\n\t\"ldr\tr12,[r13,#4*18]\t\t@ r12= fwd4\t\t\t\\n\"\n\t\"8:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r1, LSL #8\t@ for (xx = x; xx > 0; x--) {\t\\n\"\n\t\"9:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r3, LSL #16\t@ for (yy = f; yy > 0; y--) {\t\\n\"\n\t\"10:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0], r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t10b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t9b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mul\tr14,r4, r14\t\t@ r14= v *= divX\t\t\\n\"\n\t\"mov\tr14,r14,LSR #16\t\t@ r14= v >>= 16\t\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back4\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t8b\t\t\t@ }\t\t\t\t\\n\"\n\t\"add\tr0, r0, r12\t\t@ s += fwd4\t\t\t\\n\"\n\t\"11:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldr\tr14,[r13,#4*19]\t\t@ r14 = fwd3\t\t\t\\n\"\n\t\"subs\tr2, r2, r3\t\t@ h -= f\t\t\t\\n\"\n\t\"add\tr0, r0, r14\t\t@ s += fwd3\t\t\t\\n\"\n\t\"bge\t1b\t\t\t@ }\t\t\t\t\\n\"\n\t\"adds\tr2, r2, r3\t\t@ h += f\t\t\t\\n\"\n\t\"beq\t21f\t\t\t@ if no stray row, end\t\t\\n\"\n\t\"@ So doing one last (partial) row\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"@ r0 = src = ptr\t\t\t\t\t\t\\n\"\n\t\"@ r1 = w\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = h\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"@ r4 = factor\t\t\t\t\t\t\t\\n\"\n\t\"@ r5 = n\t\t\t\t\t\t\t\\n\"\n\t\"@ r6 = fwd\t\t\t\t\t\t\t\\n\"\n\t\"12:\t\t\t\t@ for (y = h; y > 0; y--) {\t\\n\"\n\t\"ldr\tr1, [r13]\t\t@ r1 = w\t\t\t\\n\"\n\t\"ldr\tr7, [r13,#4*21]\t\t@ r7 = back5\t\t\t\\n\"\n\t\"ldr\tr8, [r13,#4*14]\t\t@ r8 = back2\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ r1 = w -= f\t\t\t\\n\"\n\t\"blt\t17f\t\t\t@ Skip if less than a full col\t\\n\"\n\t\"ldr\tr4, [r13,#4*20]\t\t@ r4 = divY\t\t\t\\n\"\n\t\"ldr\tr12,[r13,#4*15]\t\t@ r12= fwd2\t\t\t\\n\"\n\t\"13:\t\t\t\t@ for (x = w; x > 0; x--) {\t\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"14:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r3, LSL #8\t@ for (xx = f; xx > 0; x--) {\t\\n\"\n\t\"15:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r2, LSL #16\t@ for (yy = y; yy > 0; y--) {\t\\n\"\n\t\"16:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0], r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t16b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back5\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t15b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mul\tr14,r4, r14\t\t@ r14 = x *= divY\t\t\\n\"\n\t\"mov\tr14,r14,LSR #16\t\t@ r14 = v >>= 16\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back2\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t14b\t\t\t@ }\t\t\t\t\\n\"\n\t\"add\tr0, r0, r12\t\t@ s += fwd2\t\t\t\\n\"\n\t\"subs\tr1, r1, r3\t\t@ x -= f\t\t\t\\n\"\n\t\"bge\t13b\t\t\t@ }\t\t\t\t\\n\"\n\t\"17:\t\t\t\t@ Less than a full column left\t\\n\"\n\t\"adds\tr1, r1, r3\t\t@ x += f\t\t\t\\n\"\n\t\"beq\t21f\t\t\t@ if (x == 0) end\t\t\\n\"\n\t\"@ r0 = src\t\t\t\t\t\t\t\\n\"\n\t\"@ r1 = x\t\t\t\t\t\t\t\\n\"\n\t\"@ r2 = y\t\t\t\t\t\t\t\\n\"\n\t\"@ r3 = f\t\t\t\t\t\t\t\\n\"\n\t\"@ r4 = factor\t\t\t\t\t\t\t\\n\"\n\t\"@ r6 = fwd\t\t\t\t\t\t\t\\n\"\n\t\"@ r7 = back5\t\t\t\t\t\t\t\\n\"\n\t\"@ r8 = back2\t\t\t\t\t\t\t\\n\"\n\t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n\t\"ldr\tr4, [r13,#4*22]\t\t@ r4 = divXY\t\t\t\\n\"\n\t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n\t\"ldr\tr8, [r13,#4*17]\t\t@ r8 = back4\t\t\t\\n\"\n\t\"18:\t\t\t\t@\t\t\t\t\\n\"\n\t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n\t\"sub\tr5, r5, r1, LSL #8\t@ for (xx = x; xx > 0; x--) {\t\\n\"\n\t\"19:\t\t\t\t@\t\t\t\t\\n\"\n\t\"add\tr5, r5, r2, LSL #16\t@ for (yy = y; yy > 0; y--) {\t\\n\"\n\t\"20:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldrb\tr11,[r0],r6\t\t@ r11= *src\tsrc += fwd\t\\n\"\n\t\"subs\tr5, r5, #1<<16\t\t@ xx--\t\t\t\t\\n\"\n\t\"add\tr14,r14,r11\t\t@ v += r11\t\t\t\\n\"\n\t\"bgt\t20b\t\t\t@ }\t\t\t\t\\n\"\n\t\"sub\tr0, r0, r7\t\t@ src -= back5\t\t\t\\n\"\n\t\"adds\tr5, r5, #1<<8\t\t@ yy--\t\t\t\t\\n\"\n\t\"blt\t19b\t\t\t@ }\t\t\t\t\\n\"\n\t\"mul\tr14,r4, r14\t\t@ r14= v *= divX\t\t\\n\"\n\t\"mov\tr14,r14,LSR #16\t\t@ r14= v >>= 16\t\t\t\\n\"\n\t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n\t\"sub\tr0, r0, r8\t\t@ s -= back4\t\t\t\\n\"\n\t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n\t\"bgt\t18b\t\t\t@ }\t\t\t\t\\n\"\n\t\"21:\t\t\t\t@\t\t\t\t\\n\"\n\t\"ldmfd\tr13!,{r1,r4-r11,PC}\t@ pop, return to thumb\t\t\\n\"\n\tVAR_18\n\t);\n}",
    "func_graph_path": "ArtifexSoftware/mupdf/2c4e5867ee699b1081527bc6c6ea0e99a35a5c27/pixmap.c/vul/after/1.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -144,6 +144,7 @@\n \t\"@STACK:r1,<9>,factor,n,fwd,back,back2,fwd2,divX,back4,fwd4,fwd3,divY,back5,divXY\\n\"\n \t\"ldr\tr4, [r13,#4*22]\t\t@ r4 = divXY\t\t\t\\n\"\n \t\"ldr\tr5, [r13,#4*11]\t\t@ for (nn = n; nn > 0; n--) {\t\\n\"\n+\t\"ldr\tr8, [r13,#4*17]\t\t@ r8 = back4\t\t\t\\n\"\n \t\"18:\t\t\t\t@\t\t\t\t\\n\"\n \t\"mov\tr14,#0\t\t\t@ r14= v = 0\t\t\t\\n\"\n \t\"sub\tr5, r5, r1, LSL #8\t@ for (xx = x; xx > 0; x--) {\t\\n\"\n@@ -160,7 +161,7 @@\n \t\"mul\tr14,r4, r14\t\t@ r14= v *= divX\t\t\\n\"\n \t\"mov\tr14,r14,LSR #16\t\t@ r14= v >>= 16\t\t\t\\n\"\n \t\"strb\tr14,[r9], #1\t\t@ *d++ = r14\t\t\t\\n\"\n-\t\"sub\tr0, r0, r8\t\t@ s -= back2\t\t\t\\n\"\n+\t\"sub\tr0, r0, r8\t\t@ s -= back4\t\t\t\\n\"\n \t\"subs\tr5, r5, #1\t\t@ n--\t\t\t\t\\n\"\n \t\"bgt\t18b\t\t\t@ }\t\t\t\t\\n\"\n \t\"21:\t\t\t\t@\t\t\t\t\\n\"",
    "diff_line_info": {
        "deleted_lines": [
            "\t\"sub\tr0, r0, r8\t\t@ s -= back2\t\t\t\\n\""
        ],
        "added_lines": [
            "\t\"ldr\tr8, [r13,#4*17]\t\t@ r8 = back4\t\t\t\\n\"",
            "\t\"sub\tr0, r0, r8\t\t@ s -= back4\t\t\t\\n\""
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}