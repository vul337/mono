{
    "cve_id": "CVE-2018-14424",
    "cwe_ids": [
        "CWE-416"
    ],
    "cvss_vector": "AV:L/AC:L/Au:N/C:P/I:P/A:P",
    "cvss_is_v3": false,
    "repo_name": "GNOME/gdm",
    "commit_msg": "display-store: Pass the display object rather than the id in the removed signal\n\nBy the time GdmDisplayStore emits the \"display-removed\" signal, the display\nis no longer in the store and gdm_display_store_lookup will not work in\nsignal handlers.\n\nChange the \"display-removed\" parameter from the display id to the GdmDisplay\nobject, so that signal handers can perform any cleanup they need to do\n\nCVE-2018-14424\n\nCloses: https://gitlab.gnome.org/GNOME/gdm/issues/401",
    "commit_hash": "1ac1697b3b019f50729a6e992065959586e170da",
    "git_url": "https://github.com/GNOME/gdm/commit/1ac1697b3b019f50729a6e992065959586e170da",
    "file_path": "daemon/gdm-local-display-factory.c",
    "func_name": "on_display_removed",
    "func_before": "static void\non_display_removed (GdmDisplayStore        *display_store,\n                    const char             *id,\n                    GdmLocalDisplayFactory *factory)\n{\n        GdmDisplay *display;\n\n        display = gdm_display_store_lookup (display_store, id);\n\n        if (display != NULL) {\n                g_signal_handlers_disconnect_by_func (display, G_CALLBACK (on_display_status_changed), factory);\n                g_object_weak_unref (G_OBJECT (display), (GWeakNotify)on_display_disposed, factory);\n\n        }\n}",
    "abstract_func_before": "static void\non_display_removed (GdmDisplayStore        *VAR_0,\n                    const char             *VAR_1,\n                    GdmLocalDisplayFactory *VAR_2)\n{\n        GdmDisplay *VAR_3;\n\n        VAR_3 = gdm_display_store_lookup (VAR_0, VAR_1);\n\n        if (VAR_3 != NULL) {\n                g_signal_handlers_disconnect_by_func (VAR_3, G_CALLBACK (VAR_4), VAR_2);\n                g_object_weak_unref (G_OBJECT (VAR_3), (GWeakNotify)VAR_5, VAR_2);\n\n        }\n}",
    "func_graph_path_before": "GNOME/gdm/1ac1697b3b019f50729a6e992065959586e170da/gdm-local-display-factory.c/vul/before/0.json",
    "func": "static void\non_display_removed (GdmDisplayStore        *display_store,\n                    GdmDisplay             *display,\n                    GdmLocalDisplayFactory *factory)\n{\n        g_signal_handlers_disconnect_by_func (display, G_CALLBACK (on_display_status_changed), factory);\n        g_object_weak_unref (G_OBJECT (display), (GWeakNotify)on_display_disposed, factory);\n}",
    "abstract_func": "static void\non_display_removed (GdmDisplayStore        *VAR_0,\n                    GdmDisplay             *VAR_1,\n                    GdmLocalDisplayFactory *VAR_2)\n{\n        g_signal_handlers_disconnect_by_func (VAR_1, G_CALLBACK (VAR_3), VAR_2);\n        g_object_weak_unref (G_OBJECT (VAR_1), (GWeakNotify)VAR_4, VAR_2);\n}",
    "func_graph_path": "GNOME/gdm/1ac1697b3b019f50729a6e992065959586e170da/gdm-local-display-factory.c/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,15 +1,8 @@\n static void\n on_display_removed (GdmDisplayStore        *display_store,\n-                    const char             *id,\n+                    GdmDisplay             *display,\n                     GdmLocalDisplayFactory *factory)\n {\n-        GdmDisplay *display;\n-\n-        display = gdm_display_store_lookup (display_store, id);\n-\n-        if (display != NULL) {\n-                g_signal_handlers_disconnect_by_func (display, G_CALLBACK (on_display_status_changed), factory);\n-                g_object_weak_unref (G_OBJECT (display), (GWeakNotify)on_display_disposed, factory);\n-\n-        }\n+        g_signal_handlers_disconnect_by_func (display, G_CALLBACK (on_display_status_changed), factory);\n+        g_object_weak_unref (G_OBJECT (display), (GWeakNotify)on_display_disposed, factory);\n }",
    "diff_line_info": {
        "deleted_lines": [
            "                    const char             *id,",
            "        GdmDisplay *display;",
            "",
            "        display = gdm_display_store_lookup (display_store, id);",
            "",
            "        if (display != NULL) {",
            "                g_signal_handlers_disconnect_by_func (display, G_CALLBACK (on_display_status_changed), factory);",
            "                g_object_weak_unref (G_OBJECT (display), (GWeakNotify)on_display_disposed, factory);",
            "",
            "        }"
        ],
        "added_lines": [
            "                    GdmDisplay             *display,",
            "        g_signal_handlers_disconnect_by_func (display, G_CALLBACK (on_display_status_changed), factory);",
            "        g_object_weak_unref (G_OBJECT (display), (GWeakNotify)on_display_disposed, factory);"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}