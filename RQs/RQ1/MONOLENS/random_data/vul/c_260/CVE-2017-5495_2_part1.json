{
    "cve_id": "CVE-2017-5495",
    "cwe_ids": [
        "CWE-119"
    ],
    "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:N/A:C",
    "cvss_is_v3": false,
    "repo_name": "FRRouting/frr",
    "commit_msg": "lib: limit size of vty buffer to 4096 bytes\n\nThis removes the automatic resizing of the vty input buffer and places a\nhard size cap of 4096 bytes. It also fixes a potentially unsafe strcpy.\n\nSigned-off-by: Quentin Young <qlyoung@cumulusnetworks.com>",
    "commit_hash": "2af38873d89e20bd039255418366c1601aa99e64",
    "git_url": "https://github.com/FRRouting/frr/commit/2af38873d89e20bd039255418366c1601aa99e64",
    "file_path": "lib/vty.c",
    "func_name": "vty_insert_word_overwrite",
    "func_before": "static void\nvty_insert_word_overwrite (struct vty *vty, char *str)\n{\n  int len = strlen (str);\n  vty_write (vty, str, len);\n  strcpy (&vty->buf[vty->cp], str);\n  vty->cp += len;\n  vty->length = vty->cp;\n}",
    "abstract_func_before": "static void\nvty_insert_word_overwrite (struct vty *vty, char *VAR_0)\n{\n  int VAR_1 = strlen (VAR_0);\n  vty_write (vty, VAR_0, VAR_1);\n  strcpy (&vty->buf[vty->cp], VAR_0);\n  vty->cp += VAR_1;\n  vty->length = vty->cp;\n}",
    "func_graph_path_before": "FRRouting/frr/2af38873d89e20bd039255418366c1601aa99e64/vty.c/vul/before/3.json",
    "func": "static void\nvty_insert_word_overwrite (struct vty *vty, char *str)\n{\n  size_t nwrite = MIN ((int) strlen (str), VTY_BUFSIZ - vty->cp);\n  vty_write (vty, str, nwrite);\n  strncpy (&vty->buf[vty->cp], str, nwrite);\n  vty->cp += nwrite;\n  vty->length = vty->cp;\n}",
    "abstract_func": "static void\nvty_insert_word_overwrite (struct vty *vty, char *VAR_0)\n{\n  size_t VAR_1 = MIN ((int) strlen (VAR_0), VAR_2 - vty->cp);\n  vty_write (vty, VAR_0, VAR_1);\n  strncpy (&vty->buf[vty->cp], VAR_0, VAR_1);\n  vty->cp += VAR_1;\n  vty->length = vty->cp;\n}",
    "func_graph_path": "FRRouting/frr/2af38873d89e20bd039255418366c1601aa99e64/vty.c/vul/after/3.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,9 +1,9 @@\n static void\n vty_insert_word_overwrite (struct vty *vty, char *str)\n {\n-  int len = strlen (str);\n-  vty_write (vty, str, len);\n-  strcpy (&vty->buf[vty->cp], str);\n-  vty->cp += len;\n+  size_t nwrite = MIN ((int) strlen (str), VTY_BUFSIZ - vty->cp);\n+  vty_write (vty, str, nwrite);\n+  strncpy (&vty->buf[vty->cp], str, nwrite);\n+  vty->cp += nwrite;\n   vty->length = vty->cp;\n }",
    "diff_line_info": {
        "deleted_lines": [
            "  int len = strlen (str);",
            "  vty_write (vty, str, len);",
            "  strcpy (&vty->buf[vty->cp], str);",
            "  vty->cp += len;"
        ],
        "added_lines": [
            "  size_t nwrite = MIN ((int) strlen (str), VTY_BUFSIZ - vty->cp);",
            "  vty_write (vty, str, nwrite);",
            "  strncpy (&vty->buf[vty->cp], str, nwrite);",
            "  vty->cp += nwrite;"
        ]
    },
    "is_vul": true,
    "pr_url": "https://github.com/FRRouting/frr/pull/63",
    "description": "This removes the automatic resizing of the vty input buffer and places a\r\nhard size cap of 4096 bytes. It also fixes a potentially unsafe strcpy.\r\n\r\nSigned-off-by: Quentin Young <qlyoung@cumulusnetworks.com>"
}