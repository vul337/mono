{
    "cve_id": "CVE-2022-31135",
    "cwe_ids": [
        "CWE-129"
    ],
    "cvss_vector": "AV:N/AC:L/Au:N/C:N/I:N/A:C",
    "cvss_is_v3": false,
    "repo_name": "AttorneyOnline/akashi",
    "commit_msg": "Fix out of bounds crash on evidence",
    "commit_hash": "5566cdfedddef1f219aee33477d9c9690bf2f78b",
    "git_url": "https://github.com/AttorneyOnline/akashi/commit/5566cdfedddef1f219aee33477d9c9690bf2f78b",
    "file_path": "core/src/packets.cpp",
    "func_name": "AOClient::pktRemoveEvidence",
    "func_before": "void AOClient::pktRemoveEvidence(AreaData* area, int argc, QStringList argv, AOPacket packet)\n{\n    if (!checkEvidenceAccess(area))\n        return;\n    bool is_int = false;\n    int idx = argv[0].toInt(&is_int);\n    if (is_int && idx <= area->evidence().size() && idx >= 0) {\n        area->deleteEvidence(idx);\n    }\n    sendEvidenceList(area);\n}",
    "abstract_func_before": "void AOClient::pktRemoveEvidence(AreaData* VAR_0, int VAR_1, QStringList VAR_2, AOPacket VAR_3)\n{\n    if (!checkEvidenceAccess(VAR_0))\n        return;\n    bool VAR_4 = false;\n    int VAR_5 = VAR_2[0].toInt(&VAR_4);\n    if (VAR_4 && VAR_5 <= VAR_0->evidence().size() && VAR_5 >= 0) {\n        VAR_0->deleteEvidence(VAR_5);\n    }\n    sendEvidenceList(VAR_0);\n}",
    "func_graph_path_before": "AttorneyOnline/akashi/5566cdfedddef1f219aee33477d9c9690bf2f78b/packets.cpp/vul/before/0.json",
    "func": "void AOClient::pktRemoveEvidence(AreaData* area, int argc, QStringList argv, AOPacket packet)\n{\n    if (!checkEvidenceAccess(area))\n        return;\n    bool is_int = false;\n    int idx = argv[0].toInt(&is_int);\n    if (is_int && idx < area->evidence().size() && idx >= 0) {\n        area->deleteEvidence(idx);\n    }\n    sendEvidenceList(area);\n}",
    "abstract_func": "void AOClient::pktRemoveEvidence(AreaData* VAR_0, int VAR_1, QStringList VAR_2, AOPacket VAR_3)\n{\n    if (!checkEvidenceAccess(VAR_0))\n        return;\n    bool VAR_4 = false;\n    int VAR_5 = VAR_2[0].toInt(&VAR_4);\n    if (is_int && VAR_5 < VAR_0->evidence().size() && VAR_5 >= 0) {\n        VAR_0->deleteEvidence(VAR_5);\n    }\n    sendEvidenceList(VAR_0);\n}",
    "func_graph_path": "AttorneyOnline/akashi/5566cdfedddef1f219aee33477d9c9690bf2f78b/packets.cpp/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -4,7 +4,7 @@\n         return;\n     bool is_int = false;\n     int idx = argv[0].toInt(&is_int);\n-    if (is_int && idx <= area->evidence().size() && idx >= 0) {\n+    if (is_int && idx < area->evidence().size() && idx >= 0) {\n         area->deleteEvidence(idx);\n     }\n     sendEvidenceList(area);",
    "diff_line_info": {
        "deleted_lines": [
            "    if (is_int && idx <= area->evidence().size() && idx >= 0) {"
        ],
        "added_lines": [
            "    if (is_int && idx < area->evidence().size() && idx >= 0) {"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}