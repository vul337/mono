{
    "cve_id": "CVE-2019-11221",
    "cwe_ids": [
        "CWE-787"
    ],
    "cvss_vector": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
    "cvss_is_v3": false,
    "repo_name": "gpac",
    "commit_msg": "fix a bunch of vsprintf -> vsnprintf\n\ncloses #1203",
    "commit_hash": "f4616202e5578e65746cf7e7ceeba63bee1b094b",
    "git_url": "https://github.com/gpac/gpac/commit/f4616202e5578e65746cf7e7ceeba63bee1b094b",
    "file_path": "src/scene_manager/loader_isom.c",
    "func_name": "mp4_report",
    "func_before": "static void mp4_report(GF_SceneLoader *load, GF_Err e, char *format, ...)\n{\n#ifndef GPAC_DISABLE_LOG\n\tif (gf_log_tool_level_on(GF_LOG_PARSER, e ? GF_LOG_ERROR : GF_LOG_WARNING)) {\n\t\tchar szMsg[1024];\n\t\tva_list args;\n\t\tva_start(args, format);\n\t\tvsprintf(szMsg, format, args);\n\t\tva_end(args);\n\t\tGF_LOG((u32) (e ? GF_LOG_ERROR : GF_LOG_WARNING), GF_LOG_PARSER, (\"[MP4 Loading] %s\\n\", szMsg) );\n\t}\n#endif\n}",
    "abstract_func_before": "static void mp4_report(GF_SceneLoader *VAR_0, GF_Err VAR_1, char *VAR_2, ...)\n{\n#ifndef VAR_3\n\tif (gf_log_tool_level_on(VAR_4, VAR_1 ? VAR_5 : VAR_6)) {\n\t\tchar VAR_7[1024];\n\t\tva_list VAR_8;\n\t\tva_start(VAR_8, VAR_2);\n\t\tvsprintf(VAR_7, VAR_2, VAR_8);\n\t\tva_end(VAR_8);\n\t\tGF_LOG((VAR_9) (VAR_1 ? VAR_5 : VAR_6), VAR_4, (\"[MP4 Loading] %s\\n\", VAR_7) );\n\t}\n#endif\n}",
    "func_graph_path_before": "gpac/f4616202e5578e65746cf7e7ceeba63bee1b094b/loader_isom.c/vul/before/0.json",
    "func": "static void mp4_report(GF_SceneLoader *load, GF_Err e, char *format, ...)\n{\n#ifndef GPAC_DISABLE_LOG\n\tif (gf_log_tool_level_on(GF_LOG_PARSER, e ? GF_LOG_ERROR : GF_LOG_WARNING)) {\n\t\tchar szMsg[1024];\n\t\tva_list args;\n\t\tva_start(args, format);\n\t\tvsnprintf(szMsg, 1024, format, args);\n\t\tva_end(args);\n\t\tGF_LOG((u32) (e ? GF_LOG_ERROR : GF_LOG_WARNING), GF_LOG_PARSER, (\"[MP4 Loading] %s\\n\", szMsg) );\n\t}\n#endif\n}",
    "abstract_func": "static void mp4_report(GF_SceneLoader *VAR_0, GF_Err VAR_1, char *VAR_2, ...)\n{\n#ifndef VAR_3\n\tif (gf_log_tool_level_on(VAR_4, VAR_1 ? VAR_5 : VAR_6)) {\n\t\tchar VAR_7[1024];\n\t\tva_list VAR_8;\n\t\tva_start(VAR_8, VAR_2);\n\t\tvsnprintf(VAR_7, 1024, VAR_2, VAR_8);\n\t\tva_end(VAR_8);\n\t\tGF_LOG((VAR_9) (VAR_1 ? VAR_5 : VAR_6), VAR_4, (\"[MP4 Loading] %s\\n\", VAR_7) );\n\t}\n#endif\n}",
    "func_graph_path": "gpac/f4616202e5578e65746cf7e7ceeba63bee1b094b/loader_isom.c/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -5,7 +5,7 @@\n \t\tchar szMsg[1024];\n \t\tva_list args;\n \t\tva_start(args, format);\n-\t\tvsprintf(szMsg, format, args);\n+\t\tvsnprintf(szMsg, 1024, format, args);\n \t\tva_end(args);\n \t\tGF_LOG((u32) (e ? GF_LOG_ERROR : GF_LOG_WARNING), GF_LOG_PARSER, (\"[MP4 Loading] %s\\n\", szMsg) );\n \t}",
    "diff_line_info": {
        "deleted_lines": [
            "\t\tvsprintf(szMsg, format, args);"
        ],
        "added_lines": [
            "\t\tvsnprintf(szMsg, 1024, format, args);"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}