{
    "cve_id": "CVE-2016-9262",
    "cwe_ids": [
        "CWE-190"
    ],
    "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
    "cvss_is_v3": false,
    "repo_name": "jasper-software/jasper",
    "commit_msg": "Made some changes to the I/O stream library for memory streams.\nThere were a number of potential problems due to the possibility\nof integer overflow.\nChanged some integral types to the larger types size_t or ssize_t.\nFor example, the function mem_resize now takes the buffer size parameter\nas a size_t.\nAdded a new function jas_stream_memopen2, which takes a\nbuffer size specified as a size_t instead of an int.\nThis can be used in jas_image_cmpt_create to avoid potential\noverflow problems.\n\nAdded a new function jas_deprecated to warn about reliance on\ndeprecated library behavior.",
    "commit_hash": "634ce8e8a5accc0fa05dd2c20d42b4749d4b2735",
    "git_url": "https://github.com/jasper-software/jasper/commit/634ce8e8a5accc0fa05dd2c20d42b4749d4b2735",
    "file_path": "src/libjasper/base/jas_stream.c",
    "func_name": "jas_stream_gobble",
    "func_before": "int jas_stream_gobble(jas_stream_t *stream, int n)\n{\n\tint m;\n\tm = n;\n\tfor (m = n; m > 0; --m) {\n\t\tif (jas_stream_getc(stream) == EOF) {\n\t\t\treturn n - m;\n\t\t}\n\t}\n\treturn n;\n}",
    "abstract_func_before": "int jas_stream_gobble(jas_stream_t *VAR_0, int VAR_1)\n{\n\tint VAR_2;\n\tVAR_2 = VAR_1;\n\tfor (VAR_2 = VAR_1; VAR_2 > 0; --VAR_2) {\n\t\tif (jas_stream_getc(VAR_0) == VAR_3) {\n\t\t\treturn VAR_1 - VAR_2;\n\t\t}\n\t}\n\treturn VAR_1;\n}",
    "func_graph_path_before": "jasper-software/jasper/634ce8e8a5accc0fa05dd2c20d42b4749d4b2735/jas_stream.c/vul/before/6.json",
    "func": "int jas_stream_gobble(jas_stream_t *stream, int n)\n{\n\tint m;\n\tif (n < 0) {\n\t\tjas_deprecated(\"negative count for jas_stream_gobble\");\n\t}\n\tm = n;\n\tfor (m = n; m > 0; --m) {\n\t\tif (jas_stream_getc(stream) == EOF) {\n\t\t\treturn n - m;\n\t\t}\n\t}\n\treturn n;\n}",
    "abstract_func": "int jas_stream_gobble(jas_stream_t *VAR_0, int VAR_1)\n{\n\tint VAR_2;\n\tif (VAR_1 < 0) {\n\t\tjas_deprecated(\"negative count for jas_stream_gobble\");\n\t}\n\tVAR_2 = VAR_1;\n\tfor (VAR_2 = VAR_1; VAR_2 > 0; --VAR_2) {\n\t\tif (jas_stream_getc(VAR_0) == VAR_3) {\n\t\t\treturn VAR_1 - VAR_2;\n\t\t}\n\t}\n\treturn VAR_1;\n}",
    "func_graph_path": "jasper-software/jasper/634ce8e8a5accc0fa05dd2c20d42b4749d4b2735/jas_stream.c/vul/after/6.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,6 +1,9 @@\n int jas_stream_gobble(jas_stream_t *stream, int n)\n {\n \tint m;\n+\tif (n < 0) {\n+\t\tjas_deprecated(\"negative count for jas_stream_gobble\");\n+\t}\n \tm = n;\n \tfor (m = n; m > 0; --m) {\n \t\tif (jas_stream_getc(stream) == EOF) {",
    "diff_line_info": {
        "deleted_lines": [],
        "added_lines": [
            "\tif (n < 0) {",
            "\t\tjas_deprecated(\"negative count for jas_stream_gobble\");",
            "\t}"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}