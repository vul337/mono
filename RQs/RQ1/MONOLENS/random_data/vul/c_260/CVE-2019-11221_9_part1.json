{
    "cve_id": "CVE-2019-11221",
    "cwe_ids": [
        "CWE-787"
    ],
    "cvss_vector": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
    "cvss_is_v3": false,
    "repo_name": "gpac",
    "commit_msg": "fix a bunch of vsprintf -> vsnprintf\n\ncloses #1203",
    "commit_hash": "f4616202e5578e65746cf7e7ceeba63bee1b094b",
    "git_url": "https://github.com/gpac/gpac/commit/f4616202e5578e65746cf7e7ceeba63bee1b094b",
    "file_path": "src/scene_manager/loader_svg.c",
    "func_name": "svg_report",
    "func_before": "static GF_Err svg_report(GF_SVG_Parser *parser, GF_Err e, char *format, ...)\n{\n#ifndef GPAC_DISABLE_LOG\n\tif (gf_log_tool_level_on(GF_LOG_PARSER, e ? GF_LOG_ERROR : GF_LOG_WARNING)) {\n\t\tchar szMsg[2048];\n\t\tva_list args;\n\t\tva_start(args, format);\n\t\tvsprintf(szMsg, format, args);\n\t\tva_end(args);\n\t\tGF_LOG((u32) (e ? GF_LOG_ERROR : GF_LOG_WARNING), GF_LOG_PARSER, (\"[SVG Parsing] line %d - %s\\n\", gf_xml_sax_get_line(parser->sax_parser), szMsg));\n\t}\n#endif\n\tif (e) {\n\t\tparser->last_error = e;\n\t\tgf_xml_sax_suspend(parser->sax_parser, GF_TRUE);\n\t}\n\treturn e;\n}",
    "abstract_func_before": "static GF_Err svg_report(GF_SVG_Parser *VAR_0, GF_Err VAR_1, char *VAR_2, ...)\n{\n#ifndef VAR_3\n\tif (gf_log_tool_level_on(VAR_4, VAR_1 ? VAR_5 : VAR_6)) {\n\t\tchar VAR_7[2048];\n\t\tva_list VAR_8;\n\t\tva_start(VAR_8, VAR_2);\n\t\tvsprintf(VAR_7, VAR_2, VAR_8);\n\t\tva_end(VAR_8);\n\t\tGF_LOG((VAR_9) (VAR_1 ? VAR_5 : VAR_6), VAR_4, (\"[SVG Parsing] line %d - %s\\n\", gf_xml_sax_get_line(VAR_0->sax_parser), VAR_7));\n\t}\n#endif\n\tif (VAR_1) {\n\t\tVAR_0->last_error = VAR_1;\n\t\tgf_xml_sax_suspend(VAR_0->sax_parser, VAR_10);\n\t}\n\treturn VAR_1;\n}",
    "func_graph_path_before": "gpac/f4616202e5578e65746cf7e7ceeba63bee1b094b/loader_svg.c/vul/before/1.json",
    "func": "static GF_Err svg_report(GF_SVG_Parser *parser, GF_Err e, char *format, ...)\n{\n#ifndef GPAC_DISABLE_LOG\n\tif (gf_log_tool_level_on(GF_LOG_PARSER, e ? GF_LOG_ERROR : GF_LOG_WARNING)) {\n\t\tchar szMsg[2048];\n\t\tva_list args;\n\t\tva_start(args, format);\n\t\tvsnprintf(szMsg, 2048, format, args);\n\t\tva_end(args);\n\t\tGF_LOG((u32) (e ? GF_LOG_ERROR : GF_LOG_WARNING), GF_LOG_PARSER, (\"[SVG Parsing] line %d - %s\\n\", gf_xml_sax_get_line(parser->sax_parser), szMsg));\n\t}\n#endif\n\tif (e) {\n\t\tparser->last_error = e;\n\t\tgf_xml_sax_suspend(parser->sax_parser, GF_TRUE);\n\t}\n\treturn e;\n}",
    "abstract_func": "static GF_Err svg_report(GF_SVG_Parser *VAR_0, GF_Err VAR_1, char *VAR_2, ...)\n{\n#ifndef VAR_3\n\tif (gf_log_tool_level_on(VAR_4, VAR_1 ? VAR_5 : VAR_6)) {\n\t\tchar VAR_7[2048];\n\t\tva_list VAR_8;\n\t\tva_start(VAR_8, VAR_2);\n\t\tvsnprintf(VAR_7, 2048, VAR_2, VAR_8);\n\t\tva_end(VAR_8);\n\t\tGF_LOG((VAR_9) (VAR_1 ? VAR_5 : VAR_6), VAR_4, (\"[SVG Parsing] line %d - %s\\n\", gf_xml_sax_get_line(VAR_0->sax_parser), VAR_7));\n\t}\n#endif\n\tif (VAR_1) {\n\t\tVAR_0->last_error = VAR_1;\n\t\tgf_xml_sax_suspend(VAR_0->sax_parser, VAR_10);\n\t}\n\treturn VAR_1;\n}",
    "func_graph_path": "gpac/f4616202e5578e65746cf7e7ceeba63bee1b094b/loader_svg.c/vul/after/1.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -5,7 +5,7 @@\n \t\tchar szMsg[2048];\n \t\tva_list args;\n \t\tva_start(args, format);\n-\t\tvsprintf(szMsg, format, args);\n+\t\tvsnprintf(szMsg, 2048, format, args);\n \t\tva_end(args);\n \t\tGF_LOG((u32) (e ? GF_LOG_ERROR : GF_LOG_WARNING), GF_LOG_PARSER, (\"[SVG Parsing] line %d - %s\\n\", gf_xml_sax_get_line(parser->sax_parser), szMsg));\n \t}",
    "diff_line_info": {
        "deleted_lines": [
            "\t\tvsprintf(szMsg, format, args);"
        ],
        "added_lines": [
            "\t\tvsnprintf(szMsg, 2048, format, args);"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}