{
    "cve_id": "CVE-2023-26123",
    "cwe_ids": [
        "CWE-79"
    ],
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cvss_is_v3": true,
    "repo_name": "raysan5/raylib",
    "commit_msg": "ADDED: Security check for `emscripten_run_script()` #2954",
    "commit_hash": "b436c8d7e5346a241b00511a11585936895d959d",
    "git_url": "https://github.com/raysan5/raylib/commit/b436c8d7e5346a241b00511a11585936895d959d",
    "file_path": "src/rcore.c",
    "func_name": "SetClipboardText",
    "func_before": "void SetClipboardText(const char *text)\n{\n#if defined(PLATFORM_DESKTOP)\n    glfwSetClipboardString(CORE.Window.handle, text);\n#endif\n#if defined(PLATFORM_WEB)\n    emscripten_run_script(TextFormat(\"navigator.clipboard.writeText('%s')\", text));\n#endif\n}",
    "abstract_func_before": "void SetClipboardText(const char *VAR_0)\n{\n#if defined(VAR_1)\n    glfwSetClipboardString(VAR_2.Window.handle, VAR_0);\n#endif\n#if defined(VAR_3)\n    emscripten_run_script(TextFormat(\"navigator.clipboard.writeText('%s')\", VAR_0));\n#endif\n}",
    "func_graph_path_before": "raysan5/raylib/b436c8d7e5346a241b00511a11585936895d959d/rcore.c/vul/before/1.json",
    "func": "void SetClipboardText(const char *text)\n{\n#if defined(PLATFORM_DESKTOP)\n    glfwSetClipboardString(CORE.Window.handle, text);\n#endif\n#if defined(PLATFORM_WEB)\n    // Security check to (partially) avoid malicious code\n    if (strchr(text, '\\'') != NULL) TRACELOG(LOG_WARNING, \"SYSTEM: Provided Clipboard could be potentially malicious, avoid [\\'] character\");\n    else emscripten_run_script(TextFormat(\"navigator.clipboard.writeText('%s')\", text));\n#endif\n}",
    "abstract_func": "void SetClipboardText(const char *VAR_0)\n{\n#if defined(VAR_1)\n    glfwSetClipboardString(VAR_2.Window.handle, VAR_0);\n#endif\n#if defined(VAR_3)\n    /* COMMENT_0 */\n    if (strchr(VAR_0, '\\'') != NULL) TRACELOG(VAR_4, \"SYSTEM: Provided Clipboard could be potentially malicious, avoid [\\'] character\");\n    else emscripten_run_script(TextFormat(\"navigator.clipboard.writeText('%s')\", VAR_0));\n#endif\n}",
    "func_graph_path": "raysan5/raylib/b436c8d7e5346a241b00511a11585936895d959d/rcore.c/vul/after/1.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -4,6 +4,8 @@\n     glfwSetClipboardString(CORE.Window.handle, text);\n #endif\n #if defined(PLATFORM_WEB)\n-    emscripten_run_script(TextFormat(\"navigator.clipboard.writeText('%s')\", text));\n+    // Security check to (partially) avoid malicious code\n+    if (strchr(text, '\\'') != NULL) TRACELOG(LOG_WARNING, \"SYSTEM: Provided Clipboard could be potentially malicious, avoid [\\'] character\");\n+    else emscripten_run_script(TextFormat(\"navigator.clipboard.writeText('%s')\", text));\n #endif\n }",
    "diff_line_info": {
        "deleted_lines": [
            "    emscripten_run_script(TextFormat(\"navigator.clipboard.writeText('%s')\", text));"
        ],
        "added_lines": [
            "    // Security check to (partially) avoid malicious code",
            "    if (strchr(text, '\\'') != NULL) TRACELOG(LOG_WARNING, \"SYSTEM: Provided Clipboard could be potentially malicious, avoid [\\'] character\");",
            "    else emscripten_run_script(TextFormat(\"navigator.clipboard.writeText('%s')\", text));"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}