{
    "cve_id": "CVE-2017-6308",
    "cwe_ids": [
        "CWE-190"
    ],
    "cvss_vector": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
    "cvss_is_v3": false,
    "repo_name": "verdammelt/tnef",
    "commit_msg": "Fix integer overflows and harden memory allocator.",
    "commit_hash": "c5044689e50039635e7700fe2472fd632ac77176",
    "git_url": "https://github.com/verdammelt/tnef/commit/c5044689e50039635e7700fe2472fd632ac77176",
    "file_path": "src/alloc.c",
    "func_name": "alloc_limit_assert",
    "func_before": "void\nalloc_limit_assert (char *fn_name, size_t size)\n{\n    if (alloc_limit && size > alloc_limit)\n    {\n\talloc_limit_failure (fn_name, size);\n\texit (-1);\n    }\n}",
    "abstract_func_before": "void\nalloc_limit_assert (char *VAR_0, size_t VAR_1)\n{\n    if (VAR_2 && VAR_1 > VAR_2)\n    {\n\talloc_limit_failure (VAR_0, VAR_1);\n\texit (-1);\n    }\n}",
    "func_graph_path_before": "verdammelt/tnef/c5044689e50039635e7700fe2472fd632ac77176/alloc.c/vul/before/5.json",
    "func": "void\nalloc_limit_assert (char *fn_name, size_t size)\n{\n    if (alloc_limit && size > alloc_limit)\n    {\n        alloc_limit_failure (fn_name, size);\n        exit (-1);\n    }\n}",
    "abstract_func": "void\nalloc_limit_assert (char *VAR_0, size_t VAR_1)\n{\n    if (VAR_2 && VAR_1 > VAR_2)\n    {\n        alloc_limit_failure (VAR_0, VAR_1);\n        exit (-1);\n    }\n}",
    "func_graph_path": "verdammelt/tnef/c5044689e50039635e7700fe2472fd632ac77176/alloc.c/vul/after/5.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -3,7 +3,7 @@\n {\n     if (alloc_limit && size > alloc_limit)\n     {\n-\talloc_limit_failure (fn_name, size);\n-\texit (-1);\n+        alloc_limit_failure (fn_name, size);\n+        exit (-1);\n     }\n }",
    "diff_line_info": {
        "deleted_lines": [
            "\talloc_limit_failure (fn_name, size);",
            "\texit (-1);"
        ],
        "added_lines": [
            "        alloc_limit_failure (fn_name, size);",
            "        exit (-1);"
        ]
    },
    "is_vul": true,
    "pr_url": "https://github.com/verdammelt/tnef/pull/14",
    "description": "Security Fixes."
}