{
    "cve_id": "CVE-2022-2466",
    "cwe_ids": [
        "CWE-444"
    ],
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cvss_is_v3": true,
    "repo_name": "quarkusio/quarkus",
    "commit_msg": "GraphQL to terminate the request even if it was active\n\nSigned-off-by: Phillip Kruger <phillip.kruger@gmail.com>",
    "commit_hash": "08e5c3106ce4bfb18b24a38514eeba6464668b07",
    "git_url": "https://github.com/quarkusio/quarkus/commit/08e5c3106ce4bfb18b24a38514eeba6464668b07",
    "file_path": "extensions/smallrye-graphql/runtime/src/main/java/io/quarkus/smallrye/graphql/runtime/SmallRyeGraphQLExecutionHandler.java",
    "func_name": "readBody",
    "func_before": "private String readBody(RoutingContext ctx) {\n        if (ctx.getBody() != null) {\n            return ctx.getBodyAsString();\n        }\n        return null;\n    }",
    "abstract_func_before": "private String readBody(RoutingContext VAR_0) {\n        if (VAR_0.getBody() != null) {\n            return VAR_0.getBodyAsString();\n        }\n        return null;\n    }",
    "func_graph_path_before": "quarkusio/quarkus/08e5c3106ce4bfb18b24a38514eeba6464668b07/SmallRyeGraphQLExecutionHandler.java/vul/before/0.json",
    "func": "private String readBody(RoutingContext ctx) {\n        if (ctx.body() != null) {\n            return ctx.body().asString();\n        }\n        return null;\n    }",
    "abstract_func": "private String readBody(RoutingContext VAR_0) {\n        if (VAR_0.body() != null) {\n            return VAR_0.body().asString();\n        }\n        return null;\n    }",
    "func_graph_path": "quarkusio/quarkus/08e5c3106ce4bfb18b24a38514eeba6464668b07/SmallRyeGraphQLExecutionHandler.java/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,6 +1,6 @@\n private String readBody(RoutingContext ctx) {\n-        if (ctx.getBody() != null) {\n-            return ctx.getBodyAsString();\n+        if (ctx.body() != null) {\n+            return ctx.body().asString();\n         }\n         return null;\n     }",
    "diff_line_info": {
        "deleted_lines": [
            "        if (ctx.getBody() != null) {",
            "            return ctx.getBodyAsString();"
        ],
        "added_lines": [
            "        if (ctx.body() != null) {",
            "            return ctx.body().asString();"
        ]
    },
    "is_vul": true,
    "pr_url": "https://github.com/quarkusio/quarkus/pull/26934",
    "description": "Fix #26748\r\n(Again)\r\n\r\nThanks @cescoffier for the help :)\r\n\r\n\r\nSigned-off-by: Phillip Kruger <phillip.kruger@gmail.com>"
}