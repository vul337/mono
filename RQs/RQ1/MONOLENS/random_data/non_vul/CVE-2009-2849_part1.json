{
    "cve_id": "CVE-2009-2849",
    "cwe_ids": [
        "CWE-Other"
    ],
    "cvss_vector": "AV:L/AC:M/Au:N/C:N/I:N/A:C",
    "cvss_is_v3": false,
    "repo_name": "torvalds/linux",
    "commit_msg": "commit b8d966efd9a46a9a35beac50cbff6e30565125ef upstream.\n\nIf we try to modify one of the md/ sysfs files\n  suspend_lo or suspend_hi\nwhen the array is not active, we dereference a NULL.\nProtect against that.\n\nSigned-off-by: NeilBrown <neilb@suse.de>\nSigned-off-by: Greg Kroah-Hartman <gregkh@suse.de>\n\n",
    "commit_hash": "3c92900d9a4afb176d3de335dc0da0198660a244",
    "git_url": "http://git.kernel.org/?p=linux/kernel/git/stable/linux.git;a=commit;h=3c92900d9a4afb176d3de335dc0da0198660a244",
    "file_path": "drivers/md/md.c",
    "func_name": "suspend_hi_store",
    "func_before": "static ssize_t\nsuspend_hi_store(mddev_t *mddev, const char *buf, size_t len)\n{\n\tchar *e;\n\tunsigned long long new = simple_strtoull(buf, &e, 10);\n\n\tif (mddev->pers->quiesce == NULL)\n\t\treturn -EINVAL;\n\tif (buf == e || (*e && *e != '\\n'))\n\t\treturn -EINVAL;\n\tif ((new <= mddev->suspend_lo && mddev->suspend_lo >= mddev->suspend_hi) ||\n\t    (new > mddev->suspend_lo && new > mddev->suspend_hi)) {\n\t\tmddev->suspend_hi = new;\n\t\tmddev->pers->quiesce(mddev, 1);\n\t\tmddev->pers->quiesce(mddev, 0);\n\t\treturn len;\n\t} else\n\t\treturn -EINVAL;\n}",
    "abstract_func_before": "static ssize_t\nsuspend_hi_store(mddev_t *VAR_0, const char *VAR_1, size_t VAR_2)\n{\n\tchar *VAR_3;\n\tunsigned long long VAR_4 = simple_strtoull(VAR_1, &VAR_3, 10);\n\n\tif (VAR_0->pers->quiesce == NULL)\n\t\treturn -VAR_5;\n\tif (VAR_1 == VAR_3 || (*VAR_3 && *VAR_3 != '\\n'))\n\t\treturn -VAR_5;\n\tif ((VAR_4 <= VAR_0->suspend_lo && VAR_0->suspend_lo >= VAR_0->suspend_hi) ||\n\t    (VAR_4 > VAR_0->suspend_lo && VAR_4 > VAR_0->suspend_hi)) {\n\t\tVAR_0->suspend_hi = VAR_4;\n\t\tVAR_0->pers->quiesce(VAR_0, 1);\n\t\tVAR_0->pers->quiesce(VAR_0, 0);\n\t\treturn VAR_2;\n\t} else\n\t\treturn -VAR_5;\n}",
    "func_graph_path_before": "torvalds/linux/3c92900d9a4afb176d3de335dc0da0198660a244/md.c/vul/before/0.json",
    "func": "static ssize_t\nsuspend_hi_store(mddev_t *mddev, const char *buf, size_t len)\n{\n\tchar *e;\n\tunsigned long long new = simple_strtoull(buf, &e, 10);\n\n\tif (mddev->pers == NULL ||\n\t    mddev->pers->quiesce == NULL)\n\t\treturn -EINVAL;\n\tif (buf == e || (*e && *e != '\\n'))\n\t\treturn -EINVAL;\n\tif ((new <= mddev->suspend_lo && mddev->suspend_lo >= mddev->suspend_hi) ||\n\t    (new > mddev->suspend_lo && new > mddev->suspend_hi)) {\n\t\tmddev->suspend_hi = new;\n\t\tmddev->pers->quiesce(mddev, 1);\n\t\tmddev->pers->quiesce(mddev, 0);\n\t\treturn len;\n\t} else\n\t\treturn -EINVAL;\n}",
    "abstract_func": "static ssize_t\nsuspend_hi_store(mddev_t *VAR_0, const char *VAR_1, size_t VAR_2)\n{\n\tchar *VAR_3;\n\tunsigned long long VAR_4 = simple_strtoull(VAR_1, &VAR_3, 10);\n\n\tif (VAR_0->pers == NULL ||\n\t    VAR_0->pers->quiesce == NULL)\n\t\treturn -VAR_5;\n\tif (VAR_1 == VAR_3 || (*VAR_3 && *VAR_3 != '\\n'))\n\t\treturn -VAR_5;\n\tif ((VAR_4 <= VAR_0->suspend_lo && VAR_0->suspend_lo >= VAR_0->suspend_hi) ||\n\t    (VAR_4 > VAR_0->suspend_lo && VAR_4 > VAR_0->suspend_hi)) {\n\t\tVAR_0->suspend_hi = VAR_4;\n\t\tVAR_0->pers->quiesce(VAR_0, 1);\n\t\tVAR_0->pers->quiesce(VAR_0, 0);\n\t\treturn VAR_2;\n\t} else\n\t\treturn -VAR_5;\n}",
    "func_graph_path": "torvalds/linux/3c92900d9a4afb176d3de335dc0da0198660a244/md.c/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -4,7 +4,8 @@\n \tchar *e;\n \tunsigned long long new = simple_strtoull(buf, &e, 10);\n \n-\tif (mddev->pers->quiesce == NULL)\n+\tif (mddev->pers == NULL ||\n+\t    mddev->pers->quiesce == NULL)\n \t\treturn -EINVAL;\n \tif (buf == e || (*e && *e != '\\n'))\n \t\treturn -EINVAL;",
    "diff_line_info": {
        "deleted_lines": [
            "\tif (mddev->pers->quiesce == NULL)"
        ],
        "added_lines": [
            "\tif (mddev->pers == NULL ||",
            "\t    mddev->pers->quiesce == NULL)"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}