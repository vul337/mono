{
    "cve_id": "CVE-2022-24818",
    "cwe_ids": [
        "CWE-917"
    ],
    "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
    "cvss_is_v3": false,
    "repo_name": "geotools",
    "commit_msg": "[GEOT-7115] Streamline JNDI lookups",
    "commit_hash": "4f70fa3234391dd0cda883a20ab0ec75688cba49",
    "git_url": "https://github.com/geotools/geotools/commit/4f70fa3234391dd0cda883a20ab0ec75688cba49",
    "file_path": "modules/library/referencing/src/main/java/org/geotools/referencing/factory/epsg/ThreadedEpsgFactory.java",
    "func_name": "createDataSource",
    "func_before": "protected DataSource createDataSource() throws SQLException {\n        InitialContext context = null;\n        DataSource source = null;\n        try {\n            context = GeoTools.getInitialContext();\n            source = (DataSource) context.lookup(datasourceName);\n        } catch (IllegalArgumentException | NoInitialContextException exception) {\n            // Fall back on 'return null' below.\n        } catch (NamingException exception) {\n            registerInto = context;\n            // Fall back on 'return null' below.\n        }\n        return source;\n    }",
    "abstract_func_before": "protected DataSource createDataSource() throws SQLException {\n        InitialContext VAR_0 = null;\n        DataSource VAR_1 = null;\n        try {\n            VAR_0 = VAR_2.getInitialContext();\n            VAR_1 = (DataSource) VAR_0.lookup(VAR_3);\n        } catch (IllegalArgumentException | NoInitialContextException VAR_4) {\n            /* COMMENT_0 */\n        } catch (NamingException VAR_4) {\n            VAR_5 = VAR_0;\n            /* COMMENT_0 */\n        }\n        return VAR_1;\n    }",
    "func_graph_path_before": "geotools/4f70fa3234391dd0cda883a20ab0ec75688cba49/ThreadedEpsgFactory.java/vul/before/0.json",
    "func": "protected DataSource createDataSource() throws SQLException {\n        DataSource source = null;\n        try {\n            source = (DataSource) GeoTools.jndiLookup(datasourceName);\n        } catch (IllegalArgumentException | NamingException exception) {\n            // Fall back on 'return null' below.\n        }\n        return source;\n    }",
    "abstract_func": "protected DataSource createDataSource() throws SQLException {\n        DataSource VAR_0 = null;\n        try {\n            VAR_0 = (DataSource) VAR_1.jndiLookup(VAR_2);\n        } catch (IllegalArgumentException | NamingException VAR_3) {\n            /* COMMENT_0 */\n        }\n        return VAR_0;\n    }",
    "func_graph_path": "geotools/4f70fa3234391dd0cda883a20ab0ec75688cba49/ThreadedEpsgFactory.java/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,13 +1,8 @@\n protected DataSource createDataSource() throws SQLException {\n-        InitialContext context = null;\n         DataSource source = null;\n         try {\n-            context = GeoTools.getInitialContext();\n-            source = (DataSource) context.lookup(datasourceName);\n-        } catch (IllegalArgumentException | NoInitialContextException exception) {\n-            // Fall back on 'return null' below.\n-        } catch (NamingException exception) {\n-            registerInto = context;\n+            source = (DataSource) GeoTools.jndiLookup(datasourceName);\n+        } catch (IllegalArgumentException | NamingException exception) {\n             // Fall back on 'return null' below.\n         }\n         return source;",
    "diff_line_info": {
        "deleted_lines": [
            "        InitialContext context = null;",
            "            context = GeoTools.getInitialContext();",
            "            source = (DataSource) context.lookup(datasourceName);",
            "        } catch (IllegalArgumentException | NoInitialContextException exception) {",
            "            // Fall back on 'return null' below.",
            "        } catch (NamingException exception) {",
            "            registerInto = context;"
        ],
        "added_lines": [
            "            source = (DataSource) GeoTools.jndiLookup(datasourceName);",
            "        } catch (IllegalArgumentException | NamingException exception) {"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}