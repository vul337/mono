{
    "cve_id": "CVE-2021-45931",
    "cwe_ids": [
        "CWE-787"
    ],
    "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
    "cvss_is_v3": false,
    "repo_name": "harfbuzz",
    "commit_msg": "[set] Make all operators null-safe again\n\nChanged my mind.\n\nAlso for hb_map_clear().\n\nPart of https://github.com/harfbuzz/harfbuzz/pull/3162",
    "commit_hash": "d3e09bf4654fe5478b6dbf2b26ebab6271317d81",
    "git_url": "https://github.com/harfbuzz/harfbuzz/commit/d3e09bf4654fe5478b6dbf2b26ebab6271317d81",
    "file_path": "src/hb-set.cc",
    "func_name": "hb_set_clear",
    "func_before": "void\nhb_set_clear (hb_set_t *set)\n{\n  if (unlikely (hb_object_is_immutable (set)))\n    return;\n\n  set->clear ();\n}",
    "abstract_func_before": "void\nhb_set_clear (hb_set_t *VAR_0)\n{\n  if (unlikely (hb_object_is_immutable (VAR_0)))\n    return;\n\n  VAR_0->clear ();\n}",
    "func_graph_path_before": "harfbuzz/d3e09bf4654fe5478b6dbf2b26ebab6271317d81/hb-set.cc/vul/before/4.json",
    "func": "void\nhb_set_clear (hb_set_t *set)\n{\n  /* Immutible-safe. */\n  set->clear ();\n}",
    "abstract_func": "void\nhb_set_clear (hb_set_t *VAR_0)\n{\n  /* COMMENT_0 */\n  VAR_0->clear ();\n}",
    "func_graph_path": "harfbuzz/d3e09bf4654fe5478b6dbf2b26ebab6271317d81/hb-set.cc/vul/after/4.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,8 +1,6 @@\n void\n hb_set_clear (hb_set_t *set)\n {\n-  if (unlikely (hb_object_is_immutable (set)))\n-    return;\n-\n+  /* Immutible-safe. */\n   set->clear ();\n }",
    "diff_line_info": {
        "deleted_lines": [
            "  if (unlikely (hb_object_is_immutable (set)))",
            "    return;",
            ""
        ],
        "added_lines": [
            "  /* Immutible-safe. */"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}