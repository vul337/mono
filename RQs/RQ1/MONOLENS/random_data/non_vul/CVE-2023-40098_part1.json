{
    "cve_id": "CVE-2023-40098",
    "cwe_ids": [
        "CWE-Other"
    ],
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "cvss_is_v3": true,
    "repo_name": "android",
    "commit_msg": "Disable priority conversation widget for secondary users\n\nTest: NotificationConversationInfoTest.java\nTest: make a conversation priority on the primary user\nTest: make a conversation priority on a secondary user\nBug: 288896269\n(cherry picked from commit adf620316dcfaf19d7d4a73e2c63322b4a3a4d3a)\n(cherry picked from https://googleplex-android-review.googlesource.com/q/commit:7444c007743970a9d6877c1b3fd2b28143687281)\nMerged-In: I3f3991d2cb7fb9970cc8ada39ceae9a7ff2fcb31\nChange-Id: I3f3991d2cb7fb9970cc8ada39ceae9a7ff2fcb31\n",
    "commit_hash": "d21ffbe8a2eeb2a5e6da7efbb1a0430ba6b022e0",
    "git_url": "https://android.googlesource.com/platform/frameworks/base/+/d21ffbe8a2eeb2a5e6da7efbb1a0430ba6b022e0",
    "file_path": "packages/SystemUI/src/com/android/systemui/statusbar/notification/dagger/NotificationsModule.java",
    "func_name": "provideNotificationGutsManager",
    "func_before": "@SysUISingleton\n    @Provides\n    static NotificationGutsManager provideNotificationGutsManager(\n            Context context,\n            Lazy<Optional<CentralSurfaces>> centralSurfacesOptionalLazy,\n            @Main Handler mainHandler,\n            @Background Handler bgHandler,\n            AccessibilityManager accessibilityManager,\n            HighPriorityProvider highPriorityProvider,\n            INotificationManager notificationManager,\n            NotificationEntryManager notificationEntryManager,\n            PeopleSpaceWidgetManager peopleSpaceWidgetManager,\n            LauncherApps launcherApps,\n            ShortcutManager shortcutManager,\n            ChannelEditorDialogController channelEditorDialogController,\n            UserContextProvider contextTracker,\n            AssistantFeedbackController assistantFeedbackController,\n            Optional<BubblesManager> bubblesManagerOptional,\n            UiEventLogger uiEventLogger,\n            OnUserInteractionCallback onUserInteractionCallback,\n            ShadeController shadeController,\n            DumpManager dumpManager) {\n        return new NotificationGutsManager(\n                context,\n                centralSurfacesOptionalLazy,\n                mainHandler,\n                bgHandler,\n                accessibilityManager,\n                highPriorityProvider,\n                notificationManager,\n                notificationEntryManager,\n                peopleSpaceWidgetManager,\n                launcherApps,\n                shortcutManager,\n                channelEditorDialogController,\n                contextTracker,\n                assistantFeedbackController,\n                bubblesManagerOptional,\n                uiEventLogger,\n                onUserInteractionCallback,\n                shadeController,\n                dumpManager);\n    }",
    "abstract_func_before": "@SysUISingleton\n    @Provides\n    static NotificationGutsManager provideNotificationGutsManager(\n            Context VAR_0,\n            Lazy<Optional<CentralSurfaces>> VAR_1,\n            @Main Handler VAR_2,\n            @Background Handler VAR_3,\n            AccessibilityManager VAR_4,\n            HighPriorityProvider VAR_5,\n            INotificationManager VAR_6,\n            NotificationEntryManager VAR_7,\n            PeopleSpaceWidgetManager VAR_8,\n            LauncherApps VAR_9,\n            ShortcutManager VAR_10,\n            ChannelEditorDialogController VAR_11,\n            UserContextProvider VAR_12,\n            AssistantFeedbackController VAR_13,\n            Optional<BubblesManager> VAR_14,\n            UiEventLogger VAR_15,\n            OnUserInteractionCallback VAR_16,\n            ShadeController VAR_17,\n            DumpManager VAR_18) {\n        return new NotificationGutsManager(\n                VAR_0,\n                VAR_1,\n                VAR_2,\n                VAR_3,\n                VAR_4,\n                VAR_5,\n                VAR_6,\n                VAR_7,\n                VAR_8,\n                VAR_9,\n                VAR_10,\n                VAR_11,\n                VAR_12,\n                VAR_13,\n                VAR_14,\n                VAR_15,\n                VAR_16,\n                VAR_17,\n                VAR_18);\n    }",
    "func_graph_path_before": "android/d21ffbe8a2eeb2a5e6da7efbb1a0430ba6b022e0/NotificationsModule.java/vul/before/0.json",
    "func": "@SysUISingleton\n    @Provides\n    static NotificationGutsManager provideNotificationGutsManager(\n            Context context,\n            Lazy<Optional<CentralSurfaces>> centralSurfacesOptionalLazy,\n            @Main Handler mainHandler,\n            @Background Handler bgHandler,\n            AccessibilityManager accessibilityManager,\n            HighPriorityProvider highPriorityProvider,\n            INotificationManager notificationManager,\n            NotificationEntryManager notificationEntryManager,\n            UserManager userManager,\n            PeopleSpaceWidgetManager peopleSpaceWidgetManager,\n            LauncherApps launcherApps,\n            ShortcutManager shortcutManager,\n            ChannelEditorDialogController channelEditorDialogController,\n            UserContextProvider contextTracker,\n            AssistantFeedbackController assistantFeedbackController,\n            Optional<BubblesManager> bubblesManagerOptional,\n            UiEventLogger uiEventLogger,\n            OnUserInteractionCallback onUserInteractionCallback,\n            ShadeController shadeController,\n            DumpManager dumpManager) {\n        return new NotificationGutsManager(\n                context,\n                centralSurfacesOptionalLazy,\n                mainHandler,\n                bgHandler,\n                accessibilityManager,\n                highPriorityProvider,\n                notificationManager,\n                notificationEntryManager,\n                userManager,\n                peopleSpaceWidgetManager,\n                launcherApps,\n                shortcutManager,\n                channelEditorDialogController,\n                contextTracker,\n                assistantFeedbackController,\n                bubblesManagerOptional,\n                uiEventLogger,\n                onUserInteractionCallback,\n                shadeController,\n                dumpManager);\n    }",
    "abstract_func": "@SysUISingleton\n    @Provides\n    static NotificationGutsManager provideNotificationGutsManager(\n            Context VAR_0,\n            Lazy<Optional<CentralSurfaces>> VAR_1,\n            @Main Handler VAR_2,\n            @Background Handler VAR_3,\n            AccessibilityManager VAR_4,\n            HighPriorityProvider VAR_5,\n            INotificationManager VAR_6,\n            NotificationEntryManager VAR_7,\n            UserManager VAR_8,\n            PeopleSpaceWidgetManager VAR_9,\n            LauncherApps VAR_10,\n            ShortcutManager VAR_11,\n            ChannelEditorDialogController VAR_12,\n            UserContextProvider VAR_13,\n            AssistantFeedbackController VAR_14,\n            Optional<BubblesManager> VAR_15,\n            UiEventLogger VAR_16,\n            OnUserInteractionCallback VAR_17,\n            ShadeController VAR_18,\n            DumpManager VAR_19) {\n        return new NotificationGutsManager(\n                VAR_0,\n                VAR_1,\n                VAR_2,\n                VAR_3,\n                VAR_4,\n                VAR_5,\n                VAR_6,\n                VAR_7,\n                VAR_8,\n                VAR_9,\n                VAR_10,\n                VAR_11,\n                VAR_12,\n                VAR_13,\n                VAR_14,\n                VAR_15,\n                VAR_16,\n                VAR_17,\n                VAR_18,\n                VAR_19);\n    }",
    "func_graph_path": "android/d21ffbe8a2eeb2a5e6da7efbb1a0430ba6b022e0/NotificationsModule.java/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -9,6 +9,7 @@\n             HighPriorityProvider highPriorityProvider,\n             INotificationManager notificationManager,\n             NotificationEntryManager notificationEntryManager,\n+            UserManager userManager,\n             PeopleSpaceWidgetManager peopleSpaceWidgetManager,\n             LauncherApps launcherApps,\n             ShortcutManager shortcutManager,\n@@ -29,6 +30,7 @@\n                 highPriorityProvider,\n                 notificationManager,\n                 notificationEntryManager,\n+                userManager,\n                 peopleSpaceWidgetManager,\n                 launcherApps,\n                 shortcutManager,",
    "diff_line_info": {
        "deleted_lines": [],
        "added_lines": [
            "            UserManager userManager,",
            "                userManager,"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}