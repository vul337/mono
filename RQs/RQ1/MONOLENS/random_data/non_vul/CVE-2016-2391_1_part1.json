{
    "cve_id": "CVE-2016-2391",
    "cwe_ids": [
        "CWE-476"
    ],
    "cvss_vector": "AV:L/AC:L/Au:N/C:N/I:N/A:P",
    "cvss_is_v3": false,
    "repo_name": "qemu",
    "commit_msg": "ohci: allocate timer only once.\n\nAllocate timer once, at init time, instead of allocating/freeing\nit all the time when starting/stopping the bus.  Simplifies the\ncode, also fixes bugs (memory leak) due to missing checks whenever\nthe time is already allocated or not.\n\nCc: Prasad J Pandit <pjp@fedoraproject.org>\nReported-by: Zuozhi Fzz <zuozhi.fzz@alibaba-inc.com>\nSigned-off-by: Gerd Hoffmann <kraxel@redhat.com>",
    "commit_hash": "fa1298c2d623522eda7b4f1f721fcb935abb7360",
    "git_url": "https://github.com/qemu/qemu/commit/fa1298c2d623522eda7b4f1f721fcb935abb7360",
    "file_path": "hw/usb/hcd-ohci.c",
    "func_name": "ohci_eof_timer_needed",
    "func_before": "static bool ohci_eof_timer_needed(void *opaque)\n{\n    OHCIState *ohci = opaque;\n\n    return ohci->eof_timer != NULL;\n}",
    "abstract_func_before": "static bool ohci_eof_timer_needed(void *VAR_0)\n{\n    OHCIState *VAR_1 = VAR_0;\n\n    return VAR_1->eof_timer != NULL;\n}",
    "func_graph_path_before": "qemu/fa1298c2d623522eda7b4f1f721fcb935abb7360/hcd-ohci.c/vul/before/2.json",
    "func": "static bool ohci_eof_timer_needed(void *opaque)\n{\n    OHCIState *ohci = opaque;\n\n    return timer_pending(ohci->eof_timer);\n}",
    "abstract_func": "static bool ohci_eof_timer_needed(void *VAR_0)\n{\n    OHCIState *VAR_1 = VAR_0;\n\n    return timer_pending(VAR_1->eof_timer);\n}",
    "func_graph_path": "qemu/fa1298c2d623522eda7b4f1f721fcb935abb7360/hcd-ohci.c/vul/after/2.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -2,5 +2,5 @@\n {\n     OHCIState *ohci = opaque;\n \n-    return ohci->eof_timer != NULL;\n+    return timer_pending(ohci->eof_timer);\n }",
    "diff_line_info": {
        "deleted_lines": [
            "    return ohci->eof_timer != NULL;"
        ],
        "added_lines": [
            "    return timer_pending(ohci->eof_timer);"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}