{
    "cve_id": "CVE-2016-1662",
    "cwe_ids": [
        "CWE-Other"
    ],
    "cvss_vector": "AV:N/AC:L/Au:N/C:C/I:C/A:C",
    "cvss_is_v3": false,
    "repo_name": "chromium",
    "commit_msg": "Don't execute the fallback if we already started running the gc callback\n\nBUG=603732\nR=vogelheim@chromium.org\n\nReview URL: https://codereview.chromium.org/1887423002\n\nCr-Commit-Position: refs/heads/master@{#387578}\n",
    "commit_hash": "34c97b31e61e8329e19188b46a489412a16d2b63",
    "git_url": "https://chromium.googlesource.com/chromium/src/+/34c97b31e61e8329e19188b46a489412a16d2b63",
    "file_path": "extensions/renderer/gc_callback.cc",
    "func_name": "GCCallback::OnContextInvalidated",
    "func_before": "void GCCallback::OnContextInvalidated() {\n  fallback_.Run();\n  delete this;\n}",
    "abstract_func_before": "void GCCallback::OnContextInvalidated() {\n  VAR_0.Run();\n  delete this;\n}",
    "func_graph_path_before": "chromium/34c97b31e61e8329e19188b46a489412a16d2b63/gc_callback.cc/vul/before/1.json",
    "func": "void GCCallback::OnContextInvalidated() {\n  if (!fallback_.is_null()) {\n    fallback_.Run();\n    delete this;\n  }\n}",
    "abstract_func": "void GCCallback::OnContextInvalidated() {\n  if (!VAR_0.is_null()) {\n    VAR_0.Run();\n    delete this;\n  }\n}",
    "func_graph_path": "chromium/34c97b31e61e8329e19188b46a489412a16d2b63/gc_callback.cc/vul/after/1.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,4 +1,6 @@\n void GCCallback::OnContextInvalidated() {\n-  fallback_.Run();\n-  delete this;\n+  if (!fallback_.is_null()) {\n+    fallback_.Run();\n+    delete this;\n+  }\n }",
    "diff_line_info": {
        "deleted_lines": [
            "  fallback_.Run();",
            "  delete this;"
        ],
        "added_lines": [
            "  if (!fallback_.is_null()) {",
            "    fallback_.Run();",
            "    delete this;",
            "  }"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}