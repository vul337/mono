{
    "cve_id": "CVE-2022-46166",
    "cwe_ids": [
        "CWE-94"
    ],
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cvss_is_v3": true,
    "repo_name": "codecentric/spring-boot-admin",
    "commit_msg": "feat: improve notifiers",
    "commit_hash": "c14c3ec12533f71f84de9ce3ce5ceb7991975f75",
    "git_url": "https://github.com/codecentric/spring-boot-admin/commit/c14c3ec12533f71f84de9ce3ce5ceb7991975f75",
    "file_path": "spring-boot-admin-server/src/main/java/de/codecentric/boot/admin/server/notify/MicrosoftTeamsNotifier.java",
    "func_name": "createEvaluationContext",
    "func_before": "protected StandardEvaluationContext createEvaluationContext(InstanceEvent event, Instance instance) {\n\t\tMap<String, Object> root = new HashMap<>();\n\t\troot.put(\"event\", event);\n\t\troot.put(\"instance\", instance);\n\t\troot.put(\"lastStatus\", getLastStatus(event.getInstance()));\n\t\tStandardEvaluationContext context = new StandardEvaluationContext(root);\n\t\tcontext.addPropertyAccessor(new MapAccessor());\n\t\treturn context;\n\t}",
    "abstract_func_before": "protected StandardEvaluationContext createEvaluationContext(InstanceEvent VAR_0, Instance VAR_1) {\n\t\tMap<String, Object> VAR_2 = new HashMap<>();\n\t\tVAR_2.put(\"event\", VAR_0);\n\t\tVAR_2.put(\"instance\", VAR_1);\n\t\tVAR_2.put(\"lastStatus\", getLastStatus(VAR_0.getInstance()));\n\t\tStandardEvaluationContext VAR_3 = new StandardEvaluationContext(VAR_2);\n\t\tVAR_3.addPropertyAccessor(new MapAccessor());\n\t\treturn VAR_3;\n\t}",
    "func_graph_path_before": "codecentric/spring-boot-admin/c14c3ec12533f71f84de9ce3ce5ceb7991975f75/MicrosoftTeamsNotifier.java/vul/before/3.json",
    "func": "protected EvaluationContext createEvaluationContext(InstanceEvent event, Instance instance) {\n\t\tMap<String, Object> root = new HashMap<>();\n\t\troot.put(\"event\", event);\n\t\troot.put(\"instance\", instance);\n\t\troot.put(\"lastStatus\", getLastStatus(event.getInstance()));\n\t\treturn SimpleEvaluationContext\n\t\t\t\t.forPropertyAccessors(DataBindingPropertyAccessor.forReadOnlyAccess(), new MapAccessor())\n\t\t\t\t.withRootObject(root).build();\n\t}",
    "abstract_func": "protected EvaluationContext createEvaluationContext(InstanceEvent VAR_0, Instance VAR_1) {\n\t\tMap<String, Object> VAR_2 = new HashMap<>();\n\t\tVAR_2.put(\"event\", VAR_0);\n\t\tVAR_2.put(\"instance\", VAR_1);\n\t\tVAR_2.put(\"lastStatus\", getLastStatus(VAR_0.getInstance()));\n\t\treturn VAR_3\n\t\t\t\t.forPropertyAccessors(VAR_4.forReadOnlyAccess(), new MapAccessor())\n\t\t\t\t.withRootObject(VAR_2).build();\n\t}",
    "func_graph_path": "codecentric/spring-boot-admin/c14c3ec12533f71f84de9ce3ce5ceb7991975f75/MicrosoftTeamsNotifier.java/vul/after/3.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,9 +1,9 @@\n-protected StandardEvaluationContext createEvaluationContext(InstanceEvent event, Instance instance) {\n+protected EvaluationContext createEvaluationContext(InstanceEvent event, Instance instance) {\n \t\tMap<String, Object> root = new HashMap<>();\n \t\troot.put(\"event\", event);\n \t\troot.put(\"instance\", instance);\n \t\troot.put(\"lastStatus\", getLastStatus(event.getInstance()));\n-\t\tStandardEvaluationContext context = new StandardEvaluationContext(root);\n-\t\tcontext.addPropertyAccessor(new MapAccessor());\n-\t\treturn context;\n+\t\treturn SimpleEvaluationContext\n+\t\t\t\t.forPropertyAccessors(DataBindingPropertyAccessor.forReadOnlyAccess(), new MapAccessor())\n+\t\t\t\t.withRootObject(root).build();\n \t}",
    "diff_line_info": {
        "deleted_lines": [
            "protected StandardEvaluationContext createEvaluationContext(InstanceEvent event, Instance instance) {",
            "\t\tStandardEvaluationContext context = new StandardEvaluationContext(root);",
            "\t\tcontext.addPropertyAccessor(new MapAccessor());",
            "\t\treturn context;"
        ],
        "added_lines": [
            "protected EvaluationContext createEvaluationContext(InstanceEvent event, Instance instance) {",
            "\t\treturn SimpleEvaluationContext",
            "\t\t\t\t.forPropertyAccessors(DataBindingPropertyAccessor.forReadOnlyAccess(), new MapAccessor())",
            "\t\t\t\t.withRootObject(root).build();"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}