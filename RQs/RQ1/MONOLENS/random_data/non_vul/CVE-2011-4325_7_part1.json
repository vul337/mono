{
    "cve_id": "CVE-2011-4325",
    "cwe_ids": [
        "CWE-Other"
    ],
    "cvss_vector": "AV:L/AC:L/Au:N/C:N/I:N/A:C",
    "cvss_is_v3": false,
    "repo_name": "torvalds/linux",
    "commit_msg": "We can't call nfs_readdata_release()/nfs_writedata_release() without\nfirst initialising and referencing args.context. Doing so inside\nnfs_direct_read_schedule_segment()/nfs_direct_write_schedule_segment()\ncauses an Oops.\n\nWe should rather be calling nfs_readdata_free()/nfs_writedata_free() in\nthose cases.\n\nLooking at the O_DIRECT code, the \"struct nfs_direct_req\" is already\nreferencing the nfs_open_context for us. Since the readdata and writedata\nstructures carry a reference to that, we can simplify things by getting rid\nof the extra nfs_open_context references, so that we can replace all\ninstances of nfs_readdata_release()/nfs_writedata_release().\n\nReported-by: Catalin Marinas <catalin.marinas@arm.com>\nSigned-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>\nTested-by: Catalin Marinas <catalin.marinas@arm.com>\nCc: stable@kernel.org\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>\n",
    "commit_hash": "1ae88b2e446261c038f2c0c3150ffae142b227a2",
    "git_url": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=commitdiff;h=1ae88b2e4",
    "file_path": "fs/nfs/direct.c",
    "func_name": "nfs_direct_free_writedata",
    "func_before": "static void nfs_direct_free_writedata(struct nfs_direct_req *dreq)\n{\n\twhile (!list_empty(&dreq->rewrite_list)) {\n\t\tstruct nfs_write_data *data = list_entry(dreq->rewrite_list.next, struct nfs_write_data, pages);\n\t\tlist_del(&data->pages);\n\t\tnfs_direct_release_pages(data->pagevec, data->npages);\n\t\tnfs_writedata_release(data);\n\t}\n}",
    "abstract_func_before": "static void nfs_direct_free_writedata(struct nfs_direct_req *VAR_0)\n{\n\twhile (!list_empty(&VAR_0->rewrite_list)) {\n\t\tstruct nfs_write_data *VAR_1 = list_entry(VAR_0->rewrite_list.next, struct nfs_write_data, VAR_2);\n\t\tlist_del(&VAR_1->pages);\n\t\tnfs_direct_release_pages(VAR_1->pagevec, VAR_1->npages);\n\t\tnfs_writedata_release(VAR_1);\n\t}\n}",
    "func_graph_path_before": "torvalds/linux/1ae88b2e446261c038f2c0c3150ffae142b227a2/direct.c/vul/before/4.json",
    "func": "static void nfs_direct_free_writedata(struct nfs_direct_req *dreq)\n{\n\twhile (!list_empty(&dreq->rewrite_list)) {\n\t\tstruct nfs_write_data *data = list_entry(dreq->rewrite_list.next, struct nfs_write_data, pages);\n\t\tlist_del(&data->pages);\n\t\tnfs_direct_release_pages(data->pagevec, data->npages);\n\t\tnfs_writedata_free(data);\n\t}\n}",
    "abstract_func": "static void nfs_direct_free_writedata(struct nfs_direct_req *VAR_0)\n{\n\twhile (!list_empty(&VAR_0->rewrite_list)) {\n\t\tstruct nfs_write_data *VAR_1 = list_entry(VAR_0->rewrite_list.next, struct nfs_write_data, VAR_2);\n\t\tlist_del(&VAR_1->pages);\n\t\tnfs_direct_release_pages(VAR_1->pagevec, VAR_1->npages);\n\t\tnfs_writedata_free(VAR_1);\n\t}\n}",
    "func_graph_path": "torvalds/linux/1ae88b2e446261c038f2c0c3150ffae142b227a2/direct.c/vul/after/4.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -4,6 +4,6 @@\n \t\tstruct nfs_write_data *data = list_entry(dreq->rewrite_list.next, struct nfs_write_data, pages);\n \t\tlist_del(&data->pages);\n \t\tnfs_direct_release_pages(data->pagevec, data->npages);\n-\t\tnfs_writedata_release(data);\n+\t\tnfs_writedata_free(data);\n \t}\n }",
    "diff_line_info": {
        "deleted_lines": [
            "\t\tnfs_writedata_release(data);"
        ],
        "added_lines": [
            "\t\tnfs_writedata_free(data);"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}