{
    "cve_id": "CVE-2016-3883",
    "cwe_ids": [
        "CWE-284"
    ],
    "cvss_vector": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
    "cvss_is_v3": false,
    "repo_name": "android",
    "commit_msg": "DO NOT MERGE add private function convertSafeLable\n\nBug: 28557603\nChange-Id: I8d6a13a71011c38e7dd7039fa7ae0a69cf6adc2e\n",
    "commit_hash": "b2c89e6f8962dc7aff88cb38aa3ee67d751edda9",
    "git_url": "https://android.googlesource.com/platform/frameworks/opt/telephony/+/b2c89e6f8962dc7aff88cb38aa3ee67d751edda9",
    "file_path": "src/java/com/android/internal/telephony/SMSDispatcher.java",
    "func_name": "getAppLabel",
    "func_before": "private CharSequence getAppLabel(String appPackage) {\n        PackageManager pm = mContext.getPackageManager();\n        try {\n            ApplicationInfo appInfo = pm.getApplicationInfo(appPackage, 0);\n            return appInfo.loadSafeLabel(pm);\n        } catch (PackageManager.NameNotFoundException e) {\n            Rlog.e(TAG, \"PackageManager Name Not Found for package \" + appPackage);\n            return appPackage;  // fall back to package name if we can't get app label\n        }\n    }",
    "abstract_func_before": "private CharSequence getAppLabel(String VAR_0) {\n        PackageManager VAR_1 = VAR_2.getPackageManager();\n        try {\n            ApplicationInfo VAR_3 = VAR_1.getApplicationInfo(VAR_0, 0);\n            return VAR_3.loadSafeLabel(VAR_1);\n        } catch (PackageManager.NameNotFoundException VAR_4) {\n            VAR_5.e(VAR_6, \"PackageManager Name Not Found for package \" + VAR_0);\n            return VAR_0;  /* COMMENT_0 */\n        }\n    }",
    "func_graph_path_before": "android/b2c89e6f8962dc7aff88cb38aa3ee67d751edda9/SMSDispatcher.java/vul/before/0.json",
    "func": "private CharSequence getAppLabel(String appPackage) {\n        PackageManager pm = mContext.getPackageManager();\n        try {\n            ApplicationInfo appInfo = pm.getApplicationInfo(appPackage, 0);\n            String label = appInfo.loadLabel(pm).toString();\n            return convertSafeLabel(label, appPackage);\n        } catch (PackageManager.NameNotFoundException e) {\n            Rlog.e(TAG, \"PackageManager Name Not Found for package \" + appPackage);\n            return appPackage;  // fall back to package name if we can't get app label\n        }\n    }",
    "abstract_func": "private CharSequence getAppLabel(String VAR_0) {\n        PackageManager VAR_1 = VAR_2.getPackageManager();\n        try {\n            ApplicationInfo VAR_3 = VAR_1.getApplicationInfo(VAR_0, 0);\n            String VAR_4 = VAR_3.loadLabel(VAR_1).toString();\n            return convertSafeLabel(VAR_4, VAR_0);\n        } catch (PackageManager.NameNotFoundException VAR_5) {\n            VAR_6.e(VAR_7, \"PackageManager Name Not Found for package \" + VAR_0);\n            return VAR_0;  /* COMMENT_0 */\n        }\n    }",
    "func_graph_path": "android/b2c89e6f8962dc7aff88cb38aa3ee67d751edda9/SMSDispatcher.java/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -2,7 +2,8 @@\n         PackageManager pm = mContext.getPackageManager();\n         try {\n             ApplicationInfo appInfo = pm.getApplicationInfo(appPackage, 0);\n-            return appInfo.loadSafeLabel(pm);\n+            String label = appInfo.loadLabel(pm).toString();\n+            return convertSafeLabel(label, appPackage);\n         } catch (PackageManager.NameNotFoundException e) {\n             Rlog.e(TAG, \"PackageManager Name Not Found for package \" + appPackage);\n             return appPackage;  // fall back to package name if we can't get app label",
    "diff_line_info": {
        "deleted_lines": [
            "            return appInfo.loadSafeLabel(pm);"
        ],
        "added_lines": [
            "            String label = appInfo.loadLabel(pm).toString();",
            "            return convertSafeLabel(label, appPackage);"
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}