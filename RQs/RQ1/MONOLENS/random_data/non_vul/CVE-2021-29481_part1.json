{
    "cve_id": "CVE-2021-29481",
    "cwe_ids": [
        "CWE-312"
    ],
    "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
    "cvss_is_v3": false,
    "repo_name": "ratpack",
    "commit_msg": "Use more portable secure random",
    "commit_hash": "60302fae7ef26897b9a0ec0def6281a9425344cf",
    "git_url": "https://github.com/ratpack/ratpack/commit/60302fae7ef26897b9a0ec0def6281a9425344cf",
    "file_path": "ratpack-session/src/main/java/ratpack/session/clientside/ClientSideSessionConfig.java",
    "func_name": "randomString",
    "func_before": "private static String randomString(int byteLength) {\n    byte[] bytes = new byte[byteLength];\n    try {\n      SecureRandom.getInstanceStrong().nextBytes(bytes);\n    } catch (NoSuchAlgorithmException e) {\n      throw new UncheckedException(e);\n    }\n    return new String(bytes, StandardCharsets.ISO_8859_1);\n  }",
    "abstract_func_before": "private static String randomString(int VAR_0) {\n    byte[] VAR_1 = new byte[VAR_0];\n    try {\n      VAR_2.getInstanceStrong().nextBytes(VAR_1);\n    } catch (NoSuchAlgorithmException VAR_3) {\n      throw new UncheckedException(VAR_3);\n    }\n    return new String(VAR_1, VAR_4.ISO_8859_1);\n  }",
    "func_graph_path_before": "ratpack/60302fae7ef26897b9a0ec0def6281a9425344cf/ClientSideSessionConfig.java/vul/before/0.json",
    "func": "private static String randomString(int byteLength) {\n    byte[] bytes = new byte[byteLength];\n    SECURE_RANDOM.nextBytes(bytes);\n    return new String(bytes, StandardCharsets.ISO_8859_1);\n  }",
    "abstract_func": "private static String randomString(int VAR_0) {\n    byte[] VAR_1 = new byte[VAR_0];\n    VAR_2.nextBytes(VAR_1);\n    return new String(VAR_1, VAR_3.ISO_8859_1);\n  }",
    "func_graph_path": "ratpack/60302fae7ef26897b9a0ec0def6281a9425344cf/ClientSideSessionConfig.java/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,9 +1,5 @@\n private static String randomString(int byteLength) {\n     byte[] bytes = new byte[byteLength];\n-    try {\n-      SecureRandom.getInstanceStrong().nextBytes(bytes);\n-    } catch (NoSuchAlgorithmException e) {\n-      throw new UncheckedException(e);\n-    }\n+    SECURE_RANDOM.nextBytes(bytes);\n     return new String(bytes, StandardCharsets.ISO_8859_1);\n   }",
    "diff_line_info": {
        "deleted_lines": [
            "    try {",
            "      SecureRandom.getInstanceStrong().nextBytes(bytes);",
            "    } catch (NoSuchAlgorithmException e) {",
            "      throw new UncheckedException(e);",
            "    }"
        ],
        "added_lines": [
            "    SECURE_RANDOM.nextBytes(bytes);"
        ]
    },
    "is_vul": true,
    "pr_url": "https://github.com/ratpack/ratpack/pull/1590",
    "description": "\n\n<!-- Reviewable:start -->\nThis change is\u2002[<img src=\"https://reviewable.io/review_button.svg\" height=\"34\" align=\"absmiddle\" alt=\"Reviewable\"/>](https://reviewable.io/reviews/ratpack/ratpack/1590)\n<!-- Reviewable:end -->\n"
}