{
    "cve_id": "CVE-2018-1000613",
    "cwe_ids": [
        "CWE-470"
    ],
    "cvss_vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
    "cvss_is_v3": false,
    "repo_name": "bcgit/bc-java",
    "commit_msg": "added additional checking to XMSS BDS tree parsing. Failures now mostly cause IOException",
    "commit_hash": "4092ede58da51af9a21e4825fbad0d9a3ef5a223",
    "git_url": "https://github.com/bcgit/bc-java/commit/4092ede58da51af9a21e4825fbad0d9a3ef5a223",
    "file_path": "core/src/main/java/org/bouncycastle/pqc/crypto/rainbow/RainbowParameters.java",
    "func_name": "checkParams",
    "func_before": "private void checkParams()\n        throws Exception\n    {\n        if (vi == null)\n        {\n            throw new Exception(\"no layers defined.\");\n        }\n        if (vi.length > 1)\n        {\n            for (int i = 0; i < vi.length - 1; i++)\n            {\n                if (vi[i] >= vi[i + 1])\n                {\n                    throw new Exception(\n                        \"v[i] has to be smaller than v[i+1]\");\n                }\n            }\n        }\n        else\n        {\n            throw new Exception(\n                \"Rainbow needs at least 1 layer, such that v1 < v2.\");\n        }\n    }",
    "abstract_func_before": "private void checkParams()\n        throws Exception\n    {\n        if (VAR_0 == null)\n        {\n            throw new Exception(\"no layers defined.\");\n        }\n        if (VAR_0.length > 1)\n        {\n            for (int VAR_1 = 0; VAR_1 < VAR_0.length - 1; VAR_1++)\n            {\n                if (VAR_0[VAR_1] >= VAR_0[VAR_1 + 1])\n                {\n                    throw new Exception(\n                        \"v[i] has to be smaller than v[i+1]\");\n                }\n            }\n        }\n        else\n        {\n            throw new Exception(\n                \"Rainbow needs at least 1 layer, such that v1 < v2.\");\n        }\n    }",
    "func_graph_path_before": "bcgit/bc-java/4092ede58da51af9a21e4825fbad0d9a3ef5a223/RainbowParameters.java/vul/before/0.json",
    "func": "private void checkParams()\n    {\n        if (vi == null)\n        {\n            throw new IllegalArgumentException(\"no layers defined.\");\n        }\n        if (vi.length > 1)\n        {\n            for (int i = 0; i < vi.length - 1; i++)\n            {\n                if (vi[i] >= vi[i + 1])\n                {\n                    throw new IllegalArgumentException(\n                        \"v[i] has to be smaller than v[i+1]\");\n                }\n            }\n        }\n        else\n        {\n            throw new IllegalArgumentException(\n                \"Rainbow needs at least 1 layer, such that v1 < v2.\");\n        }\n    }",
    "abstract_func": "private void checkParams()\n    {\n        if (VAR_0 == null)\n        {\n            throw new IllegalArgumentException(\"no layers defined.\");\n        }\n        if (VAR_0.length > 1)\n        {\n            for (int VAR_1 = 0; VAR_1 < VAR_0.length - 1; VAR_1++)\n            {\n                if (VAR_0[VAR_1] >= VAR_0[VAR_1 + 1])\n                {\n                    throw new IllegalArgumentException(\n                        \"v[i] has to be smaller than v[i+1]\");\n                }\n            }\n        }\n        else\n        {\n            throw new IllegalArgumentException(\n                \"Rainbow needs at least 1 layer, such that v1 < v2.\");\n        }\n    }",
    "func_graph_path": "bcgit/bc-java/4092ede58da51af9a21e4825fbad0d9a3ef5a223/RainbowParameters.java/vul/after/0.json",
    "diff_func": "--- func_before\n+++ func_after\n@@ -1,9 +1,8 @@\n private void checkParams()\n-        throws Exception\n     {\n         if (vi == null)\n         {\n-            throw new Exception(\"no layers defined.\");\n+            throw new IllegalArgumentException(\"no layers defined.\");\n         }\n         if (vi.length > 1)\n         {\n@@ -11,14 +10,14 @@\n             {\n                 if (vi[i] >= vi[i + 1])\n                 {\n-                    throw new Exception(\n+                    throw new IllegalArgumentException(\n                         \"v[i] has to be smaller than v[i+1]\");\n                 }\n             }\n         }\n         else\n         {\n-            throw new Exception(\n+            throw new IllegalArgumentException(\n                 \"Rainbow needs at least 1 layer, such that v1 < v2.\");\n         }\n     }",
    "diff_line_info": {
        "deleted_lines": [
            "        throws Exception",
            "            throw new Exception(\"no layers defined.\");",
            "                    throw new Exception(",
            "            throw new Exception("
        ],
        "added_lines": [
            "            throw new IllegalArgumentException(\"no layers defined.\");",
            "                    throw new IllegalArgumentException(",
            "            throw new IllegalArgumentException("
        ]
    },
    "is_vul": true,
    "pr_url": null,
    "description": "no more info"
}